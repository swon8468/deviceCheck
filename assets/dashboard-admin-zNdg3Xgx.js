import{r as $e,j as m,u as fx,a as Yc,B as Ge,C as cE,T as _e,G as Tt,b as In,c as Cn,P as ua,F as qs,I as Xs,S as Ks,M as Nr,d as $r,e as Ya,f as Qa,g as Ja,h as on,i as Te,k as Za,l as an,m as nt,n as oa,o as lE,D as uE,p as Hf,L as hE,q as fE,s as dE,t as mE,v as pE,w as gE,x as Gf,y as fp,z as dp,A as qf,E as Xf,H as Kf,R as Yf,J as qa,K as Uo,N as Du,O as mp,Q as Pu,U as Ws,V as $s,W as zs,X as Hs,Y as xE,Z as wE,_ as vE,$ as _E}from"./vendor-mui-EHn5RoE1.js";const yE="modulepreload",EE=function(t){return"/"+t},pp={},ro=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){let c=function(l){return Promise.all(l.map(h=>Promise.resolve(h).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");s=c(r.map(l=>{if(l=EE(l),l in pp)return;pp[l]=!0;const h=l.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const f=document.createElement("link");if(f.rel=h?"stylesheet":yE,h||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),h)return new Promise((g,w)=>{f.addEventListener("load",g),f.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})},TE=()=>{};var gp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dx=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},SE=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],a=t[r++],o=t[r++],c=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},mx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,o=a?t[s+1]:0,c=s+2<t.length,l=c?t[s+2]:0,h=i>>2,d=(i&3)<<4|o>>4;let f=(o&15)<<2|l>>6,g=l&63;c||(g=64,a||(f=64)),n.push(r[h],r[d],r[f],r[g])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(dx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):SE(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const l=s<t.length?r[t.charAt(s)]:64;++s;const d=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||o==null||l==null||d==null)throw new AE;const f=i<<2|o>>4;if(n.push(f),l!==64){const g=o<<4&240|l>>2;if(n.push(g),d!==64){const w=l<<6&192|d;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class AE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kE=function(t){const e=dx(t);return mx.encodeByteArray(e,!0)},oh=function(t){return kE(t).replace(/\./g,"")},px=function(t){try{return mx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE=()=>bE().__FIREBASE_DEFAULTS__,CE=()=>{if(typeof process>"u"||typeof gp>"u")return;const t=gp.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},RE=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&px(t[1]);return e&&JSON.parse(e)},Qh=()=>{try{return TE()||IE()||CE()||RE()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},gx=t=>Qh()?.emulatorHosts?.[t],DE=t=>{const e=gx(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},xx=()=>Qh()?.config,wx=t=>Qh()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tc(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function vx(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[oh(JSON.stringify(r)),oh(JSON.stringify(a)),""].join(".")}const cl={};function NE(){const t={prod:[],emulator:[]};for(const e of Object.keys(cl))cl[e]?t.emulator.push(e):t.prod.push(e);return t}function OE(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let xp=!1;function _x(t,e){if(typeof window>"u"||typeof document>"u"||!Tc(window.location.host)||cl[t]===e||cl[t]||xp)return;cl[t]=e;function r(f){return`__firebase__banner__${f}`}const n="__firebase__banner",i=NE().prod.length>0;function a(){const f=document.getElementById(n);f&&f.remove()}function o(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,g){f.setAttribute("width","24"),f.setAttribute("id",g),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function l(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{xp=!0,a()},f}function h(f,g){f.setAttribute("id",g),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function d(){const f=OE(n),g=r("text"),w=document.getElementById(g)||document.createElement("span"),x=r("learnmore"),y=document.getElementById(x)||document.createElement("a"),A=r("preprendIcon"),F=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const I=f.element;o(I),h(y,x);const W=l();c(F,A),I.append(F,w,y,W),document.body.appendChild(I)}i?(w.innerText="Preview backend disconnected.",F.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(F.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function LE(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Vn())}function ME(){const t=Qh()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function BE(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function VE(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function jE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function UE(){const t=Vn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function WE(){return!ME()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $E(){try{return typeof indexedDB=="object"}catch{return!1}}function zE(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE="FirebaseError";class Ki extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=HE,Object.setPrototypeOf(this,Ki.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Hl.prototype.create)}}class Hl{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?GE(i,n):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new Ki(s,o,n)}}function GE(t,e){return t.replace(qE,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const qE=/\{\$([^}]+)}/g;function XE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ho(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],a=e[s];if(wp(i)&&wp(a)){if(!ho(i,a))return!1}else if(i!==a)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function wp(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gl(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Zc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function el(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function KE(t,e){const r=new YE(t,e);return r.subscribe.bind(r)}class YE{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");QE(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=Qf),s.error===void 0&&(s.error=Qf),s.complete===void 0&&(s.complete=Qf);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function QE(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Qf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Br(t){return t&&t._delegate?t._delegate:t}class fo{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new PE;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(eT(e))try{this.getOrInitializeService({instanceIdentifier:eo})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=eo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=eo){return this.instances.has(e)}getOptions(e=eo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);n===o&&a.resolve(s)}return s}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const i=this.instances.get(n);return i&&e(i,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:ZE(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=eo){return this.component?this.component.multipleInstances?e:eo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ZE(t){return t===eo?void 0:t}function eT(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new JE(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var At;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(At||(At={}));const rT={debug:At.DEBUG,verbose:At.VERBOSE,info:At.INFO,warn:At.WARN,error:At.ERROR,silent:At.SILENT},nT=At.INFO,sT={[At.DEBUG]:"log",[At.VERBOSE]:"log",[At.INFO]:"info",[At.WARN]:"warn",[At.ERROR]:"error"},iT=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=sT[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class xd{constructor(e){this.name=e,this._logLevel=nT,this._logHandler=iT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in At))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?rT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,At.DEBUG,...e),this._logHandler(this,At.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,At.VERBOSE,...e),this._logHandler(this,At.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,At.INFO,...e),this._logHandler(this,At.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,At.WARN,...e),this._logHandler(this,At.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,At.ERROR,...e),this._logHandler(this,At.ERROR,...e)}}const aT=(t,e)=>e.some(r=>t instanceof r);let vp,_p;function oT(){return vp||(vp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cT(){return _p||(_p=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const yx=new WeakMap,C0=new WeakMap,Ex=new WeakMap,Jf=new WeakMap,wd=new WeakMap;function lT(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(ga(t.result)),s()},a=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&yx.set(r,t)}).catch(()=>{}),wd.set(e,t),e}function uT(t){if(C0.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),s()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});C0.set(t,e)}let R0={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return C0.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Ex.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ga(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function hT(t){R0=t(R0)}function fT(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Zf(this),e,...r);return Ex.set(n,e.sort?e.sort():[e]),ga(n)}:cT().includes(t)?function(...e){return t.apply(Zf(this),e),ga(yx.get(this))}:function(...e){return ga(t.apply(Zf(this),e))}}function dT(t){return typeof t=="function"?fT(t):(t instanceof IDBTransaction&&uT(t),aT(t,oT())?new Proxy(t,R0):t)}function ga(t){if(t instanceof IDBRequest)return lT(t);if(Jf.has(t))return Jf.get(t);const e=dT(t);return e!==t&&(Jf.set(t,e),wd.set(e,t)),e}const Zf=t=>wd.get(t);function mT(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),o=ga(a);return n&&a.addEventListener("upgradeneeded",c=>{n(ga(a.result),c.oldVersion,c.newVersion,ga(a.transaction),c)}),r&&a.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",l=>s(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}const pT=["get","getKey","getAll","getAllKeys","count"],gT=["put","add","delete","clear"],e0=new Map;function yp(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(e0.get(e))return e0.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=gT.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||pT.includes(r)))return;const i=async function(a,...o){const c=this.transaction(a,s?"readwrite":"readonly");let l=c.store;return n&&(l=l.index(o.shift())),(await Promise.all([l[r](...o),s&&c.done]))[0]};return e0.set(e,i),i}hT(t=>({...t,get:(e,r,n)=>yp(e,r)||t.get(e,r,n),has:(e,r)=>!!yp(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(wT(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function wT(t){return t.getComponent()?.type==="VERSION"}const D0="@firebase/app",Ep="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zi=new xd("@firebase/app"),vT="@firebase/app-compat",_T="@firebase/analytics-compat",yT="@firebase/analytics",ET="@firebase/app-check-compat",TT="@firebase/app-check",ST="@firebase/auth",AT="@firebase/auth-compat",kT="@firebase/database",bT="@firebase/data-connect",IT="@firebase/database-compat",CT="@firebase/functions",RT="@firebase/functions-compat",DT="@firebase/installations",PT="@firebase/installations-compat",FT="@firebase/messaging",NT="@firebase/messaging-compat",OT="@firebase/performance",LT="@firebase/performance-compat",MT="@firebase/remote-config",BT="@firebase/remote-config-compat",VT="@firebase/storage",jT="@firebase/storage-compat",UT="@firebase/firestore",WT="@firebase/ai",$T="@firebase/firestore-compat",zT="firebase",HT="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P0="[DEFAULT]",GT={[D0]:"fire-core",[vT]:"fire-core-compat",[yT]:"fire-analytics",[_T]:"fire-analytics-compat",[TT]:"fire-app-check",[ET]:"fire-app-check-compat",[ST]:"fire-auth",[AT]:"fire-auth-compat",[kT]:"fire-rtdb",[bT]:"fire-data-connect",[IT]:"fire-rtdb-compat",[CT]:"fire-fn",[RT]:"fire-fn-compat",[DT]:"fire-iid",[PT]:"fire-iid-compat",[FT]:"fire-fcm",[NT]:"fire-fcm-compat",[OT]:"fire-perf",[LT]:"fire-perf-compat",[MT]:"fire-rc",[BT]:"fire-rc-compat",[VT]:"fire-gcs",[jT]:"fire-gcs-compat",[UT]:"fire-fst",[$T]:"fire-fst-compat",[WT]:"fire-vertex","fire-js":"fire-js",[zT]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ch=new Map,qT=new Map,F0=new Map;function Tp(t,e){try{t.container.addComponent(e)}catch(r){zi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function uc(t){const e=t.name;if(F0.has(e))return zi.debug(`There were multiple attempts to register component ${e}.`),!1;F0.set(e,t);for(const r of ch.values())Tp(r,t);for(const r of qT.values())Tp(r,t);return!0}function vd(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Ds(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XT={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xa=new Hl("app","Firebase",XT);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new fo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sc=HT;function Tx(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:P0,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw xa.create("bad-app-name",{appName:String(s)});if(r||(r=xx()),!r)throw xa.create("no-options");const i=ch.get(s);if(i){if(ho(r,i.options)&&ho(n,i.config))return i;throw xa.create("duplicate-app",{appName:s})}const a=new tT(s);for(const c of F0.values())a.addComponent(c);const o=new KT(r,n,a);return ch.set(s,o),o}function Sx(t=P0){const e=ch.get(t);if(!e&&t===P0&&xx())return Tx();if(!e)throw xa.create("no-app",{appName:t});return e}function wa(t,e,r){let n=GT[t]??t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${n}" with version "${e}":`];s&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zi.warn(a.join(" "));return}uc(new fo(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YT="firebase-heartbeat-database",QT=1,Tl="firebase-heartbeat-store";let t0=null;function Ax(){return t0||(t0=mT(YT,QT,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Tl)}catch(r){console.warn(r)}}}}).catch(t=>{throw xa.create("idb-open",{originalErrorMessage:t.message})})),t0}async function JT(t){try{const r=(await Ax()).transaction(Tl),n=await r.objectStore(Tl).get(kx(t));return await r.done,n}catch(e){if(e instanceof Ki)zi.warn(e.message);else{const r=xa.create("idb-get",{originalErrorMessage:e?.message});zi.warn(r.message)}}}async function Sp(t,e){try{const n=(await Ax()).transaction(Tl,"readwrite");await n.objectStore(Tl).put(e,kx(t)),await n.done}catch(r){if(r instanceof Ki)zi.warn(r.message);else{const n=xa.create("idb-set",{originalErrorMessage:r?.message});zi.warn(n.message)}}}function kx(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZT=1024,eS=30;class tS{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new nS(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Ap();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(s=>s.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>eS){const s=sS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){zi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Ap(),{heartbeatsToSend:r,unsentEntries:n}=rS(this._heartbeatsCache.heartbeats),s=oh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return zi.warn(e),""}}}function Ap(){return new Date().toISOString().substring(0,10)}function rS(t,e=ZT){const r=[];let n=t.slice();for(const s of t){const i=r.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),kp(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),kp(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class nS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $E()?zE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await JT(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Sp(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Sp(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function kp(t){return oh(JSON.stringify({version:2,heartbeats:t})).length}function sS(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(t){uc(new fo("platform-logger",e=>new xT(e),"PRIVATE")),uc(new fo("heartbeat",e=>new tS(e),"PRIVATE")),wa(D0,Ep,t),wa(D0,Ep,"esm2020"),wa("fire-js","")}iS("");var aS="firebase",oS="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wa(aS,oS,"app");var bp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var va,bx;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,k){function S(){}S.prototype=k.prototype,T.D=k.prototype,T.prototype=new S,T.prototype.constructor=T,T.C=function(R,C,_){for(var P=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)P[Fe-2]=arguments[Fe];return k.prototype[C].apply(R,P)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,k,S){S||(S=0);var R=Array(16);if(typeof k=="string")for(var C=0;16>C;++C)R[C]=k.charCodeAt(S++)|k.charCodeAt(S++)<<8|k.charCodeAt(S++)<<16|k.charCodeAt(S++)<<24;else for(C=0;16>C;++C)R[C]=k[S++]|k[S++]<<8|k[S++]<<16|k[S++]<<24;k=T.g[0],S=T.g[1],C=T.g[2];var _=T.g[3],P=k+(_^S&(C^_))+R[0]+3614090360&4294967295;k=S+(P<<7&4294967295|P>>>25),P=_+(C^k&(S^C))+R[1]+3905402710&4294967295,_=k+(P<<12&4294967295|P>>>20),P=C+(S^_&(k^S))+R[2]+606105819&4294967295,C=_+(P<<17&4294967295|P>>>15),P=S+(k^C&(_^k))+R[3]+3250441966&4294967295,S=C+(P<<22&4294967295|P>>>10),P=k+(_^S&(C^_))+R[4]+4118548399&4294967295,k=S+(P<<7&4294967295|P>>>25),P=_+(C^k&(S^C))+R[5]+1200080426&4294967295,_=k+(P<<12&4294967295|P>>>20),P=C+(S^_&(k^S))+R[6]+2821735955&4294967295,C=_+(P<<17&4294967295|P>>>15),P=S+(k^C&(_^k))+R[7]+4249261313&4294967295,S=C+(P<<22&4294967295|P>>>10),P=k+(_^S&(C^_))+R[8]+1770035416&4294967295,k=S+(P<<7&4294967295|P>>>25),P=_+(C^k&(S^C))+R[9]+2336552879&4294967295,_=k+(P<<12&4294967295|P>>>20),P=C+(S^_&(k^S))+R[10]+4294925233&4294967295,C=_+(P<<17&4294967295|P>>>15),P=S+(k^C&(_^k))+R[11]+2304563134&4294967295,S=C+(P<<22&4294967295|P>>>10),P=k+(_^S&(C^_))+R[12]+1804603682&4294967295,k=S+(P<<7&4294967295|P>>>25),P=_+(C^k&(S^C))+R[13]+4254626195&4294967295,_=k+(P<<12&4294967295|P>>>20),P=C+(S^_&(k^S))+R[14]+2792965006&4294967295,C=_+(P<<17&4294967295|P>>>15),P=S+(k^C&(_^k))+R[15]+1236535329&4294967295,S=C+(P<<22&4294967295|P>>>10),P=k+(C^_&(S^C))+R[1]+4129170786&4294967295,k=S+(P<<5&4294967295|P>>>27),P=_+(S^C&(k^S))+R[6]+3225465664&4294967295,_=k+(P<<9&4294967295|P>>>23),P=C+(k^S&(_^k))+R[11]+643717713&4294967295,C=_+(P<<14&4294967295|P>>>18),P=S+(_^k&(C^_))+R[0]+3921069994&4294967295,S=C+(P<<20&4294967295|P>>>12),P=k+(C^_&(S^C))+R[5]+3593408605&4294967295,k=S+(P<<5&4294967295|P>>>27),P=_+(S^C&(k^S))+R[10]+38016083&4294967295,_=k+(P<<9&4294967295|P>>>23),P=C+(k^S&(_^k))+R[15]+3634488961&4294967295,C=_+(P<<14&4294967295|P>>>18),P=S+(_^k&(C^_))+R[4]+3889429448&4294967295,S=C+(P<<20&4294967295|P>>>12),P=k+(C^_&(S^C))+R[9]+568446438&4294967295,k=S+(P<<5&4294967295|P>>>27),P=_+(S^C&(k^S))+R[14]+3275163606&4294967295,_=k+(P<<9&4294967295|P>>>23),P=C+(k^S&(_^k))+R[3]+4107603335&4294967295,C=_+(P<<14&4294967295|P>>>18),P=S+(_^k&(C^_))+R[8]+1163531501&4294967295,S=C+(P<<20&4294967295|P>>>12),P=k+(C^_&(S^C))+R[13]+2850285829&4294967295,k=S+(P<<5&4294967295|P>>>27),P=_+(S^C&(k^S))+R[2]+4243563512&4294967295,_=k+(P<<9&4294967295|P>>>23),P=C+(k^S&(_^k))+R[7]+1735328473&4294967295,C=_+(P<<14&4294967295|P>>>18),P=S+(_^k&(C^_))+R[12]+2368359562&4294967295,S=C+(P<<20&4294967295|P>>>12),P=k+(S^C^_)+R[5]+4294588738&4294967295,k=S+(P<<4&4294967295|P>>>28),P=_+(k^S^C)+R[8]+2272392833&4294967295,_=k+(P<<11&4294967295|P>>>21),P=C+(_^k^S)+R[11]+1839030562&4294967295,C=_+(P<<16&4294967295|P>>>16),P=S+(C^_^k)+R[14]+4259657740&4294967295,S=C+(P<<23&4294967295|P>>>9),P=k+(S^C^_)+R[1]+2763975236&4294967295,k=S+(P<<4&4294967295|P>>>28),P=_+(k^S^C)+R[4]+1272893353&4294967295,_=k+(P<<11&4294967295|P>>>21),P=C+(_^k^S)+R[7]+4139469664&4294967295,C=_+(P<<16&4294967295|P>>>16),P=S+(C^_^k)+R[10]+3200236656&4294967295,S=C+(P<<23&4294967295|P>>>9),P=k+(S^C^_)+R[13]+681279174&4294967295,k=S+(P<<4&4294967295|P>>>28),P=_+(k^S^C)+R[0]+3936430074&4294967295,_=k+(P<<11&4294967295|P>>>21),P=C+(_^k^S)+R[3]+3572445317&4294967295,C=_+(P<<16&4294967295|P>>>16),P=S+(C^_^k)+R[6]+76029189&4294967295,S=C+(P<<23&4294967295|P>>>9),P=k+(S^C^_)+R[9]+3654602809&4294967295,k=S+(P<<4&4294967295|P>>>28),P=_+(k^S^C)+R[12]+3873151461&4294967295,_=k+(P<<11&4294967295|P>>>21),P=C+(_^k^S)+R[15]+530742520&4294967295,C=_+(P<<16&4294967295|P>>>16),P=S+(C^_^k)+R[2]+3299628645&4294967295,S=C+(P<<23&4294967295|P>>>9),P=k+(C^(S|~_))+R[0]+4096336452&4294967295,k=S+(P<<6&4294967295|P>>>26),P=_+(S^(k|~C))+R[7]+1126891415&4294967295,_=k+(P<<10&4294967295|P>>>22),P=C+(k^(_|~S))+R[14]+2878612391&4294967295,C=_+(P<<15&4294967295|P>>>17),P=S+(_^(C|~k))+R[5]+4237533241&4294967295,S=C+(P<<21&4294967295|P>>>11),P=k+(C^(S|~_))+R[12]+1700485571&4294967295,k=S+(P<<6&4294967295|P>>>26),P=_+(S^(k|~C))+R[3]+2399980690&4294967295,_=k+(P<<10&4294967295|P>>>22),P=C+(k^(_|~S))+R[10]+4293915773&4294967295,C=_+(P<<15&4294967295|P>>>17),P=S+(_^(C|~k))+R[1]+2240044497&4294967295,S=C+(P<<21&4294967295|P>>>11),P=k+(C^(S|~_))+R[8]+1873313359&4294967295,k=S+(P<<6&4294967295|P>>>26),P=_+(S^(k|~C))+R[15]+4264355552&4294967295,_=k+(P<<10&4294967295|P>>>22),P=C+(k^(_|~S))+R[6]+2734768916&4294967295,C=_+(P<<15&4294967295|P>>>17),P=S+(_^(C|~k))+R[13]+1309151649&4294967295,S=C+(P<<21&4294967295|P>>>11),P=k+(C^(S|~_))+R[4]+4149444226&4294967295,k=S+(P<<6&4294967295|P>>>26),P=_+(S^(k|~C))+R[11]+3174756917&4294967295,_=k+(P<<10&4294967295|P>>>22),P=C+(k^(_|~S))+R[2]+718787259&4294967295,C=_+(P<<15&4294967295|P>>>17),P=S+(_^(C|~k))+R[9]+3951481745&4294967295,T.g[0]=T.g[0]+k&4294967295,T.g[1]=T.g[1]+(C+(P<<21&4294967295|P>>>11))&4294967295,T.g[2]=T.g[2]+C&4294967295,T.g[3]=T.g[3]+_&4294967295}n.prototype.u=function(T,k){k===void 0&&(k=T.length);for(var S=k-this.blockSize,R=this.B,C=this.h,_=0;_<k;){if(C==0)for(;_<=S;)s(this,T,_),_+=this.blockSize;if(typeof T=="string"){for(;_<k;)if(R[C++]=T.charCodeAt(_++),C==this.blockSize){s(this,R),C=0;break}}else for(;_<k;)if(R[C++]=T[_++],C==this.blockSize){s(this,R),C=0;break}}this.h=C,this.o+=k},n.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var k=1;k<T.length-8;++k)T[k]=0;var S=8*this.o;for(k=T.length-8;k<T.length;++k)T[k]=S&255,S/=256;for(this.u(T),T=Array(16),k=S=0;4>k;++k)for(var R=0;32>R;R+=8)T[S++]=this.g[k]>>>R&255;return T};function i(T,k){var S=o;return Object.prototype.hasOwnProperty.call(S,T)?S[T]:S[T]=k(T)}function a(T,k){this.h=k;for(var S=[],R=!0,C=T.length-1;0<=C;C--){var _=T[C]|0;R&&_==k||(S[C]=_,R=!1)}this.g=S}var o={};function c(T){return-128<=T&&128>T?i(T,function(k){return new a([k|0],0>k?-1:0)}):new a([T|0],0>T?-1:0)}function l(T){if(isNaN(T)||!isFinite(T))return d;if(0>T)return y(l(-T));for(var k=[],S=1,R=0;T>=S;R++)k[R]=T/S|0,S*=4294967296;return new a(k,0)}function h(T,k){if(T.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(T.charAt(0)=="-")return y(h(T.substring(1),k));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=l(Math.pow(k,8)),R=d,C=0;C<T.length;C+=8){var _=Math.min(8,T.length-C),P=parseInt(T.substring(C,C+_),k);8>_?(_=l(Math.pow(k,_)),R=R.j(_).add(l(P))):(R=R.j(S),R=R.add(l(P)))}return R}var d=c(0),f=c(1),g=c(16777216);t=a.prototype,t.m=function(){if(x(this))return-y(this).m();for(var T=0,k=1,S=0;S<this.g.length;S++){var R=this.i(S);T+=(0<=R?R:4294967296+R)*k,k*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(w(this))return"0";if(x(this))return"-"+y(this).toString(T);for(var k=l(Math.pow(T,6)),S=this,R="";;){var C=W(S,k).g;S=A(S,C.j(k));var _=((0<S.g.length?S.g[0]:S.h)>>>0).toString(T);if(S=C,w(S))return _+R;for(;6>_.length;)_="0"+_;R=_+R}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function w(T){if(T.h!=0)return!1;for(var k=0;k<T.g.length;k++)if(T.g[k]!=0)return!1;return!0}function x(T){return T.h==-1}t.l=function(T){return T=A(this,T),x(T)?-1:w(T)?0:1};function y(T){for(var k=T.g.length,S=[],R=0;R<k;R++)S[R]=~T.g[R];return new a(S,~T.h).add(f)}t.abs=function(){return x(this)?y(this):this},t.add=function(T){for(var k=Math.max(this.g.length,T.g.length),S=[],R=0,C=0;C<=k;C++){var _=R+(this.i(C)&65535)+(T.i(C)&65535),P=(_>>>16)+(this.i(C)>>>16)+(T.i(C)>>>16);R=P>>>16,_&=65535,P&=65535,S[C]=P<<16|_}return new a(S,S[S.length-1]&-2147483648?-1:0)};function A(T,k){return T.add(y(k))}t.j=function(T){if(w(this)||w(T))return d;if(x(this))return x(T)?y(this).j(y(T)):y(y(this).j(T));if(x(T))return y(this.j(y(T)));if(0>this.l(g)&&0>T.l(g))return l(this.m()*T.m());for(var k=this.g.length+T.g.length,S=[],R=0;R<2*k;R++)S[R]=0;for(R=0;R<this.g.length;R++)for(var C=0;C<T.g.length;C++){var _=this.i(R)>>>16,P=this.i(R)&65535,Fe=T.i(C)>>>16,Ie=T.i(C)&65535;S[2*R+2*C]+=P*Ie,F(S,2*R+2*C),S[2*R+2*C+1]+=_*Ie,F(S,2*R+2*C+1),S[2*R+2*C+1]+=P*Fe,F(S,2*R+2*C+1),S[2*R+2*C+2]+=_*Fe,F(S,2*R+2*C+2)}for(R=0;R<k;R++)S[R]=S[2*R+1]<<16|S[2*R];for(R=k;R<2*k;R++)S[R]=0;return new a(S,0)};function F(T,k){for(;(T[k]&65535)!=T[k];)T[k+1]+=T[k]>>>16,T[k]&=65535,k++}function I(T,k){this.g=T,this.h=k}function W(T,k){if(w(k))throw Error("division by zero");if(w(T))return new I(d,d);if(x(T))return k=W(y(T),k),new I(y(k.g),y(k.h));if(x(k))return k=W(T,y(k)),new I(y(k.g),k.h);if(30<T.g.length){if(x(T)||x(k))throw Error("slowDivide_ only works with positive integers.");for(var S=f,R=k;0>=R.l(T);)S=U(S),R=U(R);var C=z(S,1),_=z(R,1);for(R=z(R,2),S=z(S,2);!w(R);){var P=_.add(R);0>=P.l(T)&&(C=C.add(S),_=P),R=z(R,1),S=z(S,1)}return k=A(T,C.j(k)),new I(C,k)}for(C=d;0<=T.l(k);){for(S=Math.max(1,Math.floor(T.m()/k.m())),R=Math.ceil(Math.log(S)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),_=l(S),P=_.j(k);x(P)||0<P.l(T);)S-=R,_=l(S),P=_.j(k);w(_)&&(_=f),C=C.add(_),T=A(T,P)}return new I(C,T)}t.A=function(T){return W(this,T).h},t.and=function(T){for(var k=Math.max(this.g.length,T.g.length),S=[],R=0;R<k;R++)S[R]=this.i(R)&T.i(R);return new a(S,this.h&T.h)},t.or=function(T){for(var k=Math.max(this.g.length,T.g.length),S=[],R=0;R<k;R++)S[R]=this.i(R)|T.i(R);return new a(S,this.h|T.h)},t.xor=function(T){for(var k=Math.max(this.g.length,T.g.length),S=[],R=0;R<k;R++)S[R]=this.i(R)^T.i(R);return new a(S,this.h^T.h)};function U(T){for(var k=T.g.length+1,S=[],R=0;R<k;R++)S[R]=T.i(R)<<1|T.i(R-1)>>>31;return new a(S,T.h)}function z(T,k){var S=k>>5;k%=32;for(var R=T.g.length-S,C=[],_=0;_<R;_++)C[_]=0<k?T.i(_+S)>>>k|T.i(_+S+1)<<32-k:T.i(_+S);return new a(C,T.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,bx=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=l,a.fromString=h,va=a}).apply(typeof bp<"u"?bp:typeof self<"u"?self:typeof window<"u"?window:{});var Fu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ix,tl,Cx,Ju,N0,Rx,Dx,Px;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,E){return u==Array.prototype||u==Object.prototype||(u[p]=E.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Fu=="object"&&Fu];for(var p=0;p<u.length;++p){var E=u[p];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var n=r(this);function s(u,p){if(p)e:{var E=n;u=u.split(".");for(var D=0;D<u.length-1;D++){var ee=u[D];if(!(ee in E))break e;E=E[ee]}u=u[u.length-1],D=E[u],p=p(D),p!=D&&p!=null&&e(E,u,{configurable:!0,writable:!0,value:p})}}function i(u,p){u instanceof String&&(u+="");var E=0,D=!1,ee={next:function(){if(!D&&E<u.length){var ae=E++;return{value:p(ae,u[ae]),done:!1}}return D=!0,{done:!0,value:void 0}}};return ee[Symbol.iterator]=function(){return ee},ee}s("Array.prototype.values",function(u){return u||function(){return i(this,function(p,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function c(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function l(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function h(u,p,E){return u.call.apply(u.bind,arguments)}function d(u,p,E){if(!u)throw Error();if(2<arguments.length){var D=Array.prototype.slice.call(arguments,2);return function(){var ee=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ee,D),u.apply(p,ee)}}return function(){return u.apply(p,arguments)}}function f(u,p,E){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,f.apply(null,arguments)}function g(u,p){var E=Array.prototype.slice.call(arguments,1);return function(){var D=E.slice();return D.push.apply(D,arguments),u.apply(this,D)}}function w(u,p){function E(){}E.prototype=p.prototype,u.aa=p.prototype,u.prototype=new E,u.prototype.constructor=u,u.Qb=function(D,ee,ae){for(var Ne=Array(arguments.length-2),Mt=2;Mt<arguments.length;Mt++)Ne[Mt-2]=arguments[Mt];return p.prototype[ee].apply(D,Ne)}}function x(u){const p=u.length;if(0<p){const E=Array(p);for(let D=0;D<p;D++)E[D]=u[D];return E}return[]}function y(u,p){for(let E=1;E<arguments.length;E++){const D=arguments[E];if(c(D)){const ee=u.length||0,ae=D.length||0;u.length=ee+ae;for(let Ne=0;Ne<ae;Ne++)u[ee+Ne]=D[Ne]}else u.push(D)}}class A{constructor(p,E){this.i=p,this.j=E,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function F(u){return/^[\s\xa0]*$/.test(u)}function I(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function W(u){return W[" "](u),u}W[" "]=function(){};var U=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function z(u,p,E){for(const D in u)p.call(E,u[D],D,u)}function T(u,p){for(const E in u)p.call(void 0,u[E],E,u)}function k(u){const p={};for(const E in u)p[E]=u[E];return p}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(u,p){let E,D;for(let ee=1;ee<arguments.length;ee++){D=arguments[ee];for(E in D)u[E]=D[E];for(let ae=0;ae<S.length;ae++)E=S[ae],Object.prototype.hasOwnProperty.call(D,E)&&(u[E]=D[E])}}function C(u){var p=1;u=u.split(":");const E=[];for(;0<p&&u.length;)E.push(u.shift()),p--;return u.length&&E.push(u.join(":")),E}function _(u){o.setTimeout(()=>{throw u},0)}function P(){var u=se;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class Fe{constructor(){this.h=this.g=null}add(p,E){const D=Ie.get();D.set(p,E),this.h?this.h.next=D:this.g=D,this.h=D}}var Ie=new A(()=>new je,u=>u.reset());class je{constructor(){this.next=this.g=this.h=null}set(p,E){this.h=p,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let Me,_t=!1,se=new Fe,Ye=()=>{const u=o.Promise.resolve(void 0);Me=()=>{u.then(Je)}};var Je=()=>{for(var u;u=P();){try{u.h.call(u.g)}catch(E){_(E)}var p=Ie;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}_t=!1};function V(){this.s=this.s,this.C=this.C}V.prototype.s=!1,V.prototype.ma=function(){this.s||(this.s=!0,this.N())},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Y(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}Y.prototype.h=function(){this.defaultPrevented=!0};var q=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const E=()=>{};o.addEventListener("test",E,p),o.removeEventListener("test",E,p)}catch{}return u})();function X(u,p){if(Y.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var E=this.type=u.type,D=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(U){e:{try{W(p.nodeName);var ee=!0;break e}catch{}ee=!1}ee||(p=null)}}else E=="mouseover"?p=u.fromElement:E=="mouseout"&&(p=u.toElement);this.relatedTarget=p,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:he[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&X.aa.h.call(this)}}w(X,Y);var he={2:"touch",3:"pen",4:"mouse"};X.prototype.h=function(){X.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Ee="closure_listenable_"+(1e6*Math.random()|0),Ae=0;function ye(u,p,E,D,ee){this.listener=u,this.proxy=null,this.src=p,this.type=E,this.capture=!!D,this.ha=ee,this.key=++Ae,this.da=this.fa=!1}function ve(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ct(u){this.src=u,this.g={},this.h=0}ct.prototype.add=function(u,p,E,D,ee){var ae=u.toString();u=this.g[ae],u||(u=this.g[ae]=[],this.h++);var Ne=jt(u,p,D,ee);return-1<Ne?(p=u[Ne],E||(p.fa=!1)):(p=new ye(p,this.src,ae,!!D,ee),p.fa=E,u.push(p)),p};function j(u,p){var E=p.type;if(E in u.g){var D=u.g[E],ee=Array.prototype.indexOf.call(D,p,void 0),ae;(ae=0<=ee)&&Array.prototype.splice.call(D,ee,1),ae&&(ve(p),u.g[E].length==0&&(delete u.g[E],u.h--))}}function jt(u,p,E,D){for(var ee=0;ee<u.length;++ee){var ae=u[ee];if(!ae.da&&ae.listener==p&&ae.capture==!!E&&ae.ha==D)return ee}return-1}var pt="closure_lm_"+(1e6*Math.random()|0),Ft={};function ut(u,p,E,D,ee){if(Array.isArray(p)){for(var ae=0;ae<p.length;ae++)ut(u,p[ae],E,D,ee);return null}return E=Zn(E),u&&u[Ee]?u.K(p,E,l(D)?!!D.capture:!1,ee):ke(u,p,E,!1,D,ee)}function ke(u,p,E,D,ee,ae){if(!p)throw Error("Invalid event type");var Ne=l(ee)?!!ee.capture:!!ee,Mt=Jn(u);if(Mt||(u[pt]=Mt=new ct(u)),E=Mt.add(p,E,D,Ne,ae),E.proxy)return E;if(D=lr(),E.proxy=D,D.src=u,D.listener=E,u.addEventListener)q||(ee=Ne),ee===void 0&&(ee=!1),u.addEventListener(p.toString(),D,ee);else if(u.attachEvent)u.attachEvent(Qn(p.toString()),D);else if(u.addListener&&u.removeListener)u.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return E}function lr(){function u(E){return p.call(u.src,u.listener,E)}const p=cs;return u}function dr(u,p,E,D,ee){if(Array.isArray(p))for(var ae=0;ae<p.length;ae++)dr(u,p[ae],E,D,ee);else D=l(D)?!!D.capture:!!D,E=Zn(E),u&&u[Ee]?(u=u.i,p=String(p).toString(),p in u.g&&(ae=u.g[p],E=jt(ae,E,D,ee),-1<E&&(ve(ae[E]),Array.prototype.splice.call(ae,E,1),ae.length==0&&(delete u.g[p],u.h--)))):u&&(u=Jn(u))&&(p=u.g[p.toString()],u=-1,p&&(u=jt(p,E,D,ee)),(E=-1<u?p[u]:null)&&Ur(E))}function Ur(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[Ee])j(p.i,u);else{var E=u.type,D=u.proxy;p.removeEventListener?p.removeEventListener(E,D,u.capture):p.detachEvent?p.detachEvent(Qn(E),D):p.addListener&&p.removeListener&&p.removeListener(D),(E=Jn(p))?(j(E,u),E.h==0&&(E.src=null,p[pt]=null)):ve(u)}}}function Qn(u){return u in Ft?Ft[u]:Ft[u]="on"+u}function cs(u,p){if(u.da)u=!0;else{p=new X(p,this);var E=u.listener,D=u.ha||u.src;u.fa&&Ur(u),u=E.call(D,p)}return u}function Jn(u){return u=u[pt],u instanceof ct?u:null}var Tr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Zn(u){return typeof u=="function"?u:(u[Tr]||(u[Tr]=function(p){return u.handleEvent(p)}),u[Tr])}function zt(){V.call(this),this.i=new ct(this),this.M=this,this.F=null}w(zt,V),zt.prototype[Ee]=!0,zt.prototype.removeEventListener=function(u,p,E,D){dr(this,u,p,E,D)};function mr(u,p){var E,D=u.F;if(D)for(E=[];D;D=D.F)E.push(D);if(u=u.M,D=p.type||p,typeof p=="string")p=new Y(p,u);else if(p instanceof Y)p.target=p.target||u;else{var ee=p;p=new Y(D,u),R(p,ee)}if(ee=!0,E)for(var ae=E.length-1;0<=ae;ae--){var Ne=p.g=E[ae];ee=Sr(Ne,D,!0,p)&&ee}if(Ne=p.g=u,ee=Sr(Ne,D,!0,p)&&ee,ee=Sr(Ne,D,!1,p)&&ee,E)for(ae=0;ae<E.length;ae++)Ne=p.g=E[ae],ee=Sr(Ne,D,!1,p)&&ee}zt.prototype.N=function(){if(zt.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var E=u.g[p],D=0;D<E.length;D++)ve(E[D]);delete u.g[p],u.h--}}this.F=null},zt.prototype.K=function(u,p,E,D){return this.i.add(String(u),p,!1,E,D)},zt.prototype.L=function(u,p,E,D){return this.i.add(String(u),p,!0,E,D)};function Sr(u,p,E,D){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var ee=!0,ae=0;ae<p.length;++ae){var Ne=p[ae];if(Ne&&!Ne.da&&Ne.capture==E){var Mt=Ne.listener,Pr=Ne.ha||Ne.src;Ne.fa&&j(u.i,Ne),ee=Mt.call(Pr,D)!==!1&&ee}}return ee&&!D.defaultPrevented}function Tn(u,p,E){if(typeof u=="function")E&&(u=f(u,E));else if(u&&typeof u.handleEvent=="function")u=f(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:o.setTimeout(u,p||0)}function dt(u){u.g=Tn(()=>{u.g=null,u.i&&(u.i=!1,dt(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class Kt extends V{constructor(p,E){super(),this.m=p,this.l=E,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:dt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ar(u){V.call(this),this.h=u,this.g={}}w(Ar,V);var It=[];function pn(u){z(u.g,function(p,E){this.g.hasOwnProperty(E)&&Ur(p)},u),u.g={}}Ar.prototype.N=function(){Ar.aa.N.call(this),pn(this)},Ar.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Es=o.JSON.stringify,na=o.JSON.parse,Uc=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function Ls(){}Ls.prototype.h=null;function ki(u){return u.h||(u.h=u.i())}function bi(){}var oi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ii(){Y.call(this,"d")}w(Ii,Y);function kr(){Y.call(this,"c")}w(kr,Y);var Ms={},Wc=null;function sa(){return Wc=Wc||new zt}Ms.La="serverreachability";function Lo(u){Y.call(this,Ms.La,u)}w(Lo,Y);function Bs(u){const p=sa();mr(p,new Lo(p))}Ms.STAT_EVENT="statevent";function $n(u,p){Y.call(this,Ms.STAT_EVENT,u),this.stat=p}w($n,Y);function Kr(u){const p=sa();mr(p,new $n(p,u))}Ms.Ma="timingevent";function Va(u,p){Y.call(this,Ms.Ma,u),this.size=p}w(Va,Y);function Vs(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},p)}function Ut(){this.g=!0}Ut.prototype.xa=function(){this.g=!1};function es(u,p,E,D,ee,ae){u.info(function(){if(u.g)if(ae)for(var Ne="",Mt=ae.split("&"),Pr=0;Pr<Mt.length;Pr++){var Rt=Mt[Pr].split("=");if(1<Rt.length){var en=Rt[0];Rt=Rt[1];var Gt=en.split("_");Ne=2<=Gt.length&&Gt[1]=="type"?Ne+(en+"="+Rt+"&"):Ne+(en+"=redacted&")}}else Ne=null;else Ne=ae;return"XMLHTTP REQ ("+D+") [attempt "+ee+"]: "+p+`
`+E+`
`+Ne})}function vu(u,p,E,D,ee,ae,Ne){u.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+ee+"]: "+p+`
`+E+`
`+ae+" "+Ne})}function b(u,p,E,D){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+O(u,E)+(D?" "+D:"")})}function L(u,p){u.info(function(){return"TIMEOUT: "+p})}Ut.prototype.info=function(){};function O(u,p){if(!u.g)return p;if(!p)return null;try{var E=JSON.parse(p);if(E){for(u=0;u<E.length;u++)if(Array.isArray(E[u])){var D=E[u];if(!(2>D.length)){var ee=D[1];if(Array.isArray(ee)&&!(1>ee.length)){var ae=ee[0];if(ae!="noop"&&ae!="stop"&&ae!="close")for(var Ne=1;Ne<ee.length;Ne++)ee[Ne]=""}}}}return Es(E)}catch{return p}}var N={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},B={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},M;function re(){}w(re,Ls),re.prototype.g=function(){return new XMLHttpRequest},re.prototype.i=function(){return{}},M=new re;function oe(u,p,E,D){this.j=u,this.i=p,this.l=E,this.R=D||1,this.U=new Ar(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new te}function te(){this.i=null,this.g="",this.h=!1}var ne={},H={};function ge(u,p,E){u.L=1,u.v=jo(js(p)),u.m=E,u.P=!0,de(u,null)}function de(u,p){u.F=Date.now(),De(u),u.A=js(u.v);var E=u.A,D=u.R;Array.isArray(D)||(D=[String(D)]),bu(E.i,"t",D),u.C=0,E=u.j.J,u.h=new te,u.g=tr(u.j,E?p:null,!u.m),0<u.O&&(u.M=new Kt(f(u.Y,u,u.g),u.O)),p=u.U,E=u.g,D=u.ca;var ee="readystatechange";Array.isArray(ee)||(ee&&(It[0]=ee.toString()),ee=It);for(var ae=0;ae<ee.length;ae++){var Ne=ut(E,ee[ae],D||p.handleEvent,!1,p.h||p);if(!Ne)break;p.g[Ne.key]=Ne}p=u.H?k(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),Bs(),es(u.i,u.u,u.A,u.l,u.R,u.m)}oe.prototype.ca=function(u){u=u.target;const p=this.M;p&&be(u)==3?p.j():this.Y(u)},oe.prototype.Y=function(u){try{if(u==this.g)e:{const Gt=be(this.g);var p=this.g.Ba();const Ss=this.g.Z();if(!(3>Gt)&&(Gt!=3||this.g&&(this.h.h||this.g.oa()||qe(this.g)))){this.J||Gt!=4||p==7||(p==8||0>=Ss?Bs(3):Bs(2)),Yt(this);var E=this.g.Z();this.X=E;t:if(Be(this)){var D=qe(this.g);u="";var ee=D.length,ae=be(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){sr(this),Wt(this);var Ne="";break t}this.h.i=new o.TextDecoder}for(p=0;p<ee;p++)this.h.h=!0,u+=this.h.i.decode(D[p],{stream:!(ae&&p==ee-1)});D.length=0,this.h.g+=u,this.C=0,Ne=this.h.g}else Ne=this.g.oa();if(this.o=E==200,vu(this.i,this.u,this.A,this.l,this.R,Gt,E),this.o){if(this.T&&!this.K){t:{if(this.g){var Mt,Pr=this.g;if((Mt=Pr.g?Pr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!F(Mt)){var Rt=Mt;break t}}Rt=null}if(E=Rt)b(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zn(this,E);else{this.o=!1,this.s=3,Kr(12),sr(this),Wt(this);break e}}if(this.P){E=!0;let ts;for(;!this.J&&this.C<Ne.length;)if(ts=pe(this,Ne),ts==H){Gt==4&&(this.s=4,Kr(14),E=!1),b(this.i,this.l,null,"[Incomplete Response]");break}else if(ts==ne){this.s=4,Kr(15),b(this.i,this.l,Ne,"[Invalid Chunk]"),E=!1;break}else b(this.i,this.l,ts,null),zn(this,ts);if(Be(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Gt!=4||Ne.length!=0||this.h.h||(this.s=1,Kr(16),E=!1),this.o=this.o&&E,!E)b(this.i,this.l,Ne,"[Invalid Chunked Response]"),sr(this),Wt(this);else if(0<Ne.length&&!this.W){this.W=!0;var en=this.j;en.g==this&&en.ba&&!en.M&&(en.j.info("Great, no buffering proxy detected. Bytes received: "+Ne.length),Ct(en),en.M=!0,Kr(11))}}else b(this.i,this.l,Ne,null),zn(this,Ne);Gt==4&&sr(this),this.o&&!this.J&&(Gt==4?xn(this.j,this):(this.o=!1,De(this)))}else Ue(this.g),E==400&&0<Ne.indexOf("Unknown SID")?(this.s=3,Kr(12)):(this.s=0,Kr(13)),sr(this),Wt(this)}}}catch{}finally{}};function Be(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function pe(u,p){var E=u.C,D=p.indexOf(`
`,E);return D==-1?H:(E=Number(p.substring(E,D)),isNaN(E)?ne:(D+=1,D+E>p.length?H:(p=p.slice(D,D+E),u.C=D+E,p)))}oe.prototype.cancel=function(){this.J=!0,sr(this)};function De(u){u.S=Date.now()+u.I,st(u,u.I)}function st(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Vs(f(u.ba,u),p)}function Yt(u){u.B&&(o.clearTimeout(u.B),u.B=null)}oe.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(L(this.i,this.A),this.L!=2&&(Bs(),Kr(17)),sr(this),this.s=2,Wt(this)):st(this,this.S-u)};function Wt(u){u.j.G==0||u.J||xn(u.j,u)}function sr(u){Yt(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,pn(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function zn(u,p){try{var E=u.j;if(E.G!=0&&(E.g==u||Yr(E.h,u))){if(!u.K&&Yr(E.h,u)&&E.G==3){try{var D=E.Da.g.parse(p)}catch{D=null}if(Array.isArray(D)&&D.length==3){var ee=D;if(ee[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<u.F)An(E),et(E);else break e;Dt(E),Kr(18)}}else E.za=ee[1],0<E.za-E.T&&37500>ee[2]&&E.F&&E.v==0&&!E.C&&(E.C=Vs(f(E.Za,E),6e3));if(1>=ia(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else xt(E,11)}else if((u.K||E.g==u)&&An(E),!F(p))for(ee=E.Da.g.parse(p),p=0;p<ee.length;p++){let Rt=ee[p];if(E.T=Rt[0],Rt=Rt[1],E.G==2)if(Rt[0]=="c"){E.K=Rt[1],E.ia=Rt[2];const en=Rt[3];en!=null&&(E.la=en,E.j.info("VER="+E.la));const Gt=Rt[4];Gt!=null&&(E.Aa=Gt,E.j.info("SVER="+E.Aa));const Ss=Rt[5];Ss!=null&&typeof Ss=="number"&&0<Ss&&(D=1.5*Ss,E.L=D,E.j.info("backChannelRequestTimeoutMs_="+D)),D=E;const ts=u.g;if(ts){const Ru=ts.g?ts.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ru){var ae=D.h;ae.g||Ru.indexOf("spdy")==-1&&Ru.indexOf("quic")==-1&&Ru.indexOf("h2")==-1||(ae.j=ae.l,ae.g=new Set,ae.h&&(Ci(ae,ae.h),ae.h=null))}if(D.D){const zf=ts.g?ts.g.getResponseHeader("X-HTTP-Session-Id"):null;zf&&(D.ya=zf,nr(D.I,D.D,zf))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-u.F,E.j.info("Handshake RTT: "+E.R+"ms")),D=E;var Ne=u;if(D.qa=ze(D,D.J?D.ia:null,D.W),Ne.K){_u(D.h,Ne);var Mt=Ne,Pr=D.L;Pr&&(Mt.I=Pr),Mt.B&&(Yt(Mt),De(Mt)),D.g=Ne}else gn(D);0<E.i.length&&pr(E)}else Rt[0]!="stop"&&Rt[0]!="close"||xt(E,7);else E.G==3&&(Rt[0]=="stop"||Rt[0]=="close"?Rt[0]=="stop"?xt(E,7):ie(E):Rt[0]!="noop"&&E.l&&E.l.ta(Rt),E.v=0)}}Bs(4)}catch{}}var ci=class{constructor(u,p){this.g=u,this.map=p}};function li(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ls(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function ia(u){return u.h?1:u.g?u.g.size:0}function Yr(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function Ci(u,p){u.g?u.g.add(p):u.h=p}function _u(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}li.prototype.cancel=function(){if(this.i=Mo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Mo(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const E of u.g.values())p=p.concat(E.D);return p}return x(u.i)}function $c(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var p=[],E=u.length,D=0;D<E;D++)p.push(u[D]);return p}p=[],E=0;for(D in u)p[E++]=u[D];return p}function zc(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var p=[];u=u.length;for(var E=0;E<u;E++)p.push(E);return p}p=[],E=0;for(const D in u)p[E++]=D;return p}}}function yu(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var E=zc(u),D=$c(u),ee=D.length,ae=0;ae<ee;ae++)p.call(void 0,D[ae],E&&E[ae],u)}var Hc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Vf(u,p){if(u){u=u.split("&");for(var E=0;E<u.length;E++){var D=u[E].indexOf("="),ee=null;if(0<=D){var ae=u[E].substring(0,D);ee=u[E].substring(D+1)}else ae=u[E];p(ae,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function us(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof us){this.h=u.h,Bo(this,u.j),this.o=u.o,this.g=u.g,Vo(this,u.s),this.l=u.l;var p=u.i,E=new $a;E.i=p.i,p.g&&(E.g=new Map(p.g),E.h=p.h),Eu(this,E),this.m=u.m}else u&&(p=String(u).match(Hc))?(this.h=!1,Bo(this,p[1]||"",!0),this.o=ja(p[2]||""),this.g=ja(p[3]||"",!0),Vo(this,p[4]),this.l=ja(p[5]||"",!0),Eu(this,p[6]||"",!0),this.m=ja(p[7]||"")):(this.h=!1,this.i=new $a(null,this.h))}us.prototype.toString=function(){var u=[],p=this.j;p&&u.push(Ua(p,Tu,!0),":");var E=this.g;return(E||p=="file")&&(u.push("//"),(p=this.o)&&u.push(Ua(p,Tu,!0),"@"),u.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&u.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&u.push("/"),u.push(Ua(E,E.charAt(0)=="/"?Wf:Uf,!0))),(E=this.i.toString())&&u.push("?",E),(E=this.m)&&u.push("#",Ua(E,Wa)),u.join("")};function js(u){return new us(u)}function Bo(u,p,E){u.j=E?ja(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function Vo(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function Eu(u,p,E){p instanceof $a?(u.i=p,Iu(u.i,u.h)):(E||(p=Ua(p,Su)),u.i=new $a(p,u.h))}function nr(u,p,E){u.i.set(p,E)}function jo(u){return nr(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function ja(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Ua(u,p,E){return typeof u=="string"?(u=encodeURI(u).replace(p,jf),E&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function jf(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Tu=/[#\/\?@]/g,Uf=/[#\?:]/g,Wf=/[#\?]/g,Su=/[#\?@]/g,Wa=/#/g;function $a(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function Ts(u){u.g||(u.g=new Map,u.h=0,u.i&&Vf(u.i,function(p,E){u.add(decodeURIComponent(p.replace(/\+/g," ")),E)}))}t=$a.prototype,t.add=function(u,p){Ts(this),this.i=null,u=aa(this,u);var E=this.g.get(u);return E||this.g.set(u,E=[]),E.push(p),this.h+=1,this};function Au(u,p){Ts(u),p=aa(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function ku(u,p){return Ts(u),p=aa(u,p),u.g.has(p)}t.forEach=function(u,p){Ts(this),this.g.forEach(function(E,D){E.forEach(function(ee){u.call(p,ee,D,this)},this)},this)},t.na=function(){Ts(this);const u=Array.from(this.g.values()),p=Array.from(this.g.keys()),E=[];for(let D=0;D<p.length;D++){const ee=u[D];for(let ae=0;ae<ee.length;ae++)E.push(p[D])}return E},t.V=function(u){Ts(this);let p=[];if(typeof u=="string")ku(this,u)&&(p=p.concat(this.g.get(aa(this,u))));else{u=Array.from(this.g.values());for(let E=0;E<u.length;E++)p=p.concat(u[E])}return p},t.set=function(u,p){return Ts(this),this.i=null,u=aa(this,u),ku(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},t.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function bu(u,p,E){Au(u,p),0<E.length&&(u.i=null,u.g.set(aa(u,p),x(E)),u.h+=E.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(var E=0;E<p.length;E++){var D=p[E];const ae=encodeURIComponent(String(D)),Ne=this.V(D);for(D=0;D<Ne.length;D++){var ee=ae;Ne[D]!==""&&(ee+="="+encodeURIComponent(String(Ne[D]))),u.push(ee)}}return this.i=u.join("&")};function aa(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function Iu(u,p){p&&!u.j&&(Ts(u),u.i=null,u.g.forEach(function(E,D){var ee=D.toLowerCase();D!=ee&&(Au(this,D),bu(this,ee,E))},u)),u.j=p}function Gc(u,p){const E=new Ut;if(o.Image){const D=new Image;D.onload=g(ui,E,"TestLoadImage: loaded",!0,p,D),D.onerror=g(ui,E,"TestLoadImage: error",!1,p,D),D.onabort=g(ui,E,"TestLoadImage: abort",!1,p,D),D.ontimeout=g(ui,E,"TestLoadImage: timeout",!1,p,D),o.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=u}else p(!1)}function qc(u,p){const E=new Ut,D=new AbortController,ee=setTimeout(()=>{D.abort(),ui(E,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:D.signal}).then(ae=>{clearTimeout(ee),ae.ok?ui(E,"TestPingServer: ok",!0,p):ui(E,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(ee),ui(E,"TestPingServer: error",!1,p)})}function ui(u,p,E,D,ee){try{ee&&(ee.onload=null,ee.onerror=null,ee.onabort=null,ee.ontimeout=null),D(E)}catch{}}function $f(){this.g=new Uc}function Cu(u,p,E){const D=E||"";try{yu(u,function(ee,ae){let Ne=ee;l(ee)&&(Ne=Es(ee)),p.push(D+ae+"="+encodeURIComponent(Ne))})}catch(ee){throw p.push(D+"type="+encodeURIComponent("_badmap")),ee}}function za(u){this.l=u.Ub||null,this.j=u.eb||!1}w(za,Ls),za.prototype.g=function(){return new Ha(this.l,this.j)},za.prototype.i=(function(u){return function(){return u}})({});function Ha(u,p){zt.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(Ha,zt),t=Ha.prototype,t.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,hs(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||o).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ga(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,hs(this)),this.g&&(this.readyState=3,hs(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Qr(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Qr(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?Ga(this):hs(this),this.readyState==3&&Qr(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,Ga(this))},t.Qa=function(u){this.g&&(this.response=u,Ga(this))},t.ga=function(){this.g&&Ga(this)};function Ga(u){u.readyState=4,u.l=null,u.j=null,u.v=null,hs(u)}t.setRequestHeader=function(u,p){this.u.append(u,p)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var E=p.next();!E.done;)E=E.value,u.push(E[0]+": "+E[1]),E=p.next();return u.join(`\r
`)};function hs(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Ha.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Xc(u){let p="";return z(u,function(E,D){p+=D,p+=":",p+=E,p+=`\r
`}),p}function Kc(u,p,E){e:{for(D in E){var D=!1;break e}D=!0}D||(E=Xc(E),typeof u=="string"?E!=null&&encodeURIComponent(String(E)):nr(u,p,E))}function v(u){zt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(v,zt);var K=/^https?$/i,Q=["POST","PUT"];t=v.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,p,E,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():M.g(),this.v=this.o?ki(this.o):ki(M),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(ae){J(this,ae);return}if(u=E||"",E=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var ee in D)E.set(ee,D[ee]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const ae of D.keys())E.set(ae,D.get(ae));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(E.keys()).find(ae=>ae.toLowerCase()=="content-type"),ee=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(Q,p,void 0))||D||ee||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ae,Ne]of E)this.g.setRequestHeader(ae,Ne);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Se(this),this.u=!0,this.g.send(u),this.u=!1}catch(ae){J(this,ae)}};function J(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,G(u),xe(u)}function G(u){u.A||(u.A=!0,mr(u,"complete"),mr(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,mr(this,"complete"),mr(this,"abort"),xe(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xe(this,!0)),v.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Z(this):this.bb())},t.bb=function(){Z(this)};function Z(u){if(u.h&&typeof a<"u"&&(!u.v[1]||be(u)!=4||u.Z()!=2)){if(u.u&&be(u)==4)Tn(u.Ea,0,u);else if(mr(u,"readystatechange"),be(u)==4){u.h=!1;try{const Ne=u.Z();e:switch(Ne){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var E;if(!(E=p)){var D;if(D=Ne===0){var ee=String(u.D).match(Hc)[1]||null;!ee&&o.self&&o.self.location&&(ee=o.self.location.protocol.slice(0,-1)),D=!K.test(ee?ee.toLowerCase():"")}E=D}if(E)mr(u,"complete"),mr(u,"success");else{u.m=6;try{var ae=2<be(u)?u.g.statusText:""}catch{ae=""}u.l=ae+" ["+u.Z()+"]",G(u)}}finally{xe(u)}}}}function xe(u,p){if(u.g){Se(u);const E=u.g,D=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||mr(u,"ready");try{E.onreadystatechange=D}catch{}}}function Se(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function be(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<be(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),na(p)}};function qe(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Ue(u){const p={};u=(u.g&&2<=be(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<u.length;D++){if(F(u[D]))continue;var E=C(u[D]);const ee=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const ae=p[ee]||[];p[ee]=ae,ae.push(E)}T(p,function(D){return D.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ce(u,p,E){return E&&E.internalChannelParams&&E.internalChannelParams[u]||p}function Xe(u){this.Aa=0,this.i=[],this.j=new Ut,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ce("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ce("baseRetryDelayMs",5e3,u),this.cb=Ce("retryDelaySeedMs",1e4,u),this.Wa=Ce("forwardChannelMaxRetries",2,u),this.wa=Ce("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new li(u&&u.concurrentRequestLimit),this.Da=new $f,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Xe.prototype,t.la=8,t.G=1,t.connect=function(u,p,E,D){Kr(0),this.W=u,this.H=p||{},E&&D!==void 0&&(this.H.OSID=E,this.H.OAID=D),this.F=this.X,this.I=ze(this,null,this.W),pr(this)};function ie(u){if(Ht(u),u.G==3){var p=u.U++,E=js(u.I);if(nr(E,"SID",u.K),nr(E,"RID",p),nr(E,"TYPE","terminate"),gr(u,E),p=new oe(u,u.j,p),p.L=2,p.v=jo(js(E)),E=!1,o.navigator&&o.navigator.sendBeacon)try{E=o.navigator.sendBeacon(p.v.toString(),"")}catch{}!E&&o.Image&&(new Image().src=p.v,E=!0),E||(p.g=tr(p.j,null),p.g.ea(p.v)),p.F=Date.now(),De(p)}Le(u)}function et(u){u.g&&(Ct(u),u.g.cancel(),u.g=null)}function Ht(u){et(u),u.u&&(o.clearTimeout(u.u),u.u=null),An(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function pr(u){if(!ls(u.h)&&!u.s){u.s=!0;var p=u.Ga;Me||Ye(),_t||(Me(),_t=!0),se.add(p,u),u.B=0}}function Us(u,p){return ia(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Vs(f(u.Ga,u,p),wn(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const ee=new oe(this,this.j,u);let ae=this.o;if(this.S&&(ae?(ae=k(ae),R(ae,this.S)):ae=this.S),this.m!==null||this.O||(ee.H=ae,ae=null),this.P)e:{for(var p=0,E=0;E<this.i.length;E++){t:{var D=this.i[E];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(p+=D,4096<p){p=E;break e}if(p===4096||E===this.i.length-1){p=E+1;break e}}p=1e3}else p=1e3;p=Jr(this,ee,p),E=js(this.I),nr(E,"RID",u),nr(E,"CVER",22),this.D&&nr(E,"X-HTTP-Session-Id",this.D),gr(this,E),ae&&(this.O?p="headers="+encodeURIComponent(String(Xc(ae)))+"&"+p:this.m&&Kc(E,this.m,ae)),Ci(this.h,ee),this.Ua&&nr(E,"TYPE","init"),this.P?(nr(E,"$req",p),nr(E,"SID","null"),ee.T=!0,ge(ee,E,null)):ge(ee,E,p),this.G=2}}else this.G==3&&(u?Sn(this,u):this.i.length==0||ls(this.h)||Sn(this))};function Sn(u,p){var E;p?E=p.l:E=u.U++;const D=js(u.I);nr(D,"SID",u.K),nr(D,"RID",E),nr(D,"AID",u.T),gr(u,D),u.m&&u.o&&Kc(D,u.m,u.o),E=new oe(u,u.j,E,u.B+1),u.m===null&&(E.H=u.o),p&&(u.i=p.D.concat(u.i)),p=Jr(u,E,1e3),E.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Ci(u.h,E),ge(E,D,p)}function gr(u,p){u.H&&z(u.H,function(E,D){nr(p,D,E)}),u.l&&yu({},function(E,D){nr(p,D,E)})}function Jr(u,p,E){E=Math.min(u.i.length,E);var D=u.l?f(u.l.Na,u.l,u):null;e:{var ee=u.i;let ae=-1;for(;;){const Ne=["count="+E];ae==-1?0<E?(ae=ee[0].g,Ne.push("ofs="+ae)):ae=0:Ne.push("ofs="+ae);let Mt=!0;for(let Pr=0;Pr<E;Pr++){let Rt=ee[Pr].g;const en=ee[Pr].map;if(Rt-=ae,0>Rt)ae=Math.max(0,ee[Pr].g-100),Mt=!1;else try{Cu(en,Ne,"req"+Rt+"_")}catch{D&&D(en)}}if(Mt){D=Ne.join("&");break e}}}return u=u.i.splice(0,E),p.D=u,D}function gn(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;Me||Ye(),_t||(Me(),_t=!0),se.add(p,u),u.v=0}}function Dt(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Vs(f(u.Fa,u),wn(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,Qt(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Vs(f(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Kr(10),et(this),Qt(this))};function Ct(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function Qt(u){u.g=new oe(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=js(u.qa);nr(p,"RID","rpc"),nr(p,"SID",u.K),nr(p,"AID",u.T),nr(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&nr(p,"TO",u.ja),nr(p,"TYPE","xmlhttp"),gr(u,p),u.m&&u.o&&Kc(p,u.m,u.o),u.L&&(u.g.I=u.L);var E=u.g;u=u.ia,E.L=1,E.v=jo(js(p)),E.m=null,E.P=!0,de(E,u)}t.Za=function(){this.C!=null&&(this.C=null,et(this),Dt(this),Kr(19))};function An(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function xn(u,p){var E=null;if(u.g==p){An(u),Ct(u),u.g=null;var D=2}else if(Yr(u.h,p))E=p.D,_u(u.h,p),D=1;else return;if(u.G!=0){if(p.o)if(D==1){E=p.m?p.m.length:0,p=Date.now()-p.F;var ee=u.B;D=sa(),mr(D,new Va(D,E)),pr(u)}else gn(u);else if(ee=p.s,ee==3||ee==0&&0<p.X||!(D==1&&Us(u,p)||D==2&&Dt(u)))switch(E&&0<E.length&&(p=u.h,p.i=p.i.concat(E)),ee){case 1:xt(u,5);break;case 4:xt(u,10);break;case 3:xt(u,6);break;default:xt(u,2)}}}function wn(u,p){let E=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(E*=2),E*p}function xt(u,p){if(u.j.info("Error code "+p),p==2){var E=f(u.fb,u),D=u.Xa;const ee=!D;D=new us(D||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Bo(D,"https"),jo(D),ee?Gc(D.toString(),E):qc(D.toString(),E)}else Kr(2);u.G=0,u.l&&u.l.sa(p),Le(u),Ht(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Kr(2)):(this.j.info("Failed to ping google.com"),Kr(1))};function Le(u){if(u.G=0,u.ka=[],u.l){const p=Mo(u.h);(p.length!=0||u.i.length!=0)&&(y(u.ka,p),y(u.ka,u.i),u.h.i.length=0,x(u.i),u.i.length=0),u.l.ra()}}function ze(u,p,E){var D=E instanceof us?js(E):new us(E);if(D.g!="")p&&(D.g=p+"."+D.g),Vo(D,D.s);else{var ee=o.location;D=ee.protocol,p=p?p+"."+ee.hostname:ee.hostname,ee=+ee.port;var ae=new us(null);D&&Bo(ae,D),p&&(ae.g=p),ee&&Vo(ae,ee),E&&(ae.l=E),D=ae}return E=u.D,p=u.ya,E&&p&&nr(D,E,p),nr(D,"VER",u.la),gr(u,D),D}function tr(u,p,E){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new v(new za({eb:E})):new v(u.pa),p.Ha(u.J),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function xr(){}t=xr.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Dr(){}Dr.prototype.g=function(u,p){return new Lt(u,p)};function Lt(u,p){zt.call(this),this.g=new Xe(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!F(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!F(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new Zr(this)}w(Lt,zt),Lt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Lt.prototype.close=function(){ie(this.g)},Lt.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var E={};E.__data__=u,u=E}else this.u&&(E={},E.__data__=Es(u),u=E);p.i.push(new ci(p.Ya++,u)),p.G==3&&pr(p)},Lt.prototype.N=function(){this.g.l=null,delete this.j,ie(this.g),delete this.g,Lt.aa.N.call(this)};function wr(u){Ii.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const E in p){u=E;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}w(wr,Ii);function sn(){kr.call(this),this.status=1}w(sn,kr);function Zr(u){this.g=u}w(Zr,xr),Zr.prototype.ua=function(){mr(this.g,"a")},Zr.prototype.ta=function(u){mr(this.g,new wr(u))},Zr.prototype.sa=function(u){mr(this.g,new sn)},Zr.prototype.ra=function(){mr(this.g,"b")},Dr.prototype.createWebChannel=Dr.prototype.g,Lt.prototype.send=Lt.prototype.o,Lt.prototype.open=Lt.prototype.m,Lt.prototype.close=Lt.prototype.close,Px=function(){return new Dr},Dx=function(){return sa()},Rx=Ms,N0={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},N.NO_ERROR=0,N.TIMEOUT=8,N.HTTP_ERROR=6,Ju=N,B.COMPLETE="complete",Cx=B,bi.EventType=oi,oi.OPEN="a",oi.CLOSE="b",oi.ERROR="c",oi.MESSAGE="d",zt.prototype.listen=zt.prototype.K,tl=bi,v.prototype.listenOnce=v.prototype.L,v.prototype.getLastError=v.prototype.Ka,v.prototype.getLastErrorCode=v.prototype.Ba,v.prototype.getStatus=v.prototype.Z,v.prototype.getResponseJson=v.prototype.Oa,v.prototype.getResponseText=v.prototype.oa,v.prototype.send=v.prototype.ea,v.prototype.setWithCredentials=v.prototype.Ha,Ix=v}).apply(typeof Fu<"u"?Fu:typeof self<"u"?self:typeof window<"u"?window:{});const Ip="@firebase/firestore",Cp="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Dn.UNAUTHENTICATED=new Dn(null),Dn.GOOGLE_CREDENTIALS=new Dn("google-credentials-uid"),Dn.FIRST_PARTY=new Dn("first-party-uid"),Dn.MOCK_USER=new Dn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ac="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo=new xd("@firebase/firestore");function Ho(){return mo.logLevel}function He(t,...e){if(mo.logLevel<=At.DEBUG){const r=e.map(_d);mo.debug(`Firestore (${Ac}): ${t}`,...r)}}function Hi(t,...e){if(mo.logLevel<=At.ERROR){const r=e.map(_d);mo.error(`Firestore (${Ac}): ${t}`,...r)}}function po(t,...e){if(mo.logLevel<=At.WARN){const r=e.map(_d);mo.warn(`Firestore (${Ac}): ${t}`,...r)}}function _d(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(r){return JSON.stringify(r)})(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ot(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,Fx(t,n,r)}function Fx(t,e,r){let n=`FIRESTORE (${Ac}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Hi(n),new Error(n)}function Xt(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||Fx(e,s,n)}function mt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ve extends Ki{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ox{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(Dn.UNAUTHENTICATED)))}shutdown(){}}class cS{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class lS{constructor(e){this.t=e,this.currentUser=Dn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Xt(this.o===void 0,42304);let n=this.i;const s=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let i=new Mi;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Mi,e.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const c=i;e.enqueueRetryable((async()=>{await c.promise,await s(this.currentUser)}))},o=c=>{He("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((c=>o(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(He("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Mi)}}),0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(He("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Xt(typeof n.accessToken=="string",31837,{l:n}),new Nx(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Xt(e===null||typeof e=="string",2055,{h:e}),new Dn(e)}}class uS{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Dn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class hS{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new uS(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(Dn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Rp{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fS{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ds(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Xt(this.o===void 0,3512);const n=i=>{i.error!=null&&He("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,He("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>n(i)))};const s=i=>{He("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):He("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Rp(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(Xt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new Rp(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=dS(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%62))}return n}}function kt(t,e){return t<e?-1:t>e?1:0}function O0(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const s=t.charAt(n),i=e.charAt(n);if(s!==i)return r0(s)===r0(i)?kt(s,i):r0(s)?1:-1}return kt(t.length,e.length)}const mS=55296,pS=57343;function r0(t){const e=t.charCodeAt(0);return e>=mS&&e<=pS}function hc(t,e,r){return t.length===e.length&&t.every(((n,s)=>r(n,e[s])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dp="__name__";class pi{constructor(e,r,n){r===void 0?r=0:r>e.length&&ot(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ot(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return pi.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof pi?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=pi.compareSegments(e.get(s),r.get(s));if(i!==0)return i}return kt(e.length,r.length)}static compareSegments(e,r){const n=pi.isNumericId(e),s=pi.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?pi.extractNumericId(e).compare(pi.extractNumericId(r)):O0(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return va.fromString(e.substring(4,e.length-2))}}class ar extends pi{construct(e,r,n){return new ar(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ve(fe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((s=>s.length>0)))}return new ar(r)}static emptyPath(){return new ar([])}}const gS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class un extends pi{construct(e,r,n){return new un(e,r,n)}static isValidIdentifier(e){return gS.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),un.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Dp}static keyField(){return new un([Dp])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new Ve(fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new Ve(fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Ve(fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(n+=o,s++):(i(),s++)}if(i(),a)throw new Ve(fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new un(r)}static emptyPath(){return new un([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e){this.path=e}static fromPath(e){return new Ke(ar.fromString(e))}static fromName(e){return new Ke(ar.fromString(e).popFirst(5))}static empty(){return new Ke(ar.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ar.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return ar.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ke(new ar(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lx(t,e,r){if(!r)throw new Ve(fe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Mx(t,e,r,n){if(e===!0&&n===!0)throw new Ve(fe.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Pp(t){if(!Ke.isDocumentKey(t))throw new Ve(fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Fp(t){if(Ke.isDocumentKey(t))throw new Ve(fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Bx(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Zh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ot(12329,{type:typeof t})}function Mn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ve(fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Zh(t);throw new Ve(fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xr(t,e){const r={typeString:t};return e&&(r.value=e),r}function ql(t,e){if(!Bx(t))throw new Ve(fe.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const s=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(s&&typeof a!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new Ve(fe.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Np=-62135596800,Op=1e6;class or{static now(){return or.fromMillis(Date.now())}static fromDate(e){return or.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*Op);return new or(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ve(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ve(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<Np)throw new Ve(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ve(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Op}_compareTo(e){return this.seconds===e.seconds?kt(this.nanoseconds,e.nanoseconds):kt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:or._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ql(e,or._jsonSchema))return new or(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Np;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}or._jsonSchemaVersion="firestore/timestamp/1.0",or._jsonSchema={type:Xr("string",or._jsonSchemaVersion),seconds:Xr("number"),nanoseconds:Xr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{static fromTimestamp(e){return new ft(e)}static min(){return new ft(new or(0,0))}static max(){return new ft(new or(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sl=-1;function xS(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=ft.fromTimestamp(n===1e9?new or(r+1,0):new or(r,n));return new Ea(s,Ke.empty(),e)}function wS(t){return new Ea(t.readTime,t.key,Sl)}class Ea{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ea(ft.min(),Ke.empty(),Sl)}static max(){return new Ea(ft.max(),Ke.empty(),Sl)}}function vS(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Ke.comparator(t.documentKey,e.documentKey),r!==0?r:kt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _S="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class yS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kc(t){if(t.code!==fe.FAILED_PRECONDITION||t.message!==_S)throw t;He("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ot(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new me(((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof me?r:me.resolve(r)}catch(r){return me.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):me.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):me.reject(r)}static resolve(e){return new me(((r,n)=>{r(e)}))}static reject(e){return new me(((r,n)=>{n(e)}))}static waitFor(e){return new me(((r,n)=>{let s=0,i=0,a=!1;e.forEach((o=>{++s,o.next((()=>{++i,a&&i===s&&r()}),(c=>n(c)))})),a=!0,i===s&&r()}))}static or(e){let r=me.resolve(!1);for(const n of e)r=r.next((s=>s?me.resolve(s):n()));return r}static forEach(e,r){const n=[];return e.forEach(((s,i)=>{n.push(r.call(this,s,i))})),this.waitFor(n)}static mapArray(e,r){return new me(((n,s)=>{const i=e.length,a=new Array(i);let o=0;for(let c=0;c<i;c++){const l=c;r(e[l]).next((h=>{a[l]=h,++o,o===i&&n(a)}),(h=>s(h)))}}))}static doWhile(e,r){return new me(((n,s)=>{const i=()=>{e()===!0?r().next((()=>{i()}),s):n()};i()}))}}function ES(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function bc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ef.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yd=-1;function tf(t){return t==null}function lh(t){return t===0&&1/t==-1/0}function TS(t){return typeof t=="number"&&Number.isInteger(t)&&!lh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx="";function SS(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=Lp(e)),e=AS(t.get(r),e);return Lp(e)}function AS(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const i=t.charAt(s);switch(i){case"\0":r+="";break;case Vx:r+="";break;default:r+=i}}return r}function Lp(t){return t+Vx+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mp(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Fa(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function jx(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e,r){this.comparator=e,this.root=r||_n.EMPTY}insert(e,r){return new Er(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,_n.BLACK,null,null))}remove(e){return new Er(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_n.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Nu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Nu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Nu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Nu(this.root,e,this.comparator,!0)}}class Nu{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _n{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??_n.RED,this.left=s??_n.EMPTY,this.right=i??_n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new _n(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return _n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return _n.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ot(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ot(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ot(27949);return e+(this.isRed()?0:1)}}_n.EMPTY=null,_n.RED=!0,_n.BLACK=!1;_n.EMPTY=new class{constructor(){this.size=0}get key(){throw ot(57766)}get value(){throw ot(16141)}get color(){throw ot(16727)}get left(){throw ot(29726)}get right(){throw ot(36894)}copy(e,r,n,s,i){return this}insert(e,r,n){return new _n(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.comparator=e,this.data=new Er(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Bp(this.data.getIterator())}getIteratorFrom(e){return new Bp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof rn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new rn(this.comparator);return r.data=e,r}}class Bp{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e){this.fields=e,e.sort(un.comparator)}static empty(){return new xs([])}unionWith(e){let r=new rn(un.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new xs(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return hc(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Ux("Invalid base64 string: "+i):i}})(e);return new dn(r)}static fromUint8Array(e){const r=(function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i})(e);return new dn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return kt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}dn.EMPTY_BYTE_STRING=new dn("");const kS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ta(t){if(Xt(!!t,39018),typeof t=="string"){let e=0;const r=kS.exec(t);if(Xt(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Lr(t.seconds),nanos:Lr(t.nanos)}}function Lr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Sa(t){return typeof t=="string"?dn.fromBase64String(t):dn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wx="server_timestamp",$x="__type__",zx="__previous_value__",Hx="__local_write_time__";function Ed(t){return(t?.mapValue?.fields||{})[$x]?.stringValue===Wx}function rf(t){const e=t.mapValue.fields[zx];return Ed(e)?rf(e):e}function Al(t){const e=Ta(t.mapValue.fields[Hx].timestampValue);return new or(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(e,r,n,s,i,a,o,c,l,h){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=h}}const uh="(default)";class fc{constructor(e,r){this.projectId=e,this.database=r||uh}static empty(){return new fc("","")}get isDefaultDatabase(){return this.database===uh}isEqual(e){return e instanceof fc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gx="__type__",IS="__max__",Ou={mapValue:{}},qx="__vector__",hh="value";function Aa(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ed(t)?4:RS(t)?9007199254740991:CS(t)?10:11:ot(28295,{value:t})}function Ei(t,e){if(t===e)return!0;const r=Aa(t);if(r!==Aa(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Al(t).isEqual(Al(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Ta(s.timestampValue),o=Ta(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(s,i){return Sa(s.bytesValue).isEqual(Sa(i.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(s,i){return Lr(s.geoPointValue.latitude)===Lr(i.geoPointValue.latitude)&&Lr(s.geoPointValue.longitude)===Lr(i.geoPointValue.longitude)})(t,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return Lr(s.integerValue)===Lr(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Lr(s.doubleValue),o=Lr(i.doubleValue);return a===o?lh(a)===lh(o):isNaN(a)&&isNaN(o)}return!1})(t,e);case 9:return hc(t.arrayValue.values||[],e.arrayValue.values||[],Ei);case 10:case 11:return(function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(Mp(a)!==Mp(o))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(o[c]===void 0||!Ei(a[c],o[c])))return!1;return!0})(t,e);default:return ot(52216,{left:t})}}function kl(t,e){return(t.values||[]).find((r=>Ei(r,e)))!==void 0}function dc(t,e){if(t===e)return 0;const r=Aa(t),n=Aa(e);if(r!==n)return kt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return kt(t.booleanValue,e.booleanValue);case 2:return(function(i,a){const o=Lr(i.integerValue||i.doubleValue),c=Lr(a.integerValue||a.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1})(t,e);case 3:return Vp(t.timestampValue,e.timestampValue);case 4:return Vp(Al(t),Al(e));case 5:return O0(t.stringValue,e.stringValue);case 6:return(function(i,a){const o=Sa(i),c=Sa(a);return o.compareTo(c)})(t.bytesValue,e.bytesValue);case 7:return(function(i,a){const o=i.split("/"),c=a.split("/");for(let l=0;l<o.length&&l<c.length;l++){const h=kt(o[l],c[l]);if(h!==0)return h}return kt(o.length,c.length)})(t.referenceValue,e.referenceValue);case 8:return(function(i,a){const o=kt(Lr(i.latitude),Lr(a.latitude));return o!==0?o:kt(Lr(i.longitude),Lr(a.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return jp(t.arrayValue,e.arrayValue);case 10:return(function(i,a){const o=i.fields||{},c=a.fields||{},l=o[hh]?.arrayValue,h=c[hh]?.arrayValue,d=kt(l?.values?.length||0,h?.values?.length||0);return d!==0?d:jp(l,h)})(t.mapValue,e.mapValue);case 11:return(function(i,a){if(i===Ou.mapValue&&a===Ou.mapValue)return 0;if(i===Ou.mapValue)return 1;if(a===Ou.mapValue)return-1;const o=i.fields||{},c=Object.keys(o),l=a.fields||{},h=Object.keys(l);c.sort(),h.sort();for(let d=0;d<c.length&&d<h.length;++d){const f=O0(c[d],h[d]);if(f!==0)return f;const g=dc(o[c[d]],l[h[d]]);if(g!==0)return g}return kt(c.length,h.length)})(t.mapValue,e.mapValue);default:throw ot(23264,{he:r})}}function Vp(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return kt(t,e);const r=Ta(t),n=Ta(e),s=kt(r.seconds,n.seconds);return s!==0?s:kt(r.nanos,n.nanos)}function jp(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=dc(r[s],n[s]);if(i)return i}return kt(r.length,n.length)}function mc(t){return L0(t)}function L0(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=Ta(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return Sa(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return Ke.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=L0(i);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const a of n)i?i=!1:s+=",",s+=`${a}:${L0(r.fields[a])}`;return s+"}"})(t.mapValue):ot(61005,{value:t})}function Zu(t){switch(Aa(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=rf(t);return e?16+Zu(e):16;case 5:return 2*t.stringValue.length;case 6:return Sa(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((s,i)=>s+Zu(i)),0)})(t.arrayValue);case 10:case 11:return(function(n){let s=0;return Fa(n.fields,((i,a)=>{s+=i.length+Zu(a)})),s})(t.mapValue);default:throw ot(13486,{value:t})}}function Up(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function M0(t){return!!t&&"integerValue"in t}function Td(t){return!!t&&"arrayValue"in t}function Wp(t){return!!t&&"nullValue"in t}function $p(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function eh(t){return!!t&&"mapValue"in t}function CS(t){return(t?.mapValue?.fields||{})[Gx]?.stringValue===qx}function ll(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Fa(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=ll(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=ll(t.arrayValue.values[r]);return e}return{...t}}function RS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===IS}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e){this.value=e}static empty(){return new ss({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!eh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=ll(r)}setAll(e){let r=un.emptyPath(),n={},s=[];e.forEach(((a,o)=>{if(!r.isImmediateParentOf(o)){const c=this.getFieldsMap(r);this.applyChanges(c,n,s),n={},s=[],r=o.popLast()}a?n[o.lastSegment()]=ll(a):s.push(o.lastSegment())}));const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());eh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ei(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];eh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){Fa(r,((s,i)=>e[s]=i));for(const s of n)delete e[s]}clone(){return new ss(ll(this.value))}}function Xx(t){const e=[];return Fa(t.fields,((r,n)=>{const s=new un([r]);if(eh(n)){const i=Xx(n.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)})),new xs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e,r,n,s,i,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Nn(e,0,ft.min(),ft.min(),ft.min(),ss.empty(),0)}static newFoundDocument(e,r,n,s){return new Nn(e,1,r,ft.min(),n,s,0)}static newNoDocument(e,r){return new Nn(e,2,r,ft.min(),ft.min(),ss.empty(),0)}static newUnknownDocument(e,r){return new Nn(e,3,r,ft.min(),ft.min(),ss.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(ft.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ss.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ss.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ft.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Nn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Nn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,r){this.position=e,this.inclusive=r}}function zp(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?n=Ke.comparator(Ke.fromName(a.referenceValue),r.key):n=dc(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function Hp(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ei(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e,r="asc"){this.field=e,this.dir=r}}function DS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx{}class qr extends Kx{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new FS(e,r,n):r==="array-contains"?new LS(e,n):r==="in"?new MS(e,n):r==="not-in"?new BS(e,n):r==="array-contains-any"?new VS(e,n):new qr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new NS(e,n):new OS(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(dc(r,this.value)):r!==null&&Aa(this.value)===Aa(r)&&this.matchesComparison(dc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ot(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class si extends Kx{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new si(e,r)}matches(e){return Yx(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Yx(t){return t.op==="and"}function Qx(t){return PS(t)&&Yx(t)}function PS(t){for(const e of t.filters)if(e instanceof si)return!1;return!0}function B0(t){if(t instanceof qr)return t.field.canonicalString()+t.op.toString()+mc(t.value);if(Qx(t))return t.filters.map((e=>B0(e))).join(",");{const e=t.filters.map((r=>B0(r))).join(",");return`${t.op}(${e})`}}function Jx(t,e){return t instanceof qr?(function(n,s){return s instanceof qr&&n.op===s.op&&n.field.isEqual(s.field)&&Ei(n.value,s.value)})(t,e):t instanceof si?(function(n,s){return s instanceof si&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce(((i,a,o)=>i&&Jx(a,s.filters[o])),!0):!1})(t,e):void ot(19439)}function Zx(t){return t instanceof qr?(function(r){return`${r.field.canonicalString()} ${r.op} ${mc(r.value)}`})(t):t instanceof si?(function(r){return r.op.toString()+" {"+r.getFilters().map(Zx).join(" ,")+"}"})(t):"Filter"}class FS extends qr{constructor(e,r,n){super(e,r,n),this.key=Ke.fromName(n.referenceValue)}matches(e){const r=Ke.comparator(e.key,this.key);return this.matchesComparison(r)}}class NS extends qr{constructor(e,r){super(e,"in",r),this.keys=ew("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class OS extends qr{constructor(e,r){super(e,"not-in",r),this.keys=ew("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function ew(t,e){return(e.arrayValue?.values||[]).map((r=>Ke.fromName(r.referenceValue)))}class LS extends qr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Td(r)&&kl(r.arrayValue,this.value)}}class MS extends qr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&kl(this.value.arrayValue,r)}}class BS extends qr{constructor(e,r){super(e,"not-in",r)}matches(e){if(kl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!kl(this.value.arrayValue,r)}}class VS extends qr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Td(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>kl(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e,r=null,n=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.Te=null}}function Gp(t,e=null,r=[],n=[],s=null,i=null,a=null){return new jS(t,e,r,n,s,i,a)}function Sd(t){const e=mt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>B0(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(i){return i.field.canonicalString()+i.dir})(n))).join(","),tf(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>mc(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>mc(n))).join(",")),e.Te=r}return e.Te}function Ad(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!DS(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Jx(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Hp(t.startAt,e.startAt)&&Hp(t.endAt,e.endAt)}function V0(t){return Ke.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(e,r=null,n=[],s=[],i=null,a="F",o=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function US(t,e,r,n,s,i,a,o){return new Ic(t,e,r,n,s,i,a,o)}function nf(t){return new Ic(t)}function qp(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function tw(t){return t.collectionGroup!==null}function ul(t){const e=mt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new rn(un.comparator);return a.filters.forEach((c=>{c.getFlattenedFilters().forEach((l=>{l.isInequality()&&(o=o.add(l.field))}))})),o})(e).forEach((i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new bl(i,n))})),r.has(un.keyField().canonicalString())||e.Ie.push(new bl(un.keyField(),n))}return e.Ie}function wi(t){const e=mt(t);return e.Ee||(e.Ee=WS(e,ul(t))),e.Ee}function WS(t,e){if(t.limitType==="F")return Gp(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new bl(s.field,i)}));const r=t.endAt?new fh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new fh(t.startAt.position,t.startAt.inclusive):null;return Gp(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function j0(t,e){const r=t.filters.concat([e]);return new Ic(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function U0(t,e,r){return new Ic(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function sf(t,e){return Ad(wi(t),wi(e))&&t.limitType===e.limitType}function rw(t){return`${Sd(wi(t))}|lt:${t.limitType}`}function Go(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((s=>Zx(s))).join(", ")}]`),tf(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((s=>mc(s))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((s=>mc(s))).join(",")),`Target(${n})`})(wi(t))}; limitType=${t.limitType})`}function af(t,e){return e.isFoundDocument()&&(function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Ke.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)})(t,e)&&(function(n,s){for(const i of ul(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(t,e)&&(function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0})(t,e)&&(function(n,s){return!(n.startAt&&!(function(a,o,c){const l=zp(a,o,c);return a.inclusive?l<=0:l<0})(n.startAt,ul(n),s)||n.endAt&&!(function(a,o,c){const l=zp(a,o,c);return a.inclusive?l>=0:l>0})(n.endAt,ul(n),s))})(t,e)}function $S(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function nw(t){return(e,r)=>{let n=!1;for(const s of ul(t)){const i=zS(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function zS(t,e,r){const n=t.field.isKeyField()?Ke.comparator(e.key,r.key):(function(i,a,o){const c=a.data.field(i),l=o.data.field(i);return c!==null&&l!==null?dc(c,l):ot(42886)})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ot(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Fa(this.inner,((r,n)=>{for(const[s,i]of n)e(s,i)}))}isEmpty(){return jx(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HS=new Er(Ke.comparator);function Gi(){return HS}const sw=new Er(Ke.comparator);function rl(...t){let e=sw;for(const r of t)e=e.insert(r.key,r);return e}function iw(t){let e=sw;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function so(){return hl()}function aw(){return hl()}function hl(){return new Ao((t=>t.toString()),((t,e)=>t.isEqual(e)))}const GS=new Er(Ke.comparator),qS=new rn(Ke.comparator);function bt(...t){let e=qS;for(const r of t)e=e.add(r);return e}const XS=new rn(kt);function KS(){return XS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kd(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:lh(e)?"-0":e}}function ow(t){return{integerValue:""+t}}function YS(t,e){return TS(e)?ow(e):kd(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(){this._=void 0}}function QS(t,e,r){return t instanceof dh?(function(s,i){const a={fields:{[$x]:{stringValue:Wx},[Hx]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Ed(i)&&(i=rf(i)),i&&(a.fields[zx]=i),{mapValue:a}})(r,e):t instanceof Il?lw(t,e):t instanceof Cl?uw(t,e):(function(s,i){const a=cw(s,i),o=Xp(a)+Xp(s.Ae);return M0(a)&&M0(s.Ae)?ow(o):kd(s.serializer,o)})(t,e)}function JS(t,e,r){return t instanceof Il?lw(t,e):t instanceof Cl?uw(t,e):r}function cw(t,e){return t instanceof mh?(function(n){return M0(n)||(function(i){return!!i&&"doubleValue"in i})(n)})(e)?e:{integerValue:0}:null}class dh extends of{}class Il extends of{constructor(e){super(),this.elements=e}}function lw(t,e){const r=hw(e);for(const n of t.elements)r.some((s=>Ei(s,n)))||r.push(n);return{arrayValue:{values:r}}}class Cl extends of{constructor(e){super(),this.elements=e}}function uw(t,e){let r=hw(e);for(const n of t.elements)r=r.filter((s=>!Ei(s,n)));return{arrayValue:{values:r}}}class mh extends of{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Xp(t){return Lr(t.integerValue||t.doubleValue)}function hw(t){return Td(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ZS(t,e){return t.field.isEqual(e.field)&&(function(n,s){return n instanceof Il&&s instanceof Il||n instanceof Cl&&s instanceof Cl?hc(n.elements,s.elements,Ei):n instanceof mh&&s instanceof mh?Ei(n.Ae,s.Ae):n instanceof dh&&s instanceof dh})(t.transform,e.transform)}class eA{constructor(e,r){this.version=e,this.transformResults=r}}class qn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new qn}static exists(e){return new qn(void 0,e)}static updateTime(e){return new qn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function th(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class cf{}function fw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new lf(t.key,qn.none()):new Xl(t.key,t.data,qn.none());{const r=t.data,n=ss.empty();let s=new rn(un.comparator);for(let i of e.fields)if(!s.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),s=s.add(i)}return new Na(t.key,n,new xs(s.toArray()),qn.none())}}function tA(t,e,r){t instanceof Xl?(function(s,i,a){const o=s.value.clone(),c=Yp(s.fieldTransforms,i,a.transformResults);o.setAll(c),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()})(t,e,r):t instanceof Na?(function(s,i,a){if(!th(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=Yp(s.fieldTransforms,i,a.transformResults),c=i.data;c.setAll(dw(s)),c.setAll(o),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()})(t,e,r):(function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,r)}function fl(t,e,r,n){return t instanceof Xl?(function(i,a,o,c){if(!th(i.precondition,a))return o;const l=i.value.clone(),h=Qp(i.fieldTransforms,c,a);return l.setAll(h),a.convertToFoundDocument(a.version,l).setHasLocalMutations(),null})(t,e,r,n):t instanceof Na?(function(i,a,o,c){if(!th(i.precondition,a))return o;const l=Qp(i.fieldTransforms,c,a),h=a.data;return h.setAll(dw(i)),h.setAll(l),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((d=>d.field)))})(t,e,r,n):(function(i,a,o){return th(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o})(t,e,r)}function rA(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=cw(n.transform,s||null);i!=null&&(r===null&&(r=ss.empty()),r.set(n.field,i))}return r||null}function Kp(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&hc(n,s,((i,a)=>ZS(i,a)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Xl extends cf{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Na extends cf{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function dw(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function Yp(t,e,r){const n=new Map;Xt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let s=0;s<r.length;s++){const i=t[s],a=i.transform,o=e.data.field(i.field);n.set(i.field,JS(a,o,r[s]))}return n}function Qp(t,e,r){const n=new Map;for(const s of t){const i=s.transform,a=r.data.field(s.field);n.set(s.field,QS(i,a,e))}return n}class lf extends cf{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nA extends cf{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sA{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&tA(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=fl(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=fl(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=aw();return this.mutations.forEach((s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=r.has(s.key)?null:o;const c=fw(a,o);c!==null&&n.set(s.key,c),a.isValidDocument()||a.convertToNoDocument(ft.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),bt())}isEqual(e){return this.batchId===e.batchId&&hc(this.mutations,e.mutations,((r,n)=>Kp(r,n)))&&hc(this.baseMutations,e.baseMutations,((r,n)=>Kp(r,n)))}}class bd{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){Xt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=(function(){return GS})();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,n[a].version);return new bd(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zr,Pt;function oA(t){switch(t){case fe.OK:return ot(64938);case fe.CANCELLED:case fe.UNKNOWN:case fe.DEADLINE_EXCEEDED:case fe.RESOURCE_EXHAUSTED:case fe.INTERNAL:case fe.UNAVAILABLE:case fe.UNAUTHENTICATED:return!1;case fe.INVALID_ARGUMENT:case fe.NOT_FOUND:case fe.ALREADY_EXISTS:case fe.PERMISSION_DENIED:case fe.FAILED_PRECONDITION:case fe.ABORTED:case fe.OUT_OF_RANGE:case fe.UNIMPLEMENTED:case fe.DATA_LOSS:return!0;default:return ot(15467,{code:t})}}function mw(t){if(t===void 0)return Hi("GRPC error has no .code"),fe.UNKNOWN;switch(t){case zr.OK:return fe.OK;case zr.CANCELLED:return fe.CANCELLED;case zr.UNKNOWN:return fe.UNKNOWN;case zr.DEADLINE_EXCEEDED:return fe.DEADLINE_EXCEEDED;case zr.RESOURCE_EXHAUSTED:return fe.RESOURCE_EXHAUSTED;case zr.INTERNAL:return fe.INTERNAL;case zr.UNAVAILABLE:return fe.UNAVAILABLE;case zr.UNAUTHENTICATED:return fe.UNAUTHENTICATED;case zr.INVALID_ARGUMENT:return fe.INVALID_ARGUMENT;case zr.NOT_FOUND:return fe.NOT_FOUND;case zr.ALREADY_EXISTS:return fe.ALREADY_EXISTS;case zr.PERMISSION_DENIED:return fe.PERMISSION_DENIED;case zr.FAILED_PRECONDITION:return fe.FAILED_PRECONDITION;case zr.ABORTED:return fe.ABORTED;case zr.OUT_OF_RANGE:return fe.OUT_OF_RANGE;case zr.UNIMPLEMENTED:return fe.UNIMPLEMENTED;case zr.DATA_LOSS:return fe.DATA_LOSS;default:return ot(39323,{code:t})}}(Pt=zr||(zr={}))[Pt.OK=0]="OK",Pt[Pt.CANCELLED=1]="CANCELLED",Pt[Pt.UNKNOWN=2]="UNKNOWN",Pt[Pt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Pt[Pt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Pt[Pt.NOT_FOUND=5]="NOT_FOUND",Pt[Pt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Pt[Pt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Pt[Pt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Pt[Pt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Pt[Pt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Pt[Pt.ABORTED=10]="ABORTED",Pt[Pt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Pt[Pt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Pt[Pt.INTERNAL=13]="INTERNAL",Pt[Pt.UNAVAILABLE=14]="UNAVAILABLE",Pt[Pt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lA=new va([4294967295,4294967295],0);function Jp(t){const e=cA().encode(t),r=new bx;return r.update(e),new Uint8Array(r.digest())}function Zp(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new va([r,n],0),new va([s,i],0)]}class Id{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new nl(`Invalid padding: ${r}`);if(n<0)throw new nl(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new nl(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new nl(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=va.fromNumber(this.ge)}ye(e,r,n){let s=e.add(r.multiply(va.fromNumber(n)));return s.compare(lA)===1&&(s=new va([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Jp(e),[n,s]=Zp(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);if(!this.we(a))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Id(i,s,r);return n.forEach((o=>a.insert(o))),a}insert(e){if(this.ge===0)return;const r=Jp(e),[n,s]=Zp(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class nl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Kl.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new uf(ft.min(),s,new Er(kt),Gi(),bt())}}class Kl{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Kl(n,r,bt(),bt(),bt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,r,n,s){this.be=e,this.removedTargetIds=r,this.key=n,this.De=s}}class pw{constructor(e,r){this.targetId=e,this.Ce=r}}class gw{constructor(e,r,n=dn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class eg{constructor(){this.ve=0,this.Fe=tg(),this.Me=dn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=bt(),r=bt(),n=bt();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:ot(38017,{changeType:i})}})),new Kl(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=tg()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Xt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class uA{constructor(e){this.Ge=e,this.ze=new Map,this.je=Gi(),this.Je=Lu(),this.He=Lu(),this.Ye=new Er(kt)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,(r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:ot(56790,{state:e.state})}}))}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach(((n,s)=>{this.rt(s)&&r(s)}))}st(e){const r=e.targetId,n=e.Ce.count,s=this.ot(r);if(s){const i=s.target;if(V0(i))if(n===0){const a=new Ke(i.path);this.et(r,a,Nn.newNoDocument(a,ft.min()))}else Xt(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const o=this.ut(e),c=o?this.ct(o,e,a):1;if(c!==0){this.it(r);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,l)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let a,o;try{a=Sa(n).toUint8Array()}catch(c){if(c instanceof Ux)return po("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{o=new Id(a,s,i)}catch(c){return po(c instanceof nl?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let s=0;return n.forEach((i=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.et(r,i,null),s++)})),s}Tt(e){const r=new Map;this.ze.forEach(((i,a)=>{const o=this.ot(a);if(o){if(i.current&&V0(o.target)){const c=new Ke(o.target.path);this.It(c).has(a)||this.Et(a,c)||this.et(a,c,Nn.newNoDocument(c,e))}i.Be&&(r.set(a,i.ke()),i.qe())}}));let n=bt();this.He.forEach(((i,a)=>{let o=!0;a.forEachWhile((c=>{const l=this.ot(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)})),o&&(n=n.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const s=new uf(e,r,this.Ye,this.je,n);return this.je=Gi(),this.Je=Lu(),this.He=Lu(),this.Ye=new Er(kt),s}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,r)?s.Qe(r,1):s.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new eg,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new rn(kt),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new rn(kt),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||He("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new eg),this.Ge.getRemoteKeysForTarget(e).forEach((r=>{this.et(e,r,null)}))}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Lu(){return new Er(Ke.comparator)}function tg(){return new Er(Ke.comparator)}const hA={asc:"ASCENDING",desc:"DESCENDING"},fA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},dA={and:"AND",or:"OR"};class mA{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function W0(t,e){return t.useProto3Json||tf(e)?e:{value:e}}function ph(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function pA(t,e){return ph(t,e.toTimestamp())}function vi(t){return Xt(!!t,49232),ft.fromTimestamp((function(r){const n=Ta(r);return new or(n.seconds,n.nanos)})(t))}function Cd(t,e){return $0(t,e).canonicalString()}function $0(t,e){const r=(function(s){return new ar(["projects",s.projectId,"databases",s.database])})(t).child("documents");return e===void 0?r:r.child(e)}function ww(t){const e=ar.fromString(t);return Xt(Tw(e),10190,{key:e.toString()}),e}function z0(t,e){return Cd(t.databaseId,e.path)}function n0(t,e){const r=ww(e);if(r.get(1)!==t.databaseId.projectId)throw new Ve(fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Ve(fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Ke(_w(r))}function vw(t,e){return Cd(t.databaseId,e)}function gA(t){const e=ww(t);return e.length===4?ar.emptyPath():_w(e)}function H0(t){return new ar(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function _w(t){return Xt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function rg(t,e,r){return{name:z0(t,e),fields:r.value.mapValue.fields}}function xA(t,e){let r;if("targetChange"in e){e.targetChange;const n=(function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:ot(39313,{state:l})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(l,h){return l.useProto3Json?(Xt(h===void 0||typeof h=="string",58123),dn.fromBase64String(h||"")):(Xt(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),dn.fromUint8Array(h||new Uint8Array))})(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&(function(l){const h=l.code===void 0?fe.UNKNOWN:mw(l.code);return new Ve(h,l.message||"")})(a);r=new gw(n,s,i,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=n0(t,n.document.name),i=vi(n.document.updateTime),a=n.document.createTime?vi(n.document.createTime):ft.min(),o=new ss({mapValue:{fields:n.document.fields}}),c=Nn.newFoundDocument(s,i,a,o),l=n.targetIds||[],h=n.removedTargetIds||[];r=new rh(l,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=n0(t,n.document),i=n.readTime?vi(n.readTime):ft.min(),a=Nn.newNoDocument(s,i),o=n.removedTargetIds||[];r=new rh([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=n0(t,n.document),i=n.removedTargetIds||[];r=new rh([],i,s,null)}else{if(!("filter"in e))return ot(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,a=new aA(s,i),o=n.targetId;r=new pw(o,a)}}return r}function wA(t,e){let r;if(e instanceof Xl)r={update:rg(t,e.key,e.value)};else if(e instanceof lf)r={delete:z0(t,e.key)};else if(e instanceof Na)r={update:rg(t,e.key,e.data),updateMask:bA(e.fieldMask)};else{if(!(e instanceof nA))return ot(16599,{Vt:e.type});r={verify:z0(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(i,a){const o=a.transform;if(o instanceof dh)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Il)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Cl)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof mh)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw ot(20930,{transform:a.transform})})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:pA(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ot(27497)})(t,e.precondition)),r}function vA(t,e){return t&&t.length>0?(Xt(e!==void 0,14353),t.map((r=>(function(s,i){let a=s.updateTime?vi(s.updateTime):vi(i);return a.isEqual(ft.min())&&(a=vi(i)),new eA(a,s.transformResults||[])})(r,e)))):[]}function _A(t,e){return{documents:[vw(t,e.path)]}}function yA(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=vw(t,s);const i=(function(l){if(l.length!==0)return Ew(si.create(l,"and"))})(e.filters);i&&(r.structuredQuery.where=i);const a=(function(l){if(l.length!==0)return l.map((h=>(function(f){return{field:qo(f.field),direction:SA(f.dir)}})(h)))})(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=W0(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=(function(l){return{before:l.inclusive,values:l.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(l){return{before:!l.inclusive,values:l.position}})(e.endAt)),{ft:r,parent:s}}function EA(t){let e=gA(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){Xt(n===1,65062);const h=r.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];r.where&&(i=(function(d){const f=yw(d);return f instanceof si&&Qx(f)?f.getFilters():[f]})(r.where));let a=[];r.orderBy&&(a=(function(d){return d.map((f=>(function(w){return new bl(Xo(w.field),(function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(f)))})(r.orderBy));let o=null;r.limit&&(o=(function(d){let f;return f=typeof d=="object"?d.value:d,tf(f)?null:f})(r.limit));let c=null;r.startAt&&(c=(function(d){const f=!!d.before,g=d.values||[];return new fh(g,f)})(r.startAt));let l=null;return r.endAt&&(l=(function(d){const f=!d.before,g=d.values||[];return new fh(g,f)})(r.endAt)),US(e,s,a,i,o,"F",c,l)}function TA(t,e){const r=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ot(28987,{purpose:s})}})(e.purpose);return r==null?null:{"goog-listen-tags":r}}function yw(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Xo(r.unaryFilter.field);return qr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Xo(r.unaryFilter.field);return qr.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Xo(r.unaryFilter.field);return qr.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Xo(r.unaryFilter.field);return qr.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ot(61313);default:return ot(60726)}})(t):t.fieldFilter!==void 0?(function(r){return qr.create(Xo(r.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ot(58110);default:return ot(50506)}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return si.create(r.compositeFilter.filters.map((n=>yw(n))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ot(1026)}})(r.compositeFilter.op))})(t):ot(30097,{filter:t})}function SA(t){return hA[t]}function AA(t){return fA[t]}function kA(t){return dA[t]}function qo(t){return{fieldPath:t.canonicalString()}}function Xo(t){return un.fromServerFormat(t.fieldPath)}function Ew(t){return t instanceof qr?(function(r){if(r.op==="=="){if($p(r.value))return{unaryFilter:{field:qo(r.field),op:"IS_NAN"}};if(Wp(r.value))return{unaryFilter:{field:qo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if($p(r.value))return{unaryFilter:{field:qo(r.field),op:"IS_NOT_NAN"}};if(Wp(r.value))return{unaryFilter:{field:qo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qo(r.field),op:AA(r.op),value:r.value}}})(t):t instanceof si?(function(r){const n=r.getFilters().map((s=>Ew(s)));return n.length===1?n[0]:{compositeFilter:{op:kA(r.op),filters:n}}})(t):ot(54877,{filter:t})}function bA(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function Tw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(e,r,n,s,i=ft.min(),a=ft.min(),o=dn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=c}withSequenceNumber(e){return new ha(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new ha(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ha(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ha(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(e){this.yt=e}}function CA(t){const e=EA({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?U0(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(){this.Cn=new DA}addToCollectionParentIndex(e,r){return this.Cn.add(r),me.resolve()}getCollectionParents(e,r){return me.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return me.resolve()}deleteFieldIndex(e,r){return me.resolve()}deleteAllFieldIndexes(e){return me.resolve()}createTargetIndexes(e,r){return me.resolve()}getDocumentsMatchingTarget(e,r){return me.resolve(null)}getIndexType(e,r){return me.resolve(0)}getFieldIndexes(e,r){return me.resolve([])}getNextCollectionGroupToUpdate(e){return me.resolve(null)}getMinOffset(e,r){return me.resolve(Ea.min())}getMinOffsetFromCollectionGroup(e,r){return me.resolve(Ea.min())}updateCollectionGroup(e,r,n){return me.resolve()}updateIndexEntries(e,r){return me.resolve()}}class DA{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new rn(ar.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new rn(ar.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Sw=41943040;class ns{static withCacheSize(e){return new ns(e,ns.DEFAULT_COLLECTION_PERCENTILE,ns.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ns.DEFAULT_COLLECTION_PERCENTILE=10,ns.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ns.DEFAULT=new ns(Sw,ns.DEFAULT_COLLECTION_PERCENTILE,ns.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ns.DISABLED=new ns(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new pc(0)}static cr(){return new pc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sg="LruGarbageCollector",PA=1048576;function ig([t,e],[r,n]){const s=kt(t,r);return s===0?kt(e,n):s}class FA{constructor(e){this.Ir=e,this.buffer=new rn(ig),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();ig(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class NA{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){He(sg,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){bc(r)?He(sg,"Ignoring IndexedDB error during garbage collection: ",r):await kc(r)}await this.Vr(3e5)}))}}class OA{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next((n=>Math.floor(r/100*n)))}nthSequenceNumber(e,r){if(r===0)return me.resolve(ef.ce);const n=new FA(r);return this.mr.forEachTarget(e,(s=>n.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>n.Ar(s))))).next((()=>n.maxValue))}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(He("LruGarbageCollector","Garbage collection skipped; disabled"),me.resolve(ng)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(He("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ng):this.yr(e,r)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,s,i,a,o,c,l;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((d=>(d>this.params.maximumSequenceNumbersToCollect?(He("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),s=this.params.maximumSequenceNumbersToCollect):s=d,a=Date.now(),this.nthSequenceNumber(e,s)))).next((d=>(n=d,o=Date.now(),this.removeTargets(e,n,r)))).next((d=>(i=d,c=Date.now(),this.removeOrphanedDocuments(e,n)))).next((d=>(l=Date.now(),Ho()<=At.DEBUG&&He("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${s} in `+(o-a)+`ms
	Removed ${i} targets in `+(c-o)+`ms
	Removed ${d} documents in `+(l-c)+`ms
Total Duration: ${l-h}ms`),me.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:d}))))}}function LA(t,e){return new OA(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(){this.changes=new Ao((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Nn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?me.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((s=>(n=s,this.remoteDocumentCache.getEntry(e,r)))).next((s=>(n!==null&&fl(n.mutation,s,xs.empty(),or.now()),s)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,bt()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=bt()){const s=so();return this.populateOverlays(e,s,r).next((()=>this.computeViews(e,r,s,n).next((i=>{let a=rl();return i.forEach(((o,c)=>{a=a.insert(o,c.overlayedDocument)})),a}))))}getOverlayedDocuments(e,r){const n=so();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,bt())))}populateOverlays(e,r,n){const s=[];return n.forEach((i=>{r.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((a,o)=>{r.set(a,o)}))}))}computeViews(e,r,n,s){let i=Gi();const a=hl(),o=(function(){return hl()})();return r.forEach(((c,l)=>{const h=n.get(l.key);s.has(l.key)&&(h===void 0||h.mutation instanceof Na)?i=i.insert(l.key,l):h!==void 0?(a.set(l.key,h.mutation.getFieldMask()),fl(h.mutation,l,h.mutation.getFieldMask(),or.now())):a.set(l.key,xs.empty())})),this.recalculateAndSaveOverlays(e,i).next((c=>(c.forEach(((l,h)=>a.set(l,h))),r.forEach(((l,h)=>o.set(l,new BA(h,a.get(l)??null)))),o)))}recalculateAndSaveOverlays(e,r){const n=hl();let s=new Er(((a,o)=>a-o)),i=bt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((a=>{for(const o of a)o.keys().forEach((c=>{const l=r.get(c);if(l===null)return;let h=n.get(c)||xs.empty();h=o.applyToLocalView(l,h),n.set(c,h);const d=(s.get(o.batchId)||bt()).add(c);s=s.insert(o.batchId,d)}))})).next((()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const c=o.getNext(),l=c.key,h=c.value,d=aw();h.forEach((f=>{if(!i.has(f)){const g=fw(r.get(f),n.get(f));g!==null&&d.set(f,g),i=i.add(f)}})),a.push(this.documentOverlayCache.saveOverlays(e,l,d))}return me.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,s){return(function(a){return Ke.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):tw(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next((i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):me.resolve(so());let o=Sl,c=i;return a.next((l=>me.forEach(l,((h,d)=>(o<d.largestBatchId&&(o=d.largestBatchId),i.get(h)?me.resolve():this.remoteDocumentCache.getEntry(e,h).next((f=>{c=c.insert(h,f)}))))).next((()=>this.populateOverlays(e,l,i))).next((()=>this.computeViews(e,c,l,bt()))).next((h=>({batchId:o,changes:iw(h)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Ke(r)).next((n=>{let s=rl();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let a=rl();return this.indexManager.getCollectionParents(e,i).next((o=>me.forEach(o,(c=>{const l=(function(d,f){return new Ic(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)})(r,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,l,n,s).next((h=>{h.forEach(((d,f)=>{a=a.insert(d,f)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s)))).next((a=>{i.forEach(((c,l)=>{const h=l.getKey();a.get(h)===null&&(a=a.insert(h,Nn.newInvalidDocument(h)))}));let o=rl();return a.forEach(((c,l)=>{const h=i.get(c);h!==void 0&&fl(h.mutation,l,xs.empty(),or.now()),af(r,l)&&(o=o.insert(c,l))})),o}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return me.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,(function(s){return{id:s.id,version:s.version,createTime:vi(s.createTime)}})(r)),me.resolve()}getNamedQuery(e,r){return me.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,(function(s){return{name:s.name,query:CA(s.bundledQuery),readTime:vi(s.readTime)}})(r)),me.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(){this.overlays=new Er(Ke.comparator),this.qr=new Map}getOverlay(e,r){return me.resolve(this.overlays.get(r))}getOverlays(e,r){const n=so();return me.forEach(r,(s=>this.getOverlay(e,s).next((i=>{i!==null&&n.set(s,i)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((s,i)=>{this.St(e,r,i)})),me.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(n)),me.resolve()}getOverlaysForCollection(e,r,n){const s=so(),i=r.length+1,a=new Ke(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const c=o.getNext().value,l=c.getKey();if(!r.isPrefixOf(l.path))break;l.path.length===i&&c.largestBatchId>n&&s.set(c.getKey(),c)}return me.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new Er(((l,h)=>l-h));const a=this.overlays.getIterator();for(;a.hasNext();){const l=a.getNext().value;if(l.getKey().getCollectionGroup()===r&&l.largestBatchId>n){let h=i.get(l.largestBatchId);h===null&&(h=so(),i=i.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}const o=so(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((l,h)=>o.set(l,h))),!(o.size()>=s)););return me.resolve(o)}St(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new iA(r,n));let i=this.qr.get(r);i===void 0&&(i=bt(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(){this.sessionToken=dn.EMPTY_BYTE_STRING}getSessionToken(e){return me.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,me.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(){this.Qr=new rn(cn.$r),this.Ur=new rn(cn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new cn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Gr(new cn(e,r))}zr(e,r){e.forEach((n=>this.removeReference(n,r)))}jr(e){const r=new Ke(new ar([])),n=new cn(r,e),s=new cn(r,e+1),i=[];return this.Ur.forEachInRange([n,s],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Ke(new ar([])),n=new cn(r,e),s=new cn(r,e+1);let i=bt();return this.Ur.forEachInRange([n,s],(a=>{i=i.add(a.key)})),i}containsKey(e){const r=new cn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class cn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Ke.comparator(e.key,r.key)||kt(e.Yr,r.Yr)}static Kr(e,r){return kt(e.Yr,r.Yr)||Ke.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new rn(cn.$r)}checkEmpty(e){return me.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new sA(i,r,n,s);this.mutationQueue.push(a);for(const o of s)this.Zr=this.Zr.add(new cn(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return me.resolve(a)}lookupMutationBatch(e,r){return me.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.ei(n),i=s<0?0:s;return me.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return me.resolve(this.mutationQueue.length===0?yd:this.tr-1)}getAllMutationBatches(e){return me.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new cn(r,0),s=new cn(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,s],(a=>{const o=this.Xr(a.Yr);i.push(o)})),me.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new rn(kt);return r.forEach((s=>{const i=new cn(s,0),a=new cn(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(o=>{n=n.add(o.Yr)}))})),me.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;Ke.isDocumentKey(i)||(i=i.child(""));const a=new cn(new Ke(i),0);let o=new rn(kt);return this.Zr.forEachWhile((c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===s&&(o=o.add(c.Yr)),!0)}),a),me.resolve(this.ti(o))}ti(e){const r=[];return e.forEach((n=>{const s=this.Xr(n);s!==null&&r.push(s)})),r}removeMutationBatch(e,r){Xt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return me.forEach(r.mutations,(s=>{const i=new cn(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,r){const n=new cn(r,0),s=this.Zr.firstAfterOrEqual(n);return me.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,me.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(e){this.ri=e,this.docs=(function(){return new Er(Ke.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return me.resolve(n?n.document.mutableCopy():Nn.newInvalidDocument(r))}getEntries(e,r){let n=Gi();return r.forEach((s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Nn.newInvalidDocument(s))})),me.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=Gi();const a=r.path,o=new Ke(a.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){const{key:l,value:{document:h}}=c.getNext();if(!a.isPrefixOf(l.path))break;l.path.length>a.length+1||vS(wS(h),n)<=0||(s.has(h.key)||af(r,h))&&(i=i.insert(h.key,h.mutableCopy()))}return me.resolve(i)}getAllFromCollectionGroup(e,r,n,s){ot(9500)}ii(e,r){return me.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new HA(this)}getSize(e){return me.resolve(this.size)}}class HA extends MA{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?r.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)})),me.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{constructor(e){this.persistence=e,this.si=new Ao((r=>Sd(r)),Ad),this.lastRemoteSnapshotVersion=ft.min(),this.highestTargetId=0,this.oi=0,this._i=new Rd,this.targetCount=0,this.ai=pc.ur()}forEachTarget(e,r){return this.si.forEach(((n,s)=>r(s))),me.resolve()}getLastRemoteSnapshotVersion(e){return me.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return me.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),me.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),me.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new pc(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,me.resolve()}updateTargetData(e,r){return this.Pr(r),me.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,me.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)})),me.waitFor(i).next((()=>s))}getTargetCount(e){return me.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return me.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),me.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach((a=>{i.push(s.markPotentiallyOrphaned(e,a))})),me.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),me.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return me.resolve(n)}containsKey(e,r){return me.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{constructor(e,r){this.ui={},this.overlays={},this.ci=new ef(0),this.li=!1,this.li=!0,this.hi=new WA,this.referenceDelegate=e(this),this.Pi=new GA(this),this.indexManager=new RA,this.remoteDocumentCache=(function(s){return new zA(s)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new IA(r),this.Ii=new jA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new UA,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new $A(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){He("MemoryPersistence","Starting transaction:",e);const s=new qA(this.ci.next());return this.referenceDelegate.Ei(),n(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,r){return me.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,r))))}}class qA extends yS{constructor(e){super(),this.currentSequenceNumber=e}}class Dd{constructor(e){this.persistence=e,this.Ri=new Rd,this.Vi=null}static mi(e){return new Dd(e)}get fi(){if(this.Vi)return this.Vi;throw ot(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),me.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),me.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),me.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach((s=>this.fi.add(s.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>n.removeTargetData(e,r)))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return me.forEach(this.fi,(n=>{const s=Ke.fromPath(n);return this.gi(e,s).next((i=>{i||r.removeEntry(s,ft.min())}))})).next((()=>(this.Vi=null,r.apply(e))))}updateLimboDocument(e,r){return this.gi(e,r).next((n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())}))}Ti(e){return 0}gi(e,r){return me.or([()=>me.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class gh{constructor(e,r){this.persistence=e,this.pi=new Ao((n=>SS(n.path)),((n,s)=>n.isEqual(s))),this.garbageCollector=LA(this,r)}static mi(e,r){return new gh(e,r)}Ei(){}di(e){return me.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>r.next((s=>n+s))))}wr(e){let r=0;return this.pr(e,(n=>{r++})).next((()=>r))}pr(e,r){return me.forEach(this.pi,((n,s)=>this.br(e,n,s).next((i=>i?me.resolve():r(s)))))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(a=>this.br(e,a,r).next((o=>{o||(n++,i.removeEntry(a,ft.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),me.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),me.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),me.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),me.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Zu(e.data.value)),r}br(e,r,n){return me.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const s=this.pi.get(r);return me.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=s}static As(e,r){let n=bt(),s=bt();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Pd(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KA{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return WE()?8:ES(Vn())>0?6:4})()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.ys(e,r).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,r,s,n).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new XA;return this.Ss(e,r,a).next((o=>{if(i.result=o,this.Vs)return this.bs(e,r,a,o.size)}))})).next((()=>i.result))}bs(e,r,n,s){return n.documentReadCount<this.fs?(Ho()<=At.DEBUG&&He("QueryEngine","SDK will not create cache indexes for query:",Go(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),me.resolve()):(Ho()<=At.DEBUG&&He("QueryEngine","Query:",Go(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(Ho()<=At.DEBUG&&He("QueryEngine","The SDK decides to create cache indexes for query:",Go(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,wi(r))):me.resolve())}ys(e,r){if(qp(r))return me.resolve(null);let n=wi(r);return this.indexManager.getIndexType(e,n).next((s=>s===0?null:(r.limit!==null&&s===1&&(r=U0(r,null,"F"),n=wi(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const a=bt(...i);return this.ps.getDocuments(e,a).next((o=>this.indexManager.getMinOffset(e,n).next((c=>{const l=this.Ds(r,o);return this.Cs(r,l,a,c.readTime)?this.ys(e,U0(r,null,"F")):this.vs(e,l,r,c)}))))})))))}ws(e,r,n,s){return qp(r)||s.isEqual(ft.min())?me.resolve(null):this.ps.getDocuments(e,n).next((i=>{const a=this.Ds(r,i);return this.Cs(r,a,n,s)?me.resolve(null):(Ho()<=At.DEBUG&&He("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Go(r)),this.vs(e,a,r,xS(s,Sl)).next((o=>o)))}))}Ds(e,r){let n=new rn(nw(e));return r.forEach(((s,i)=>{af(e,i)&&(n=n.add(i))})),n}Cs(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,r,n){return Ho()<=At.DEBUG&&He("QueryEngine","Using full collection scan to execute query:",Go(r)),this.ps.getDocumentsMatchingQuery(e,r,Ea.min(),n)}vs(e,r,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next((i=>(r.forEach((a=>{i=i.insert(a.key,a)})),i)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fd="LocalStore",YA=3e8;class QA{constructor(e,r,n,s){this.persistence=e,this.Fs=r,this.serializer=s,this.Ms=new Er(kt),this.xs=new Ao((i=>Sd(i)),Ad),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new VA(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.Ms)))}}function JA(t,e,r,n){return new QA(t,e,r,n)}async function kw(t,e){const r=mt(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next((i=>(s=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n)))).next((i=>{const a=[],o=[];let c=bt();for(const l of s){a.push(l.batchId);for(const h of l.mutations)c=c.add(h.key)}for(const l of i){o.push(l.batchId);for(const h of l.mutations)c=c.add(h.key)}return r.localDocuments.getDocuments(n,c).next((l=>({Ls:l,removedBatchIds:a,addedBatchIds:o})))}))}))}function ZA(t,e){const r=mt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const s=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return(function(o,c,l,h){const d=l.batch,f=d.keys();let g=me.resolve();return f.forEach((w=>{g=g.next((()=>h.getEntry(c,w))).next((x=>{const y=l.docVersions.get(w);Xt(y!==null,48541),x.version.compareTo(y)<0&&(d.applyToRemoteDocument(x,l),x.isValidDocument()&&(x.setReadTime(l.commitVersion),h.addEntry(x)))}))})),g.next((()=>o.mutationQueue.removeMutationBatch(c,d)))})(r,n,e,i).next((()=>i.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(o){let c=bt();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(c=c.add(o.batch.mutations[l].key));return c})(e)))).next((()=>r.localDocuments.getDocuments(n,s)))}))}function bw(t){const e=mt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.Pi.getLastRemoteSnapshotVersion(r)))}function ek(t,e){const r=mt(t),n=e.snapshotVersion;let s=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});s=r.Ms;const o=[];e.targetChanges.forEach(((h,d)=>{const f=s.get(d);if(!f)return;o.push(r.Pi.removeMatchingKeys(i,h.removedDocuments,d).next((()=>r.Pi.addMatchingKeys(i,h.addedDocuments,d))));let g=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?g=g.withResumeToken(dn.EMPTY_BYTE_STRING,ft.min()).withLastLimboFreeSnapshotVersion(ft.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,n)),s=s.insert(d,g),(function(x,y,A){return x.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=YA?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0})(f,g,h)&&o.push(r.Pi.updateTargetData(i,g))}));let c=Gi(),l=bt();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(i,h))})),o.push(tk(i,a,e.documentUpdates).next((h=>{c=h.ks,l=h.qs}))),!n.isEqual(ft.min())){const h=r.Pi.getLastRemoteSnapshotVersion(i).next((d=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n)));o.push(h)}return me.waitFor(o).next((()=>a.apply(i))).next((()=>r.localDocuments.getLocalViewOfDocuments(i,c,l))).next((()=>c))})).then((i=>(r.Ms=s,i)))}function tk(t,e,r){let n=bt(),s=bt();return r.forEach((i=>n=n.add(i))),e.getEntries(t,n).next((i=>{let a=Gi();return r.forEach(((o,c)=>{const l=i.get(o);c.isFoundDocument()!==l.isFoundDocument()&&(s=s.add(o)),c.isNoDocument()&&c.version.isEqual(ft.min())?(e.removeEntry(o,c.readTime),a=a.insert(o,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),a=a.insert(o,c)):He(Fd,"Ignoring outdated watch update for ",o,". Current version:",l.version," Watch version:",c.version)})),{ks:a,qs:s}}))}function rk(t,e){const r=mt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=yd),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function nk(t,e){const r=mt(t);return r.persistence.runTransaction("Allocate target","readwrite",(n=>{let s;return r.Pi.getTargetData(n,e).next((i=>i?(s=i,me.resolve(s)):r.Pi.allocateTargetId(n).next((a=>(s=new ha(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,s).next((()=>s)))))))})).then((n=>{const s=r.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n}))}async function G0(t,e,r){const n=mt(t),s=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,(a=>n.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!bc(a))throw a;He(Fd,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function ag(t,e,r){const n=mt(t);let s=ft.min(),i=bt();return n.persistence.runTransaction("Execute query","readwrite",(a=>(function(c,l,h){const d=mt(c),f=d.xs.get(h);return f!==void 0?me.resolve(d.Ms.get(f)):d.Pi.getTargetData(l,h)})(n,a,wi(e)).next((o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,o.targetId).next((c=>{i=c}))})).next((()=>n.Fs.getDocumentsMatchingQuery(a,e,r?s:ft.min(),r?i:bt()))).next((o=>(sk(n,$S(e),o),{documents:o,Qs:i})))))}function sk(t,e,r){let n=t.Os.get(e)||ft.min();r.forEach(((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)})),t.Os.set(e,n)}class og{constructor(){this.activeTargetIds=KS()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ik{constructor(){this.Mo=new og,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new og,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cg="ConnectivityMonitor";class lg{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){He(cg,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){He(cg,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mu=null;function q0(){return Mu===null?Mu=(function(){return 268435456+Math.round(2147483648*Math.random())})():Mu++,"0x"+Mu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s0="RestConnection",ok={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ck{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===uh?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,r,n,s,i){const a=q0(),o=this.zo(e,r.toUriEncodedString());He(s0,`Sending RPC '${e}' ${a}:`,o,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,s,i);const{host:l}=new URL(o),h=Tc(l);return this.Jo(e,o,c,n,h).then((d=>(He(s0,`Received RPC '${e}' ${a}: `,d),d)),(d=>{throw po(s0,`RPC '${e}' ${a} failed with error: `,d,"url: ",o,"request:",n),d}))}Ho(e,r,n,s,i,a){return this.Go(e,r,n,s,i)}jo(e,r,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ac})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((s,i)=>e[i]=s)),n&&n.headers.forEach(((s,i)=>e[i]=s))}zo(e,r){const n=ok[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kn="WebChannelConnection";class uk extends ck{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,s,i){const a=q0();return new Promise(((o,c)=>{const l=new Ix;l.setWithCredentials(!0),l.listenOnce(Cx.COMPLETE,(()=>{try{switch(l.getLastErrorCode()){case Ju.NO_ERROR:const d=l.getResponseJson();He(kn,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(d)),o(d);break;case Ju.TIMEOUT:He(kn,`RPC '${e}' ${a} timed out`),c(new Ve(fe.DEADLINE_EXCEEDED,"Request time out"));break;case Ju.HTTP_ERROR:const f=l.getStatus();if(He(kn,`RPC '${e}' ${a} failed with status:`,f,"response text:",l.getResponseText()),f>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const w=g?.error;if(w&&w.status&&w.message){const x=(function(A){const F=A.toLowerCase().replace(/_/g,"-");return Object.values(fe).indexOf(F)>=0?F:fe.UNKNOWN})(w.status);c(new Ve(x,w.message))}else c(new Ve(fe.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new Ve(fe.UNAVAILABLE,"Connection failed."));break;default:ot(9055,{l_:e,streamId:a,h_:l.getLastErrorCode(),P_:l.getLastError()})}}finally{He(kn,`RPC '${e}' ${a} completed.`)}}));const h=JSON.stringify(s);He(kn,`RPC '${e}' ${a} sending request:`,s),l.send(r,"POST",h,n,15)}))}T_(e,r,n){const s=q0(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Px(),o=Dx(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const h=i.join("");He(kn,`Creating RPC '${e}' stream ${s}: ${h}`,c);const d=a.createWebChannel(h,c);this.I_(d);let f=!1,g=!1;const w=new lk({Yo:y=>{g?He(kn,`Not sending because RPC '${e}' stream ${s} is closed:`,y):(f||(He(kn,`Opening RPC '${e}' stream ${s} transport.`),d.open(),f=!0),He(kn,`RPC '${e}' stream ${s} sending:`,y),d.send(y))},Zo:()=>d.close()}),x=(y,A,F)=>{y.listen(A,(I=>{try{F(I)}catch(W){setTimeout((()=>{throw W}),0)}}))};return x(d,tl.EventType.OPEN,(()=>{g||(He(kn,`RPC '${e}' stream ${s} transport opened.`),w.o_())})),x(d,tl.EventType.CLOSE,(()=>{g||(g=!0,He(kn,`RPC '${e}' stream ${s} transport closed`),w.a_(),this.E_(d))})),x(d,tl.EventType.ERROR,(y=>{g||(g=!0,po(kn,`RPC '${e}' stream ${s} transport errored. Name:`,y.name,"Message:",y.message),w.a_(new Ve(fe.UNAVAILABLE,"The operation could not be completed")))})),x(d,tl.EventType.MESSAGE,(y=>{if(!g){const A=y.data[0];Xt(!!A,16349);const F=A,I=F?.error||F[0]?.error;if(I){He(kn,`RPC '${e}' stream ${s} received error:`,I);const W=I.status;let U=(function(k){const S=zr[k];if(S!==void 0)return mw(S)})(W),z=I.message;U===void 0&&(U=fe.INTERNAL,z="Unknown error status: "+W+" with message "+I.message),g=!0,w.a_(new Ve(U,z)),d.close()}else He(kn,`RPC '${e}' stream ${s} received:`,A),w.u_(A)}})),x(o,Rx.STAT_EVENT,(y=>{y.stat===N0.PROXY?He(kn,`RPC '${e}' stream ${s} detected buffering proxy`):y.stat===N0.NOPROXY&&He(kn,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{w.__()}),0),w}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((r=>r===e))}}function i0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hf(t){return new mA(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e,r,n=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-n);s>0&&He("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ug="PersistentStream";class Cw{constructor(e,r,n,s,i,a,o,c){this.Mi=e,this.S_=n,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Iw(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===fe.RESOURCE_EXHAUSTED?(Hi(r.toString()),Hi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===fe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,s])=>{this.D_===r&&this.G_(n,s)}),(n=>{e((()=>{const s=new Ve(fe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)}))}))}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{n((()=>this.z_(s)))})),this.stream.onMessage((s=>{n((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return He(ug,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget((()=>this.D_===e?r():(He(ug,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class hk extends Cw{constructor(e,r,n,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=xA(this.serializer,e),n=(function(i){if(!("targetChange"in i))return ft.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?ft.min():a.readTime?vi(a.readTime):ft.min()})(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=H0(this.serializer),r.addTarget=(function(i,a){let o;const c=a.target;if(o=V0(c)?{documents:_A(i,c)}:{query:yA(i,c).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=xw(i,a.resumeToken);const l=W0(i,a.expectedCount);l!==null&&(o.expectedCount=l)}else if(a.snapshotVersion.compareTo(ft.min())>0){o.readTime=ph(i,a.snapshotVersion.toTimestamp());const l=W0(i,a.expectedCount);l!==null&&(o.expectedCount=l)}return o})(this.serializer,e);const n=TA(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=H0(this.serializer),r.removeTarget=e,this.q_(r)}}class fk extends Cw{constructor(e,r,n,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Xt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Xt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Xt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=vA(e.writeResults,e.commitTime),n=vi(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=H0(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>wA(this.serializer,n)))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{}class mk extends dk{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Ve(fe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,$0(r,n),s,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ve(fe.UNKNOWN,i.toString())}))}Ho(e,r,n,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,$0(r,n),s,a,o,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ve(fe.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class pk{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Hi(r),this.aa=!1):He("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const go="RemoteStore";class gk{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{n.enqueueAndForget((async()=>{ko(this)&&(He(go,"Restarting streams for network reachability change."),await(async function(c){const l=mt(c);l.Ea.add(4),await Yl(l),l.Ra.set("Unknown"),l.Ea.delete(4),await ff(l)})(this))}))})),this.Ra=new pk(n,s)}}async function ff(t){if(ko(t))for(const e of t.da)await e(!0)}async function Yl(t){for(const e of t.da)await e(!1)}function Rw(t,e){const r=mt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Md(r)?Ld(r):Cc(r).O_()&&Od(r,e))}function Nd(t,e){const r=mt(t),n=Cc(r);r.Ia.delete(e),n.O_()&&Dw(r,e),r.Ia.size===0&&(n.O_()?n.L_():ko(r)&&r.Ra.set("Unknown"))}function Od(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ft.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Cc(t).Y_(e)}function Dw(t,e){t.Va.Ue(e),Cc(t).Z_(e)}function Ld(t){t.Va=new uA({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Cc(t).start(),t.Ra.ua()}function Md(t){return ko(t)&&!Cc(t).x_()&&t.Ia.size>0}function ko(t){return mt(t).Ea.size===0}function Pw(t){t.Va=void 0}async function xk(t){t.Ra.set("Online")}async function wk(t){t.Ia.forEach(((e,r)=>{Od(t,e)}))}async function vk(t,e){Pw(t),Md(t)?(t.Ra.ha(e),Ld(t)):t.Ra.set("Unknown")}async function _k(t,e,r){if(t.Ra.set("Online"),e instanceof gw&&e.state===2&&e.cause)try{await(async function(s,i){const a=i.cause;for(const o of i.targetIds)s.Ia.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.Ia.delete(o),s.Va.removeTarget(o))})(t,e)}catch(n){He(go,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await xh(t,n)}else if(e instanceof rh?t.Va.Ze(e):e instanceof pw?t.Va.st(e):t.Va.tt(e),!r.isEqual(ft.min()))try{const n=await bw(t.localStore);r.compareTo(n)>=0&&await(function(i,a){const o=i.Va.Tt(a);return o.targetChanges.forEach(((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const h=i.Ia.get(l);h&&i.Ia.set(l,h.withResumeToken(c.resumeToken,a))}})),o.targetMismatches.forEach(((c,l)=>{const h=i.Ia.get(c);if(!h)return;i.Ia.set(c,h.withResumeToken(dn.EMPTY_BYTE_STRING,h.snapshotVersion)),Dw(i,c);const d=new ha(h.target,c,l,h.sequenceNumber);Od(i,d)})),i.remoteSyncer.applyRemoteEvent(o)})(t,r)}catch(n){He(go,"Failed to raise snapshot:",n),await xh(t,n)}}async function xh(t,e,r){if(!bc(e))throw e;t.Ea.add(1),await Yl(t),t.Ra.set("Offline"),r||(r=()=>bw(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{He(go,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await ff(t)}))}function Fw(t,e){return e().catch((r=>xh(t,r,e)))}async function df(t){const e=mt(t),r=ka(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:yd;for(;yk(e);)try{const s=await rk(e.localStore,n);if(s===null){e.Ta.length===0&&r.L_();break}n=s.batchId,Ek(e,s)}catch(s){await xh(e,s)}Nw(e)&&Ow(e)}function yk(t){return ko(t)&&t.Ta.length<10}function Ek(t,e){t.Ta.push(e);const r=ka(t);r.O_()&&r.X_&&r.ea(e.mutations)}function Nw(t){return ko(t)&&!ka(t).x_()&&t.Ta.length>0}function Ow(t){ka(t).start()}async function Tk(t){ka(t).ra()}async function Sk(t){const e=ka(t);for(const r of t.Ta)e.ea(r.mutations)}async function Ak(t,e,r){const n=t.Ta.shift(),s=bd.from(n,e,r);await Fw(t,(()=>t.remoteSyncer.applySuccessfulWrite(s))),await df(t)}async function kk(t,e){e&&ka(t).X_&&await(async function(n,s){if((function(a){return oA(a)&&a!==fe.ABORTED})(s.code)){const i=n.Ta.shift();ka(n).B_(),await Fw(n,(()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s))),await df(n)}})(t,e),Nw(t)&&Ow(t)}async function hg(t,e){const r=mt(t);r.asyncQueue.verifyOperationInProgress(),He(go,"RemoteStore received new credentials");const n=ko(r);r.Ea.add(3),await Yl(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await ff(r)}async function bk(t,e){const r=mt(t);e?(r.Ea.delete(2),await ff(r)):e||(r.Ea.add(2),await Yl(r),r.Ra.set("Unknown"))}function Cc(t){return t.ma||(t.ma=(function(r,n,s){const i=mt(r);return i.sa(),new hk(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(t.datastore,t.asyncQueue,{Xo:xk.bind(null,t),t_:wk.bind(null,t),r_:vk.bind(null,t),H_:_k.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),Md(t)?Ld(t):t.Ra.set("Unknown")):(await t.ma.stop(),Pw(t))}))),t.ma}function ka(t){return t.fa||(t.fa=(function(r,n,s){const i=mt(r);return i.sa(),new fk(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:Tk.bind(null,t),r_:kk.bind(null,t),ta:Sk.bind(null,t),na:Ak.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await df(t)):(await t.fa.stop(),t.Ta.length>0&&(He(go,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new Mi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const a=Date.now()+n,o=new Bd(e,r,a,s,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ve(fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Vd(t,e){if(Hi("AsyncQueue",`${e}: ${t}`),bc(t))return new Ve(fe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{static emptySet(e){return new ec(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Ke.comparator(r.key,n.key):(r,n)=>Ke.comparator(r.key,n.key),this.keyedMap=rl(),this.sortedSet=new Er(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((r,n)=>(e(r),!1)))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof ec)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((r=>{e.push(r.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new ec;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fg{constructor(){this.ga=new Er(Ke.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):ot(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal(((r,n)=>{e.push(n)})),e}}class gc{constructor(e,r,n,s,i,a,o,c,l){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,r,n,s,i){const a=[];return r.forEach((o=>{a.push({type:0,doc:o})})),new gc(e,r,ec.emptySet(r),a,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&sf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Ck{constructor(){this.queries=dg(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const s=mt(r),i=s.queries;s.queries=dg(),i.forEach(((a,o)=>{for(const c of o.Sa)c.onError(n)}))})(this,new Ve(fe.ABORTED,"Firestore shutting down"))}}function dg(){return new Ao((t=>rw(t)),sf)}async function jd(t,e){const r=mt(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.ba()&&e.Da()&&(n=2):(i=new Ik,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(s,!0);break;case 1:i.wa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(a){const o=Vd(a,`Initialization of query '${Go(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&Wd(r)}async function Ud(t,e){const r=mt(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function Rk(t,e){const r=mt(t);let n=!1;for(const s of e){const i=s.query,a=r.queries.get(i);if(a){for(const o of a.Sa)o.Fa(s)&&(n=!0);a.wa=s}}n&&Wd(r)}function Dk(t,e,r){const n=mt(t),s=n.queries.get(e);if(s)for(const i of s.Sa)i.onError(r);n.queries.delete(e)}function Wd(t){t.Ca.forEach((e=>{e.next()}))}var X0,mg;(mg=X0||(X0={})).Ma="default",mg.Cache="cache";class $d{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new gc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=gc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==X0.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{constructor(e){this.key=e}}class Mw{constructor(e){this.key=e}}class Pk{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=bt(),this.mutatedKeys=bt(),this.eu=nw(e),this.tu=new ec(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new fg,s=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,a=s,o=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,l=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((h,d)=>{const f=s.get(h),g=af(this.query,d)?d:null,w=!!f&&this.mutatedKeys.has(f.key),x=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let y=!1;f&&g?f.data.isEqual(g.data)?w!==x&&(n.track({type:3,doc:g}),y=!0):this.su(f,g)||(n.track({type:2,doc:g}),y=!0,(c&&this.eu(g,c)>0||l&&this.eu(g,l)<0)&&(o=!0)):!f&&g?(n.track({type:0,doc:g}),y=!0):f&&!g&&(n.track({type:1,doc:f}),y=!0,(c||l)&&(o=!0)),y&&(g?(a=a.add(g),i=x?i.add(h):i.delete(h)):(a=a.delete(h),i=i.delete(h)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),i=i.delete(h.key),n.track({type:1,doc:h})}return{tu:a,iu:n,Cs:o,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((h,d)=>(function(g,w){const x=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ot(20277,{Rt:y})}};return x(g)-x(w)})(h.type,d.type)||this.eu(h.doc,d.doc))),this.ou(n),s=s??!1;const o=r&&!s?this._u():[],c=this.Xa.size===0&&this.current&&!s?1:0,l=c!==this.Za;return this.Za=c,a.length!==0||l?{snapshot:new gc(this.query,e.tu,i,a,e.mutatedKeys,c===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new fg,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((r=>this.Ya=this.Ya.add(r))),e.modifiedDocuments.forEach((r=>{})),e.removedDocuments.forEach((r=>this.Ya=this.Ya.delete(r))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=bt(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const r=[];return e.forEach((n=>{this.Xa.has(n)||r.push(new Mw(n))})),this.Xa.forEach((n=>{e.has(n)||r.push(new Lw(n))})),r}cu(e){this.Ya=e.Qs,this.Xa=bt();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return gc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const zd="SyncEngine";class Fk{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class Nk{constructor(e){this.key=e,this.hu=!1}}class Ok{constructor(e,r,n,s,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Ao((o=>rw(o)),sf),this.Iu=new Map,this.Eu=new Set,this.du=new Er(Ke.comparator),this.Au=new Map,this.Ru=new Rd,this.Vu={},this.mu=new Map,this.fu=pc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Lk(t,e,r=!0){const n=$w(t);let s;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await Bw(n,e,r,!0),s}async function Mk(t,e){const r=$w(t);await Bw(r,e,!0,!1)}async function Bw(t,e,r,n){const s=await nk(t.localStore,wi(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let o;return n&&(o=await Bk(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&r&&Rw(t.remoteStore,s),o}async function Bk(t,e,r,n,s){t.pu=(d,f,g)=>(async function(x,y,A,F){let I=y.view.ru(A);I.Cs&&(I=await ag(x.localStore,y.query,!1).then((({documents:T})=>y.view.ru(T,I))));const W=F&&F.targetChanges.get(y.targetId),U=F&&F.targetMismatches.get(y.targetId)!=null,z=y.view.applyChanges(I,x.isPrimaryClient,W,U);return gg(x,y.targetId,z.au),z.snapshot})(t,d,f,g);const i=await ag(t.localStore,e,!0),a=new Pk(e,i.Qs),o=a.ru(i.documents),c=Kl.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),l=a.applyChanges(o,t.isPrimaryClient,c);gg(t,r,l.au);const h=new Fk(e,r,a);return t.Tu.set(e,h),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),l.snapshot}async function Vk(t,e,r){const n=mt(t),s=n.Tu.get(e),i=n.Iu.get(s.targetId);if(i.length>1)return n.Iu.set(s.targetId,i.filter((a=>!sf(a,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await G0(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),r&&Nd(n.remoteStore,s.targetId),K0(n,s.targetId)})).catch(kc)):(K0(n,s.targetId),await G0(n.localStore,s.targetId,!0))}async function jk(t,e){const r=mt(t),n=r.Tu.get(e),s=r.Iu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Nd(r.remoteStore,n.targetId))}async function Uk(t,e,r){const n=Xk(t);try{const s=await(function(a,o){const c=mt(a),l=or.now(),h=o.reduce(((g,w)=>g.add(w.key)),bt());let d,f;return c.persistence.runTransaction("Locally write mutations","readwrite",(g=>{let w=Gi(),x=bt();return c.Ns.getEntries(g,h).next((y=>{w=y,w.forEach(((A,F)=>{F.isValidDocument()||(x=x.add(A))}))})).next((()=>c.localDocuments.getOverlayedDocuments(g,w))).next((y=>{d=y;const A=[];for(const F of o){const I=rA(F,d.get(F.key).overlayedDocument);I!=null&&A.push(new Na(F.key,I,Xx(I.value.mapValue),qn.exists(!0)))}return c.mutationQueue.addMutationBatch(g,l,A,o)})).next((y=>{f=y;const A=y.applyToLocalDocumentSet(d,x);return c.documentOverlayCache.saveOverlays(g,y.batchId,A)}))})).then((()=>({batchId:f.batchId,changes:iw(d)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),(function(a,o,c){let l=a.Vu[a.currentUser.toKey()];l||(l=new Er(kt)),l=l.insert(o,c),a.Vu[a.currentUser.toKey()]=l})(n,s.batchId,r),await Ql(n,s.changes),await df(n.remoteStore)}catch(s){const i=Vd(s,"Failed to persist write");r.reject(i)}}async function Vw(t,e){const r=mt(t);try{const n=await ek(r.localStore,e);e.targetChanges.forEach(((s,i)=>{const a=r.Au.get(i);a&&(Xt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?Xt(a.hu,14607):s.removedDocuments.size>0&&(Xt(a.hu,42227),a.hu=!1))})),await Ql(r,n,e)}catch(n){await kc(n)}}function pg(t,e,r){const n=mt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Tu.forEach(((i,a)=>{const o=a.view.va(e);o.snapshot&&s.push(o.snapshot)})),(function(a,o){const c=mt(a);c.onlineState=o;let l=!1;c.queries.forEach(((h,d)=>{for(const f of d.Sa)f.va(o)&&(l=!0)})),l&&Wd(c)})(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Wk(t,e,r){const n=mt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Au.get(e),i=s&&s.key;if(i){let a=new Er(Ke.comparator);a=a.insert(i,Nn.newNoDocument(i,ft.min()));const o=bt().add(i),c=new uf(ft.min(),new Map,new Er(kt),a,o);await Vw(n,c),n.du=n.du.remove(i),n.Au.delete(e),Hd(n)}else await G0(n.localStore,e,!1).then((()=>K0(n,e,r))).catch(kc)}async function $k(t,e){const r=mt(t),n=e.batch.batchId;try{const s=await ZA(r.localStore,e);Uw(r,n,null),jw(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Ql(r,s)}catch(s){await kc(s)}}async function zk(t,e,r){const n=mt(t);try{const s=await(function(a,o){const c=mt(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",(l=>{let h;return c.mutationQueue.lookupMutationBatch(l,o).next((d=>(Xt(d!==null,37113),h=d.keys(),c.mutationQueue.removeMutationBatch(l,d)))).next((()=>c.mutationQueue.performConsistencyCheck(l))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(l,h,o))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h))).next((()=>c.localDocuments.getDocuments(l,h)))}))})(n.localStore,e);Uw(n,e,r),jw(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Ql(n,s)}catch(s){await kc(s)}}function jw(t,e){(t.mu.get(e)||[]).forEach((r=>{r.resolve()})),t.mu.delete(e)}function Uw(t,e,r){const n=mt(t);let s=n.Vu[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function K0(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((n=>{t.Ru.containsKey(n)||Ww(t,n)}))}function Ww(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Nd(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),Hd(t))}function gg(t,e,r){for(const n of r)n instanceof Lw?(t.Ru.addReference(n.key,e),Hk(t,n)):n instanceof Mw?(He(zd,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||Ww(t,n.key)):ot(19791,{wu:n})}function Hk(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(He(zd,"New document in limbo: "+r),t.Eu.add(n),Hd(t))}function Hd(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Ke(ar.fromString(e)),n=t.fu.next();t.Au.set(n,new Nk(r)),t.du=t.du.insert(r,n),Rw(t.remoteStore,new ha(wi(nf(r.path)),n,"TargetPurposeLimboResolution",ef.ce))}}async function Ql(t,e,r){const n=mt(t),s=[],i=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach(((o,c)=>{a.push(n.pu(c,e,r).then((l=>{if((l||r)&&n.isPrimaryClient){const h=l?!l.fromCache:r?.targetChanges.get(c.targetId)?.current;n.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(l){s.push(l);const h=Pd.As(c.targetId,l);i.push(h)}})))})),await Promise.all(a),n.Pu.H_(s),await(async function(c,l){const h=mt(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(d=>me.forEach(l,(f=>me.forEach(f.Es,(g=>h.persistence.referenceDelegate.addReference(d,f.targetId,g))).next((()=>me.forEach(f.ds,(g=>h.persistence.referenceDelegate.removeReference(d,f.targetId,g)))))))))}catch(d){if(!bc(d))throw d;He(Fd,"Failed to update sequence numbers: "+d)}for(const d of l){const f=d.targetId;if(!d.fromCache){const g=h.Ms.get(f),w=g.snapshotVersion,x=g.withLastLimboFreeSnapshotVersion(w);h.Ms=h.Ms.insert(f,x)}}})(n.localStore,i))}async function Gk(t,e){const r=mt(t);if(!r.currentUser.isEqual(e)){He(zd,"User change. New user:",e.toKey());const n=await kw(r.localStore,e);r.currentUser=e,(function(i,a){i.mu.forEach((o=>{o.forEach((c=>{c.reject(new Ve(fe.CANCELLED,a))}))})),i.mu.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Ql(r,n.Ls)}}function qk(t,e){const r=mt(t),n=r.Au.get(e);if(n&&n.hu)return bt().add(n.key);{let s=bt();const i=r.Iu.get(e);if(!i)return s;for(const a of i){const o=r.Tu.get(a);s=s.unionWith(o.view.nu)}return s}}function $w(t){const e=mt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Vw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qk.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Wk.bind(null,e),e.Pu.H_=Rk.bind(null,e.eventManager),e.Pu.yu=Dk.bind(null,e.eventManager),e}function Xk(t){const e=mt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$k.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zk.bind(null,e),e}class wh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return JA(this.persistence,new KA,e.initialUser,this.serializer)}Cu(e){return new Aw(Dd.mi,this.serializer)}Du(e){return new ik}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}wh.provider={build:()=>new wh};class Kk extends wh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Xt(this.persistence.referenceDelegate instanceof gh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new NA(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?ns.withCacheSize(this.cacheSizeBytes):ns.DEFAULT;return new Aw((n=>gh.mi(n,r)),this.serializer)}}class Y0{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>pg(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Gk.bind(null,this.syncEngine),await bk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Ck})()}createDatastore(e){const r=hf(e.databaseInfo.databaseId),n=(function(i){return new uk(i)})(e.databaseInfo);return(function(i,a,o,c){return new mk(i,a,o,c)})(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,s,i,a,o){return new gk(n,s,i,a,o)})(this.localStore,this.datastore,e.asyncQueue,(r=>pg(this.syncEngine,r,0)),(function(){return lg.v()?new lg:new ak})())}createSyncEngine(e,r){return(function(s,i,a,o,c,l,h){const d=new Ok(s,i,a,o,c,l);return h&&(d.gu=!0),d})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){const n=mt(r);He(go,"RemoteStore shutting down."),n.Ea.add(5),await Yl(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Y0.provider={build:()=>new Y0};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Hi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout((()=>{this.muted||e(r)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba="FirestoreClient";class Yk{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Dn.UNAUTHENTICATED,this.clientId=Jh.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async a=>{He(ba,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(n,(a=>(He(ba,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Mi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Vd(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function a0(t,e){t.asyncQueue.verifyOperationInProgress(),He(ba,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener((async s=>{n.isEqual(s)||(await kw(e.localStore,s),n=s)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function xg(t,e){t.asyncQueue.verifyOperationInProgress();const r=await Qk(t);He(ba,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener((n=>hg(e.remoteStore,n))),t.setAppCheckTokenChangeListener(((n,s)=>hg(e.remoteStore,s))),t._onlineComponents=e}async function Qk(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){He(ba,"Using user provided OfflineComponentProvider");try{await a0(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!(function(s){return s.name==="FirebaseError"?s.code===fe.FAILED_PRECONDITION||s.code===fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(r))throw r;po("Error using user provided cache. Falling back to memory cache: "+r),await a0(t,new wh)}}else He(ba,"Using default OfflineComponentProvider"),await a0(t,new Kk(void 0));return t._offlineComponents}async function zw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(He(ba,"Using user provided OnlineComponentProvider"),await xg(t,t._uninitializedComponentsProvider._online)):(He(ba,"Using default OnlineComponentProvider"),await xg(t,new Y0))),t._onlineComponents}function Jk(t){return zw(t).then((e=>e.syncEngine))}async function vh(t){const e=await zw(t),r=e.eventManager;return r.onListen=Lk.bind(null,e.syncEngine),r.onUnlisten=Vk.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=Mk.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=jk.bind(null,e.syncEngine),r}function Zk(t,e,r={}){const n=new Mi;return t.asyncQueue.enqueueAndForget((async()=>(function(i,a,o,c,l){const h=new Gd({next:f=>{h.Nu(),a.enqueueAndForget((()=>Ud(i,d)));const g=f.docs.has(o);!g&&f.fromCache?l.reject(new Ve(fe.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&f.fromCache&&c&&c.source==="server"?l.reject(new Ve(fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(f)},error:f=>l.reject(f)}),d=new $d(nf(o.path),h,{includeMetadataChanges:!0,qa:!0});return jd(i,d)})(await vh(t),t.asyncQueue,e,r,n))),n.promise}function eb(t,e,r={}){const n=new Mi;return t.asyncQueue.enqueueAndForget((async()=>(function(i,a,o,c,l){const h=new Gd({next:f=>{h.Nu(),a.enqueueAndForget((()=>Ud(i,d))),f.fromCache&&c.source==="server"?l.reject(new Ve(fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(f)},error:f=>l.reject(f)}),d=new $d(o,h,{includeMetadataChanges:!0,qa:!0});return jd(i,d)})(await vh(t),t.asyncQueue,e,r,n))),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wg=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gw="firestore.googleapis.com",vg=!0;class _g{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ve(fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Gw,this.ssl=vg}else this.host=e.host,this.ssl=e.ssl??vg;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Sw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<PA)throw new Ve(fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Mx("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Hw(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ve(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ve(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ve(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,s){return n.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class mf{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _g({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ve(fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ve(fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _g(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new Ox;switch(n.type){case"firstParty":return new hS(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ve(fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=wg.get(r);n&&(He("ComponentProvider","Removing Datastore"),wg.delete(r),n.terminate())})(this),Promise.resolve()}}function qw(t,e,r,n={}){t=Mn(t,mf);const s=Tc(e),i=t._getSettings(),a={...i,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;s&&(vx(`https://${o}`),_x("Firestore",!0)),i.host!==Gw&&i.host!==o&&po("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...i,host:o,ssl:s,emulatorOptions:n};if(!ho(c,a)&&(t._setSettings(c),n.mockUserToken)){let l,h;if(typeof n.mockUserToken=="string")l=n.mockUserToken,h=Dn.MOCK_USER;else{l=FE(n.mockUserToken,t._app?.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new Ve(fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Dn(d)}t._authCredentials=new cS(new Nx(l,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Yi(this.firestore,e,this._query)}}class vr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vr(this.firestore,e,this._key)}toJSON(){return{type:vr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(ql(r,vr._jsonSchema))return new vr(e,n||null,new Ke(ar.fromString(r.referencePath)))}}vr._jsonSchemaVersion="firestore/documentReference/1.0",vr._jsonSchema={type:Xr("string",vr._jsonSchemaVersion),referencePath:Xr("string")};class Bi extends Yi{constructor(e,r,n){super(e,r,nf(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vr(this.firestore,null,new Ke(e))}withConverter(e){return new Bi(this.firestore,e,this._path)}}function We(t,e,...r){if(t=Br(t),Lx("collection","path",e),t instanceof mf){const n=ar.fromString(e,...r);return Fp(n),new Bi(t,null,n)}{if(!(t instanceof vr||t instanceof Bi))throw new Ve(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ar.fromString(e,...r));return Fp(n),new Bi(t.firestore,null,n)}}function ht(t,e,...r){if(t=Br(t),arguments.length===1&&(e=Jh.newId()),Lx("doc","path",e),t instanceof mf){const n=ar.fromString(e,...r);return Pp(n),new vr(t,null,new Ke(n))}{if(!(t instanceof vr||t instanceof Bi))throw new Ve(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ar.fromString(e,...r));return Pp(n),new vr(t.firestore,t instanceof Bi?t.converter:null,new Ke(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yg="AsyncQueue";class Eg{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Iw(this,"async_queue_retry"),this._c=()=>{const n=i0();n&&He(yg,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=i0();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=i0();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new Mi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!bc(e))throw e;He(yg,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,Hi("INTERNAL UNHANDLED ERROR: ",Tg(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const s=Bd.createAndSchedule(this,e,r,n,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&ot(47125,{Pc:Tg(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function Tg(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sg(t){return(function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1})(t,["next","error","complete"])}class ii extends mf{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new Eg,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Eg(e),this._firestoreClient=void 0,await e}}}function Xw(t,e){const r=typeof t=="object"?t:Sx(),n=typeof t=="string"?t:uh,s=vd(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=DE("firestore");i&&qw(s,...i)}return s}function Rc(t){if(t._terminated)throw new Ve(fe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||tb(t),t._firestoreClient}function tb(t){const e=t._freezeSettings(),r=(function(s,i,a,o){return new bS(s,i,a,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,Hw(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new Yk(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&(function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}})(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ms(dn.fromBase64String(e))}catch(r){throw new Ve(fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new ms(dn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ms._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ql(e,ms._jsonSchema))return ms.fromBase64String(e.bytes)}}ms._jsonSchemaVersion="firestore/bytes/1.0",ms._jsonSchema={type:Xr("string",ms._jsonSchemaVersion),bytes:Xr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ve(fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new un(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ve(fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ve(fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return kt(this._lat,e._lat)||kt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ei._jsonSchemaVersion}}static fromJSON(e){if(ql(e,ei._jsonSchema))return new ei(e.latitude,e.longitude)}}ei._jsonSchemaVersion="firestore/geoPoint/1.0",ei._jsonSchema={type:Xr("string",ei._jsonSchemaVersion),latitude:Xr("number"),longitude:Xr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ti._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ql(e,ti._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new ti(e.vectorValues);throw new Ve(fe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ti._jsonSchemaVersion="firestore/vectorValue/1.0",ti._jsonSchema={type:Xr("string",ti._jsonSchemaVersion),vectorValues:Xr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rb=/^__.*__$/;class nb{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Na(e,this.data,this.fieldMask,r,this.fieldTransforms):new Xl(e,this.data,r,this.fieldTransforms)}}class Kw{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Na(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Yw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ot(40011,{Ac:t})}}class qd{constructor(e,r,n,s,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new qd({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return _h(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((r=>e.isPrefixOf(r)))!==void 0||this.fieldTransforms.find((r=>e.isPrefixOf(r.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Yw(this.Ac)&&rb.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class sb{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||hf(e)}Cc(e,r,n,s=!1){return new qd({Ac:e,methodName:r,Dc:n,path:un.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Jl(t){const e=t._freezeSettings(),r=hf(t._databaseId);return new sb(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Xd(t,e,r,n,s,i={}){const a=t.Cc(i.merge||i.mergeFields?2:0,e,r,s);Kd("Data must be an object, but it was:",a,n);const o=Zw(n,a);let c,l;if(i.merge)c=new xs(a.fieldMask),l=a.fieldTransforms;else if(i.mergeFields){const h=[];for(const d of i.mergeFields){const f=Q0(e,d,r);if(!a.contains(f))throw new Ve(fe.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);tv(h,f)||h.push(f)}c=new xs(h),l=a.fieldTransforms.filter((d=>c.covers(d.field)))}else c=null,l=a.fieldTransforms;return new nb(new ss(o),c,l)}class gf extends pf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gf}}function Qw(t,e,r,n){const s=t.Cc(1,e,r);Kd("Data must be an object, but it was:",s,n);const i=[],a=ss.empty();Fa(n,((c,l)=>{const h=Yd(e,c,r);l=Br(l);const d=s.yc(h);if(l instanceof gf)i.push(h);else{const f=Zl(l,d);f!=null&&(i.push(h),a.set(h,f))}}));const o=new xs(i);return new Kw(a,o,s.fieldTransforms)}function Jw(t,e,r,n,s,i){const a=t.Cc(1,e,r),o=[Q0(e,n,r)],c=[s];if(i.length%2!=0)throw new Ve(fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)o.push(Q0(e,i[f])),c.push(i[f+1]);const l=[],h=ss.empty();for(let f=o.length-1;f>=0;--f)if(!tv(l,o[f])){const g=o[f];let w=c[f];w=Br(w);const x=a.yc(g);if(w instanceof gf)l.push(g);else{const y=Zl(w,x);y!=null&&(l.push(g),h.set(g,y))}}const d=new xs(l);return new Kw(h,d,a.fieldTransforms)}function ib(t,e,r,n=!1){return Zl(r,t.Cc(n?4:3,e))}function Zl(t,e){if(ev(t=Br(t)))return Kd("Unsupported field value:",e,t),Zw(t,e);if(t instanceof pf)return(function(n,s){if(!Yw(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,s){const i=[];let a=0;for(const o of n){let c=Zl(o,s.wc(a));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),a++}return{arrayValue:{values:i}}})(t,e)}return(function(n,s){if((n=Br(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return YS(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=or.fromDate(n);return{timestampValue:ph(s.serializer,i)}}if(n instanceof or){const i=new or(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:ph(s.serializer,i)}}if(n instanceof ei)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ms)return{bytesValue:xw(s.serializer,n._byteString)};if(n instanceof vr){const i=s.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Cd(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof ti)return(function(a,o){return{mapValue:{fields:{[Gx]:{stringValue:qx},[hh]:{arrayValue:{values:a.toArray().map((l=>{if(typeof l!="number")throw o.Sc("VectorValues must only contain numeric values.");return kd(o.serializer,l)}))}}}}}})(n,s);throw s.Sc(`Unsupported field value: ${Zh(n)}`)})(t,e)}function Zw(t,e){const r={};return jx(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fa(t,((n,s)=>{const i=Zl(s,e.mc(n));i!=null&&(r[n]=i)})),{mapValue:{fields:r}}}function ev(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof or||t instanceof ei||t instanceof ms||t instanceof vr||t instanceof pf||t instanceof ti)}function Kd(t,e,r){if(!ev(r)||!Bx(r)){const n=Zh(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function Q0(t,e,r){if((e=Br(e))instanceof Dc)return e._internalPath;if(typeof e=="string")return Yd(t,e);throw _h("Field path arguments must be of type string or ",t,!1,void 0,r)}const ab=new RegExp("[~\\*/\\[\\]]");function Yd(t,e,r){if(e.search(ab)>=0)throw _h(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Dc(...e.split("."))._internalPath}catch{throw _h(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function _h(t,e,r,n,s){const i=n&&!n.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(i||a)&&(c+=" (found",i&&(c+=` in field ${n}`),a&&(c+=` in document ${s}`),c+=")"),new Ve(fe.INVALID_ARGUMENT,o+t+c)}function tv(t,e){return t.some((r=>r.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new vr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ob(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(xf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class ob extends rv{data(){return super.data()}}function xf(t,e){return typeof e=="string"?Yd(t,e):e instanceof Dc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nv(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ve(fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Qd{}class Jd extends Qd{}function St(t,e,...r){let n=[];e instanceof Qd&&n.push(e),n=n.concat(r),(function(i){const a=i.filter((c=>c instanceof wf)).length,o=i.filter((c=>c instanceof eu)).length;if(a>1||a>0&&o>0)throw new Ve(fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const s of n)t=s._apply(t);return t}class eu extends Jd{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new eu(e,r,n)}_apply(e){const r=this._parse(e);return sv(e._query,r),new Yi(e.firestore,e.converter,j0(e._query,r))}_parse(e){const r=Jl(e.firestore);return(function(i,a,o,c,l,h,d){let f;if(l.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Ve(fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){kg(d,h);const w=[];for(const x of d)w.push(Ag(c,i,x));f={arrayValue:{values:w}}}else f=Ag(c,i,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||kg(d,h),f=ib(o,a,d,h==="in"||h==="not-in");return qr.create(l,h,f)})(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function gt(t,e,r){const n=e,s=xf("where",t);return eu._create(s,n,r)}class wf extends Qd{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new wf(e,r)}_parse(e){const r=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return r.length===1?r[0]:si.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:((function(s,i){let a=s;const o=i.getFlattenedFilters();for(const c of o)sv(a,c),a=j0(a,c)})(e._query,r),new Yi(e.firestore,e.converter,j0(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class vf extends Jd{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new vf(e,r)}_apply(e){const r=(function(s,i,a){if(s.startAt!==null)throw new Ve(fe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Ve(fe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new bl(i,a)})(e._query,this._field,this._direction);return new Yi(e.firestore,e.converter,(function(s,i){const a=s.explicitOrderBy.concat([i]);return new Ic(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,r))}}function Zd(t,e="asc"){const r=e,n=xf("orderBy",t);return vf._create(n,r)}function Ag(t,e,r){if(typeof(r=Br(r))=="string"){if(r==="")throw new Ve(fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!tw(e)&&r.indexOf("/")!==-1)throw new Ve(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(ar.fromString(r));if(!Ke.isDocumentKey(n))throw new Ve(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Up(t,new Ke(n))}if(r instanceof vr)return Up(t,r._key);throw new Ve(fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Zh(r)}.`)}function kg(t,e){if(!Array.isArray(t)||t.length===0)throw new Ve(fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function sv(t,e){const r=(function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null})(t.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(r!==null)throw r===e.op?new Ve(fe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ve(fe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class iv{convertValue(e,r="none"){switch(Aa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Lr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Sa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ot(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Fa(e,((s,i)=>{n[s]=this.convertValue(i,r)})),n}convertVectorValue(e){const r=e.fields?.[hh].arrayValue?.values?.map((n=>Lr(n.doubleValue)));return new ti(r)}convertGeoPoint(e){return new ei(Lr(e.latitude),Lr(e.longitude))}convertArray(e,r){return(e.values||[]).map((n=>this.convertValue(n,r)))}convertServerTimestamp(e,r){switch(r){case"previous":const n=rf(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Al(e));default:return null}}convertTimestamp(e){const r=Ta(e);return new or(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=ar.fromString(e);Xt(Tw(n),9688,{name:e});const s=new fc(n.get(1),n.get(3)),i=new Ke(n.popFirst(5));return s.isEqual(r)||Hi(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function em(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class Qo{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class _a extends rv{constructor(e,r,n,s,i,a){super(e,r,n,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new dl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(xf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(fe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=_a._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}_a._jsonSchemaVersion="firestore/documentSnapshot/1.0",_a._jsonSchema={type:Xr("string",_a._jsonSchemaVersion),bundleSource:Xr("string","DocumentSnapshot"),bundleName:Xr("string"),bundle:Xr("string")};class dl extends _a{data(e={}){return super.data(e)}}class ya{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Qo(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new dl(this._firestore,this._userDataWriter,n.key,n,new Qo(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ve(fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((o=>{const c=new dl(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Qo(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((o=>i||o.type!==3)).map((o=>{const c=new dl(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Qo(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let l=-1,h=-1;return o.type!==0&&(l=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),h=a.indexOf(o.doc.key)),{type:cb(o.type),doc:c,oldIndex:l,newIndex:h}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(fe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ya._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Jh.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function cb(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ot(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ys(t){t=Mn(t,vr);const e=Mn(t.firestore,ii);return Zk(Rc(e),t._key).then((r=>ov(e,t,r)))}ya._jsonSchemaVersion="firestore/querySnapshot/1.0",ya._jsonSchema={type:Xr("string",ya._jsonSchemaVersion),bundleSource:Xr("string","QuerySnapshot"),bundleName:Xr("string"),bundle:Xr("string")};class tm extends iv{constructor(e){super(),this.firestore=e}convertBytes(e){return new ms(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new vr(this.firestore,null,r)}}function tt(t){t=Mn(t,Yi);const e=Mn(t.firestore,ii),r=Rc(e),n=new tm(e);return nv(t._query),eb(r,t._query).then((s=>new ya(e,n,t,s)))}function lb(t,e,r){t=Mn(t,vr);const n=Mn(t.firestore,ii),s=em(t.converter,e,r);return Pc(n,[Xd(Jl(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,qn.none())])}function fi(t,e,r,...n){t=Mn(t,vr);const s=Mn(t.firestore,ii),i=Jl(s);let a;return a=typeof(e=Br(e))=="string"||e instanceof Dc?Jw(i,"updateDoc",t._key,e,r,n):Qw(i,"updateDoc",t._key,e),Pc(s,[a.toMutation(t._key,qn.exists(!0))])}function av(t){return Pc(Mn(t.firestore,ii),[new lf(t._key,qn.none())])}function Rn(t,e){const r=Mn(t.firestore,ii),n=ht(t),s=em(t.converter,e);return Pc(r,[Xd(Jl(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,qn.exists(!1))]).then((()=>n))}function Ko(t,...e){t=Br(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Sg(e[n])||(r=e[n++]);const s={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(Sg(e[n])){const c=e[n];e[n]=c.next?.bind(c),e[n+1]=c.error?.bind(c),e[n+2]=c.complete?.bind(c)}let i,a,o;if(t instanceof vr)a=Mn(t.firestore,ii),o=nf(t._key.path),i={next:c=>{e[n]&&e[n](ov(a,t,c))},error:e[n+1],complete:e[n+2]};else{const c=Mn(t,Yi);a=Mn(c.firestore,ii),o=c._query;const l=new tm(a);i={next:h=>{e[n]&&e[n](new ya(a,l,c,h))},error:e[n+1],complete:e[n+2]},nv(t._query)}return(function(l,h,d,f){const g=new Gd(f),w=new $d(h,g,d);return l.asyncQueue.enqueueAndForget((async()=>jd(await vh(l),w))),()=>{g.Nu(),l.asyncQueue.enqueueAndForget((async()=>Ud(await vh(l),w)))}})(Rc(a),o,s,i)}function Pc(t,e){return(function(n,s){const i=new Mi;return n.asyncQueue.enqueueAndForget((async()=>Uk(await Jk(n),s,i))),i.promise})(Rc(t),e)}function ov(t,e,r){const n=r.docs.get(e._key),s=new tm(t);return new _a(t,s,e._key,n,new Qo(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Jl(e)}set(e,r,n){this._verifyNotCommitted();const s=o0(e,this._firestore),i=em(s.converter,r,n),a=Xd(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(a.toMutation(s._key,qn.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=o0(e,this._firestore);let a;return a=typeof(r=Br(r))=="string"||r instanceof Dc?Jw(this._dataReader,"WriteBatch.update",i._key,r,n,s):Qw(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(a.toMutation(i._key,qn.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=o0(e,this._firestore);return this._mutations=this._mutations.concat(new lf(r._key,qn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ve(fe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function o0(t,e){if((t=Br(t)).firestore!==e)throw new Ve(fe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function br(t){return Rc(t=Mn(t,ii)),new cv(t,(e=>Pc(t,e)))}(function(e,r=!0){(function(s){Ac=s})(Sc),uc(new fo("firestore",((n,{instanceIdentifier:s,options:i})=>{const a=n.getProvider("app").getImmediate(),o=new ii(new lS(n.getProvider("auth-internal")),new fS(a,n.getProvider("app-check-internal")),(function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Ve(fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new fc(l.options.projectId,h)})(a,s),a);return i={useFetchStreams:r,...i},o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),wa(Ip,Cp,e),wa(Ip,Cp,"esm2020")})();const J0=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:iv,Bytes:ms,CollectionReference:Bi,DocumentReference:vr,DocumentSnapshot:_a,FieldPath:Dc,FieldValue:pf,Firestore:ii,FirestoreError:Ve,GeoPoint:ei,Query:Yi,QueryCompositeFilterConstraint:wf,QueryConstraint:Jd,QueryDocumentSnapshot:dl,QueryFieldFilterConstraint:eu,QueryOrderByConstraint:vf,QuerySnapshot:ya,SnapshotMetadata:Qo,Timestamp:or,VectorValue:ti,WriteBatch:cv,_AutoId:Jh,_ByteString:dn,_DatabaseId:fc,_DocumentKey:Ke,_EmptyAuthCredentialsProvider:Ox,_FieldPath:un,_cast:Mn,_logWarn:po,_validateIsNotUsedTogether:Mx,addDoc:Rn,collection:We,connectFirestoreEmulator:qw,deleteDoc:av,doc:ht,ensureFirestoreConfigured:Rc,executeWrite:Pc,getDoc:Ys,getDocs:tt,getFirestore:Xw,onSnapshot:Ko,orderBy:Zd,query:St,setDoc:lb,updateDoc:fi,where:gt,writeBatch:br},Symbol.toStringTag,{value:"Module"}));function lv(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const uv=lv,hv=new Hl("auth","Firebase",lv());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yh=new xd("@firebase/auth");function ub(t,...e){yh.logLevel<=At.WARN&&yh.warn(`Auth (${Sc}): ${t}`,...e)}function nh(t,...e){yh.logLevel<=At.ERROR&&yh.error(`Auth (${Sc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ai(t,...e){throw rm(t,...e)}function _i(t,...e){return rm(t,...e)}function fv(t,e,r){const n={...uv(),[e]:r};return new Hl("auth","Firebase",n).create(e,{appName:t.name})}function Vi(t){return fv(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function rm(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return hv.create(t,...e)}function Ze(t,e,...r){if(!t)throw rm(e,...r)}function Ni(t){const e="INTERNAL ASSERTION FAILED: "+t;throw nh(e),new Error(e)}function qi(t,e){t||Ni(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z0(){return typeof self<"u"&&self.location?.href||""}function hb(){return bg()==="http:"||bg()==="https:"}function bg(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(hb()||VE()||"connection"in navigator)?navigator.onLine:!0}function db(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(e,r){this.shortDelay=e,this.longDelay=r,qi(r>e,"Short delay should be less than long delay!"),this.isMobile=LE()||jE()}get(){return fb()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nm(t,e){qi(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ni("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ni("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ni("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mb={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],gb=new tu(3e4,6e4);function Qi(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ji(t,e,r,n,s={}){return mv(t,s,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const o=Gl({key:t.config.apiKey,...a}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const l={method:e,headers:c,...i};return BE()||(l.referrerPolicy="no-referrer"),t.emulatorConfig&&Tc(t.emulatorConfig.host)&&(l.credentials="include"),dv.fetch()(await pv(t,t.config.apiHost,r,o),l)})}async function mv(t,e,r){t._canInitEmulator=!1;const n={...mb,...e};try{const s=new wb(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Bu(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[c,l]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Bu(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw Bu(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw Bu(t,"user-disabled",a);const h=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw fv(t,h,l);ai(t,h)}}catch(s){if(s instanceof Ki)throw s;ai(t,"network-request-failed",{message:String(s)})}}async function ru(t,e,r,n,s={}){const i=await Ji(t,e,r,n,s);return"mfaPendingCredential"in i&&ai(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function pv(t,e,r,n){const s=`${e}${r}?${n}`,i=t,a=i.config.emulator?nm(t.config,s):`${t.config.apiScheme}://${s}`;return pb.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}function xb(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class wb{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(_i(this.auth,"network-request-failed")),gb.get())})}}function Bu(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=_i(t,e,n);return s.customData._tokenResponse=r,s}function Ig(t){return t!==void 0&&t.enterprise!==void 0}class vb{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return xb(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function _b(t,e){return Ji(t,"GET","/v2/recaptchaConfig",Qi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yb(t,e){return Ji(t,"POST","/v1/accounts:delete",e)}async function Eh(t,e){return Ji(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ml(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function gv(t,e=!1){const r=Br(t),n=await r.getIdToken(e),s=sm(n);Ze(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i?.sign_in_provider;return{claims:s,token:n,authTime:ml(c0(s.auth_time)),issuedAtTime:ml(c0(s.iat)),expirationTime:ml(c0(s.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function c0(t){return Number(t)*1e3}function sm(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return nh("JWT malformed, contained fewer than 3 sections"),null;try{const s=px(r);return s?JSON.parse(s):(nh("Failed to decode base64 JWT payload"),null)}catch(s){return nh("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Cg(t){const e=sm(t);return Ze(e,"internal-error"),Ze(typeof e.exp<"u","internal-error"),Ze(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rl(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ki&&Eb(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Eb({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=ml(this.lastLoginAt),this.creationTime=ml(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Th(t){const e=t.auth,r=await t.getIdToken(),n=await Rl(t,Eh(e,{idToken:r}));Ze(n?.users.length,e,"internal-error");const s=n.users[0];t._notifyReloadListener(s);const i=s.providerUserInfo?.length?wv(s.providerUserInfo):[],a=Sb(t.providerData,i),o=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!a?.length,l=o?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ed(s.createdAt,s.lastLoginAt),isAnonymous:l};Object.assign(t,h)}async function xv(t){const e=Br(t);await Th(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Sb(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function wv(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ab(t,e){const r=await mv(t,{},async()=>{const n=Gl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=await pv(t,s,"/v1/token",`key=${i}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:o,body:n};return t.emulatorConfig&&Tc(t.emulatorConfig.host)&&(c.credentials="include"),dv.fetch()(a,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function kb(t,e){return Ji(t,"POST","/v2/accounts:revokeToken",Qi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ze(e.idToken,"internal-error"),Ze(typeof e.idToken<"u","internal-error"),Ze(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Cg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Ze(e.length!==0,"internal-error");const r=Cg(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Ze(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await Ab(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,a=new tc;return n&&(Ze(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),s&&(Ze(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(Ze(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new tc,this.toJSON())}_performRefresh(){return Ni("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ca(t,e){Ze(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Qs{constructor({uid:e,auth:r,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new Tb(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ed(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Rl(this,this.stsTokenManager.getToken(this.auth,e));return Ze(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return gv(this,e)}reload(){return xv(this)}_assign(e){this!==e&&(Ze(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Qs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Ze(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Th(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ds(this.auth.app))return Promise.reject(Vi(this.auth));const e=await this.getIdToken();return await Rl(this,yb(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,s=r.email??void 0,i=r.phoneNumber??void 0,a=r.photoURL??void 0,o=r.tenantId??void 0,c=r._redirectEventId??void 0,l=r.createdAt??void 0,h=r.lastLoginAt??void 0,{uid:d,emailVerified:f,isAnonymous:g,providerData:w,stsTokenManager:x}=r;Ze(d&&x,e,"internal-error");const y=tc.fromJSON(this.name,x);Ze(typeof d=="string",e,"internal-error"),ca(n,e.name),ca(s,e.name),Ze(typeof f=="boolean",e,"internal-error"),Ze(typeof g=="boolean",e,"internal-error"),ca(i,e.name),ca(a,e.name),ca(o,e.name),ca(c,e.name),ca(l,e.name),ca(h,e.name);const A=new Qs({uid:d,auth:e,email:s,emailVerified:f,displayName:n,isAnonymous:g,photoURL:a,phoneNumber:i,tenantId:o,stsTokenManager:y,createdAt:l,lastLoginAt:h});return w&&Array.isArray(w)&&(A.providerData=w.map(F=>({...F}))),c&&(A._redirectEventId=c),A}static async _fromIdTokenResponse(e,r,n=!1){const s=new tc;s.updateFromServerResponse(r);const i=new Qs({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Th(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Ze(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?wv(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!i?.length,o=new tc;o.updateFromIdToken(n);const c=new Qs({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:a}),l={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new ed(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(c,l),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rg=new Map;function Oi(t){qi(t instanceof Function,"Expected a class definition");let e=Rg.get(t);return e?(qi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Rg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}vv.type="NONE";const td=vv;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sh(t,e,r){return`firebase:${t}:${e}:${r}`}class rc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=sh(this.userKey,s.apiKey,i),this.fullPersistenceKey=sh("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Eh(this.auth,{idToken:e}).catch(()=>{});return r?Qs._fromGetAccountInfoResponse(this.auth,r,e):null}return Qs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new rc(Oi(td),e,n);const s=(await Promise.all(r.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let i=s[0]||Oi(td);const a=sh(n,e.config.apiKey,e.name);let o=null;for(const l of r)try{const h=await l._get(a);if(h){let d;if(typeof h=="string"){const f=await Eh(e,{idToken:h}).catch(()=>{});if(!f)break;d=await Qs._fromGetAccountInfoResponse(e,f,h)}else d=Qs._fromJSON(e,h);l!==i&&(o=d),i=l;break}}catch{}const c=s.filter(l=>l._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new rc(i,e,n):(i=c[0],o&&await i._set(a,o.toJSON()),await Promise.all(r.map(async l=>{if(l!==i)try{await l._remove(a)}catch{}})),new rc(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Tv(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_v(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Av(e))return"Blackberry";if(kv(e))return"Webos";if(yv(e))return"Safari";if((e.includes("chrome/")||Ev(e))&&!e.includes("edge/"))return"Chrome";if(Sv(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function _v(t=Vn()){return/firefox\//i.test(t)}function yv(t=Vn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ev(t=Vn()){return/crios\//i.test(t)}function Tv(t=Vn()){return/iemobile/i.test(t)}function Sv(t=Vn()){return/android/i.test(t)}function Av(t=Vn()){return/blackberry/i.test(t)}function kv(t=Vn()){return/webos/i.test(t)}function im(t=Vn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function bb(t=Vn()){return im(t)&&!!window.navigator?.standalone}function Ib(){return UE()&&document.documentMode===10}function bv(t=Vn()){return im(t)||Sv(t)||kv(t)||Av(t)||/windows phone/i.test(t)||Tv(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iv(t,e=[]){let r;switch(t){case"Browser":r=Dg(Vn());break;case"Worker":r=`${Dg(Vn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Sc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,o)=>{try{const c=e(i);a(c)}catch(c){o(c)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rb(t,e={}){return Ji(t,"GET","/v2/passwordPolicy",Qi(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Db=6;class Pb{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??Db,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fb{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Pg(this),this.idTokenSubscription=new Pg(this),this.beforeStateQueue=new Cb(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hv,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Oi(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await rc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Eh(this,{idToken:e}),n=await Qs._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ds(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=n?._redirectEventId,o=await this.tryRedirectSignIn(e);(!i||i===a)&&o?.user&&(n=o.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(i){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Ze(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Th(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=db()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ds(this.app))return Promise.reject(Vi(this));const r=e?Br(e):null;return r&&Ze(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Ze(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ds(this.app)?Promise.reject(Vi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ds(this.app)?Promise.reject(Vi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Oi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Rb(this),r=new Pb(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Hl("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await kb(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Oi(e)||this._popupRedirectResolver;Ze(r,this,"argument-error"),this.redirectPersistenceManager=await rc.create(this,[Oi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ze(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,s);return()=>{a=!0,c()}}else{const c=e.addObserver(r);return()=>{a=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ze(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Iv(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Ds(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&ub(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Oa(t){return Br(t)}class Pg{constructor(e){this.auth=e,this.observer=null,this.addObserver=KE(r=>this.observer=r)}get next(){return Ze(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _f={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Nb(t){_f=t}function Cv(t){return _f.loadJS(t)}function Ob(){return _f.recaptchaEnterpriseScript}function Lb(){return _f.gapiScript}function Mb(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class Bb{constructor(){this.enterprise=new Vb}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class Vb{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const jb="recaptcha-enterprise",Rv="NO_RECAPTCHA";class Ub{constructor(e){this.type=jb,this.auth=Oa(e)}async verify(e="verify",r=!1){async function n(i){if(!r){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,o)=>{_b(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const l=new vb(c);return i.tenantId==null?i._agentRecaptchaConfig=l:i._tenantRecaptchaConfigs[i.tenantId]=l,a(l.siteKey)}}).catch(c=>{o(c)})})}function s(i,a,o){const c=window.grecaptcha;Ig(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(l=>{a(l)}).catch(()=>{a(Rv)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Bb().execute("siteKey",{action:"verify"}):new Promise((i,a)=>{n(this.auth).then(o=>{if(!r&&Ig(window.grecaptcha))s(o,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let c=Ob();c.length!==0&&(c+=o),Cv(c).then(()=>{s(o,i,a)}).catch(l=>{a(l)})}}).catch(o=>{a(o)})})}}async function Fg(t,e,r,n=!1,s=!1){const i=new Ub(t);let a;if(s)a=Rv;else try{a=await i.verify(r)}catch{a=await i.verify(r,!0)}const o={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const c=o.phoneEnrollmentInfo.phoneNumber,l=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const c=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Sh(t,e,r,n,s){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Fg(t,e,r,r==="getOobCode");return n(t,i)}else return n(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Fg(t,e,r,r==="getOobCode");return n(t,a)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dv(t,e){const r=vd(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(ho(i,e??{}))return s;ai(s,"already-initialized")}return r.initialize({options:e})}function Wb(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Oi);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function Pv(t,e,r){const n=Oa(t);Ze(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=Fv(e),{host:a,port:o}=$b(e),c=o===null?"":`:${o}`,l={url:`${i}//${a}${c}/`},h=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){Ze(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Ze(ho(l,n.config.emulator)&&ho(h,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=l,n.emulatorConfig=h,n.settings.appVerificationDisabledForTesting=!0,Tc(a)?(vx(`${i}//${a}${c}`),_x("Auth",!0)):zb()}function Fv(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function $b(t){const e=Fv(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:Ng(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:Ng(a)}}}function Ng(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function zb(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ni("not implemented")}_getIdTokenResponse(e){return Ni("not implemented")}_linkToIdToken(e,r){return Ni("not implemented")}_getReauthenticationResolver(e){return Ni("not implemented")}}async function Hb(t,e){return Ji(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gb(t,e){return ru(t,"POST","/v1/accounts:signInWithPassword",Qi(t,e))}async function qb(t,e){return Ji(t,"POST","/v1/accounts:sendOobCode",Qi(t,e))}async function Xb(t,e){return qb(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kb(t,e){return ru(t,"POST","/v1/accounts:signInWithEmailLink",Qi(t,e))}async function Yb(t,e){return ru(t,"POST","/v1/accounts:signInWithEmailLink",Qi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc extends yf{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new xc(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new xc(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Sh(e,r,"signInWithPassword",Gb);case"emailLink":return Kb(e,{email:this._email,oobCode:this._password});default:ai(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Sh(e,n,"signUpPassword",Hb);case"emailLink":return Yb(e,{idToken:r,email:this._email,oobCode:this._password});default:ai(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nc(t,e){return ru(t,"POST","/v1/accounts:signInWithIdp",Qi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qb="http://localhost";class Ia extends yf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Ia(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ai("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...i}=r;if(!n||!s)return null;const a=new Ia(n,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return nc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,nc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,nc(e,r)}buildRequest(){const e={requestUri:Qb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Gl(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jb(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Zb(t){const e=Zc(el(t)).link,r=e?Zc(el(e)).deep_link_id:null,n=Zc(el(t)).deep_link_id;return(n?Zc(el(n)).link:null)||n||r||e||t}class Ef{constructor(e){const r=Zc(el(e)),n=r.apiKey??null,s=r.oobCode??null,i=Jb(r.mode??null);Ze(n&&s&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=s,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=Zb(e);try{return new Ef(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(){this.providerId=bo.PROVIDER_ID}static credential(e,r){return xc._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=Ef.parseLink(r);return Ze(n,"argument-error"),xc._fromEmailAndCode(e,n.code,n.tenantId)}}bo.PROVIDER_ID="password";bo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";bo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu extends Nv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri extends nu{constructor(){super("facebook.com")}static credential(e){return Ia._fromParams({providerId:Ri.PROVIDER_ID,signInMethod:Ri.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ri.credentialFromTaggedObject(e)}static credentialFromError(e){return Ri.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ri.credential(e.oauthAccessToken)}catch{return null}}}Ri.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ri.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di extends nu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Ia._fromParams({providerId:Di.PROVIDER_ID,signInMethod:Di.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Di.credentialFromTaggedObject(e)}static credentialFromError(e){return Di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Di.credential(r,n)}catch{return null}}}Di.GOOGLE_SIGN_IN_METHOD="google.com";Di.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi extends nu{constructor(){super("github.com")}static credential(e){return Ia._fromParams({providerId:Pi.PROVIDER_ID,signInMethod:Pi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pi.credentialFromTaggedObject(e)}static credentialFromError(e){return Pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Pi.credential(e.oauthAccessToken)}catch{return null}}}Pi.GITHUB_SIGN_IN_METHOD="github.com";Pi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi extends nu{constructor(){super("twitter.com")}static credential(e,r){return Ia._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Fi.credential(r,n)}catch{return null}}}Fi.TWITTER_SIGN_IN_METHOD="twitter.com";Fi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eI(t,e){return ru(t,"POST","/v1/accounts:signUp",Qi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await Qs._fromIdTokenResponse(e,n,s),a=Og(n);return new xo({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=Og(n);return new xo({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function Og(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah extends Ki{constructor(e,r,n,s){super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Ah.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new Ah(e,r,n,s)}}function Ov(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Ah._fromErrorAndOperation(t,i,e,n):i})}async function tI(t,e,r=!1){const n=await Rl(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return xo._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rI(t,e,r=!1){const{auth:n}=t;if(Ds(n.app))return Promise.reject(Vi(n));const s="reauthenticate";try{const i=await Rl(t,Ov(n,s,e,t),r);Ze(i.idToken,n,"internal-error");const a=sm(i.idToken);Ze(a,n,"internal-error");const{sub:o}=a;return Ze(t.uid===o,n,"user-mismatch"),xo._forOperation(t,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&ai(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lv(t,e,r=!1){if(Ds(t.app))return Promise.reject(Vi(t));const n="signIn",s=await Ov(t,n,e),i=await xo._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}async function Mv(t,e){return Lv(Oa(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nI(t,e,r){Ze(r.url?.length>0,t,"invalid-continue-uri"),Ze(typeof r.dynamicLinkDomain>"u"||r.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),Ze(typeof r.linkDomain>"u"||r.linkDomain.length>0,t,"invalid-hosting-link-domain"),e.continueUrl=r.url,e.dynamicLinkDomain=r.dynamicLinkDomain,e.linkDomain=r.linkDomain,e.canHandleCodeInApp=r.handleCodeInApp,r.iOS&&(Ze(r.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=r.iOS.bundleId),r.android&&(Ze(r.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=r.android.installApp,e.androidMinimumVersionCode=r.android.minimumVersion,e.androidPackageName=r.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bv(t){const e=Oa(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Vv(t,e,r){const n=Oa(t),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};r&&nI(n,s,r),await Sh(n,s,"getOobCode",Xb)}async function sI(t,e,r){if(Ds(t.app))return Promise.reject(Vi(t));const n=Oa(t),a=await Sh(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",eI).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Bv(t),c}),o=await xo._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}function jv(t,e,r){return Ds(t.app)?Promise.reject(Vi(t)):Mv(Br(t),bo.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&Bv(t),n})}function Uv(t,e,r,n){return Br(t).onIdTokenChanged(e,r,n)}function Wv(t,e,r){return Br(t).beforeAuthStateChanged(e,r)}function $v(t,e,r,n){return Br(t).onAuthStateChanged(e,r,n)}function sl(t){return Br(t).signOut()}const kh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(kh,"1"),this.storage.removeItem(kh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI=1e3,aI=10;class Hv extends zv{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=bv(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,c)=>{this.notifyListeners(a,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);Ib()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,aI):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},iI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Hv.type="LOCAL";const Gv=Hv;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv extends zv{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}qv.type="SESSION";const am=qv;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new Tf(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(a).map(async l=>l(r.origin,i)),c=await oI(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Tf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function om(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((o,c)=>{const l=om("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(d){const f=d;if(f.data.eventId===l)switch(f.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(f.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:l,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yi(){return window}function lI(t){yi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xv(){return typeof yi().WorkerGlobalScope<"u"&&typeof yi().importScripts=="function"}async function uI(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function hI(){return navigator?.serviceWorker?.controller||null}function fI(){return Xv()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kv="firebaseLocalStorageDb",dI=1,bh="firebaseLocalStorage",Yv="fbase_key";class su{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Sf(t,e){return t.transaction([bh],e?"readwrite":"readonly").objectStore(bh)}function mI(){const t=indexedDB.deleteDatabase(Kv);return new su(t).toPromise()}function rd(){const t=indexedDB.open(Kv,dI);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(bh,{keyPath:Yv})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(bh)?e(n):(n.close(),await mI(),e(await rd()))})})}async function Lg(t,e,r){const n=Sf(t,!0).put({[Yv]:e,value:r});return new su(n).toPromise()}async function pI(t,e){const r=Sf(t,!1).get(e),n=await new su(r).toPromise();return n===void 0?null:n.value}function Mg(t,e){const r=Sf(t,!0).delete(e);return new su(r).toPromise()}const gI=800,xI=3;class Qv{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await rd(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>xI)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Xv()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Tf._getInstance(fI()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await uI(),!this.activeServiceWorker)return;this.sender=new cI(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||hI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await rd();return await Lg(e,kh,"1"),await Mg(e,kh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Lg(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>pI(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Mg(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Sf(s,!1).getAll();return new su(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),gI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Qv.type="LOCAL";const Jv=Qv;new tu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wI(t,e){return e?Oi(e):(Ze(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm extends yf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return nc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return nc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return nc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function vI(t){return Lv(t.auth,new cm(t),t.bypassAuthState)}function _I(t){const{auth:e,user:r}=t;return Ze(r,e,"internal-error"),rI(r,new cm(t),t.bypassAuthState)}async function yI(t){const{auth:e,user:r}=t;return Ze(r,e,"internal-error"),tI(r,new cm(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return vI;case"linkViaPopup":case"linkViaRedirect":return yI;case"reauthViaPopup":case"reauthViaRedirect":return _I;default:ai(this.auth,"internal-error")}}resolve(e){qi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EI=new tu(2e3,1e4);class Jo extends Zv{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,Jo.currentPopupAction&&Jo.currentPopupAction.cancel(),Jo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ze(e,this.auth,"internal-error"),e}async onExecution(){qi(this.filter.length===1,"Popup operations only handle one event");const e=om();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(_i(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(_i(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Jo.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_i(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,EI.get())};e()}}Jo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI="pendingRedirect",ih=new Map;class SI extends Zv{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=ih.get(this.auth._key());if(!e){try{const n=await AI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}ih.set(this.auth._key(),e)}return this.bypassAuthState||ih.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function AI(t,e){const r=II(e),n=bI(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function kI(t,e){ih.set(t._key(),e)}function bI(t){return Oi(t._redirectPersistence)}function II(t){return sh(TI,t.config.apiKey,t.name)}async function CI(t,e,r=!1){if(Ds(t.app))return Promise.reject(Vi(t));const n=Oa(t),s=wI(n,e),a=await new SI(n,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI=600*1e3;class DI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!PI(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!e_(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(_i(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=RI&&this.cachedEventUids.clear(),this.cachedEventUids.has(Bg(e))}saveEventToCache(e){this.cachedEventUids.add(Bg(e)),this.lastProcessedEventTime=Date.now()}}function Bg(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function e_({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function PI(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return e_(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FI(t,e={}){return Ji(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,OI=/^https?/;async function LI(t){if(t.config.emulator)return;const{authorizedDomains:e}=await FI(t);for(const r of e)try{if(MI(r))return}catch{}ai(t,"unauthorized-domain")}function MI(t){const e=Z0(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!OI.test(r))return!1;if(NI.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI=new tu(3e4,6e4);function Vg(){const t=yi().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function VI(t){return new Promise((e,r)=>{function n(){Vg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Vg(),r(_i(t,"network-request-failed"))},timeout:BI.get()})}if(yi().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(yi().gapi?.load)n();else{const s=Mb("iframefcb");return yi()[s]=()=>{gapi.load?n():r(_i(t,"network-request-failed"))},Cv(`${Lb()}?onload=${s}`).catch(i=>r(i))}}).catch(e=>{throw ah=null,e})}let ah=null;function jI(t){return ah=ah||VI(t),ah}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI=new tu(5e3,15e3),WI="__/auth/iframe",$I="emulator/auth/iframe",zI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},HI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function GI(t){const e=t.config;Ze(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?nm(e,$I):`https://${t.config.authDomain}/${WI}`,n={apiKey:e.apiKey,appName:t.name,v:Sc},s=HI.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${Gl(n).slice(1)}`}async function qI(t){const e=await jI(t),r=yi().gapi;return Ze(r,t,"internal-error"),e.open({where:document.body,url:GI(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:zI,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const a=_i(t,"network-request-failed"),o=yi().setTimeout(()=>{i(a)},UI.get());function c(){yi().clearTimeout(o),s(n)}n.ping(c).then(c,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},KI=500,YI=600,QI="_blank",JI="http://localhost";class jg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ZI(t,e,r,n=KI,s=YI){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const c={...XI,width:n.toString(),height:s.toString(),top:i,left:a},l=Vn().toLowerCase();r&&(o=Ev(l)?QI:r),_v(l)&&(e=e||JI,c.scrollbars="yes");const h=Object.entries(c).reduce((f,[g,w])=>`${f}${g}=${w},`,"");if(bb(l)&&o!=="_self")return eC(e||"",o),new jg(null);const d=window.open(e||"",o,h);Ze(d,t,"popup-blocked");try{d.focus()}catch{}return new jg(d)}function eC(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC="__/auth/handler",rC="emulator/auth/handler",nC=encodeURIComponent("fac");async function Ug(t,e,r,n,s,i){Ze(t.config.authDomain,t,"auth-domain-config-required"),Ze(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Sc,eventId:s};if(e instanceof Nv){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",XE(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,d]of Object.entries({}))a[h]=d}if(e instanceof nu){const h=e.getScopes().filter(d=>d!=="");h.length>0&&(a.scopes=h.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const c=await t._getAppCheckToken(),l=c?`#${nC}=${encodeURIComponent(c)}`:"";return`${sC(t)}?${Gl(o).slice(1)}${l}`}function sC({config:t}){return t.emulator?nm(t,rC):`https://${t.authDomain}/${tC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l0="webStorageSupport";class iC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=am,this._completeRedirectFn=CI,this._overrideRedirectResult=kI}async _openPopup(e,r,n,s){qi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await Ug(e,r,n,Z0(),s);return ZI(e,i,om())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await Ug(e,r,n,Z0(),s);return lI(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(qi(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await qI(e),n=new DI(e);return r.register("authEvent",s=>(Ze(s?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(l0,{type:l0},s=>{const i=s?.[0]?.[l0];i!==void 0&&r(!!i),ai(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=LI(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return bv()||yv()||im()}}const t_=iC;var Wg="@firebase/auth",$g="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Ze(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oC(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function cC(t){uc(new fo("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Ze(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Iv(t)},l=new Fb(n,s,i,c);return Wb(l,r),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),uc(new fo("auth-internal",e=>{const r=Oa(e.getProvider("auth").getImmediate());return(n=>new aC(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),wa(Wg,$g,oC(t)),wa(Wg,$g,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lC=300,uC=wx("authIdTokenMaxAge")||lC;let zg=null;const hC=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>uC)return;const s=r?.token;zg!==s&&(zg=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function lm(t=Sx()){const e=vd(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Dv(t,{popupRedirectResolver:t_,persistence:[Jv,Gv,am]}),n=wx("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=hC(i.toString());Wv(r,a,()=>a(r.currentUser)),Uv(r,o=>a(o))}}const s=gx("auth");return s&&Pv(r,`http://${s}`),r}function fC(){return document.getElementsByTagName("head")?.[0]??document}Nb({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=_i("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",fC().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});cC("Browser");const Hg=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:Ef,AuthCredential:yf,EmailAuthCredential:xc,EmailAuthProvider:bo,FacebookAuthProvider:Ri,GithubAuthProvider:Pi,GoogleAuthProvider:Di,OAuthCredential:Ia,TwitterAuthProvider:Fi,beforeAuthStateChanged:Wv,browserLocalPersistence:Gv,browserPopupRedirectResolver:t_,browserSessionPersistence:am,connectAuthEmulator:Pv,createUserWithEmailAndPassword:sI,getAuth:lm,getIdTokenResult:gv,inMemoryPersistence:td,indexedDBLocalPersistence:Jv,initializeAuth:Dv,onAuthStateChanged:$v,onIdTokenChanged:Uv,prodErrorMap:uv,reload:xv,sendPasswordResetEmail:Vv,signInWithCredential:Mv,signInWithEmailAndPassword:jv,signOut:sl},Symbol.toStringTag,{value:"Module"})),dC={apiKey:"AIzaSyCFaNgmyUhdwtPT1mnc1uIxAmYLP7tnW0E",authDomain:"testdevice-ea315.firebaseapp.com",projectId:"testdevice-ea315",storageBucket:"testdevice-ea315.firebasestorage.app",messagingSenderId:"979913733573",appId:"1:979913733573:web:a600bc588ad2ac86d4c7ac",measurementId:"G-20R0FDDR8P"},r_=Tx(dC),ce=Xw(r_),to=lm(r_),n_=Object.freeze(Object.defineProperty({__proto__:null,auth:to,db:ce},Symbol.toStringTag,{value:"Module"})),s_=$e.createContext(),mC=()=>{const t=$e.useContext(s_);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},gB=({children:t})=>{const[e,r]=$e.useState(null),[n,s]=$e.useState(null),[i,a]=$e.useState(!0),o=async(f,g,w)=>{try{console.log("  :",{name:f,birthDate:g,studentId:w});const x=We(ce,"accounts"),y=St(x,gt("role","==","student"),gt("studentId","==",w)),A=await tt(y);if(!A.empty){const F=A.docs[0],I=F.data();if(console.log("  :",I),I.name===f&&I.birthDate===g)return r({...I,id:F.id}),s("student"),{success:!0}}return{success:!1,error:"   ."}}catch(x){return console.error("  :",x),{success:!1,error:x.message}}},c=async(f,g)=>{try{console.log("  :",f);const w=await jv(to,f,g);console.log("Firebase Auth  :",w.user.uid);const x=ht(ce,"accounts",w.user.uid),y=await Ys(x);if(y.exists()){const A=y.data();if(console.log("  :",A),A.status==="disabled")return await sl(to),{success:!1,error:` . : ${A.disabledReason||"  "}`};if(A.status==="deleted")return await sl(to),{success:!1,error:" .  ."};const F={...A,uid:w.user.uid};r(F),s(A.role);try{await Rn(We(ce,"system_logs"),{userId:F.uid,userName:F.name||F.email,userRole:F.role,majorCategory:"",middleCategory:"",minorCategory:"",action:" ",details:`${F.name||F.email} .`,timestamp:new Date,createdAt:new Date})}catch(I){console.error("  :",I)}return{success:!0}}else return console.error("Firestore   :",w.user.uid),{success:!1,error:"    . Firestore    ."}}catch(w){console.error("  :",w);let x=" .";switch(w.code){case"auth/user-not-found":x="  .";break;case"auth/wrong-password":x="  .";break;case"auth/invalid-email":x="   .";break;case"auth/too-many-requests":x="    .    .";break;default:x=w.message}try{await Rn(We(ce,"system_logs"),{userId:"unknown",userName:f,userRole:"unknown",majorCategory:"",middleCategory:"",minorCategory:"",action:" ",details:`${f}   : ${x}`,timestamp:new Date,createdAt:new Date})}catch(y){console.error("  :",y)}return{success:!1,error:x}}},l=async f=>{try{const g=ht(ce,"accounts",f),w=await Ys(g);if(w.exists()){const x=w.data();return r({...x,uid:f}),s(x.role),console.log("   :",x.name),{success:!0}}else return console.error("     ."),{success:!1,error:"     ."}}catch(g){return console.error("   :",g),{success:!1,error:g.message}}},h=async()=>{try{const f=e;if(await sl(to),r(null),s(null),console.log(" "),f)try{await Rn(We(ce,"system_logs"),{userId:f.uid,userName:f.name||f.email,userRole:f.role,majorCategory:"",middleCategory:"",minorCategory:"",action:"",details:`${f.name||f.email} .`,timestamp:new Date,createdAt:new Date})}catch(g){console.error("  :",g)}}catch(f){console.error(" :",f)}};$e.useEffect(()=>$v(to,async g=>{if(console.log("Auth  :",g?g.uid:""),g)try{const w=ht(ce,"accounts",g.uid),x=await Ys(w);if(x.exists()){const y=x.data();if(console.log("   :",y),y.status==="disabled"){console.log("    :",g.email),await sl(to),r(null),s(null);return}r({...y,uid:g.uid}),s(y.role)}else console.error("   Firestore   "),r(null),s(null)}catch(w){console.error("   :",w),r(null),s(null)}else r(null),s(null);a(!1)}),[]);const d={currentUser:e,userRole:n,loginStudent:o,loginTeacher:c,restoreAdminAccount:l,logout:h,loading:i};return m.jsx(s_.Provider,{value:d,children:!i&&t})},pC=()=>{const t=fx(),e=Yc(t.breakpoints.down("md")),r=Yc(t.breakpoints.between("md","lg")),n=Yc(t.breakpoints.up("lg")),s=Yc(t.breakpoints.down("sm")),i=Yc(t.breakpoints.up("xl"));return{isMobile:e,isTablet:r,isDesktop:n,isSmallMobile:s,isLargeDesktop:i,isMobileOrSmaller:e,isTabletOrLarger:!e}};/*!
* sweetalert2 v11.22.5
* Released under the MIT License.
*/function i_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}function gC(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gg(t,e){return t.get(i_(t,e))}function xC(t,e,r){gC(t,e),e.set(t,r)}function wC(t,e,r){return t.set(i_(t,e),r),r}const vC=100,rt={},_C=()=>{rt.previousActiveElement instanceof HTMLElement?(rt.previousActiveElement.focus(),rt.previousActiveElement=null):document.body&&document.body.focus()},yC=t=>new Promise(e=>{if(!t)return e();const r=window.scrollX,n=window.scrollY;rt.restoreFocusTimeout=setTimeout(()=>{_C(),e()},vC),window.scrollTo(r,n)}),a_="swal2-",EC=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],le=EC.reduce((t,e)=>(t[e]=a_+e,t),{}),TC=["success","warning","info","question","error"],Ih=TC.reduce((t,e)=>(t[e]=a_+e,t),{}),o_="SweetAlert2:",um=t=>t.charAt(0).toUpperCase()+t.slice(1),Kn=t=>{console.warn(`${o_} ${typeof t=="object"?t.join(" "):t}`)},Io=t=>{console.error(`${o_} ${t}`)},qg=[],SC=t=>{qg.includes(t)||(qg.push(t),Kn(t))},c_=(t,e=null)=>{SC(`"${t}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`)},Af=t=>typeof t=="function"?t():t,hm=t=>t&&typeof t.toPromise=="function",iu=t=>hm(t)?t.toPromise():Promise.resolve(t),fm=t=>t&&Promise.resolve(t)===t,Yn=()=>document.body.querySelector(`.${le.container}`),au=t=>{const e=Yn();return e?e.querySelector(t):null},_s=t=>au(`.${t}`),Vt=()=>_s(le.popup),Fc=()=>_s(le.icon),AC=()=>_s(le["icon-content"]),l_=()=>_s(le.title),dm=()=>_s(le["html-container"]),u_=()=>_s(le.image),mm=()=>_s(le["progress-steps"]),kf=()=>_s(le["validation-message"]),Ti=()=>au(`.${le.actions} .${le.confirm}`),Nc=()=>au(`.${le.actions} .${le.cancel}`),Co=()=>au(`.${le.actions} .${le.deny}`),kC=()=>_s(le["input-label"]),Oc=()=>au(`.${le.loader}`),ou=()=>_s(le.actions),h_=()=>_s(le.footer),bf=()=>_s(le["timer-progress-bar"]),pm=()=>_s(le.close),bC=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,gm=()=>{const t=Vt();if(!t)return[];const e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),r=Array.from(e).sort((i,a)=>{const o=parseInt(i.getAttribute("tabindex")||"0"),c=parseInt(a.getAttribute("tabindex")||"0");return o>c?1:o<c?-1:0}),n=t.querySelectorAll(bC),s=Array.from(n).filter(i=>i.getAttribute("tabindex")!=="-1");return[...new Set(r.concat(s))].filter(i=>is(i))},xm=()=>ji(document.body,le.shown)&&!ji(document.body,le["toast-shown"])&&!ji(document.body,le["no-backdrop"]),If=()=>{const t=Vt();return t?ji(t,le.toast):!1},IC=()=>{const t=Vt();return t?t.hasAttribute("data-loading"):!1},ys=(t,e)=>{if(t.textContent="",e){const n=new DOMParser().parseFromString(e,"text/html"),s=n.querySelector("head");s&&Array.from(s.childNodes).forEach(a=>{t.appendChild(a)});const i=n.querySelector("body");i&&Array.from(i.childNodes).forEach(a=>{a instanceof HTMLVideoElement||a instanceof HTMLAudioElement?t.appendChild(a.cloneNode(!0)):t.appendChild(a)})}},ji=(t,e)=>{if(!e)return!1;const r=e.split(/\s+/);for(let n=0;n<r.length;n++)if(!t.classList.contains(r[n]))return!1;return!0},CC=(t,e)=>{Array.from(t.classList).forEach(r=>{!Object.values(le).includes(r)&&!Object.values(Ih).includes(r)&&!Object.values(e.showClass||{}).includes(r)&&t.classList.remove(r)})},ws=(t,e,r)=>{if(CC(t,e),!e.customClass)return;const n=e.customClass[r];if(n){if(typeof n!="string"&&!n.forEach){Kn(`Invalid type of customClass.${r}! Expected string or iterable object, got "${typeof n}"`);return}$t(t,n)}},Cf=(t,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(`.${le.popup} > .${le[e]}`);case"checkbox":return t.querySelector(`.${le.popup} > .${le.checkbox} input`);case"radio":return t.querySelector(`.${le.popup} > .${le.radio} input:checked`)||t.querySelector(`.${le.popup} > .${le.radio} input:first-child`);case"range":return t.querySelector(`.${le.popup} > .${le.range} input`);default:return t.querySelector(`.${le.popup} > .${le.input}`)}},f_=t=>{if(t.focus(),t.type!=="file"){const e=t.value;t.value="",t.value=e}},d_=(t,e,r)=>{!t||!e||(typeof e=="string"&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(n=>{Array.isArray(t)?t.forEach(s=>{r?s.classList.add(n):s.classList.remove(n)}):r?t.classList.add(n):t.classList.remove(n)}))},$t=(t,e)=>{d_(t,e,!0)},Fs=(t,e)=>{d_(t,e,!1)},fa=(t,e)=>{const r=Array.from(t.children);for(let n=0;n<r.length;n++){const s=r[n];if(s instanceof HTMLElement&&ji(s,e))return s}},ao=(t,e,r)=>{r===`${parseInt(r)}`&&(r=parseInt(r)),r||parseInt(r)===0?t.style.setProperty(e,typeof r=="number"?`${r}px`:r):t.style.removeProperty(e)},mn=(t,e="flex")=>{t&&(t.style.display=e)},jn=t=>{t&&(t.style.display="none")},wm=(t,e="block")=>{t&&new MutationObserver(()=>{cu(t,t.innerHTML,e)}).observe(t,{childList:!0,subtree:!0})},Xg=(t,e,r,n)=>{const s=t.querySelector(e);s&&s.style.setProperty(r,n)},cu=(t,e,r="flex")=>{e?mn(t,r):jn(t)},is=t=>!!(t&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),RC=()=>!is(Ti())&&!is(Co())&&!is(Nc()),nd=t=>t.scrollHeight>t.clientHeight,DC=(t,e)=>{let r=t;for(;r&&r!==e;){if(nd(r))return!0;r=r.parentElement}return!1},m_=t=>{const e=window.getComputedStyle(t),r=parseFloat(e.getPropertyValue("animation-duration")||"0"),n=parseFloat(e.getPropertyValue("transition-duration")||"0");return r>0||n>0},vm=(t,e=!1)=>{const r=bf();r&&is(r)&&(e&&(r.style.transition="none",r.style.width="100%"),setTimeout(()=>{r.style.transition=`width ${t/1e3}s linear`,r.style.width="0%"},10))},PC=()=>{const t=bf();if(!t)return;const e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const r=parseInt(window.getComputedStyle(t).width),n=e/r*100;t.style.width=`${n}%`},FC=()=>typeof window>"u"||typeof document>"u",NC=`
 <div aria-labelledby="${le.title}" aria-describedby="${le["html-container"]}" class="${le.popup}" tabindex="-1">
   <button type="button" class="${le.close}"></button>
   <ul class="${le["progress-steps"]}"></ul>
   <div class="${le.icon}"></div>
   <img class="${le.image}" />
   <h2 class="${le.title}" id="${le.title}"></h2>
   <div class="${le["html-container"]}" id="${le["html-container"]}"></div>
   <input class="${le.input}" id="${le.input}" />
   <input type="file" class="${le.file}" />
   <div class="${le.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${le.select}" id="${le.select}"></select>
   <div class="${le.radio}"></div>
   <label class="${le.checkbox}">
     <input type="checkbox" id="${le.checkbox}" />
     <span class="${le.label}"></span>
   </label>
   <textarea class="${le.textarea}" id="${le.textarea}"></textarea>
   <div class="${le["validation-message"]}" id="${le["validation-message"]}"></div>
   <div class="${le.actions}">
     <div class="${le.loader}"></div>
     <button type="button" class="${le.confirm}"></button>
     <button type="button" class="${le.deny}"></button>
     <button type="button" class="${le.cancel}"></button>
   </div>
   <div class="${le.footer}"></div>
   <div class="${le["timer-progress-bar-container"]}">
     <div class="${le["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),OC=()=>{const t=Yn();return t?(t.remove(),Fs([document.documentElement,document.body],[le["no-backdrop"],le["toast-shown"],le["has-column"]]),!0):!1},Xa=()=>{rt.currentInstance.resetValidationMessage()},LC=()=>{const t=Vt(),e=fa(t,le.input),r=fa(t,le.file),n=t.querySelector(`.${le.range} input`),s=t.querySelector(`.${le.range} output`),i=fa(t,le.select),a=t.querySelector(`.${le.checkbox} input`),o=fa(t,le.textarea);e.oninput=Xa,r.onchange=Xa,i.onchange=Xa,a.onchange=Xa,o.oninput=Xa,n.oninput=()=>{Xa(),s.value=n.value},n.onchange=()=>{Xa(),s.value=n.value}},MC=t=>typeof t=="string"?document.querySelector(t):t,BC=t=>{const e=Vt();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")},VC=t=>{window.getComputedStyle(t).direction==="rtl"&&$t(Yn(),le.rtl)},jC=t=>{const e=OC();if(FC()){Io("SweetAlert2 requires document to initialize");return}const r=document.createElement("div");r.className=le.container,e&&$t(r,le["no-transition"]),ys(r,NC),r.dataset.swal2Theme=t.theme;const n=MC(t.target);n.appendChild(r),t.topLayer&&(r.setAttribute("popover",""),r.showPopover()),BC(t),VC(n),LC()},_m=(t,e)=>{t instanceof HTMLElement?e.appendChild(t):typeof t=="object"?UC(t,e):t&&ys(e,t)},UC=(t,e)=>{t.jquery?WC(e,t):ys(e,t.toString())},WC=(t,e)=>{if(t.textContent="",0 in e)for(let r=0;r in e;r++)t.appendChild(e[r].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},$C=(t,e)=>{const r=ou(),n=Oc();!r||!n||(!e.showConfirmButton&&!e.showDenyButton&&!e.showCancelButton?jn(r):mn(r),ws(r,e,"actions"),zC(r,n,e),ys(n,e.loaderHtml||""),ws(n,e,"loader"))};function zC(t,e,r){const n=Ti(),s=Co(),i=Nc();!n||!s||!i||(h0(n,"confirm",r),h0(s,"deny",r),h0(i,"cancel",r),HC(n,s,i,r),r.reverseButtons&&(r.toast?(t.insertBefore(i,n),t.insertBefore(s,n)):(t.insertBefore(i,e),t.insertBefore(s,e),t.insertBefore(n,e))))}function HC(t,e,r,n){if(!n.buttonsStyling){Fs([t,e,r],le.styled);return}$t([t,e,r],le.styled),n.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",n.confirmButtonColor),n.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",n.denyButtonColor),n.cancelButtonColor&&r.style.setProperty("--swal2-cancel-button-background-color",n.cancelButtonColor),u0(t),u0(e),u0(r)}function u0(t){const e=window.getComputedStyle(t);if(e.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;const r=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-focus-box-shadow",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${r}`))}function h0(t,e,r){const n=um(e);cu(t,r[`show${n}Button`],"inline-block"),ys(t,r[`${e}ButtonText`]||""),t.setAttribute("aria-label",r[`${e}ButtonAriaLabel`]||""),t.className=le[e],ws(t,r,`${e}Button`)}const GC=(t,e)=>{const r=pm();r&&(ys(r,e.closeButtonHtml||""),ws(r,e,"closeButton"),cu(r,e.showCloseButton),r.setAttribute("aria-label",e.closeButtonAriaLabel||""))},qC=(t,e)=>{const r=Yn();r&&(XC(r,e.backdrop),KC(r,e.position),YC(r,e.grow),ws(r,e,"container"))};function XC(t,e){typeof e=="string"?t.style.background=e:e||$t([document.documentElement,document.body],le["no-backdrop"])}function KC(t,e){e&&(e in le?$t(t,le[e]):(Kn('The "position" parameter is not valid, defaulting to "center"'),$t(t,le.center)))}function YC(t,e){e&&$t(t,le[`grow-${e}`])}var cr={innerParams:new WeakMap,domCache:new WeakMap};const QC=["input","file","range","select","radio","checkbox","textarea"],JC=(t,e)=>{const r=Vt();if(!r)return;const n=cr.innerParams.get(t),s=!n||e.input!==n.input;QC.forEach(i=>{const a=fa(r,le[i]);a&&(t4(i,e.inputAttributes),a.className=le[i],s&&jn(a))}),e.input&&(s&&ZC(e),r4(e))},ZC=t=>{if(!t.input)return;if(!Or[t.input]){Io(`Unexpected type of input! Expected ${Object.keys(Or).join(" | ")}, got "${t.input}"`);return}const e=p_(t.input);if(!e)return;const r=Or[t.input](e,t);mn(e),t.inputAutoFocus&&setTimeout(()=>{f_(r)})},e4=t=>{for(let e=0;e<t.attributes.length;e++){const r=t.attributes[e].name;["id","type","value","style"].includes(r)||t.removeAttribute(r)}},t4=(t,e)=>{const r=Vt();if(!r)return;const n=Cf(r,t);if(n){e4(n);for(const s in e)n.setAttribute(s,e[s])}},r4=t=>{if(!t.input)return;const e=p_(t.input);e&&ws(e,t,"input")},ym=(t,e)=>{!t.placeholder&&e.inputPlaceholder&&(t.placeholder=e.inputPlaceholder)},lu=(t,e,r)=>{if(r.inputLabel){const n=document.createElement("label"),s=le["input-label"];n.setAttribute("for",t.id),n.className=s,typeof r.customClass=="object"&&$t(n,r.customClass.inputLabel),n.innerText=r.inputLabel,e.insertAdjacentElement("beforebegin",n)}},p_=t=>{const e=Vt();if(e)return fa(e,le[t]||le.input)},Ch=(t,e)=>{["string","number"].includes(typeof e)?t.value=`${e}`:fm(e)||Kn(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},Or={};Or.text=Or.email=Or.password=Or.number=Or.tel=Or.url=Or.search=Or.date=Or["datetime-local"]=Or.time=Or.week=Or.month=(t,e)=>(Ch(t,e.inputValue),lu(t,t,e),ym(t,e),t.type=e.input,t);Or.file=(t,e)=>(lu(t,t,e),ym(t,e),t);Or.range=(t,e)=>{const r=t.querySelector("input"),n=t.querySelector("output");return Ch(r,e.inputValue),r.type=e.input,Ch(n,e.inputValue),lu(r,t,e),t};Or.select=(t,e)=>{if(t.textContent="",e.inputPlaceholder){const r=document.createElement("option");ys(r,e.inputPlaceholder),r.value="",r.disabled=!0,r.selected=!0,t.appendChild(r)}return lu(t,t,e),t};Or.radio=t=>(t.textContent="",t);Or.checkbox=(t,e)=>{const r=Cf(Vt(),"checkbox");r.value="1",r.checked=!!e.inputValue;const n=t.querySelector("span");return ys(n,e.inputPlaceholder||e.inputLabel),r};Or.textarea=(t,e)=>{Ch(t,e.inputValue),ym(t,e),lu(t,t,e);const r=n=>parseInt(window.getComputedStyle(n).marginLeft)+parseInt(window.getComputedStyle(n).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const n=parseInt(window.getComputedStyle(Vt()).width),s=()=>{if(!document.body.contains(t))return;const i=t.offsetWidth+r(t);i>n?Vt().style.width=`${i}px`:ao(Vt(),"width",e.width)};new MutationObserver(s).observe(t,{attributes:!0,attributeFilter:["style"]})}}),t};const n4=(t,e)=>{const r=dm();r&&(wm(r),ws(r,e,"htmlContainer"),e.html?(_m(e.html,r),mn(r,"block")):e.text?(r.textContent=e.text,mn(r,"block")):jn(r),JC(t,e))},s4=(t,e)=>{const r=h_();r&&(wm(r),cu(r,e.footer,"block"),e.footer&&_m(e.footer,r),ws(r,e,"footer"))},i4=(t,e)=>{const r=cr.innerParams.get(t),n=Fc();if(!n)return;if(r&&e.icon===r.icon){Yg(n,e),Kg(n,e);return}if(!e.icon&&!e.iconHtml){jn(n);return}if(e.icon&&Object.keys(Ih).indexOf(e.icon)===-1){Io(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),jn(n);return}mn(n),Yg(n,e),Kg(n,e),$t(n,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",g_)},Kg=(t,e)=>{for(const[r,n]of Object.entries(Ih))e.icon!==r&&Fs(t,n);$t(t,e.icon&&Ih[e.icon]),c4(t,e),g_(),ws(t,e,"icon")},g_=()=>{const t=Vt();if(!t)return;const e=window.getComputedStyle(t).getPropertyValue("background-color"),r=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let n=0;n<r.length;n++)r[n].style.backgroundColor=e},a4=t=>`
  ${t.animation?'<div class="swal2-success-circular-line-left"></div>':""}
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div>
  ${t.animation?'<div class="swal2-success-fix"></div>':""}
  ${t.animation?'<div class="swal2-success-circular-line-right"></div>':""}
`,o4=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,Yg=(t,e)=>{if(!e.icon&&!e.iconHtml)return;let r=t.innerHTML,n="";e.iconHtml?n=Qg(e.iconHtml):e.icon==="success"?(n=a4(e),r=r.replace(/ style=".*?"/g,"")):e.icon==="error"?n=o4:e.icon&&(n=Qg({question:"?",warning:"!",info:"i"}[e.icon])),r.trim()!==n.trim()&&ys(t,n)},c4=(t,e)=>{if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(const r of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])Xg(t,r,"background-color",e.iconColor);Xg(t,".swal2-success-ring","border-color",e.iconColor)}},Qg=t=>`<div class="${le["icon-content"]}">${t}</div>`,l4=(t,e)=>{const r=u_();if(r){if(!e.imageUrl){jn(r);return}mn(r,""),r.setAttribute("src",e.imageUrl),r.setAttribute("alt",e.imageAlt||""),ao(r,"width",e.imageWidth),ao(r,"height",e.imageHeight),r.className=le.image,ws(r,e,"image")}};let Em=!1,x_=0,w_=0,v_=0,__=0;const u4=t=>{t.addEventListener("mousedown",Rh),document.body.addEventListener("mousemove",Dh),t.addEventListener("mouseup",Ph),t.addEventListener("touchstart",Rh),document.body.addEventListener("touchmove",Dh),t.addEventListener("touchend",Ph)},h4=t=>{t.removeEventListener("mousedown",Rh),document.body.removeEventListener("mousemove",Dh),t.removeEventListener("mouseup",Ph),t.removeEventListener("touchstart",Rh),document.body.removeEventListener("touchmove",Dh),t.removeEventListener("touchend",Ph)},Rh=t=>{const e=Vt();if(t.target===e||Fc().contains(t.target)){Em=!0;const r=y_(t);x_=r.clientX,w_=r.clientY,v_=parseInt(e.style.insetInlineStart)||0,__=parseInt(e.style.insetBlockStart)||0,$t(e,"swal2-dragging")}},Dh=t=>{const e=Vt();if(Em){let{clientX:r,clientY:n}=y_(t);e.style.insetInlineStart=`${v_+(r-x_)}px`,e.style.insetBlockStart=`${__+(n-w_)}px`}},Ph=()=>{const t=Vt();Em=!1,Fs(t,"swal2-dragging")},y_=t=>{let e=0,r=0;return t.type.startsWith("mouse")?(e=t.clientX,r=t.clientY):t.type.startsWith("touch")&&(e=t.touches[0].clientX,r=t.touches[0].clientY),{clientX:e,clientY:r}},f4=(t,e)=>{const r=Yn(),n=Vt();if(!(!r||!n)){if(e.toast){ao(r,"width",e.width),n.style.width="100%";const s=Oc();s&&n.insertBefore(s,Fc())}else ao(n,"width",e.width);ao(n,"padding",e.padding),e.color&&(n.style.color=e.color),e.background&&(n.style.background=e.background),jn(kf()),d4(n,e),e.draggable&&!e.toast?($t(n,le.draggable),u4(n)):(Fs(n,le.draggable),h4(n))}},d4=(t,e)=>{const r=e.showClass||{};t.className=`${le.popup} ${is(t)?r.popup:""}`,e.toast?($t([document.documentElement,document.body],le["toast-shown"]),$t(t,le.toast)):$t(t,le.modal),ws(t,e,"popup"),typeof e.customClass=="string"&&$t(t,e.customClass),e.icon&&$t(t,le[`icon-${e.icon}`])},m4=(t,e)=>{const r=mm();if(!r)return;const{progressSteps:n,currentProgressStep:s}=e;if(!n||n.length===0||s===void 0){jn(r);return}mn(r),r.textContent="",s>=n.length&&Kn("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),n.forEach((i,a)=>{const o=p4(i);if(r.appendChild(o),a===s&&$t(o,le["active-progress-step"]),a!==n.length-1){const c=g4(e);r.appendChild(c)}})},p4=t=>{const e=document.createElement("li");return $t(e,le["progress-step"]),ys(e,t),e},g4=t=>{const e=document.createElement("li");return $t(e,le["progress-step-line"]),t.progressStepsDistance&&ao(e,"width",t.progressStepsDistance),e},x4=(t,e)=>{const r=l_();r&&(wm(r),cu(r,e.title||e.titleText,"block"),e.title&&_m(e.title,r),e.titleText&&(r.innerText=e.titleText),ws(r,e,"title"))},E_=(t,e)=>{f4(t,e),qC(t,e),m4(t,e),i4(t,e),l4(t,e),x4(t,e),GC(t,e),n4(t,e),$C(t,e),s4(t,e);const r=Vt();typeof e.didRender=="function"&&r&&e.didRender(r),rt.eventEmitter.emit("didRender",r)},w4=()=>is(Vt()),T_=()=>{var t;return(t=Ti())===null||t===void 0?void 0:t.click()},v4=()=>{var t;return(t=Co())===null||t===void 0?void 0:t.click()},_4=()=>{var t;return(t=Nc())===null||t===void 0?void 0:t.click()},Lc=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),S_=t=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},y4=(t,e,r)=>{S_(t),e.toast||(t.keydownHandler=n=>T4(e,n,r),t.keydownTarget=e.keydownListenerCapture?window:Vt(),t.keydownListenerCapture=e.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},sd=(t,e)=>{var r;const n=gm();if(n.length){t=t+e,t===-2&&(t=n.length-1),t===n.length?t=0:t===-1&&(t=n.length-1),n[t].focus();return}(r=Vt())===null||r===void 0||r.focus()},A_=["ArrowRight","ArrowDown"],E4=["ArrowLeft","ArrowUp"],T4=(t,e,r)=>{t&&(e.isComposing||e.keyCode===229||(t.stopKeydownPropagation&&e.stopPropagation(),e.key==="Enter"?S4(e,t):e.key==="Tab"?A4(e):[...A_,...E4].includes(e.key)?k4(e.key):e.key==="Escape"&&b4(e,t,r)))},S4=(t,e)=>{if(!Af(e.allowEnterKey))return;const r=Cf(Vt(),e.input);if(t.target&&r&&t.target instanceof HTMLElement&&t.target.outerHTML===r.outerHTML){if(["textarea","file"].includes(e.input))return;T_(),t.preventDefault()}},A4=t=>{const e=t.target,r=gm();let n=-1;for(let s=0;s<r.length;s++)if(e===r[s]){n=s;break}t.shiftKey?sd(n,-1):sd(n,1),t.stopPropagation(),t.preventDefault()},k4=t=>{const e=ou(),r=Ti(),n=Co(),s=Nc();if(!e||!r||!n||!s)return;const i=[r,n,s];if(document.activeElement instanceof HTMLElement&&!i.includes(document.activeElement))return;const a=A_.includes(t)?"nextElementSibling":"previousElementSibling";let o=document.activeElement;if(o){for(let c=0;c<e.children.length;c++){if(o=o[a],!o)return;if(o instanceof HTMLButtonElement&&is(o))break}o instanceof HTMLButtonElement&&o.focus()}},b4=(t,e,r)=>{t.preventDefault(),Af(e.allowEscapeKey)&&r(Lc.esc)};var wc={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const I4=()=>{const t=Yn();Array.from(document.body.children).forEach(r=>{r.contains(t)||(r.hasAttribute("aria-hidden")&&r.setAttribute("data-previous-aria-hidden",r.getAttribute("aria-hidden")||""),r.setAttribute("aria-hidden","true"))})},k_=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},b_=typeof window<"u"&&!!window.GestureEvent,C4=()=>{if(b_&&!ji(document.body,le.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,$t(document.body,le.iosfix),R4()}},R4=()=>{const t=Yn();if(!t)return;let e;t.ontouchstart=r=>{e=D4(r)},t.ontouchmove=r=>{e&&(r.preventDefault(),r.stopPropagation())}},D4=t=>{const e=t.target,r=Yn(),n=dm();return!r||!n||P4(t)||F4(t)?!1:e===r||!nd(r)&&e instanceof HTMLElement&&!DC(e,n)&&e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&!(nd(n)&&n.contains(e))},P4=t=>t.touches&&t.touches.length&&t.touches[0].touchType==="stylus",F4=t=>t.touches&&t.touches.length>1,N4=()=>{if(ji(document.body,le.iosfix)){const t=parseInt(document.body.style.top,10);Fs(document.body,le.iosfix),document.body.style.top="",document.body.scrollTop=t*-1}},O4=()=>{const t=document.createElement("div");t.className=le["scrollbar-measure"],document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e};let sc=null;const L4=t=>{sc===null&&(document.body.scrollHeight>window.innerHeight||t==="scroll")&&(sc=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${sc+O4()}px`)},M4=()=>{sc!==null&&(document.body.style.paddingRight=`${sc}px`,sc=null)};function I_(t,e,r,n){If()?Jg(t,n):(yC(r).then(()=>Jg(t,n)),S_(rt)),b_?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),xm()&&(M4(),N4(),k_()),B4()}function B4(){Fs([document.documentElement,document.body],[le.shown,le["height-auto"],le["no-backdrop"],le["toast-shown"]])}function da(t){t=j4(t);const e=wc.swalPromiseResolve.get(this),r=V4(this);this.isAwaitingPromise?t.isDismissed||(uu(this),e(t)):r&&e(t)}const V4=t=>{const e=Vt();if(!e)return!1;const r=cr.innerParams.get(t);if(!r||ji(e,r.hideClass.popup))return!1;Fs(e,r.showClass.popup),$t(e,r.hideClass.popup);const n=Yn();return Fs(n,r.showClass.backdrop),$t(n,r.hideClass.backdrop),U4(t,e,r),!0};function C_(t){const e=wc.swalPromiseReject.get(this);uu(this),e&&e(t)}const uu=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,cr.innerParams.get(t)||t._destroy())},j4=t=>typeof t>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),U4=(t,e,r)=>{var n;const s=Yn(),i=m_(e);typeof r.willClose=="function"&&r.willClose(e),(n=rt.eventEmitter)===null||n===void 0||n.emit("willClose",e),i?W4(t,e,s,r.returnFocus,r.didClose):I_(t,s,r.returnFocus,r.didClose)},W4=(t,e,r,n,s)=>{rt.swalCloseEventFinishedCallback=I_.bind(null,t,r,n,s);const i=function(a){if(a.target===e){var o;(o=rt.swalCloseEventFinishedCallback)===null||o===void 0||o.call(rt),delete rt.swalCloseEventFinishedCallback,e.removeEventListener("animationend",i),e.removeEventListener("transitionend",i)}};e.addEventListener("animationend",i),e.addEventListener("transitionend",i)},Jg=(t,e)=>{setTimeout(()=>{var r;typeof e=="function"&&e.bind(t.params)(),(r=rt.eventEmitter)===null||r===void 0||r.emit("didClose"),t._destroy&&t._destroy()})},vc=t=>{let e=Vt();if(e||new Re,e=Vt(),!e)return;const r=Oc();If()?jn(Fc()):$4(e,t),mn(r),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},$4=(t,e)=>{const r=ou(),n=Oc();!r||!n||(!e&&is(Ti())&&(e=Ti()),mn(r),e&&(jn(e),n.setAttribute("data-button-to-replace",e.className),r.insertBefore(n,e)),$t([t,r],le.loading))},z4=(t,e)=>{e.input==="select"||e.input==="radio"?K4(t,e):["text","email","number","tel","textarea"].some(r=>r===e.input)&&(hm(e.inputValue)||fm(e.inputValue))&&(vc(Ti()),Y4(t,e))},H4=(t,e)=>{const r=t.getInput();if(!r)return null;switch(e.input){case"checkbox":return G4(r);case"radio":return q4(r);case"file":return X4(r);default:return e.inputAutoTrim?r.value.trim():r.value}},G4=t=>t.checked?1:0,q4=t=>t.checked?t.value:null,X4=t=>t.files&&t.files.length?t.getAttribute("multiple")!==null?t.files:t.files[0]:null,K4=(t,e)=>{const r=Vt();if(!r)return;const n=s=>{e.input==="select"?Q4(r,Fh(s),e):e.input==="radio"&&J4(r,Fh(s),e)};hm(e.inputOptions)||fm(e.inputOptions)?(vc(Ti()),iu(e.inputOptions).then(s=>{t.hideLoading(),n(s)})):typeof e.inputOptions=="object"?n(e.inputOptions):Io(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof e.inputOptions}`)},Y4=(t,e)=>{const r=t.getInput();r&&(jn(r),iu(e.inputValue).then(n=>{r.value=e.input==="number"?`${parseFloat(n)||0}`:`${n}`,mn(r),r.focus(),t.hideLoading()}).catch(n=>{Io(`Error in inputValue promise: ${n}`),r.value="",mn(r),r.focus(),t.hideLoading()}))};function Q4(t,e,r){const n=fa(t,le.select);if(!n)return;const s=(i,a,o)=>{const c=document.createElement("option");c.value=o,ys(c,a),c.selected=R_(o,r.inputValue),i.appendChild(c)};e.forEach(i=>{const a=i[0],o=i[1];if(Array.isArray(o)){const c=document.createElement("optgroup");c.label=a,c.disabled=!1,n.appendChild(c),o.forEach(l=>s(c,l[1],l[0]))}else s(n,o,a)}),n.focus()}function J4(t,e,r){const n=fa(t,le.radio);if(!n)return;e.forEach(i=>{const a=i[0],o=i[1],c=document.createElement("input"),l=document.createElement("label");c.type="radio",c.name=le.radio,c.value=a,R_(a,r.inputValue)&&(c.checked=!0);const h=document.createElement("span");ys(h,o),h.className=le.label,l.appendChild(c),l.appendChild(h),n.appendChild(l)});const s=n.querySelectorAll("input");s.length&&s[0].focus()}const Fh=t=>{const e=[];return t instanceof Map?t.forEach((r,n)=>{let s=r;typeof s=="object"&&(s=Fh(s)),e.push([n,s])}):Object.keys(t).forEach(r=>{let n=t[r];typeof n=="object"&&(n=Fh(n)),e.push([r,n])}),e},R_=(t,e)=>!!e&&e.toString()===t.toString(),Z4=t=>{const e=cr.innerParams.get(t);t.disableButtons(),e.input?D_(t,"confirm"):Sm(t,!0)},eR=t=>{const e=cr.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?D_(t,"deny"):Tm(t,!1)},tR=(t,e)=>{t.disableButtons(),e(Lc.cancel)},D_=(t,e)=>{const r=cr.innerParams.get(t);if(!r.input){Io(`The "input" parameter is needed to be set when using returnInputValueOn${um(e)}`);return}const n=t.getInput(),s=H4(t,r);r.inputValidator?rR(t,s,e):n&&!n.checkValidity()?(t.enableButtons(),t.showValidationMessage(r.validationMessage||n.validationMessage)):e==="deny"?Tm(t,s):Sm(t,s)},rR=(t,e,r)=>{const n=cr.innerParams.get(t);t.disableInput(),Promise.resolve().then(()=>iu(n.inputValidator(e,n.validationMessage))).then(i=>{t.enableButtons(),t.enableInput(),i?t.showValidationMessage(i):r==="deny"?Tm(t,e):Sm(t,e)})},Tm=(t,e)=>{const r=cr.innerParams.get(t||void 0);r.showLoaderOnDeny&&vc(Co()),r.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then(()=>iu(r.preDeny(e,r.validationMessage))).then(s=>{s===!1?(t.hideLoading(),uu(t)):t.close({isDenied:!0,value:typeof s>"u"?e:s})}).catch(s=>P_(t||void 0,s))):t.close({isDenied:!0,value:e})},Zg=(t,e)=>{t.close({isConfirmed:!0,value:e})},P_=(t,e)=>{t.rejectPromise(e)},Sm=(t,e)=>{const r=cr.innerParams.get(t||void 0);r.showLoaderOnConfirm&&vc(),r.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then(()=>iu(r.preConfirm(e,r.validationMessage))).then(s=>{is(kf())||s===!1?(t.hideLoading(),uu(t)):Zg(t,typeof s>"u"?e:s)}).catch(s=>P_(t||void 0,s))):Zg(t,e)};function Nh(){const t=cr.innerParams.get(this);if(!t)return;const e=cr.domCache.get(this);jn(e.loader),If()?t.icon&&mn(Fc()):nR(e),Fs([e.popup,e.actions],le.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const nR=t=>{const e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?mn(e[0],"inline-block"):RC()&&jn(t.actions)};function F_(){const t=cr.innerParams.get(this),e=cr.domCache.get(this);return e?Cf(e.popup,t.input):null}function N_(t,e,r){const n=cr.domCache.get(t);e.forEach(s=>{n[s].disabled=r})}function O_(t,e){const r=Vt();if(!(!r||!t))if(t.type==="radio"){const n=r.querySelectorAll(`[name="${le.radio}"]`);for(let s=0;s<n.length;s++)n[s].disabled=e}else t.disabled=e}function L_(){N_(this,["confirmButton","denyButton","cancelButton"],!1)}function M_(){N_(this,["confirmButton","denyButton","cancelButton"],!0)}function B_(){O_(this.getInput(),!1)}function V_(){O_(this.getInput(),!0)}function j_(t){const e=cr.domCache.get(this),r=cr.innerParams.get(this);ys(e.validationMessage,t),e.validationMessage.className=le["validation-message"],r.customClass&&r.customClass.validationMessage&&$t(e.validationMessage,r.customClass.validationMessage),mn(e.validationMessage);const n=this.getInput();n&&(n.setAttribute("aria-invalid","true"),n.setAttribute("aria-describedby",le["validation-message"]),f_(n),$t(n,le.inputerror))}function U_(){const t=cr.domCache.get(this);t.validationMessage&&jn(t.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),Fs(e,le.inputerror))}const ic={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},sR=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],iR={allowEnterKey:void 0},aR=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],W_=t=>Object.prototype.hasOwnProperty.call(ic,t),$_=t=>sR.indexOf(t)!==-1,z_=t=>iR[t],oR=t=>{W_(t)||Kn(`Unknown parameter "${t}"`)},cR=t=>{aR.includes(t)&&Kn(`The parameter "${t}" is incompatible with toasts`)},lR=t=>{const e=z_(t);e&&c_(t,e)},H_=t=>{t.backdrop===!1&&t.allowOutsideClick&&Kn('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","minimal","borderless","embed-iframe","bulma","bulma-light","bulma-dark"].includes(t.theme)&&Kn(`Invalid theme "${t.theme}"`);for(const e in t)oR(e),t.toast&&cR(e),lR(e)};function G_(t){const e=Yn(),r=Vt(),n=cr.innerParams.get(this);if(!r||ji(r,n.hideClass.popup)){Kn("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const s=uR(t),i=Object.assign({},n,s);H_(i),e.dataset.swal2Theme=i.theme,E_(this,i),cr.innerParams.set(this,i),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const uR=t=>{const e={};return Object.keys(t).forEach(r=>{$_(r)?e[r]=t[r]:Kn(`Invalid parameter to update: ${r}`)}),e};function q_(){const t=cr.domCache.get(this),e=cr.innerParams.get(this);if(!e){X_(this);return}t.popup&&rt.swalCloseEventFinishedCallback&&(rt.swalCloseEventFinishedCallback(),delete rt.swalCloseEventFinishedCallback),typeof e.didDestroy=="function"&&e.didDestroy(),rt.eventEmitter.emit("didDestroy"),hR(this)}const hR=t=>{X_(t),delete t.params,delete rt.keydownHandler,delete rt.keydownTarget,delete rt.currentInstance},X_=t=>{t.isAwaitingPromise?(f0(cr,t),t.isAwaitingPromise=!0):(f0(wc,t),f0(cr,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},f0=(t,e)=>{for(const r in t)t[r].delete(e)};var fR=Object.freeze({__proto__:null,_destroy:q_,close:da,closeModal:da,closePopup:da,closeToast:da,disableButtons:M_,disableInput:V_,disableLoading:Nh,enableButtons:L_,enableInput:B_,getInput:F_,handleAwaitingPromise:uu,hideLoading:Nh,rejectPromise:C_,resetValidationMessage:U_,showValidationMessage:j_,update:G_});const dR=(t,e,r)=>{t.toast?mR(t,e,r):(gR(e),xR(e),wR(t,e,r))},mR=(t,e,r)=>{e.popup.onclick=()=>{t&&(pR(t)||t.timer||t.input)||r(Lc.close)}},pR=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let Oh=!1;const gR=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(e){t.container.onmouseup=()=>{},e.target===t.container&&(Oh=!0)}}},xR=t=>{t.container.onmousedown=e=>{e.target===t.container&&e.preventDefault(),t.popup.onmouseup=function(r){t.popup.onmouseup=()=>{},(r.target===t.popup||r.target instanceof HTMLElement&&t.popup.contains(r.target))&&(Oh=!0)}}},wR=(t,e,r)=>{e.container.onclick=n=>{if(Oh){Oh=!1;return}n.target===e.container&&Af(t.allowOutsideClick)&&r(Lc.backdrop)}},vR=t=>typeof t=="object"&&t.jquery,e1=t=>t instanceof Element||vR(t),_R=t=>{const e={};return typeof t[0]=="object"&&!e1(t[0])?Object.assign(e,t[0]):["title","html","icon"].forEach((r,n)=>{const s=t[n];typeof s=="string"||e1(s)?e[r]=s:s!==void 0&&Io(`Unexpected type of ${r}! Expected "string" or "Element", got ${typeof s}`)}),e};function yR(...t){return new this(...t)}function ER(t){class e extends this{_main(n,s){return super._main(n,Object.assign({},t,s))}}return e}const TR=()=>rt.timeout&&rt.timeout.getTimerLeft(),K_=()=>{if(rt.timeout)return PC(),rt.timeout.stop()},Y_=()=>{if(rt.timeout){const t=rt.timeout.start();return vm(t),t}},SR=()=>{const t=rt.timeout;return t&&(t.running?K_():Y_())},AR=t=>{if(rt.timeout){const e=rt.timeout.increase(t);return vm(e,!0),e}},kR=()=>!!(rt.timeout&&rt.timeout.isRunning());let t1=!1;const id={};function bR(t="data-swal-template"){id[t]=this,t1||(document.body.addEventListener("click",IR),t1=!0)}const IR=t=>{for(let e=t.target;e&&e!==document;e=e.parentNode)for(const r in id){const n=e.getAttribute(r);if(n){id[r].fire({template:n});return}}};class CR{constructor(){this.events={}}_getHandlersByEventName(e){return typeof this.events[e]>"u"&&(this.events[e]=[]),this.events[e]}on(e,r){const n=this._getHandlersByEventName(e);n.includes(r)||n.push(r)}once(e,r){const n=(...s)=>{this.removeListener(e,n),r.apply(this,s)};this.on(e,n)}emit(e,...r){this._getHandlersByEventName(e).forEach(n=>{try{n.apply(this,r)}catch(s){console.error(s)}})}removeListener(e,r){const n=this._getHandlersByEventName(e),s=n.indexOf(r);s>-1&&n.splice(s,1)}removeAllListeners(e){this.events[e]!==void 0&&(this.events[e].length=0)}reset(){this.events={}}}rt.eventEmitter=new CR;const RR=(t,e)=>{rt.eventEmitter.on(t,e)},DR=(t,e)=>{rt.eventEmitter.once(t,e)},PR=(t,e)=>{if(!t){rt.eventEmitter.reset();return}e?rt.eventEmitter.removeListener(t,e):rt.eventEmitter.removeAllListeners(t)};var FR=Object.freeze({__proto__:null,argsToParams:_R,bindClickHandler:bR,clickCancel:_4,clickConfirm:T_,clickDeny:v4,enableLoading:vc,fire:yR,getActions:ou,getCancelButton:Nc,getCloseButton:pm,getConfirmButton:Ti,getContainer:Yn,getDenyButton:Co,getFocusableElements:gm,getFooter:h_,getHtmlContainer:dm,getIcon:Fc,getIconContent:AC,getImage:u_,getInputLabel:kC,getLoader:Oc,getPopup:Vt,getProgressSteps:mm,getTimerLeft:TR,getTimerProgressBar:bf,getTitle:l_,getValidationMessage:kf,increaseTimer:AR,isDeprecatedParameter:z_,isLoading:IC,isTimerRunning:kR,isUpdatableParameter:$_,isValidParameter:W_,isVisible:w4,mixin:ER,off:PR,on:RR,once:DR,resumeTimer:Y_,showLoading:vc,stopTimer:K_,toggleTimer:SR});class NR{constructor(e,r){this.callback=e,this.remaining=r,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(e){const r=this.running;return r&&this.stop(),this.remaining+=e,r&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const Q_=["swal-title","swal-html","swal-footer"],OR=t=>{const e=typeof t.template=="string"?document.querySelector(t.template):t.template;if(!e)return{};const r=e.content;return $R(r),Object.assign(LR(r),MR(r),BR(r),VR(r),jR(r),UR(r),WR(r,Q_))},LR=t=>{const e={};return Array.from(t.querySelectorAll("swal-param")).forEach(n=>{wo(n,["name","value"]);const s=n.getAttribute("name"),i=n.getAttribute("value");!s||!i||(typeof ic[s]=="boolean"?e[s]=i!=="false":typeof ic[s]=="object"?e[s]=JSON.parse(i):e[s]=i)}),e},MR=t=>{const e={};return Array.from(t.querySelectorAll("swal-function-param")).forEach(n=>{const s=n.getAttribute("name"),i=n.getAttribute("value");!s||!i||(e[s]=new Function(`return ${i}`)())}),e},BR=t=>{const e={};return Array.from(t.querySelectorAll("swal-button")).forEach(n=>{wo(n,["type","color","aria-label"]);const s=n.getAttribute("type");!s||!["confirm","cancel","deny"].includes(s)||(e[`${s}ButtonText`]=n.innerHTML,e[`show${um(s)}Button`]=!0,n.hasAttribute("color")&&(e[`${s}ButtonColor`]=n.getAttribute("color")),n.hasAttribute("aria-label")&&(e[`${s}ButtonAriaLabel`]=n.getAttribute("aria-label")))}),e},VR=t=>{const e={},r=t.querySelector("swal-image");return r&&(wo(r,["src","width","height","alt"]),r.hasAttribute("src")&&(e.imageUrl=r.getAttribute("src")||void 0),r.hasAttribute("width")&&(e.imageWidth=r.getAttribute("width")||void 0),r.hasAttribute("height")&&(e.imageHeight=r.getAttribute("height")||void 0),r.hasAttribute("alt")&&(e.imageAlt=r.getAttribute("alt")||void 0)),e},jR=t=>{const e={},r=t.querySelector("swal-icon");return r&&(wo(r,["type","color"]),r.hasAttribute("type")&&(e.icon=r.getAttribute("type")),r.hasAttribute("color")&&(e.iconColor=r.getAttribute("color")),e.iconHtml=r.innerHTML),e},UR=t=>{const e={},r=t.querySelector("swal-input");r&&(wo(r,["type","label","placeholder","value"]),e.input=r.getAttribute("type")||"text",r.hasAttribute("label")&&(e.inputLabel=r.getAttribute("label")),r.hasAttribute("placeholder")&&(e.inputPlaceholder=r.getAttribute("placeholder")),r.hasAttribute("value")&&(e.inputValue=r.getAttribute("value")));const n=Array.from(t.querySelectorAll("swal-input-option"));return n.length&&(e.inputOptions={},n.forEach(s=>{wo(s,["value"]);const i=s.getAttribute("value");if(!i)return;const a=s.innerHTML;e.inputOptions[i]=a})),e},WR=(t,e)=>{const r={};for(const n in e){const s=e[n],i=t.querySelector(s);i&&(wo(i,[]),r[s.replace(/^swal-/,"")]=i.innerHTML.trim())}return r},$R=t=>{const e=Q_.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach(r=>{const n=r.tagName.toLowerCase();e.includes(n)||Kn(`Unrecognized element <${n}>`)})},wo=(t,e)=>{Array.from(t.attributes).forEach(r=>{e.indexOf(r.name)===-1&&Kn([`Unrecognized attribute "${r.name}" on <${t.tagName.toLowerCase()}>.`,`${e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."}`])})},J_=10,zR=t=>{const e=Yn(),r=Vt();typeof t.willOpen=="function"&&t.willOpen(r),rt.eventEmitter.emit("willOpen",r);const s=window.getComputedStyle(document.body).overflowY;qR(e,r,t),setTimeout(()=>{HR(e,r)},J_),xm()&&(GR(e,t.scrollbarPadding,s),I4()),!If()&&!rt.previousActiveElement&&(rt.previousActiveElement=document.activeElement),typeof t.didOpen=="function"&&setTimeout(()=>t.didOpen(r)),rt.eventEmitter.emit("didOpen",r),Fs(e,le["no-transition"])},Lh=t=>{const e=Vt();if(t.target!==e)return;const r=Yn();e.removeEventListener("animationend",Lh),e.removeEventListener("transitionend",Lh),r.style.overflowY="auto"},HR=(t,e)=>{m_(e)?(t.style.overflowY="hidden",e.addEventListener("animationend",Lh),e.addEventListener("transitionend",Lh)):t.style.overflowY="auto"},GR=(t,e,r)=>{C4(),e&&r!=="hidden"&&L4(r),setTimeout(()=>{t.scrollTop=0})},qR=(t,e,r)=>{$t(t,r.showClass.backdrop),r.animation?(e.style.setProperty("opacity","0","important"),mn(e,"grid"),setTimeout(()=>{$t(e,r.showClass.popup),e.style.removeProperty("opacity")},J_)):mn(e,"grid"),$t([document.documentElement,document.body],le.shown),r.heightAuto&&r.backdrop&&!r.toast&&$t([document.documentElement,document.body],le["height-auto"])};var r1={email:(t,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address"),url:(t,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")};function XR(t){t.inputValidator||(t.input==="email"&&(t.inputValidator=r1.email),t.input==="url"&&(t.inputValidator=r1.url))}function KR(t){(!t.target||typeof t.target=="string"&&!document.querySelector(t.target)||typeof t.target!="string"&&!t.target.appendChild)&&(Kn('Target parameter is not valid, defaulting to "body"'),t.target="body")}function YR(t){XR(t),t.showLoaderOnConfirm&&!t.preConfirm&&Kn(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),KR(t),typeof t.title=="string"&&(t.title=t.title.split(`
`).join("<br />")),jC(t)}let gi;var Vu=new WeakMap;class Vr{constructor(...e){if(xC(this,Vu,void 0),typeof window>"u")return;gi=this;const r=Object.freeze(this.constructor.argsToParams(e));this.params=r,this.isAwaitingPromise=!1,wC(Vu,this,this._main(gi.params))}_main(e,r={}){if(H_(Object.assign({},r,e)),rt.currentInstance){const i=wc.swalPromiseResolve.get(rt.currentInstance),{isAwaitingPromise:a}=rt.currentInstance;rt.currentInstance._destroy(),a||i({isDismissed:!0}),xm()&&k_()}rt.currentInstance=gi;const n=JR(e,r);YR(n),Object.freeze(n),rt.timeout&&(rt.timeout.stop(),delete rt.timeout),clearTimeout(rt.restoreFocusTimeout);const s=ZR(gi);return E_(gi,n),cr.innerParams.set(gi,n),QR(gi,s,n)}then(e){return Gg(Vu,this).then(e)}finally(e){return Gg(Vu,this).finally(e)}}const QR=(t,e,r)=>new Promise((n,s)=>{const i=a=>{t.close({isDismissed:!0,dismiss:a})};wc.swalPromiseResolve.set(t,n),wc.swalPromiseReject.set(t,s),e.confirmButton.onclick=()=>{Z4(t)},e.denyButton.onclick=()=>{eR(t)},e.cancelButton.onclick=()=>{tR(t,i)},e.closeButton.onclick=()=>{i(Lc.close)},dR(r,e,i),y4(rt,r,i),z4(t,r),zR(r),eD(rt,r,i),tD(e,r),setTimeout(()=>{e.container.scrollTop=0})}),JR=(t,e)=>{const r=OR(t),n=Object.assign({},ic,e,r,t);return n.showClass=Object.assign({},ic.showClass,n.showClass),n.hideClass=Object.assign({},ic.hideClass,n.hideClass),n.animation===!1&&(n.showClass={backdrop:"swal2-noanimation"},n.hideClass={}),n},ZR=t=>{const e={popup:Vt(),container:Yn(),actions:ou(),confirmButton:Ti(),denyButton:Co(),cancelButton:Nc(),loader:Oc(),closeButton:pm(),validationMessage:kf(),progressSteps:mm()};return cr.domCache.set(t,e),e},eD=(t,e,r)=>{const n=bf();jn(n),e.timer&&(t.timeout=new NR(()=>{r("timer"),delete t.timeout},e.timer),e.timerProgressBar&&(mn(n),ws(n,e,"timerProgressBar"),setTimeout(()=>{t.timeout&&t.timeout.running&&vm(e.timer)})))},tD=(t,e)=>{if(!e.toast){if(!Af(e.allowEnterKey)){c_("allowEnterKey"),sD();return}rD(t)||nD(t,e)||sd(-1,1)}},rD=t=>{const e=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const r of e)if(r instanceof HTMLElement&&is(r))return r.focus(),!0;return!1},nD=(t,e)=>e.focusDeny&&is(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&is(t.cancelButton)?(t.cancelButton.focus(),!0):e.focusConfirm&&is(t.confirmButton)?(t.confirmButton.focus(),!0):!1,sD=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};Vr.prototype.disableButtons=M_;Vr.prototype.enableButtons=L_;Vr.prototype.getInput=F_;Vr.prototype.disableInput=V_;Vr.prototype.enableInput=B_;Vr.prototype.hideLoading=Nh;Vr.prototype.disableLoading=Nh;Vr.prototype.showValidationMessage=j_;Vr.prototype.resetValidationMessage=U_;Vr.prototype.close=da;Vr.prototype.closePopup=da;Vr.prototype.closeModal=da;Vr.prototype.closeToast=da;Vr.prototype.rejectPromise=C_;Vr.prototype.update=G_;Vr.prototype._destroy=q_;Object.assign(Vr,FR);Object.keys(fR).forEach(t=>{Vr[t]=function(...e){return gi&&gi[t]?gi[t](...e):null}});Vr.DismissReason=Lc;Vr.version="11.22.5";const Re=Vr;Re.default=Re;typeof document<"u"&&(function(t,e){var r=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(r),r.styleSheet)r.styleSheet.disabled||(r.styleSheet.cssText=e);else try{r.innerHTML=e}catch{r.innerText=e}})(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px $swal2-outline-color;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-timer-progress-bar-background: rgba(0, 0, 0, 0.3);--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:var(--swal2-timer-progress-bar-background)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');const iD="/assets/logo-DX0DPFAu.png",xB=()=>m.jsx(Ge,{component:"footer",sx:{py:3,px:2,backgroundColor:t=>t.palette.grey[100],borderTop:1,borderColor:"divider",position:"sticky",bottom:0,zIndex:1,width:"100%"},children:m.jsx(cE,{maxWidth:"lg",children:m.jsxs(_e,{variant:"body2",color:"text.secondary",align:"center",sx:{fontSize:"0.875rem"},children:[" ",new Date().getFullYear()," deviceCheck. All rights reserved."]})})}),aD=async t=>{try{const e=lm();return await Vv(e,t),{success:!0,message:"   ."}}catch(e){return console.error("    :",e),{success:!1,message:`  : ${e.message}`}}},oD=async t=>{try{const{db:e}=await ro(async()=>{const{db:l}=await Promise.resolve().then(()=>n_);return{db:l}},void 0),{collection:r,query:n,where:s,getDocs:i}=await ro(async()=>{const{collection:l,query:h,where:d,getDocs:f}=await Promise.resolve().then(()=>J0);return{collection:l,query:h,where:d,getDocs:f}},void 0),a=r(e,"accounts"),o=n(a,s("email","==",t)),c=await i(o);return c.empty?{success:!1,message:"    ."}:{success:!0,user:c.docs[0].data()}}catch(e){return console.error("  :",e),{success:!1,message:`  : ${e.message}`}}},cD=()=>{const[t,e]=$e.useState([]),[r,n]=$e.useState([]),[s,i]=$e.useState(!0),[a,o]=$e.useState({majorCategory:"",middleCategory:"",minorCategory:"",userRole:"",action:"",startDate:"",endDate:""});$e.useEffect(()=>{c()},[]),$e.useEffect(()=>{l()},[t,a]);const c=async()=>{try{i(!0);const A=We(ce,"system_logs"),F=St(A,Zd("timestamp","desc")),W=(await tt(F)).docs.map(U=>({id:U.id,...U.data(),timestamp:U.data().timestamp?.toDate?.()||new Date(U.data().timestamp)}));e(W)}catch(A){console.error("  :",A)}finally{i(!1)}},l=()=>{let A=[...t];a.majorCategory&&(A=A.filter(F=>F.majorCategory===a.majorCategory)),a.middleCategory&&(A=A.filter(F=>F.middleCategory===a.middleCategory)),a.minorCategory&&(A=A.filter(F=>F.minorCategory===a.minorCategory)),a.userRole&&(A=A.filter(F=>F.userRole===a.userRole)),a.action&&(A=A.filter(F=>F.action.includes(a.action))),a.startDate&&(A=A.filter(F=>F.timestamp>=new Date(a.startDate))),a.endDate&&(A=A.filter(F=>F.timestamp<=new Date(a.endDate+"T23:59:59"))),n(A)},h=A=>({" ":"primary"," ":"secondary"," ":"success"," ":"warning",:"error"," ":"info"})[A]||"default",d=A=>A.includes("")||A.includes("")?"success":A.includes("")?"warning":A.includes("")?"error":A.includes("")?"info":"default",f=A=>A?new Date(A).toLocaleString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-",g=[...new Set(t.map(A=>A.majorCategory))].filter(Boolean),w=[...new Set(t.map(A=>A.middleCategory))].filter(Boolean),x=[...new Set(t.map(A=>A.minorCategory))].filter(Boolean),y=[...new Set(t.map(A=>A.userRole))].filter(Boolean);return m.jsxs(Ge,{sx:{width:"100%",maxWidth:"100%",minWidth:"100%"},children:[m.jsxs(Tt,{container:!0,spacing:2,sx:{mb:3,width:"100%"},children:[m.jsx(Tt,{item:!0,xs:6,sm:3,children:m.jsx(In,{children:m.jsxs(Cn,{sx:{textAlign:"center",p:2},children:[m.jsx(_e,{variant:"h5",color:"primary.main",children:t.length}),m.jsx(_e,{variant:"body2",color:"text.secondary",children:" "})]})})}),m.jsx(Tt,{item:!0,xs:6,sm:3,children:m.jsx(In,{children:m.jsxs(Cn,{sx:{textAlign:"center",p:2},children:[m.jsx(_e,{variant:"h5",color:"success.main",children:r.length}),m.jsx(_e,{variant:"body2",color:"text.secondary",children:" "})]})})}),m.jsx(Tt,{item:!0,xs:6,sm:3,children:m.jsx(In,{children:m.jsxs(Cn,{sx:{textAlign:"center",p:2},children:[m.jsx(_e,{variant:"h5",color:"info.main",children:g.length}),m.jsx(_e,{variant:"body2",color:"text.secondary",children:""})]})})}),m.jsx(Tt,{item:!0,xs:6,sm:3,children:m.jsx(In,{children:m.jsxs(Cn,{sx:{textAlign:"center",p:2},children:[m.jsx(_e,{variant:"h5",color:"warning.main",children:y.length}),m.jsx(_e,{variant:"body2",color:"text.secondary",children:" "})]})})})]}),m.jsxs(ua,{sx:{p:2,mb:2,width:"100%",maxWidth:"100%"},children:[m.jsx(_e,{variant:"h6",gutterBottom:!0,children:""}),m.jsxs(Tt,{container:!0,spacing:2,sx:{width:"100%"},children:[m.jsx(Tt,{item:!0,xs:12,sm:6,md:3,children:m.jsxs(qs,{fullWidth:!0,children:[m.jsx(Xs,{children:""}),m.jsxs(Ks,{value:a.majorCategory,onChange:A=>o({...a,majorCategory:A.target.value}),size:"small",children:[m.jsx(Nr,{value:"",children:""}),g.map(A=>m.jsx(Nr,{value:A,children:A},A))]})]})}),m.jsx(Tt,{item:!0,xs:12,sm:6,md:3,children:m.jsxs(qs,{fullWidth:!0,children:[m.jsx(Xs,{children:""}),m.jsxs(Ks,{value:a.middleCategory,onChange:A=>o({...a,middleCategory:A.target.value}),size:"small",children:[m.jsx(Nr,{value:"",children:""}),w.map(A=>m.jsx(Nr,{value:A,children:A},A))]})]})}),m.jsx(Tt,{item:!0,xs:12,sm:6,md:3,children:m.jsxs(qs,{fullWidth:!0,children:[m.jsx(Xs,{children:""}),m.jsxs(Ks,{value:a.minorCategory,onChange:A=>o({...a,minorCategory:A.target.value}),size:"small",children:[m.jsx(Nr,{value:"",children:""}),x.map(A=>m.jsx(Nr,{value:A,children:A},A))]})]})}),m.jsx(Tt,{item:!0,xs:12,sm:6,md:3,children:m.jsxs(qs,{fullWidth:!0,children:[m.jsx(Xs,{children:" "}),m.jsxs(Ks,{value:a.userRole,onChange:A=>o({...a,userRole:A.target.value}),size:"small",children:[m.jsx(Nr,{value:"",children:""}),y.map(A=>m.jsx(Nr,{value:A,children:A},A))]})]})}),m.jsx(Tt,{item:!0,xs:12,sm:6,md:3,children:m.jsx($r,{fullWidth:!0,label:"  ",value:a.action,onChange:A=>o({...a,action:A.target.value}),placeholder:", ,  ",size:"medium"})}),m.jsx(Tt,{item:!0,xs:12,sm:6,md:3,children:m.jsx($r,{fullWidth:!0,label:" ",type:"date",value:a.startDate,onChange:A=>o({...a,startDate:A.target.value}),InputLabelProps:{shrink:!0},size:"medium"})}),m.jsx(Tt,{item:!0,xs:12,sm:6,md:3,children:m.jsx($r,{fullWidth:!0,label:" ",type:"date",value:a.endDate,onChange:A=>o({...a,endDate:A.target.value}),InputLabelProps:{shrink:!0},size:"medium"})})]})]}),m.jsx("div",{className:"table-scroll-container",children:m.jsx(Ya,{component:ua,children:m.jsxs(Qa,{sx:{minWidth:"900px"},children:[m.jsx(Ja,{children:m.jsxs(on,{children:[m.jsx(Te,{sx:{minWidth:"120px",whiteSpace:"nowrap"},children:""}),m.jsx(Te,{sx:{minWidth:"100px",whiteSpace:"nowrap"},children:""}),m.jsx(Te,{sx:{minWidth:"80px",whiteSpace:"nowrap"},children:""}),m.jsx(Te,{sx:{minWidth:"100px",whiteSpace:"nowrap"},children:""}),m.jsx(Te,{sx:{minWidth:"100px",whiteSpace:"nowrap"},children:""}),m.jsx(Te,{sx:{minWidth:"100px",whiteSpace:"nowrap"},children:""}),m.jsx(Te,{sx:{minWidth:"100px",whiteSpace:"nowrap"},children:""}),m.jsx(Te,{sx:{minWidth:"200px",whiteSpace:"nowrap"},children:" "})]})}),m.jsx(Za,{children:s?m.jsx(on,{children:m.jsx(Te,{colSpan:8,align:"center",children:" ..."})}):r.length===0?m.jsx(on,{children:m.jsx(Te,{colSpan:8,align:"center",children:" ."})}):r.map(A=>m.jsxs(on,{children:[m.jsx(Te,{sx:{minWidth:"120px",whiteSpace:"nowrap"},children:f(A.timestamp)}),m.jsx(Te,{sx:{minWidth:"100px",whiteSpace:"nowrap"},children:A.userName}),m.jsx(Te,{sx:{minWidth:"80px",whiteSpace:"nowrap"},children:m.jsx(an,{label:A.userRole,size:"small",color:"primary"})}),m.jsx(Te,{sx:{minWidth:"100px",whiteSpace:"nowrap"},children:m.jsx(an,{label:A.majorCategory,size:"small",color:h(A.majorCategory)})}),m.jsx(Te,{sx:{minWidth:"100px",whiteSpace:"nowrap"},children:A.middleCategory}),m.jsx(Te,{sx:{minWidth:"100px",whiteSpace:"nowrap"},children:A.minorCategory}),m.jsx(Te,{sx:{minWidth:"100px",whiteSpace:"nowrap"},children:m.jsx(an,{label:A.action,size:"small",color:d(A.action)})}),m.jsx(Te,{sx:{minWidth:"200px",whiteSpace:"nowrap",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis"},title:A.details,children:A.details})]},A.id))})]})})})]})},Zi=async t=>{try{const e={...t,timestamp:new Date,createdAt:new Date};await Rn(We(ce,"system_logs"),e)}catch(e){console.error("  :",e)}},qt={USER_MANAGEMENT:{major:" ",middle:{TEACHER:" ",STUDENT:" ",AUTH:" ",CREATE:" ",UPDATE:" ",DELETE:" ",ROLE_CHANGE:" ",STATUS_CHANGE:" "}},CLASS_MANAGEMENT:{major:" ",middle:{CREATE:" ",UPDATE:" ",DELETE:" ",ASSIGN:" ",VIEW:" ",DETAILS:"  "}},STUDENT_MANAGEMENT:{major:" ",middle:{CREATE:" ",UPDATE:" ",DELETE:" ",CSV:"CSV ",XLSX:"XLSX ",BULK_CREATE:" ",BULK_UPDATE:" ",BULK_DELETE:" ",VIEW:" ",DETAILS:"  ",HISTORY:"  "}},MERIT_MANAGEMENT:{major:" ",middle:{CREATE:" ",APPROVE:" ",REJECT:" ",REQUEST:" ",PROCESS:"  ",VIEW:" ",HISTORY:"  ",REASON_ADD:"  ",REASON_UPDATE:"  ",REASON_DELETE:"  ",BULK_PROCESS:"  "}},SYSTEM:{major:"",middle:{LOGIN:"",LOGOUT:"",RESET:" ",EXPORT:" ",IMPORT:" ",DASHBOARD_VIEW:" ",RESET_APPROVAL:" ",ERROR:" ",WARNING:" ",INFO:" ",MAINTENANCE:" "}},DATA_MANAGEMENT:{major:" ",middle:{BACKUP:" ",RESTORE:" ",OVERWRITE:" ",EXPORT:" ",IMPORT:" ",VALIDATION:" ",CLEANUP:" ",MIGRATION:" "}},SECURITY:{major:"",middle:{LOGIN_ATTEMPT:" ",LOGIN_SUCCESS:" ",LOGIN_FAILED:" ",PERMISSION_DENIED:" ",SUSPICIOUS_ACTIVITY:" ",PASSWORD_CHANGE:" ",ACCOUNT_LOCKED:" ",ACCOUNT_UNLOCKED:"  "}},AUDIT:{major:"",middle:{DATA_ACCESS:" ",DATA_MODIFICATION:" ",CONFIGURATION_CHANGE:" ",POLICY_CHANGE:" ",COMPLIANCE_CHECK:"  "}}},lD=(t,e,r,n="")=>Zi({userId:t.uid,userName:t.name||t.email,userRole:t.role,majorCategory:qt.USER_MANAGEMENT.major,middleCategory:e,minorCategory:n,action:r,details:`${t.name||t.email} ${r}`}),uD=(t,e,r,n="")=>Zi({userId:t.uid,userName:t.name||t.email,userRole:t.role,majorCategory:qt.CLASS_MANAGEMENT.major,middleCategory:e,minorCategory:n,action:r,details:`${t.name||t.email} ${r}`}),hD=(t,e,r,n="")=>Zi({userId:t.uid,userName:t.name||t.email,userRole:t.role,majorCategory:qt.STUDENT_MANAGEMENT.major,middleCategory:e,minorCategory:n,action:r,details:`${t.name||t.email} ${r}`}),wB=(t,e,r,n="")=>Zi({userId:t.uid,userName:t.name||t.email,userRole:t.role,majorCategory:qt.MERIT_MANAGEMENT.major,middleCategory:e,minorCategory:n,action:r,details:`${t.name||t.email} ${r}`}),Ka=(t,e,r,n="")=>Zi({userId:t.uid,userName:t.name||t.email,userRole:t.role,majorCategory:qt.SYSTEM.major,middleCategory:e,minorCategory:n,action:r,details:`${t.name||t.email} ${r}`}),d0=(t,e,r,n="")=>Zi({userId:t.uid,userName:t.name||t.email,userRole:t.role,majorCategory:qt.SECURITY.major,middleCategory:e,minorCategory:n,action:r,details:`${t.name||t.email} ${r}`}),ju=(t,e,r,n,s,i={})=>Zi({userId:t.uid,userName:t.name||t.email,userEmail:t.email,userRole:t.role,majorCategory:e,middleCategory:r,action:n,details:s,additionalData:i,ipAddress:i.ipAddress||"N/A",userAgent:i.userAgent||"N/A",sessionId:i.sessionId||"N/A",timestamp:new Date,createdAt:new Date}),fD=(t,e,r="",n={})=>Zi({userId:t?.uid||"system",userName:t?.name||t?.email||"system",userRole:t?.role||"system",majorCategory:qt.SYSTEM.major,middleCategory:qt.SYSTEM.middle.ERROR,action:"  ",details:`: ${e.message}, : ${r}`,errorStack:e.stack,errorCode:e.code,additionalData:n,timestamp:new Date,createdAt:new Date}),m0=(t,e,r,n={})=>Zi({userId:t.uid,userName:t.name||t.email,userRole:t.role,majorCategory:qt.SYSTEM.major,middleCategory:qt.SYSTEM.middle.INFO,action:" ",details:`: ${e}, : ${r}ms`,operation:e,duration:r,additionalData:n,timestamp:new Date,createdAt:new Date});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Mh={};Mh.version="0.18.5";var Z_=1252,dD=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Am={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},km=function(t){dD.indexOf(t)!=-1&&(Z_=Am[0]=t)};function mD(){km(1252)}var Js=function(t){km(t)};function bm(){Js(1200),mD()}function n1(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function pD(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function e2(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var il=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?pD(t.slice(2)):e==254&&r==255?e2(t.slice(2)):e==65279?t.slice(1):t},Uu=function(e){return String.fromCharCode(e)},s1=function(e){return String.fromCharCode(e)},Dl,ma="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Pl(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0,c=0,l=0;l<t.length;)r=t.charCodeAt(l++),i=r>>2,n=t.charCodeAt(l++),a=(r&3)<<4|n>>4,s=t.charCodeAt(l++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),e+=ma.charAt(i)+ma.charAt(a)+ma.charAt(o)+ma.charAt(c);return e}function vs(t){var e="",r=0,n=0,s=0,i=0,a=0,o=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<t.length;)i=ma.indexOf(t.charAt(l++)),a=ma.indexOf(t.charAt(l++)),r=i<<2|a>>4,e+=String.fromCharCode(r),o=ma.indexOf(t.charAt(l++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),c=ma.indexOf(t.charAt(l++)),s=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(s));return e}var yt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ea=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Ca(t){return yt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function i1(t){return yt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ps=function(e){return yt?ea(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Rf(t){if(typeof ArrayBuffer>"u")return ps(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function La(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function gD(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Im(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Im(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var hn=yt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:ea(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function xD(t){for(var e=[],r=0,n=t.length+250,s=Ca(t.length+255),i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(e.push(s.slice(0,r)),r=0,s=Ca(65535),n=65530)}return e.push(s.slice(0,r)),hn(e)}var Xn=/\u0000/g,al=/[\u0001-\u0006]/g;function ac(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Zs(t,e){var r=""+t;return r.length>=e?r:Ir("0",e-r.length)+r}function Cm(t,e){var r=""+t;return r.length>=e?r:Ir(" ",e-r.length)+r}function Bh(t,e){var r=""+t;return r.length>=e?r:r+Ir(" ",e-r.length)}function wD(t,e){var r=""+Math.round(t);return r.length>=e?r:Ir("0",e-r.length)+r}function vD(t,e){var r=""+t;return r.length>=e?r:Ir("0",e-r.length)+r}var a1=Math.pow(2,32);function Wo(t,e){if(t>a1||t<-a1)return wD(t,e);var r=Math.round(t);return vD(r,e)}function Vh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var o1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],p0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function _D(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var it={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},c1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},yD={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function jh(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,a=1,o=0,c=1,l=0,h=0,d=Math.floor(s);l<e&&(d=Math.floor(s),o=d*a+i,h=d*l+c,!(s-d<5e-8));)s=1/(s-d),i=a,a=o,c=l,l=h;if(h>e&&(l>e?(h=c,o=i):(h=l,o=a)),!r)return[0,n*o,h];var f=Math.floor(n*o/h);return[f,n*o-f*h,h]}function io(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,a=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=bD(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var t2=new Date(1899,11,31,0,0,0),ED=t2.getTime(),TD=new Date(1900,2,1,0,0,0);function r2(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=TD&&(r+=1440*60*1e3),(r-(ED+(t.getTimezoneOffset()-t2.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Rm(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SD(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function AD(t){var e=t<0?12:11,r=Rm(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function kD(t){var e=Rm(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Fl(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=AD(t):e===10?r=t.toFixed(10).substr(0,12):r=kD(t),Rm(SD(r.toUpperCase()))}function vo(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Fl(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ns(14,r2(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function bD(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function ID(t,e,r,n){var s="",i=0,a=0,o=r.y,c,l=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,l=e.length;break;case 3:return p0[r.m-1][1];case 5:return p0[r.m-1][0];default:return p0[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,l=e.length;break;case 3:return o1[r.q][0];default:return o1[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,l=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,l=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,l=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Zs(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),e==="s"?i===0?"0":""+i/a:(s=Zs(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}l=e.length===3?1:2;break;case 101:c=o,l=1;break}var h=l>0?Zs(c,l):"";return h}function pa(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var n2=/%/g;function CD(t,e,r){var n=e.replace(n2,""),s=e.length-n.length;return Ui(t,n,r*Math.pow(10,2*s))+Ir("%",s)}function RD(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ui(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function s2(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+s2(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,h){return c+l+h.substr(0,(s+i)%s)+"."+h.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var i2=/# (\?+)( ?)\/( ?)(\d+)/;function DD(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?Ir(" ",t[1].length+1+t[4].length):Cm(a,t[1].length)+t[2]+"/"+t[3]+Zs(o,t[4].length))}function PD(t,e,r){return r+(e===0?"":""+e)+Ir(" ",t[1].length+2+t[4].length)}var a2=/^#*0*\.([0#]+)/,o2=/\).*[0#]/,c2=/\(###\) ###\\?-####/;function Hn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function l1(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function u1(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function FD(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function ND(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ks(t,e,r){if(t.charCodeAt(0)===40&&!e.match(o2)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ks("n",n,r):"("+ks("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return RD(t,e,r);if(e.indexOf("%")!==-1)return CD(t,e,r);if(e.indexOf("E")!==-1)return s2(e,r);if(e.charCodeAt(0)===36)return"$"+ks(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,c=Math.abs(r),l=r<0?"-":"";if(e.match(/^00+$/))return l+Wo(c,e.length);if(e.match(/^[#?]+$/))return s=Wo(r,0),s==="0"&&(s=""),s.length>e.length?s:Hn(e.substr(0,e.length-s.length))+s;if(i=e.match(i2))return DD(i,c,l);if(e.match(/^#+0+$/))return l+Wo(c,e.length-e.indexOf("0"));if(i=e.match(a2))return s=l1(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Hn(i[1])).replace(/\.$/,"."+Hn(i[1])).replace(/\.(\d*)$/,function(w,x){return"."+x+Ir("0",Hn(i[1]).length-x.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return l+l1(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return l+pa(Wo(c,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ks(t,e,-r):pa(""+(Math.floor(r)+FD(r,i[1].length)))+"."+Zs(u1(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return ks(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ac(ks(t,e.replace(/[\\-]/g,""),r)),a=0,ac(ac(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return a<s.length?s.charAt(a++):w==="0"?"0":""}));if(e.match(c2))return s=ks(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=jh(c,Math.pow(10,a)-1,!1),s=""+l,h=Ui("n",i[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+i[2]+"/"+i[3],h=Bh(o[2],a),h.length<i[4].length&&(h=Hn(i[4].substr(i[4].length-h.length))+h),s+=h,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=jh(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Cm(o[1],a)+i[2]+"/"+i[3]+Bh(o[2],a):Ir(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=Wo(r,0),e.length<=s.length?s:Hn(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var d=e.indexOf(".")-a,f=e.length-s.length-d;return Hn(e.substr(0,d)+s+e.substr(e.length-f))}if(i=e.match(/^00,000\.([#0]*0)$/))return a=u1(r,i[1].length),r<0?"-"+ks(t,e,-r):pa(ND(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?Zs(0,3-w.length):"")+w})+"."+Zs(a,i[1].length);switch(e){case"###,##0.00":return ks(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=pa(Wo(c,0));return g!=="0"?l+g:"";case"###,###.00":return ks(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ks(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function OD(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ui(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function LD(t,e,r){var n=e.replace(n2,""),s=e.length-n.length;return Ui(t,n,r*Math.pow(10,2*s))+Ir("%",s)}function l2(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+l2(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,h){return c+l+h.substr(0,(s+i)%s)+"."+h.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function di(t,e,r){if(t.charCodeAt(0)===40&&!e.match(o2)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?di("n",n,r):"("+di("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return OD(t,e,r);if(e.indexOf("%")!==-1)return LD(t,e,r);if(e.indexOf("E")!==-1)return l2(e,r);if(e.charCodeAt(0)===36)return"$"+di(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,c=Math.abs(r),l=r<0?"-":"";if(e.match(/^00+$/))return l+Zs(c,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Hn(e.substr(0,e.length-s.length))+s;if(i=e.match(i2))return PD(i,c,l);if(e.match(/^#+0+$/))return l+Zs(c,e.length-e.indexOf("0"));if(i=e.match(a2))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Hn(i[1])).replace(/\.$/,"."+Hn(i[1])),s=s.replace(/\.(\d*)$/,function(w,x){return"."+x+Ir("0",Hn(i[1]).length-x.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return l+pa(""+c);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+di(t,e,-r):pa(""+r)+"."+Ir("0",i[1].length);if(i=e.match(/^#,#*,#0/))return di(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ac(di(t,e.replace(/[\\-]/g,""),r)),a=0,ac(ac(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return a<s.length?s.charAt(a++):w==="0"?"0":""}));if(e.match(c2))return s=di(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=jh(c,Math.pow(10,a)-1,!1),s=""+l,h=Ui("n",i[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+i[2]+"/"+i[3],h=Bh(o[2],a),h.length<i[4].length&&(h=Hn(i[4].substr(i[4].length-h.length))+h),s+=h,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=jh(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Cm(o[1],a)+i[2]+"/"+i[3]+Bh(o[2],a):Ir(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Hn(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var d=e.indexOf(".")-a,f=e.length-s.length-d;return Hn(e.substr(0,d)+s+e.substr(e.length-f))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+di(t,e,-r):pa(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?Zs(0,3-w.length):"")+w})+"."+Zs(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=pa(""+c);return g!=="0"?l+g:"";default:if(e.match(/\.[0#?]*$/))return di(t,e.slice(0,e.lastIndexOf(".")),r)+Hn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ui(t,e,r){return(r|0)===r?di(t,e,r):ks(t,e,r)}function MD(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var u2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Mc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Vh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(u2))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function BD(t,e,r,n){for(var s=[],i="",a=0,o="",c="t",l,h,d,f="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Vh(t,a))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(d=t.charCodeAt(++a))!==34&&a<t.length;)i+=String.fromCharCode(d);s[s.length]={t:"t",v:i},++a;break;case"\\":var g=t.charAt(++a),w=g==="("||g===")"?g:"t";s[s.length]={t:w,v:g},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(l==null&&(l=io(e,r,t.charAt(a+1)==="2"),l==null))return"";s[s.length]={t:"X",v:t.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||l==null&&(l=io(e,r),l==null))return"";for(i=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),s[s.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var x={t:o,v:o};if(l==null&&(l=io(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(l!=null&&(x.v=l.H>=12?"P":"A"),x.t="T",f="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(l!=null&&(x.v=l.H>=12?"PM":"AM"),x.t="T",a+=5,f="h"):t.substr(a,5).toUpperCase()==="/"?(l!=null&&(x.v=l.H>=12?"":""),x.t="T",a+=5,f="h"):(x.t="t",++a),l==null&&x.t==="T")return"";s[s.length]=x,c=o;break;case"[":for(i=o;t.charAt(a++)!=="]"&&a<t.length;)i+=t.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(u2)){if(l==null&&(l=io(e,r),l==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Mc(t)||(s[s.length]={t:"t",v:i}));break;case".":if(l!=null){for(i=o;++a<t.length&&(o=t.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;t.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},c=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)i+=t.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++a;break}var y=0,A=0,F;for(a=s.length-1,c="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=f,c="h",y<1&&(y=1);break;case"s":(F=s[a].v.match(/\.0+$/))&&(A=Math.max(A,F[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=s[a].t;break;case"m":c==="s"&&(s[a].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&s[a].v.match(/[Hh]/)&&(y=1),y<2&&s[a].v.match(/[Mm]/)&&(y=2),y<3&&s[a].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var I="",W;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=ID(s[a].t.charCodeAt(0),s[a].v,l,A),s[a].t="t";break;case"n":case"?":for(W=a+1;s[W]!=null&&((o=s[W].t)==="?"||o==="D"||(o===" "||o==="t")&&s[W+1]!=null&&(s[W+1].t==="?"||s[W+1].t==="t"&&s[W+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[W].v==="/"||s[W].v===" "&&s[W+1]!=null&&s[W+1].t=="?"));)s[a].v+=s[W].v,s[W]={v:"",t:";"},++W;I+=s[a].v,a=W-1;break;case"G":s[a].t="t",s[a].v=vo(e,r);break}var U="",z,T;if(I.length>0){I.charCodeAt(0)==40?(z=e<0&&I.charCodeAt(0)===45?-e:e,T=Ui("n",I,z)):(z=e<0&&n>1?-e:e,T=Ui("n",I,z),z<0&&s[0]&&s[0].t=="t"&&(T=T.substr(1),s[0].v="-"+s[0].v)),W=T.length-1;var k=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){k=a;break}var S=s.length;if(k===s.length&&T.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(W>=s[a].v.length-1?(W-=s[a].v.length,s[a].v=T.substr(W+1,s[a].v.length)):W<0?s[a].v="":(s[a].v=T.substr(0,W+1),W=-1),s[a].t="t",S=a);W>=0&&S<s.length&&(s[S].v=T.substr(0,W+1)+s[S].v)}else if(k!==s.length&&T.indexOf("E")===-1){for(W=T.indexOf(".")-1,a=k;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(h=s[a].v.indexOf(".")>-1&&a===k?s[a].v.indexOf(".")-1:s[a].v.length-1,U=s[a].v.substr(h+1);h>=0;--h)W>=0&&(s[a].v.charAt(h)==="0"||s[a].v.charAt(h)==="#")&&(U=T.charAt(W--)+U);s[a].v=U,s[a].t="t",S=a}for(W>=0&&S<s.length&&(s[S].v=T.substr(0,W+1)+s[S].v),W=T.indexOf(".")+1,a=k;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==k)){for(h=s[a].v.indexOf(".")>-1&&a===k?s[a].v.indexOf(".")+1:0,U=s[a].v.substr(0,h);h<s[a].v.length;++h)W<T.length&&(U+=T.charAt(W++));s[a].v=U,s[a].t="t",S=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(z=n>1&&e<0&&a>0&&s[a-1].v==="-"?-e:e,s[a].v=Ui(s[a].t,s[a].v,z),s[a].t="t");var R="";for(a=0;a!==s.length;++a)s[a]!=null&&(R+=s[a].v);return R}var h1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function f1(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function VD(t,e){var r=MD(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(h1),o=r[1].match(h1);return f1(e,a)?[n,r[0]]:f1(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function Ns(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:it)[t],n==null&&(n=r.table&&r.table[c1[t]]||it[c1[t]]),n==null&&(n=yD[t]||"General");break}if(Vh(n,0))return vo(e,r);e instanceof Date&&(e=r2(e,r.date1904));var s=VD(n,e);if(Vh(s[1]))return vo(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return BD(s[1],e,r,s[0])}function Wi(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(it[r]==null){e<0&&(e=r);continue}if(it[r]==t){e=r;break}}e<0&&(e=391)}return it[e]=t,e}function Df(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Wi(t[e],e)}function Bc(){it=_D()}var jD={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},h2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function UD(t){var e=typeof t=="number"?it[t]:t;return e=e.replace(h2,"(\\d+)"),new RegExp("^"+e+"$")}function WD(t,e,r){var n=-1,s=-1,i=-1,a=-1,o=-1,c=-1;(e.match(h2)||[]).forEach(function(d,f){var g=parseInt(r[f+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=g;break;case"d":i=g;break;case"h":a=g;break;case"s":c=g;break;case"m":a>=0?o=g:s=g;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?l:n==-1&&s==-1&&i==-1?h:l+"T"+h}var $D=(function(){var t={};t.version="1.2.0";function e(){for(var T=0,k=new Array(256),S=0;S!=256;++S)T=S,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,k[S]=T;return typeof Int32Array<"u"?new Int32Array(k):k}var r=e();function n(T){var k=0,S=0,R=0,C=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)C[R]=T[R];for(R=0;R!=256;++R)for(S=T[R],k=256+R;k<4096;k+=256)S=C[k]=S>>>8^T[S&255];var _=[];for(R=1;R!=16;++R)_[R-1]=typeof Int32Array<"u"?C.subarray(R*256,R*256+256):C.slice(R*256,R*256+256);return _}var s=n(r),i=s[0],a=s[1],o=s[2],c=s[3],l=s[4],h=s[5],d=s[6],f=s[7],g=s[8],w=s[9],x=s[10],y=s[11],A=s[12],F=s[13],I=s[14];function W(T,k){for(var S=k^-1,R=0,C=T.length;R<C;)S=S>>>8^r[(S^T.charCodeAt(R++))&255];return~S}function U(T,k){for(var S=k^-1,R=T.length-15,C=0;C<R;)S=I[T[C++]^S&255]^F[T[C++]^S>>8&255]^A[T[C++]^S>>16&255]^y[T[C++]^S>>>24]^x[T[C++]]^w[T[C++]]^g[T[C++]]^f[T[C++]]^d[T[C++]]^h[T[C++]]^l[T[C++]]^c[T[C++]]^o[T[C++]]^a[T[C++]]^i[T[C++]]^r[T[C++]];for(R+=15;C<R;)S=S>>>8^r[(S^T[C++])&255];return~S}function z(T,k){for(var S=k^-1,R=0,C=T.length,_=0,P=0;R<C;)_=T.charCodeAt(R++),_<128?S=S>>>8^r[(S^_)&255]:_<2048?(S=S>>>8^r[(S^(192|_>>6&31))&255],S=S>>>8^r[(S^(128|_&63))&255]):_>=55296&&_<57344?(_=(_&1023)+64,P=T.charCodeAt(R++)&1023,S=S>>>8^r[(S^(240|_>>8&7))&255],S=S>>>8^r[(S^(128|_>>2&63))&255],S=S>>>8^r[(S^(128|P>>6&15|(_&3)<<4))&255],S=S>>>8^r[(S^(128|P&63))&255]):(S=S>>>8^r[(S^(224|_>>12&15))&255],S=S>>>8^r[(S^(128|_>>6&63))&255],S=S>>>8^r[(S^(128|_&63))&255]);return~S}return t.table=r,t.bstr=W,t.buf=U,t.str=z,t})(),Qe=(function(){var e={};e.version="1.2.1";function r(b,L){for(var O=b.split("/"),N=L.split("/"),B=0,M=0,re=Math.min(O.length,N.length);B<re;++B){if(M=O[B].length-N[B].length)return M;if(O[B]!=N[B])return O[B]<N[B]?-1:1}return O.length-N.length}function n(b){if(b.charAt(b.length-1)=="/")return b.slice(0,-1).indexOf("/")===-1?b:n(b.slice(0,-1));var L=b.lastIndexOf("/");return L===-1?b:b.slice(0,L+1)}function s(b){if(b.charAt(b.length-1)=="/")return s(b.slice(0,-1));var L=b.lastIndexOf("/");return L===-1?b:b.slice(L+1)}function i(b,L){typeof L=="string"&&(L=new Date(L));var O=L.getHours();O=O<<6|L.getMinutes(),O=O<<5|L.getSeconds()>>>1,b.write_shift(2,O);var N=L.getFullYear()-1980;N=N<<4|L.getMonth()+1,N=N<<5|L.getDate(),b.write_shift(2,N)}function a(b){var L=b.read_shift(2)&65535,O=b.read_shift(2)&65535,N=new Date,B=O&31;O>>>=5;var M=O&15;O>>>=4,N.setMilliseconds(0),N.setFullYear(O+1980),N.setMonth(M-1),N.setDate(B);var re=L&31;L>>>=5;var oe=L&63;return L>>>=6,N.setHours(L),N.setMinutes(oe),N.setSeconds(re<<1),N}function o(b){yn(b,0);for(var L={},O=0;b.l<=b.length-4;){var N=b.read_shift(2),B=b.read_shift(2),M=b.l+B,re={};switch(N){case 21589:O=b.read_shift(1),O&1&&(re.mtime=b.read_shift(4)),B>5&&(O&2&&(re.atime=b.read_shift(4)),O&4&&(re.ctime=b.read_shift(4))),re.mtime&&(re.mt=new Date(re.mtime*1e3));break}b.l=M,L[N]=re}return L}var c;function l(){return c||(c={})}function h(b,L){if(b[0]==80&&b[1]==75)return bi(b,L);if((b[0]|32)==109&&(b[1]|32)==105)return $n(b,L);if(b.length<512)throw new Error("CFB file size "+b.length+" < 512");var O=3,N=512,B=0,M=0,re=0,oe=0,te=0,ne=[],H=b.slice(0,512);yn(H,0);var ge=d(H);switch(O=ge[0],O){case 3:N=512;break;case 4:N=4096;break;case 0:if(ge[1]==0)return bi(b,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}N!==512&&(H=b.slice(0,N),yn(H,28));var de=b.slice(0,N);f(H,O);var Be=H.read_shift(4,"i");if(O===3&&Be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Be);H.l+=4,re=H.read_shift(4,"i"),H.l+=4,H.chk("00100000","Mini Stream Cutoff Size: "),oe=H.read_shift(4,"i"),B=H.read_shift(4,"i"),te=H.read_shift(4,"i"),M=H.read_shift(4,"i");for(var pe=-1,De=0;De<109&&(pe=H.read_shift(4,"i"),!(pe<0));++De)ne[De]=pe;var st=g(b,N);y(te,M,st,N,ne);var Yt=F(st,re,ne,N);Yt[re].name="!Directory",B>0&&oe!==P&&(Yt[oe].name="!MiniFAT"),Yt[ne[0]].name="!FAT",Yt.fat_addrs=ne,Yt.ssz=N;var Wt={},sr=[],zn=[],ci=[];I(re,Yt,st,sr,B,Wt,zn,oe),w(zn,ci,sr),sr.shift();var li={FileIndex:zn,FullPaths:ci};return L&&L.raw&&(li.raw={header:de,sectors:st}),li}function d(b){if(b[b.l]==80&&b[b.l+1]==75)return[0,0];b.chk(Fe,"Header Signature: "),b.l+=16;var L=b.read_shift(2,"u");return[b.read_shift(2,"u"),L]}function f(b,L){var O=9;switch(b.l+=2,O=b.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}b.chk("0600","Mini Sector Shift: "),b.chk("000000000000","Reserved: ")}function g(b,L){for(var O=Math.ceil(b.length/L)-1,N=[],B=1;B<O;++B)N[B-1]=b.slice(B*L,(B+1)*L);return N[O-1]=b.slice(O*L),N}function w(b,L,O){for(var N=0,B=0,M=0,re=0,oe=0,te=O.length,ne=[],H=[];N<te;++N)ne[N]=H[N]=N,L[N]=O[N];for(;oe<H.length;++oe)N=H[oe],B=b[N].L,M=b[N].R,re=b[N].C,ne[N]===N&&(B!==-1&&ne[B]!==B&&(ne[N]=ne[B]),M!==-1&&ne[M]!==M&&(ne[N]=ne[M])),re!==-1&&(ne[re]=N),B!==-1&&N!=ne[N]&&(ne[B]=ne[N],H.lastIndexOf(B)<oe&&H.push(B)),M!==-1&&N!=ne[N]&&(ne[M]=ne[N],H.lastIndexOf(M)<oe&&H.push(M));for(N=1;N<te;++N)ne[N]===N&&(M!==-1&&ne[M]!==M?ne[N]=ne[M]:B!==-1&&ne[B]!==B&&(ne[N]=ne[B]));for(N=1;N<te;++N)if(b[N].type!==0){if(oe=N,oe!=ne[oe])do oe=ne[oe],L[N]=L[oe]+"/"+L[N];while(oe!==0&&ne[oe]!==-1&&oe!=ne[oe]);ne[N]=-1}for(L[0]+="/",N=1;N<te;++N)b[N].type!==2&&(L[N]+="/")}function x(b,L,O){for(var N=b.start,B=b.size,M=[],re=N;O&&B>0&&re>=0;)M.push(L.slice(re*_,re*_+_)),B-=_,re=no(O,re*4);return M.length===0?ue(0):hn(M).slice(0,b.size)}function y(b,L,O,N,B){var M=P;if(b===P){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(b!==-1){var re=O[b],oe=(N>>>2)-1;if(!re)return;for(var te=0;te<oe&&(M=no(re,te*4))!==P;++te)B.push(M);y(no(re,N-4),L-1,O,N,B)}}function A(b,L,O,N,B){var M=[],re=[];B||(B=[]);var oe=N-1,te=0,ne=0;for(te=L;te>=0;){B[te]=!0,M[M.length]=te,re.push(b[te]);var H=O[Math.floor(te*4/N)];if(ne=te*4&oe,N<4+ne)throw new Error("FAT boundary crossed: "+te+" 4 "+N);if(!b[H])break;te=no(b[H],ne)}return{nodes:M,data:S1([re])}}function F(b,L,O,N){var B=b.length,M=[],re=[],oe=[],te=[],ne=N-1,H=0,ge=0,de=0,Be=0;for(H=0;H<B;++H)if(oe=[],de=H+L,de>=B&&(de-=B),!re[de]){te=[];var pe=[];for(ge=de;ge>=0;){pe[ge]=!0,re[ge]=!0,oe[oe.length]=ge,te.push(b[ge]);var De=O[Math.floor(ge*4/N)];if(Be=ge*4&ne,N<4+Be)throw new Error("FAT boundary crossed: "+ge+" 4 "+N);if(!b[De]||(ge=no(b[De],Be),pe[ge]))break}M[de]={nodes:oe,data:S1([te])}}return M}function I(b,L,O,N,B,M,re,oe){for(var te=0,ne=N.length?2:0,H=L[b].data,ge=0,de=0,Be;ge<H.length;ge+=128){var pe=H.slice(ge,ge+128);yn(pe,64),de=pe.read_shift(2),Be=Mm(pe,0,de-ne),N.push(Be);var De={name:Be,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},st=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);st!==0&&(De.ct=W(pe,pe.l-8));var Yt=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);Yt!==0&&(De.mt=W(pe,pe.l-8)),De.start=pe.read_shift(4,"i"),De.size=pe.read_shift(4,"i"),De.size<0&&De.start<0&&(De.size=De.type=0,De.start=P,De.name=""),De.type===5?(te=De.start,B>0&&te!==P&&(L[te].name="!StreamData")):De.size>=4096?(De.storage="fat",L[De.start]===void 0&&(L[De.start]=A(O,De.start,L.fat_addrs,L.ssz)),L[De.start].name=De.name,De.content=L[De.start].data.slice(0,De.size)):(De.storage="minifat",De.size<0?De.size=0:te!==P&&De.start!==P&&L[te]&&(De.content=x(De,L[te].data,(L[oe]||{}).data))),De.content&&yn(De.content,0),M[Be]=De,re.push(De)}}function W(b,L){return new Date((ds(b,L+4)/1e7*Math.pow(2,32)+ds(b,L)/1e7-11644473600)*1e3)}function U(b,L){return l(),h(c.readFileSync(b),L)}function z(b,L){var O=L&&L.type;switch(O||yt&&Buffer.isBuffer(b)&&(O="buffer"),O||"base64"){case"file":return U(b,L);case"base64":return h(ps(vs(b)),L);case"binary":return h(ps(b),L)}return h(b,L)}function T(b,L){var O=L||{},N=O.root||"Root Entry";if(b.FullPaths||(b.FullPaths=[]),b.FileIndex||(b.FileIndex=[]),b.FullPaths.length!==b.FileIndex.length)throw new Error("inconsistent CFB structure");b.FullPaths.length===0&&(b.FullPaths[0]=N+"/",b.FileIndex[0]={name:N,type:5}),O.CLSID&&(b.FileIndex[0].clsid=O.CLSID),k(b)}function k(b){var L="Sh33tJ5";if(!Qe.find(b,"/"+L)){var O=ue(4);O[0]=55,O[1]=O[3]=50,O[2]=54,b.FileIndex.push({name:L,type:2,content:O,size:4,L:69,R:69,C:69}),b.FullPaths.push(b.FullPaths[0]+L),S(b)}}function S(b,L){T(b);for(var O=!1,N=!1,B=b.FullPaths.length-1;B>=0;--B){var M=b.FileIndex[B];switch(M.type){case 0:N?O=!0:(b.FileIndex.pop(),b.FullPaths.pop());break;case 1:case 2:case 5:N=!0,isNaN(M.R*M.L*M.C)&&(O=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!L)){var re=new Date(1987,1,19),oe=0,te=Object.create?Object.create(null):{},ne=[];for(B=0;B<b.FullPaths.length;++B)te[b.FullPaths[B]]=!0,b.FileIndex[B].type!==0&&ne.push([b.FullPaths[B],b.FileIndex[B]]);for(B=0;B<ne.length;++B){var H=n(ne[B][0]);N=te[H],N||(ne.push([H,{name:s(H).replace("/",""),type:1,clsid:je,ct:re,mt:re,content:null}]),te[H]=!0)}for(ne.sort(function(Be,pe){return r(Be[0],pe[0])}),b.FullPaths=[],b.FileIndex=[],B=0;B<ne.length;++B)b.FullPaths[B]=ne[B][0],b.FileIndex[B]=ne[B][1];for(B=0;B<ne.length;++B){var ge=b.FileIndex[B],de=b.FullPaths[B];if(ge.name=s(de).replace("/",""),ge.L=ge.R=ge.C=-(ge.color=1),ge.size=ge.content?ge.content.length:0,ge.start=0,ge.clsid=ge.clsid||je,B===0)ge.C=ne.length>1?1:-1,ge.size=0,ge.type=5;else if(de.slice(-1)=="/"){for(oe=B+1;oe<ne.length&&n(b.FullPaths[oe])!=de;++oe);for(ge.C=oe>=ne.length?-1:oe,oe=B+1;oe<ne.length&&n(b.FullPaths[oe])!=n(de);++oe);ge.R=oe>=ne.length?-1:oe,ge.type=1}else n(b.FullPaths[B+1]||"")==n(de)&&(ge.R=B+1),ge.type=2}}}function R(b,L){var O=L||{};if(O.fileType=="mad")return Kr(b,O);switch(S(b),O.fileType){case"zip":return Ii(b,O)}var N=(function(Be){for(var pe=0,De=0,st=0;st<Be.FileIndex.length;++st){var Yt=Be.FileIndex[st];if(Yt.content){var Wt=Yt.content.length;Wt>0&&(Wt<4096?pe+=Wt+63>>6:De+=Wt+511>>9)}}for(var sr=Be.FullPaths.length+3>>2,zn=pe+7>>3,ci=pe+127>>7,li=zn+De+sr+ci,ls=li+127>>7,ia=ls<=109?0:Math.ceil((ls-109)/127);li+ls+ia+127>>7>ls;)ia=++ls<=109?0:Math.ceil((ls-109)/127);var Yr=[1,ia,ls,ci,sr,De,pe,0];return Be.FileIndex[0].size=pe<<6,Yr[7]=(Be.FileIndex[0].start=Yr[0]+Yr[1]+Yr[2]+Yr[3]+Yr[4]+Yr[5])+(Yr[6]+7>>3),Yr})(b),B=ue(N[7]<<9),M=0,re=0;{for(M=0;M<8;++M)B.write_shift(1,Ie[M]);for(M=0;M<8;++M)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),M=0;M<3;++M)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,N[2]),B.write_shift(4,N[0]+N[1]+N[2]+N[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,N[3]?N[0]+N[1]+N[2]-1:P),B.write_shift(4,N[3]),B.write_shift(-4,N[1]?N[0]-1:P),B.write_shift(4,N[1]),M=0;M<109;++M)B.write_shift(-4,M<N[2]?N[1]+M:-1)}if(N[1])for(re=0;re<N[1];++re){for(;M<236+re*127;++M)B.write_shift(-4,M<N[2]?N[1]+M:-1);B.write_shift(-4,re===N[1]-1?P:re+1)}var oe=function(Be){for(re+=Be;M<re-1;++M)B.write_shift(-4,M+1);Be&&(++M,B.write_shift(-4,P))};for(re=M=0,re+=N[1];M<re;++M)B.write_shift(-4,Me.DIFSECT);for(re+=N[2];M<re;++M)B.write_shift(-4,Me.FATSECT);oe(N[3]),oe(N[4]);for(var te=0,ne=0,H=b.FileIndex[0];te<b.FileIndex.length;++te)H=b.FileIndex[te],H.content&&(ne=H.content.length,!(ne<4096)&&(H.start=re,oe(ne+511>>9)));for(oe(N[6]+7>>3);B.l&511;)B.write_shift(-4,Me.ENDOFCHAIN);for(re=M=0,te=0;te<b.FileIndex.length;++te)H=b.FileIndex[te],H.content&&(ne=H.content.length,!(!ne||ne>=4096)&&(H.start=re,oe(ne+63>>6)));for(;B.l&511;)B.write_shift(-4,Me.ENDOFCHAIN);for(M=0;M<N[4]<<2;++M){var ge=b.FullPaths[M];if(!ge||ge.length===0){for(te=0;te<17;++te)B.write_shift(4,0);for(te=0;te<3;++te)B.write_shift(4,-1);for(te=0;te<12;++te)B.write_shift(4,0);continue}H=b.FileIndex[M],M===0&&(H.start=H.size?H.start-1:P);var de=M===0&&O.root||H.name;if(ne=2*(de.length+1),B.write_shift(64,de,"utf16le"),B.write_shift(2,ne),B.write_shift(1,H.type),B.write_shift(1,H.color),B.write_shift(-4,H.L),B.write_shift(-4,H.R),B.write_shift(-4,H.C),H.clsid)B.write_shift(16,H.clsid,"hex");else for(te=0;te<4;++te)B.write_shift(4,0);B.write_shift(4,H.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,H.start),B.write_shift(4,H.size),B.write_shift(4,0)}for(M=1;M<b.FileIndex.length;++M)if(H=b.FileIndex[M],H.size>=4096)if(B.l=H.start+1<<9,yt&&Buffer.isBuffer(H.content))H.content.copy(B,B.l,0,H.size),B.l+=H.size+511&-512;else{for(te=0;te<H.size;++te)B.write_shift(1,H.content[te]);for(;te&511;++te)B.write_shift(1,0)}for(M=1;M<b.FileIndex.length;++M)if(H=b.FileIndex[M],H.size>0&&H.size<4096)if(yt&&Buffer.isBuffer(H.content))H.content.copy(B,B.l,0,H.size),B.l+=H.size+63&-64;else{for(te=0;te<H.size;++te)B.write_shift(1,H.content[te]);for(;te&63;++te)B.write_shift(1,0)}if(yt)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function C(b,L){var O=b.FullPaths.map(function(te){return te.toUpperCase()}),N=O.map(function(te){var ne=te.split("/");return ne[ne.length-(te.slice(-1)=="/"?2:1)]}),B=!1;L.charCodeAt(0)===47?(B=!0,L=O[0].slice(0,-1)+L):B=L.indexOf("/")!==-1;var M=L.toUpperCase(),re=B===!0?O.indexOf(M):N.indexOf(M);if(re!==-1)return b.FileIndex[re];var oe=!M.match(al);for(M=M.replace(Xn,""),oe&&(M=M.replace(al,"!")),re=0;re<O.length;++re)if((oe?O[re].replace(al,"!"):O[re]).replace(Xn,"")==M||(oe?N[re].replace(al,"!"):N[re]).replace(Xn,"")==M)return b.FileIndex[re];return null}var _=64,P=-2,Fe="d0cf11e0a1b11ae1",Ie=[208,207,17,224,161,177,26,225],je="00000000000000000000000000000000",Me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:Fe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:je,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _t(b,L,O){l();var N=R(b,O);c.writeFileSync(L,N)}function se(b){for(var L=new Array(b.length),O=0;O<b.length;++O)L[O]=String.fromCharCode(b[O]);return L.join("")}function Ye(b,L){var O=R(b,L);switch(L&&L.type||"buffer"){case"file":return l(),c.writeFileSync(L.filename,O),O;case"binary":return typeof O=="string"?O:se(O);case"base64":return Pl(typeof O=="string"?O:se(O));case"buffer":if(yt)return Buffer.isBuffer(O)?O:ea(O);case"array":return typeof O=="string"?ps(O):O}return O}var Je;function V(b){try{var L=b.InflateRaw,O=new L;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)Je=b;else throw new Error("zlib does not expose bytesRead")}catch(N){console.error("cannot use native zlib: "+(N.message||N))}}function Y(b,L){if(!Je)return Ls(b,L);var O=Je.InflateRaw,N=new O,B=N._processChunk(b.slice(b.l),N._finishFlushFlag);return b.l+=N.bytesRead,B}function q(b){return Je?Je.deflateRawSync(b):dt(b)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],he=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ae(b){var L=(b<<1|b<<11)&139536|(b<<5|b<<15)&558144;return(L>>16|L>>8|L)&255}for(var ye=typeof Uint8Array<"u",ve=ye?new Uint8Array(256):[],ct=0;ct<256;++ct)ve[ct]=Ae(ct);function j(b,L){var O=ve[b&255];return L<=8?O>>>8-L:(O=O<<8|ve[b>>8&255],L<=16?O>>>16-L:(O=O<<8|ve[b>>16&255],O>>>24-L))}function jt(b,L){var O=L&7,N=L>>>3;return(b[N]|(O<=6?0:b[N+1]<<8))>>>O&3}function pt(b,L){var O=L&7,N=L>>>3;return(b[N]|(O<=5?0:b[N+1]<<8))>>>O&7}function Ft(b,L){var O=L&7,N=L>>>3;return(b[N]|(O<=4?0:b[N+1]<<8))>>>O&15}function ut(b,L){var O=L&7,N=L>>>3;return(b[N]|(O<=3?0:b[N+1]<<8))>>>O&31}function ke(b,L){var O=L&7,N=L>>>3;return(b[N]|(O<=1?0:b[N+1]<<8))>>>O&127}function lr(b,L,O){var N=L&7,B=L>>>3,M=(1<<O)-1,re=b[B]>>>N;return O<8-N||(re|=b[B+1]<<8-N,O<16-N)||(re|=b[B+2]<<16-N,O<24-N)||(re|=b[B+3]<<24-N),re&M}function dr(b,L,O){var N=L&7,B=L>>>3;return N<=5?b[B]|=(O&7)<<N:(b[B]|=O<<N&255,b[B+1]=(O&7)>>8-N),L+3}function Ur(b,L,O){var N=L&7,B=L>>>3;return O=(O&1)<<N,b[B]|=O,L+1}function Qn(b,L,O){var N=L&7,B=L>>>3;return O<<=N,b[B]|=O&255,O>>>=8,b[B+1]=O,L+8}function cs(b,L,O){var N=L&7,B=L>>>3;return O<<=N,b[B]|=O&255,O>>>=8,b[B+1]=O&255,b[B+2]=O>>>8,L+16}function Jn(b,L){var O=b.length,N=2*O>L?2*O:L+5,B=0;if(O>=L)return b;if(yt){var M=i1(N);if(b.copy)b.copy(M);else for(;B<b.length;++B)M[B]=b[B];return M}else if(ye){var re=new Uint8Array(N);if(re.set)re.set(b);else for(;B<O;++B)re[B]=b[B];return re}return b.length=N,b}function Tr(b){for(var L=new Array(b),O=0;O<b;++O)L[O]=0;return L}function Zn(b,L,O){var N=1,B=0,M=0,re=0,oe=0,te=b.length,ne=ye?new Uint16Array(32):Tr(32);for(M=0;M<32;++M)ne[M]=0;for(M=te;M<O;++M)b[M]=0;te=b.length;var H=ye?new Uint16Array(te):Tr(te);for(M=0;M<te;++M)ne[B=b[M]]++,N<B&&(N=B),H[M]=0;for(ne[0]=0,M=1;M<=N;++M)ne[M+16]=oe=oe+ne[M-1]<<1;for(M=0;M<te;++M)oe=b[M],oe!=0&&(H[M]=ne[oe+16]++);var ge=0;for(M=0;M<te;++M)if(ge=b[M],ge!=0)for(oe=j(H[M],N)>>N-ge,re=(1<<N+4-ge)-1;re>=0;--re)L[oe|re<<ge]=ge&15|M<<4;return N}var zt=ye?new Uint16Array(512):Tr(512),mr=ye?new Uint16Array(32):Tr(32);if(!ye){for(var Sr=0;Sr<512;++Sr)zt[Sr]=0;for(Sr=0;Sr<32;++Sr)mr[Sr]=0}(function(){for(var b=[],L=0;L<32;L++)b.push(5);Zn(b,mr,32);var O=[];for(L=0;L<=143;L++)O.push(8);for(;L<=255;L++)O.push(9);for(;L<=279;L++)O.push(7);for(;L<=287;L++)O.push(8);Zn(O,zt,288)})();var Tn=(function(){for(var L=ye?new Uint8Array(32768):[],O=0,N=0;O<Ee.length-1;++O)for(;N<Ee[O+1];++N)L[N]=O;for(;N<32768;++N)L[N]=29;var B=ye?new Uint8Array(259):[];for(O=0,N=0;O<he.length-1;++O)for(;N<he[O+1];++N)B[N]=O;function M(oe,te){for(var ne=0;ne<oe.length;){var H=Math.min(65535,oe.length-ne),ge=ne+H==oe.length;for(te.write_shift(1,+ge),te.write_shift(2,H),te.write_shift(2,~H&65535);H-- >0;)te[te.l++]=oe[ne++]}return te.l}function re(oe,te){for(var ne=0,H=0,ge=ye?new Uint16Array(32768):[];H<oe.length;){var de=Math.min(65535,oe.length-H);if(de<10){for(ne=dr(te,ne,+(H+de==oe.length)),ne&7&&(ne+=8-(ne&7)),te.l=ne/8|0,te.write_shift(2,de),te.write_shift(2,~de&65535);de-- >0;)te[te.l++]=oe[H++];ne=te.l*8;continue}ne=dr(te,ne,+(H+de==oe.length)+2);for(var Be=0;de-- >0;){var pe=oe[H];Be=(Be<<5^pe)&32767;var De=-1,st=0;if((De=ge[Be])&&(De|=H&-32768,De>H&&(De-=32768),De<H))for(;oe[De+st]==oe[H+st]&&st<250;)++st;if(st>2){pe=B[st],pe<=22?ne=Qn(te,ne,ve[pe+1]>>1)-1:(Qn(te,ne,3),ne+=5,Qn(te,ne,ve[pe-23]>>5),ne+=3);var Yt=pe<8?0:pe-4>>2;Yt>0&&(cs(te,ne,st-he[pe]),ne+=Yt),pe=L[H-De],ne=Qn(te,ne,ve[pe]>>3),ne-=3;var Wt=pe<4?0:pe-2>>1;Wt>0&&(cs(te,ne,H-De-Ee[pe]),ne+=Wt);for(var sr=0;sr<st;++sr)ge[Be]=H&32767,Be=(Be<<5^oe[H])&32767,++H;de-=st-1}else pe<=143?pe=pe+48:ne=Ur(te,ne,1),ne=Qn(te,ne,ve[pe]),ge[Be]=H&32767,++H}ne=Qn(te,ne,0)-1}return te.l=(ne+7)/8|0,te.l}return function(te,ne){return te.length<8?M(te,ne):re(te,ne)}})();function dt(b){var L=ue(50+Math.floor(b.length*1.1)),O=Tn(b,L);return L.slice(0,O)}var Kt=ye?new Uint16Array(32768):Tr(32768),Ar=ye?new Uint16Array(32768):Tr(32768),It=ye?new Uint16Array(128):Tr(128),pn=1,Es=1;function na(b,L){var O=ut(b,L)+257;L+=5;var N=ut(b,L)+1;L+=5;var B=Ft(b,L)+4;L+=4;for(var M=0,re=ye?new Uint8Array(19):Tr(19),oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,ne=ye?new Uint8Array(8):Tr(8),H=ye?new Uint8Array(8):Tr(8),ge=re.length,de=0;de<B;++de)re[X[de]]=M=pt(b,L),te<M&&(te=M),ne[M]++,L+=3;var Be=0;for(ne[0]=0,de=1;de<=te;++de)H[de]=Be=Be+ne[de-1]<<1;for(de=0;de<ge;++de)(Be=re[de])!=0&&(oe[de]=H[Be]++);var pe=0;for(de=0;de<ge;++de)if(pe=re[de],pe!=0){Be=ve[oe[de]]>>8-pe;for(var De=(1<<7-pe)-1;De>=0;--De)It[Be|De<<pe]=pe&7|de<<3}var st=[];for(te=1;st.length<O+N;)switch(Be=It[ke(b,L)],L+=Be&7,Be>>>=3){case 16:for(M=3+jt(b,L),L+=2,Be=st[st.length-1];M-- >0;)st.push(Be);break;case 17:for(M=3+pt(b,L),L+=3;M-- >0;)st.push(0);break;case 18:for(M=11+ke(b,L),L+=7;M-- >0;)st.push(0);break;default:st.push(Be),te<Be&&(te=Be);break}var Yt=st.slice(0,O),Wt=st.slice(O);for(de=O;de<286;++de)Yt[de]=0;for(de=N;de<30;++de)Wt[de]=0;return pn=Zn(Yt,Kt,286),Es=Zn(Wt,Ar,30),L}function Uc(b,L){if(b[0]==3&&!(b[1]&3))return[Ca(L),2];for(var O=0,N=0,B=i1(L||1<<18),M=0,re=B.length>>>0,oe=0,te=0;(N&1)==0;){if(N=pt(b,O),O+=3,N>>>1)N>>1==1?(oe=9,te=5):(O=na(b,O),oe=pn,te=Es);else{O&7&&(O+=8-(O&7));var ne=b[O>>>3]|b[(O>>>3)+1]<<8;if(O+=32,ne>0)for(!L&&re<M+ne&&(B=Jn(B,M+ne),re=B.length);ne-- >0;)B[M++]=b[O>>>3],O+=8;continue}for(;;){!L&&re<M+32767&&(B=Jn(B,M+32767),re=B.length);var H=lr(b,O,oe),ge=N>>>1==1?zt[H]:Kt[H];if(O+=ge&15,ge>>>=4,(ge>>>8&255)===0)B[M++]=ge;else{if(ge==256)break;ge-=257;var de=ge<8?0:ge-4>>2;de>5&&(de=0);var Be=M+he[ge];de>0&&(Be+=lr(b,O,de),O+=de),H=lr(b,O,te),ge=N>>>1==1?mr[H]:Ar[H],O+=ge&15,ge>>>=4;var pe=ge<4?0:ge-2>>1,De=Ee[ge];for(pe>0&&(De+=lr(b,O,pe),O+=pe),!L&&re<Be&&(B=Jn(B,Be+100),re=B.length);M<Be;)B[M]=B[M-De],++M}}}return L?[B,O+7>>>3]:[B.slice(0,M),O+7>>>3]}function Ls(b,L){var O=b.slice(b.l||0),N=Uc(O,L);return b.l+=N[1],N[0]}function ki(b,L){if(b)typeof console<"u"&&console.error(L);else throw new Error(L)}function bi(b,L){var O=b;yn(O,0);var N=[],B=[],M={FileIndex:N,FullPaths:B};T(M,{root:L.root});for(var re=O.length-4;(O[re]!=80||O[re+1]!=75||O[re+2]!=5||O[re+3]!=6)&&re>=0;)--re;O.l=re+4,O.l+=4;var oe=O.read_shift(2);O.l+=6;var te=O.read_shift(4);for(O.l=te,re=0;re<oe;++re){O.l+=20;var ne=O.read_shift(4),H=O.read_shift(4),ge=O.read_shift(2),de=O.read_shift(2),Be=O.read_shift(2);O.l+=8;var pe=O.read_shift(4),De=o(O.slice(O.l+ge,O.l+ge+de));O.l+=ge+de+Be;var st=O.l;O.l=pe+4,oi(O,ne,H,M,De),O.l=st}return M}function oi(b,L,O,N,B){b.l+=2;var M=b.read_shift(2),re=b.read_shift(2),oe=a(b);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var te=b.read_shift(4),ne=b.read_shift(4),H=b.read_shift(4),ge=b.read_shift(2),de=b.read_shift(2),Be="",pe=0;pe<ge;++pe)Be+=String.fromCharCode(b[b.l++]);if(de){var De=o(b.slice(b.l,b.l+de));(De[21589]||{}).mt&&(oe=De[21589].mt),((B||{})[21589]||{}).mt&&(oe=B[21589].mt)}b.l+=de;var st=b.slice(b.l,b.l+ne);switch(re){case 8:st=Y(b,H);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+re)}var Yt=!1;M&8&&(te=b.read_shift(4),te==134695760&&(te=b.read_shift(4),Yt=!0),ne=b.read_shift(4),H=b.read_shift(4)),ne!=L&&ki(Yt,"Bad compressed size: "+L+" != "+ne),H!=O&&ki(Yt,"Bad uncompressed size: "+O+" != "+H),Vs(N,Be,st,{unsafe:!0,mt:oe})}function Ii(b,L){var O=L||{},N=[],B=[],M=ue(1),re=O.compression?8:0,oe=0,te=0,ne=0,H=0,ge=0,de=b.FullPaths[0],Be=de,pe=b.FileIndex[0],De=[],st=0;for(te=1;te<b.FullPaths.length;++te)if(Be=b.FullPaths[te].slice(de.length),pe=b.FileIndex[te],!(!pe.size||!pe.content||Be=="Sh33tJ5")){var Yt=H,Wt=ue(Be.length);for(ne=0;ne<Be.length;++ne)Wt.write_shift(1,Be.charCodeAt(ne)&127);Wt=Wt.slice(0,Wt.l),De[ge]=$D.buf(pe.content,0);var sr=pe.content;re==8&&(sr=q(sr)),M=ue(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,oe),M.write_shift(2,re),pe.mt?i(M,pe.mt):M.write_shift(4,0),M.write_shift(-4,De[ge]),M.write_shift(4,sr.length),M.write_shift(4,pe.content.length),M.write_shift(2,Wt.length),M.write_shift(2,0),H+=M.length,N.push(M),H+=Wt.length,N.push(Wt),H+=sr.length,N.push(sr),M=ue(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,oe),M.write_shift(2,re),M.write_shift(4,0),M.write_shift(-4,De[ge]),M.write_shift(4,sr.length),M.write_shift(4,pe.content.length),M.write_shift(2,Wt.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,Yt),st+=M.l,B.push(M),st+=Wt.length,B.push(Wt),++ge}return M=ue(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,ge),M.write_shift(2,ge),M.write_shift(4,st),M.write_shift(4,H),M.write_shift(2,0),hn([hn(N),hn(B),M])}var kr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ms(b,L){if(b.ctype)return b.ctype;var O=b.name||"",N=O.match(/\.([^\.]+)$/);return N&&kr[N[1]]||L&&(N=(O=L).match(/[\.\\]([^\.\\])+$/),N&&kr[N[1]])?kr[N[1]]:"application/octet-stream"}function Wc(b){for(var L=Pl(b),O=[],N=0;N<L.length;N+=76)O.push(L.slice(N,N+76));return O.join(`\r
`)+`\r
`}function sa(b){var L=b.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ne){var H=ne.charCodeAt(0).toString(16).toUpperCase();return"="+(H.length==1?"0"+H:H)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],N=L.split(`\r
`),B=0;B<N.length;++B){var M=N[B];if(M.length==0){O.push("");continue}for(var re=0;re<M.length;){var oe=76,te=M.slice(re,re+oe);te.charAt(oe-1)=="="?oe--:te.charAt(oe-2)=="="?oe-=2:te.charAt(oe-3)=="="&&(oe-=3),te=M.slice(re,re+oe),re+=oe,re<M.length&&(te+="="),O.push(te)}}return O.join(`\r
`)}function Lo(b){for(var L=[],O=0;O<b.length;++O){for(var N=b[O];O<=b.length&&N.charAt(N.length-1)=="=";)N=N.slice(0,N.length-1)+b[++O];L.push(N)}for(var B=0;B<L.length;++B)L[B]=L[B].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return ps(L.join(`\r
`))}function Bs(b,L,O){for(var N="",B="",M="",re,oe=0;oe<10;++oe){var te=L[oe];if(!te||te.match(/^\s*$/))break;var ne=te.match(/^(.*?):\s*([^\s].*)$/);if(ne)switch(ne[1].toLowerCase()){case"content-location":N=ne[2].trim();break;case"content-type":M=ne[2].trim();break;case"content-transfer-encoding":B=ne[2].trim();break}}switch(++oe,B.toLowerCase()){case"base64":re=ps(vs(L.slice(oe).join("")));break;case"quoted-printable":re=Lo(L.slice(oe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var H=Vs(b,N.slice(O.length),re,{unsafe:!0});M&&(H.ctype=M)}function $n(b,L){if(se(b.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=L&&L.root||"",N=(yt&&Buffer.isBuffer(b)?b.toString("binary"):se(b)).split(`\r
`),B=0,M="";for(B=0;B<N.length;++B)if(M=N[B],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),O||(O=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),M.slice(0,O.length)!=O););var re=(N[1]||"").match(/boundary="(.*?)"/);if(!re)throw new Error("MAD cannot find boundary");var oe="--"+(re[1]||""),te=[],ne=[],H={FileIndex:te,FullPaths:ne};T(H);var ge,de=0;for(B=0;B<N.length;++B){var Be=N[B];Be!==oe&&Be!==oe+"--"||(de++&&Bs(H,N.slice(ge,B),O),ge=B)}return H}function Kr(b,L){var O=L||{},N=O.boundary||"SheetJS";N="------="+N;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+N.slice(2)+'"',"","",""],M=b.FullPaths[0],re=M,oe=b.FileIndex[0],te=1;te<b.FullPaths.length;++te)if(re=b.FullPaths[te].slice(M.length),oe=b.FileIndex[te],!(!oe.size||!oe.content||re=="Sh33tJ5")){re=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(st){return"_x"+st.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(st){return"_u"+st.charCodeAt(0).toString(16)+"_"});for(var ne=oe.content,H=yt&&Buffer.isBuffer(ne)?ne.toString("binary"):se(ne),ge=0,de=Math.min(1024,H.length),Be=0,pe=0;pe<=de;++pe)(Be=H.charCodeAt(pe))>=32&&Be<128&&++ge;var De=ge>=de*4/5;B.push(N),B.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+re),B.push("Content-Transfer-Encoding: "+(De?"quoted-printable":"base64")),B.push("Content-Type: "+Ms(oe,re)),B.push(""),B.push(De?sa(H):Wc(H))}return B.push(N+`--\r
`),B.join(`\r
`)}function Va(b){var L={};return T(L,b),L}function Vs(b,L,O,N){var B=N&&N.unsafe;B||T(b);var M=!B&&Qe.find(b,L);if(!M){var re=b.FullPaths[0];L.slice(0,re.length)==re?re=L:(re.slice(-1)!="/"&&(re+="/"),re=(re+L).replace("//","/")),M={name:s(L),type:2},b.FileIndex.push(M),b.FullPaths.push(re),B||Qe.utils.cfb_gc(b)}return M.content=O,M.size=O?O.length:0,N&&(N.CLSID&&(M.clsid=N.CLSID),N.mt&&(M.mt=N.mt),N.ct&&(M.ct=N.ct)),M}function Ut(b,L){T(b);var O=Qe.find(b,L);if(O){for(var N=0;N<b.FileIndex.length;++N)if(b.FileIndex[N]==O)return b.FileIndex.splice(N,1),b.FullPaths.splice(N,1),!0}return!1}function es(b,L,O){T(b);var N=Qe.find(b,L);if(N){for(var B=0;B<b.FileIndex.length;++B)if(b.FileIndex[B]==N)return b.FileIndex[B].name=s(O),b.FullPaths[B]=O,!0}return!1}function vu(b){S(b,!0)}return e.find=C,e.read=z,e.parse=h,e.write=Ye,e.writeFile=_t,e.utils={cfb_new:Va,cfb_add:Vs,cfb_del:Ut,cfb_mov:es,cfb_gc:vu,ReadShift:pl,CheckField:F2,prep_blob:yn,bconcat:hn,use_zlib:V,_deflateRaw:dt,_inflateRaw:Ls,consts:Me},e})();function zD(t){return typeof t=="string"?Rf(t):Array.isArray(t)?gD(t):t}function hu(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Rf(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?xi(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([zD(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=La(e)),o.write(e),o.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function HD(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Rr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function d1(t,e){for(var r=[],n=Rr(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function Pf(t){for(var e=[],r=Rr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Ff(t){for(var e=[],r=Rr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function GD(t){for(var e=[],r=Rr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Uh=new Date(1899,11,30,0,0,0);function nn(t,e){var r=t.getTime(),n=Uh.getTime()+(t.getTimezoneOffset()-Uh.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var f2=new Date,qD=Uh.getTime()+(f2.getTimezoneOffset()-Uh.getTimezoneOffset())*6e4,m1=f2.getTimezoneOffset();function Nf(t){var e=new Date;return e.setTime(t*24*60*60*1e3+qD),e.getTimezoneOffset()!==m1&&e.setTime(e.getTime()+(e.getTimezoneOffset()-m1)*6e4),e}function XD(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var p1=new Date("2017-02-19T19:06:09.000Z"),d2=isNaN(p1.getFullYear())?new Date("2/19/17"):p1,KD=d2.getFullYear()==2017;function hr(t,e){var r=new Date(t);if(KD)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(d2.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function _o(t,e){if(yt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return xi(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return xi(e2(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return xi(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return xi(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function fr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=fr(t[r]));return e}function Ir(t,e){for(var r="";r.length<e;)r+=t;return r}function ri(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var YD=["january","february","march","april","may","june","july","august","september","october","november","december"];function _c(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&YD.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var QD=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),a=[i[0]],o=1;o<i.length;++o)a.push(s),a.push(i[o]);return a}})();function m2(t){return t?t.content&&t.type?_o(t.content,!0):t.data?il(t.data):t.asNodeBuffer&&yt?il(t.asNodeBuffer().toString("binary")):t.asBinary?il(t.asBinary()):t._data&&t._data.getContent?il(_o(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function p2(t){if(!t)return null;if(t.data)return n1(t.data);if(t.asNodeBuffer&&yt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?n1(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function JD(t){return t&&t.name.slice(-4)===".bin"?p2(t):m2(t)}function Cs(t,e){for(var r=t.FullPaths||Rr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var a=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||s==a)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function Dm(t,e){var r=Cs(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Hr(t,e,r){if(!r)return JD(Dm(t,e));if(!e)return null;try{return Hr(t,e)}catch{return null}}function gs(t,e,r){if(!r)return m2(Dm(t,e));if(!e)return null;try{return gs(t,e)}catch{return null}}function ZD(t,e,r){return p2(Dm(t,e))}function g1(t){for(var e=t.FullPaths||Rr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function vt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return yt?n=ea(r):n=xD(r),Qe.utils.cfb_add(t,e,n)}Qe.utils.cfb_add(t,e,r)}else t.file(e,r)}function Pm(){return Qe.utils.cfb_new()}function g2(t,e){switch(e.type){case"base64":return Qe.read(t,{type:"base64"});case"binary":return Qe.read(t,{type:"binary"});case"buffer":case"array":return Qe.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function ol(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var jr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,eP=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,x1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tP=/<[^>]*>/g,Wn=jr.match(x1)?x1:tP,rP=/<\w*:/,nP=/<(\/?)\w+:/;function lt(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var a=t.match(eP),o=0,c="",l=0,h="",d="",f=1;if(a)for(l=0;l!=a.length;++l){for(d=a[l],i=0;i!=d.length&&d.charCodeAt(i)!==61;++i);for(h=d.slice(0,i).trim();d.charCodeAt(i+1)==32;)++i;for(f=(s=d.charCodeAt(i+1))==34||s==39?1:0,c=d.slice(i+1+f,d.length-f),o=0;o!=h.length&&h.charCodeAt(o)!==58;++o);if(o===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=c,n[h.toLowerCase()]=c;else{var g=(o===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(o+1);if(n[g]&&h.slice(o-3,o)=="ext")continue;n[g]=c,n[g.toLowerCase()]=c}}return n}function Si(t){return t.replace(nP,"<$1")}var x2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Fm=Pf(x2),Nt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(o,c){return x2[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,c){return String.fromCharCode(parseInt(c,16))});var a=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,a)+r(s.slice(a+3))}})(),Nm=/[&<>'"]/g,sP=/[\u0000-\u0008\u000b-\u001f]/g;function er(t){var e=t+"";return e.replace(Nm,function(r){return Fm[r]}).replace(sP,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function w1(t){return er(t).replace(/ /g,"_x0020_")}var w2=/[\u0000-\u001f]/g;function Om(t){var e=t+"";return e.replace(Nm,function(r){return Fm[r]}).replace(/\n/g,"<br/>").replace(w2,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function iP(t){var e=t+"";return e.replace(Nm,function(r){return Fm[r]}).replace(w2,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var v1=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function aP(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function ur(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function g0(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,e+=String.fromCharCode(a);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function _1(t){var e=Ca(2*t.length),r,n,s=1,i=0,a=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[i++]=a&255,e[i++]=a>>>8,a=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function y1(t){return ea(t,"binary").toString("utf8")}var Wu="foo bar baz",rr=yt&&(y1(Wu)==g0(Wu)&&y1||_1(Wu)==g0(Wu)&&_1)||g0,xi=yt?function(t){return ea(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Nl=(function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),v2=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}})(),oP=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),cP=/<\/?(?:vt:)?variant>/g,lP=/<(?:vt:)([^>]*)>([\s\S]*)</;function E1(t,e){var r=lt(t),n=t.match(oP(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var a=i.replace(cP,"").match(lP);a&&s.push({v:rr(a[2]),t:a[1]})}),s}var _2=/(^\s|\s$|\n)/;function En(t,e){return"<"+t+(e.match(_2)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Ol(t){return Rr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Pe(t,e,r){return"<"+t+(r!=null?Ol(r):"")+(e!=null?(e.match(_2)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function ad(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function uP(t,e){switch(typeof t){case"string":var r=Pe("vt:lpwstr",er(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Pe((t|0)==t?"vt:i4":"vt:r8",er(String(t)));case"boolean":return Pe("vt:bool",t?"true":"false")}if(t instanceof Date)return Pe("vt:filetime",ad(t));throw new Error("Unable to serialize "+t)}function Lm(t){if(yt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return rr(La(Im(t)));throw new Error("Bad input format: expected Buffer or string")}var Ll=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,tn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ro=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],fs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function hP(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function fP(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,a=n?-e:e;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var o=0;o<=5;++o,i/=256)t[r+o]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var T1=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},S1=yt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:ea(e)})):T1(t)}:T1,A1=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(Li(t,s)));return n.join("").replace(Xn,"")},Mm=yt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Xn,""):A1(t,e,r)}:A1,k1=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},y2=yt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):k1(t,e,r)}:k1,b1=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Yo(t,s)));return n.join("")},fu=yt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):b1(e,r,n)}:b1,E2=function(t,e){var r=ds(t,e);return r>0?fu(t,e+4,e+4+r-1):""},T2=E2,S2=function(t,e){var r=ds(t,e);return r>0?fu(t,e+4,e+4+r-1):""},A2=S2,k2=function(t,e){var r=2*ds(t,e);return r>0?fu(t,e+4,e+4+r-1):""},b2=k2,I2=function(e,r){var n=ds(e,r);return n>0?Mm(e,r+4,r+4+n):""},C2=I2,R2=function(t,e){var r=ds(t,e);return r>0?fu(t,e+4,e+4+r):""},D2=R2,P2=function(t,e){return hP(t,e)},Wh=P2,Bm=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};yt&&(T2=function(e,r){if(!Buffer.isBuffer(e))return E2(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},A2=function(e,r){if(!Buffer.isBuffer(e))return S2(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},b2=function(e,r){if(!Buffer.isBuffer(e))return k2(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},C2=function(e,r){if(!Buffer.isBuffer(e))return I2(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},D2=function(e,r){if(!Buffer.isBuffer(e))return R2(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Wh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):P2(e,r)},Bm=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Yo=function(t,e){return t[e]},Li=function(t,e){return t[e+1]*256+t[e]},dP=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ds=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},no=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},mP=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function pl(t,e){var r="",n,s,i=[],a,o,c,l;switch(e){case"dbcs":if(l=this.l,yt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(Li(this,l)),l+=2;t*=2;break;case"utf8":r=fu(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Mm(this,this.l,this.l+t);break;case"wstr":return pl.call(this,t,"dbcs");case"lpstr-ansi":r=T2(this,this.l),t=4+ds(this,this.l);break;case"lpstr-cp":r=A2(this,this.l),t=4+ds(this,this.l);break;case"lpwstr":r=b2(this,this.l),t=4+2*ds(this,this.l);break;case"lpp4":t=4+ds(this,this.l),r=C2(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ds(this,this.l),r=D2(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Yo(this,this.l+t++))!==0;)i.push(Uu(a));r=i.join("");break;case"_wstr":for(t=0,r="";(a=Li(this,this.l+t))!==0;)i.push(Uu(a)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",l=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=Yo(this,l),this.l=l+1,o=pl.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Uu(Li(this,l))),l+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",l=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=Yo(this,l),this.l=l+1,o=pl.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Uu(Yo(this,l))),l+=1}r=i.join("");break;default:switch(t){case 1:return n=Yo(this,this.l),this.l++,n;case 2:return n=(e==="i"?dP:Li)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?no:mP)(this,this.l),this.l+=4,n):(s=ds(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=Wh(this,this.l):s=Wh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=y2(this,this.l,t);break}}return this.l+=t,r}var pP=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},gP=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},xP=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function wP(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)xP(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var a=e.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,pP(this,e,this.l);break;case 8:if(n=8,r==="f"){fP(this,e,this.l);break}case 16:break;case-4:n=4,gP(this,e,this.l);break}return this.l+=n,this}function F2(t,e){var r=y2(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function yn(t,e){t.l=e,t.read_shift=pl,t.chk=F2,t.write_shift=wP}function Un(t,e){t.l+=e}function ue(t){var e=Ca(t);return yn(e,0),e}function ta(t,e,r){if(t){var n,s,i;yn(t,t.l||0);for(var a=t.length,o=0,c=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var l=Wl[o]||Wl[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;c=t.l+i;var h=l.f&&l.f(t,i,r);if(t.l=c,e(h,l,o))return}}}function as(){var t=[],e=yt?256:2048,r=function(l){var h=ue(l);return yn(h,0),h},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(l){return n&&l<n.length-n.l?n:(s(),n=r(Math.max(l+1,e)))},a=function(){return s(),hn(t)},o=function(l){s(),n=l,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:o,end:a,_bufs:t}}function we(t,e,r,n){var s=+e,i;if(!isNaN(s)){n||(n=Wl[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var a=t.next(i);s<=127?a.write_shift(1,s):(a.write_shift(1,(s&127)+128),a.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Bm(r)&&t.push(r)}}function gl(t,e,r){var n=fr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function I1(t,e,r){var n=fr(t);return n.s=gl(n.s,e.s,r),n.e=gl(n.e,e.s,r),n}function xl(t,e){if(t.cRel&&t.c<0)for(t=fr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=fr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=at(t);return!t.cRel&&t.cRel!=null&&(r=yP(r)),!t.rRel&&t.rRel!=null&&(r=vP(r)),r}function x0(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+_r(t.s.c)+":"+(t.e.cRel?"":"$")+_r(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Mr(t.s.r)+":"+(t.e.rRel?"":"$")+Mr(t.e.r):xl(t.s,e.biff)+":"+xl(t.e,e.biff)}function Vm(t){return parseInt(_P(t),10)-1}function Mr(t){return""+(t+1)}function vP(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function _P(t){return t.replace(/\$(\d+)$/,"$1")}function jm(t){for(var e=EP(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function _r(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function yP(t){return t.replace(/^([A-Z])/,"$$$1")}function EP(t){return t.replace(/^\$([A-Z])/,"$1")}function TP(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function yr(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function at(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function os(t){var e=t.indexOf(":");return e==-1?{s:yr(t),e:yr(t)}:{s:yr(t.slice(0,e)),e:yr(t.slice(e+1))}}function wt(t,e){return typeof e>"u"||typeof e=="number"?wt(t.s,t.e):(typeof t!="string"&&(t=at(t)),typeof e!="string"&&(e=at(e)),t==e?t:t+":"+e)}function Ot(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function C1(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Ns(t.z,r?nn(e):e)}catch{}try{return t.w=Ns((t.XF||{}).numFmtId||(r?14:0),r?nn(e):e)}catch{return""+e}}function Xi(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?ra[t.v]||t.v:e==null?C1(t,t.v):C1(t,e))}function Ma(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function N2(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?yr(n.origin):n.origin;a=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=Ot(i["!ref"]);l.s.c=h.s.c,l.s.r=h.s.r,l.e.c=Math.max(l.e.c,h.e.c),l.e.r=Math.max(l.e.r,h.e.r),a==-1&&(l.e.r=a=h.e.r+1)}for(var d=0;d!=e.length;++d)if(e[d]){if(!Array.isArray(e[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=e[d].length;++f)if(!(typeof e[d][f]>"u")){var g={v:e[d][f]},w=a+d,x=o+f;if(l.s.r>w&&(l.s.r=w),l.s.c>x&&(l.s.c=x),l.e.r<w&&(l.e.r=w),l.e.c<x&&(l.e.c=x),e[d][f]&&typeof e[d][f]=="object"&&!Array.isArray(e[d][f])&&!(e[d][f]instanceof Date))g=e[d][f];else if(Array.isArray(g.v)&&(g.f=e[d][f][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||it[14],n.cellDates?(g.t="d",g.w=Ns(g.z,nn(g.v))):(g.t="n",g.v=nn(g.v),g.w=Ns(g.z,g.v))):g.t="s";if(s)i[w]||(i[w]=[]),i[w][x]&&i[w][x].z&&(g.z=i[w][x].z),i[w][x]=g;else{var y=at({c:x,r:w});i[y]&&i[y].z&&(g.z=i[y].z),i[y]=g}}}return l.s.c<1e7&&(i["!ref"]=wt(l)),i}function Vc(t,e){return N2(null,t,e)}function SP(t){return t.read_shift(4,"i")}function ni(t,e){return e||(e=ue(4)),e.write_shift(4,t),e}function Bn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function fn(t,e){var r=!1;return e==null&&(r=!0,e=ue(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function AP(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function kP(t,e){return e||(e=ue(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Um(t,e){var r=t.l,n=t.read_shift(1),s=Bn(t),i=[],a={t:s,h:s};if((n&1)!==0){for(var o=t.read_shift(4),c=0;c!=o;++c)i.push(AP(t));a.r=i}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function bP(t,e){var r=!1;return e==null&&(r=!0,e=ue(15+4*t.t.length)),e.write_shift(1,0),fn(t.t,e),r?e.slice(0,e.l):e}var IP=Um;function CP(t,e){var r=!1;return e==null&&(r=!0,e=ue(23+4*t.t.length)),e.write_shift(1,1),fn(t.t,e),e.write_shift(4,1),kP({},e),r?e.slice(0,e.l):e}function Os(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Do(t,e){return e==null&&(e=ue(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Po(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Fo(t,e){return e==null&&(e=ue(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var RP=Bn,O2=fn;function Wm(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function $h(t,e){var r=!1;return e==null&&(r=!0,e=ue(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var DP=Bn,od=Wm,$m=$h;function zm(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?Wh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):no(e,0)>>2;return r?s/100:s}function L2(t,e){e==null&&(e=ue(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function M2(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function PP(t,e){return e||(e=ue(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var No=M2,jc=PP;function Ln(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function yo(t,e){return(e||ue(8)).write_shift(8,t,"f")}function FP(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var l=oo[s];l&&(e.rgb=Bl(l));break;case 2:e.rgb=Bl([a,o,c]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function zh(t,e){if(e||(e=ue(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function NP(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function OP(t,e){e||(e=ue(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function B2(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function LP(t){return B2(t,1)}function MP(t){return B2(t,2)}var Hm=2,rs=3,$u=11,R1=12,Hh=19,zu=64,BP=65,VP=71,jP=4108,UP=4126,ln=80,V2=81,WP=[ln,V2],cd={1:{n:"CodePage",t:Hm},2:{n:"Category",t:ln},3:{n:"PresentationFormat",t:ln},4:{n:"ByteCount",t:rs},5:{n:"LineCount",t:rs},6:{n:"ParagraphCount",t:rs},7:{n:"SlideCount",t:rs},8:{n:"NoteCount",t:rs},9:{n:"HiddenCount",t:rs},10:{n:"MultimediaClipCount",t:rs},11:{n:"ScaleCrop",t:$u},12:{n:"HeadingPairs",t:jP},13:{n:"TitlesOfParts",t:UP},14:{n:"Manager",t:ln},15:{n:"Company",t:ln},16:{n:"LinksUpToDate",t:$u},17:{n:"CharacterCount",t:rs},19:{n:"SharedDoc",t:$u},22:{n:"HyperlinksChanged",t:$u},23:{n:"AppVersion",t:rs,p:"version"},24:{n:"DigSig",t:BP},26:{n:"ContentType",t:ln},27:{n:"ContentStatus",t:ln},28:{n:"Language",t:ln},29:{n:"Version",t:ln},255:{},2147483648:{n:"Locale",t:Hh},2147483651:{n:"Behavior",t:Hh},1919054434:{}},ld={1:{n:"CodePage",t:Hm},2:{n:"Title",t:ln},3:{n:"Subject",t:ln},4:{n:"Author",t:ln},5:{n:"Keywords",t:ln},6:{n:"Comments",t:ln},7:{n:"Template",t:ln},8:{n:"LastAuthor",t:ln},9:{n:"RevNumber",t:ln},10:{n:"EditTime",t:zu},11:{n:"LastPrinted",t:zu},12:{n:"CreatedDate",t:zu},13:{n:"ModifiedDate",t:zu},14:{n:"PageCount",t:rs},15:{n:"WordCount",t:rs},16:{n:"CharCount",t:rs},17:{n:"Thumbnail",t:VP},18:{n:"Application",t:ln},19:{n:"DocSecurity",t:rs},255:{},2147483648:{n:"Locale",t:Hh},2147483651:{n:"Behavior",t:Hh},1919054434:{}},D1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},$P=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function zP(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var HP=zP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),oo=fr(HP),ra={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},j2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ud={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Hu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Gm(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function GP(t){var e=Gm();if(!t||!t.match)return e;var r={};if((t.match(Wn)||[]).forEach(function(n){var s=lt(n);switch(s[0].replace(rP,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[ud[s.ContentType]]!==void 0&&e[ud[s.ContentType]].push(s.PartName);break}}),e.xmlns!==tn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function U2(t,e){var r=GD(ud),n=[],s;n[n.length]=jr,n[n.length]=Pe("Types",null,{xmlns:tn.CT,"xmlns:xsd":tn.xsd,"xmlns:xsi":tn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Pe("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){t[c]&&t[c].length>0&&(s=t[c][0],n[n.length]=Pe("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Hu[c][e.bookType]||Hu[c].xlsx}))},a=function(c){(t[c]||[]).forEach(function(l){n[n.length]=Pe("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:Hu[c][e.bookType]||Hu[c].xlsx})})},o=function(c){(t[c]||[]).forEach(function(l){n[n.length]=Pe("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:r[c][0]})})};return i("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Et={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ml(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function wl(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Wn)||[]).forEach(function(s){var i=lt(s);if(i[0]==="<Relationship"){var a={};a.Type=i.Type,a.Target=i.Target,a.Id=i.Id,i.TargetMode&&(a.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:ol(i.Target,e);r[o]=a,n[i.Id]=a}}),r["!id"]=n,r}function oc(t){var e=[jr,Pe("Relationships",null,{xmlns:tn.RELS})];return Rr(t["!id"]).forEach(function(r){e[e.length]=Pe("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Zt(t,e,r,n,s,i){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,[Et.HLINK,Et.XPATH,Et.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}var qP="application/vnd.oasis.opendocument.spreadsheet";function XP(t,e){for(var r=Lm(t),n,s;n=Ll.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=lt(n[0],!1),s.path=="/"&&s.type!==qP)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function KP(t){var e=[jr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function P1(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function YP(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function QP(t){var e=[jr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(P1(t[r][0],t[r][1])),e.push(YP("",t[r][0]));return e.push(P1("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function W2(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Mh.version+"</meta:generator></office:meta></office:document-meta>"}var Ps=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],JP=(function(){for(var t=new Array(Ps.length),e=0;e<Ps.length;++e){var r=Ps[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function $2(t){var e={};t=rr(t);for(var r=0;r<Ps.length;++r){var n=Ps[r],s=t.match(JP[r]);s!=null&&s.length>0&&(e[n[1]]=Nt(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=hr(e[n[1]]))}return e}function w0(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=er(e),n[n.length]=r?Pe(t,e,r):En(t,e))}function z2(t,e){var r=e||{},n=[jr,Pe("cp:coreProperties",null,{"xmlns:cp":tn.CORE_PROPS,"xmlns:dc":tn.dc,"xmlns:dcterms":tn.dcterms,"xmlns:dcmitype":tn.dcmitype,"xmlns:xsi":tn.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&w0("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:ad(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&w0("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:ad(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=Ps.length;++i){var a=Ps[i],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&w0(a[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var co=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],H2=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function G2(t,e,r,n){var s=[];if(typeof t=="string")s=E1(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(h){return{v:h}}));var a=typeof e=="string"?E1(e,n).map(function(h){return h.v}):e,o=0,c=0;if(a.length>0)for(var l=0;l!==s.length;l+=2){switch(c=+s[l+1].v,s[l].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=a.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=a.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=a.slice(o,o+c);break}o+=c}}function ZP(t,e,r){var n={};return e||(e={}),t=rr(t),co.forEach(function(s){var i=(t.match(Nl(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=Nt(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var a=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));a&&a.length>0&&(n[s[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&G2(n.HeadingPairs,n.TitlesOfParts,e,r),e}function q2(t){var e=[],r=Pe;return t||(t={}),t.Application="SheetJS",e[e.length]=jr,e[e.length]=Pe("Properties",null,{xmlns:tn.EXT_PROPS,"xmlns:vt":tn.vt}),co.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=er(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+er(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var eF=/<[^>]+>[^<]*/g;function tF(t,e){var r={},n="",s=t.match(eF);if(s)for(var i=0;i!=s.length;++i){var a=s[i],o=lt(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Nt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var c=a.split(">"),l=c[0].slice(4),h=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":r[n]=Nt(h);break;case"bool":r[n]=ur(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=hr(h);break;case"cy":case"error":r[n]=Nt(h);break;default:if(l.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,l,c)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function X2(t){var e=[jr,Pe("Properties",null,{xmlns:tn.CUST_PROPS,"xmlns:vt":tn.vt})];if(!t)return e.join("");var r=1;return Rr(t).forEach(function(s){++r,e[e.length]=Pe("property",uP(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:er(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var hd={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},v0;function rF(t,e,r){v0||(v0=Pf(hd)),e=v0[e]||e,t[e]=r}function nF(t,e){var r=[];return Rr(hd).map(function(n){for(var s=0;s<Ps.length;++s)if(Ps[s][1]==n)return Ps[s];for(s=0;s<co.length;++s)if(co[s][1]==n)return co[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(En(hd[n[1]]||n[1],s))}}),Pe("DocumentProperties",r.join(""),{xmlns:fs.o})}function sF(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&Rr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var a=0;a<Ps.length;++a)if(i==Ps[a][1])return;for(a=0;a<co.length;++a)if(i==co[a][1])return;for(a=0;a<r.length;++a)if(i==r[a])return;var o=t[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(Pe(w1(i),o,{"dt:dt":c}))}}),e&&Rr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var a=e[i],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),s.push(Pe(w1(i),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+fs.o+'">'+s.join("")+"</"+n+">"}function qm(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function iF(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var a=ue(8);return a.write_shift(4,n),a.write_shift(4,s),a}function K2(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function Y2(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function Q2(t,e,r){return e===31?Y2(t):K2(t,e,r)}function fd(t,e,r){return Q2(t,e,r===!1?0:4)}function aF(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return Q2(t,e,0)}function oF(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Xn,""),t.l-s&2&&(t.l+=2)}return r}function cF(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Xn,"");return r}function lF(t){var e=t.l,r=Gh(t,V2);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Gh(t,rs);return[r,n]}function uF(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(lF(t));return r}function F1(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),a=t.read_shift(4);n[i]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Xn,"").replace(al,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function J2(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function hF(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Gh(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==R1&&n!==e&&WP.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===R1?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return K2(t,n,4).replace(Xn,"");case 31:return Y2(t);case 64:return qm(t);case 65:return J2(t);case 71:return hF(t);case 80:return fd(t,n,!i.raw).replace(Xn,"");case 81:return aF(t,n).replace(Xn,"");case 4108:return uF(t);case 4126:case 4127:return n==4127?oF(t):cF(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function N1(t,e){var r=ue(4),n=ue(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ue(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=iF(e);break;case 31:case 80:for(n=ue(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return hn([r,n])}function O1(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0,o=0,c=-1,l={};for(a=0;a!=s;++a){var h=t.read_shift(4),d=t.read_shift(4);i[a]=[h,d+r]}i.sort(function(F,I){return F[1]-I[1]});var f={};for(a=0;a!=s;++a){if(t.l!==i[a][1]){var g=!0;if(a>0&&e)switch(e[i[a-1][0]].t){case 2:t.l+2===i[a][1]&&(t.l+=2,g=!1);break;case 80:t.l<=i[a][1]&&(t.l=i[a][1],g=!1);break;case 4108:t.l<=i[a][1]&&(t.l=i[a][1],g=!1);break}if((!e||a==0)&&t.l<=i[a][1]&&(g=!1,t.l=i[a][1]),g)throw new Error("Read Error: Expected address "+i[a][1]+" at "+t.l+" :"+a)}if(e){var w=e[i[a][0]];if(f[w.n]=Gh(t,w.t,{raw:!0}),w.p==="version"&&(f[w.n]=String(f[w.n]>>16)+"."+("0000"+String(f[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(f[w.n]){case 0:f[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Js(o=f[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[w.n])}}else if(i[a][0]===1){if(o=f.CodePage=Gh(t,Hm),Js(o),c!==-1){var x=t.l;t.l=i[c][1],l=F1(t,o),t.l=x}}else if(i[a][0]===0){if(o===0){c=a,t.l=i[a+1][1];continue}l=F1(t,o)}else{var y=l[i[a][0]],A;switch(t[t.l]){case 65:t.l+=4,A=J2(t);break;case 30:t.l+=4,A=fd(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,A=fd(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,A=t.read_shift(4,"i");break;case 19:t.l+=4,A=t.read_shift(4);break;case 5:t.l+=4,A=t.read_shift(8,"f");break;case 11:t.l+=4,A=Fr(t,4);break;case 64:t.l+=4,A=hr(qm(t));break;default:throw new Error("unparsed value: "+t[t.l])}f[y]=A}}return t.l=r+n,f}var Z2=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function fF(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function L1(t,e,r){var n=ue(8),s=[],i=[],a=8,o=0,c=ue(8),l=ue(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),i.push(c),s.push(l),a+=8+c.length,!e){l=ue(8),l.write_shift(4,0),s.unshift(l);var h=[ue(4)];for(h[0].write_shift(4,t.length),o=0;o<t.length;++o){var d=t[o][0];for(c=ue(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=hn(h),i.unshift(c),a+=8+c.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(Z2.indexOf(t[o][0])>-1||H2.indexOf(t[o][0])>-1)&&t[o][1]!=null){var f=t[o][1],g=0;if(e){g=+e[t[o][0]];var w=r[g];if(w.p=="version"&&typeof f=="string"){var x=f.split(".");f=(+x[0]<<16)+(+x[1]||0)}c=N1(w.t,f)}else{var y=fF(f);y==-1&&(y=31,f=String(f)),c=N1(y,f)}i.push(c),l=ue(8),l.write_shift(4,e?g:2+o),s.push(l),a+=8+c.length}var A=8*(i.length+1);for(o=0;o<i.length;++o)s[o].write_shift(4,A),A+=i[o].length;return n.write_shift(4,a),n.write_shift(4,i.length),hn([n].concat(s).concat(i))}function M1(t,e,r){var n=t.content;if(!n)return{};yn(n,0);var s,i,a,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),h=n.read_shift(16);if(h!==Qe.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(a=n.read_shift(16),c=n.read_shift(4));var d=O1(n,e),f={SystemIdentifier:l};for(var g in d)f[g]=d[g];if(f.FMTID=i,s===1)return f;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var w;try{w=O1(n,null)}catch{}for(g in w)f[g]=w[g];return f.FMTID=[i,a],f}function B1(t,e,r,n,s,i){var a=ue(s?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Qe.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,s?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,s?68:48);var c=L1(t,r,n);if(o.push(c),s){var l=L1(s,null,null);a.write_shift(16,i,"hex"),a.write_shift(4,68+c.length),o.push(l)}return hn(o)}function la(t,e){return t.read_shift(e),null}function dF(t,e){e||(e=ue(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function mF(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Fr(t,e){return t.read_shift(e)===1}function Gn(t,e){return e||(e=ue(2)),e.write_shift(2,+!!t),e}function Gr(t){return t.read_shift(2,"u")}function Rs(t,e){return e||(e=ue(2)),e.write_shift(2,t),e}function ey(t,e){return mF(t,e,Gr)}function pF(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function ty(t,e,r){return r||(r=ue(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function du(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?t.read_shift(n,s):"";return a}function gF(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),a=0,o,c={};s&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var l=i==2?"dbcs-cont":"sbcs-cont",h=e===0?"":t.read_shift(e,l);return s&&(t.l+=4*a),n&&(t.l+=o),c.t=h,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function xF(t){var e=t.t||"",r=ue(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ue(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return hn(s)}function Eo(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function mu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Eo(t,n,r)}function Oo(t,e,r){if(r.biff>5)return mu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function ry(t,e,r){return r||(r=ue(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function wF(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function vF(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Xn,"");return n&&(t.l+=24),s}function _F(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(i>>1,"utf16le").replace(Xn,"");return r+a}function yF(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return vF(t);case"0303000000000000c000000000000046":return _F(t);default:throw new Error("Unsupported Moniker "+r)}}function Gu(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Xn,""):"";return r}function V1(t,e){e||(e=ue(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function EF(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,a,o,c,l="",h,d;s&16&&(i=Gu(t,r-t.l)),s&128&&(a=Gu(t,r-t.l)),(s&257)===257&&(o=Gu(t,r-t.l)),(s&257)===1&&(c=yF(t,r-t.l)),s&8&&(l=Gu(t,r-t.l)),s&32&&(h=t.read_shift(16)),s&64&&(d=qm(t)),t.l=r;var f=a||o||c||"";f&&l&&(f+="#"+l),f||(f="#"+l),s&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var g={Target:f};return h&&(g.guid=h),d&&(g.time=d),i&&(g.Tooltip=i),g}function TF(t){var e=ue(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(i==28)n=n.slice(1),V1(n,e);else if(i&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),i&8&&V1(s>-1?n.slice(s+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function ny(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function sy(t,e){var r=ny(t);return r[3]=0,r}function Ai(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function To(t,e,r,n){return n||(n=ue(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function SF(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function AF(t,e,r){return e===0?"":Oo(t,e,r)}function kF(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[s,i,a]}function iy(t){var e=t.read_shift(2),r=zm(t);return[e,r]}function bF(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=du(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function Of(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function ay(t,e){return e||(e=ue(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function oy(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var IF=oy;function cy(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function CF(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function RF(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function bn(t){t.l+=2,t.l+=t.read_shift(2)}var DF={0:bn,4:bn,5:bn,6:bn,7:RF,8:bn,9:bn,10:bn,11:bn,12:bn,13:CF,14:bn,15:bn,16:bn,17:bn,18:bn,19:bn,20:bn,21:cy};function PF(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(DF[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function qu(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Xm(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=ue(s);return i.write_shift(2,n),i.write_shift(2,e),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function FF(t,e){return e===0||t.read_shift(2),1200}function NF(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=Oo(t,0,r);return t.read_shift(e+n-t.l),s}function OF(t,e){var r=!e||e.biff==8,n=ue(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function LF(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function MF(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var a=du(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:s,dt:i,name:a}}function BF(t,e){var r=!e||e.biff>=8?2:1,n=ue(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function VF(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0;a!=s&&t.l<r;++a)i.push(gF(t));return i.Count=n,i.Unique=s,i}function jF(t,e){var r=ue(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=xF(t[s]);var i=hn([r].concat(n));return i.parts=[r.length].concat(n.map(function(a){return a.length})),i}function UF(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function WF(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function $F(t){var e=SF(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function zF(t){return t.read_shift(2),t.read_shift(4)}function j1(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function HF(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),l=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:a,FirstTab:o,Selected:c,TabRatio:l}}function GF(){var t=ue(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function qF(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function XF(t){var e=ue(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function KF(){}function YF(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=du(t,0,r),n}function QF(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,i=ue(s);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function JF(t){var e=Ai(t);return e.isst=t.read_shift(4),e}function ZF(t,e,r,n){var s=ue(10);return To(t,e,n,s),s.write_shift(4,r),s}function e3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Ai(t);r.biff==2&&t.l++;var i=mu(t,n-t.l,r);return s.val=i,s}function t3(t,e,r,n,s){var i=!s||s.biff==8,a=ue(8+ +i+(1+i)*r.length);return To(t,e,n,a),a.write_shift(2,r.length),i&&a.write_shift(1,1),a.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),a}function r3(t,e,r){var n=t.read_shift(2),s=Oo(t,0,r);return[n,s]}function n3(t,e,r,n){var s=r&&r.biff==5;n||(n=ue(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var s3=Oo;function U1(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),a=t.read_shift(s),o=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:i,c:o},e:{r:a,c}}}function i3(t,e){var r=e.biff==8||!e.biff?4:2,n=ue(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function a3(t){var e=t.read_shift(2),r=t.read_shift(2),n=iy(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function o3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(iy(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:a,rkrec:i}}function c3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:a,ixfe:i}}function l3(t,e,r,n){var s={},i=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(2);return s.patternType=$P[o>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=a&15,s.dgRight=a>>4&15,s.dgTop=a>>8&15,s.dgBottom=a>>12&15,s.icvLeft=a>>16&127,s.icvRight=a>>23&127,s.grbitDiag=a>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function u3(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=l3(t,e,n.fStyle,r),n}function W1(t,e,r,n){var s=r&&r.biff==5;n||(n=ue(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function h3(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function f3(t){var e=ue(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function $1(t,e,r){var n=Ai(t);(r.biff==2||e==9)&&++t.l;var s=pF(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function d3(t,e,r,n,s,i){var a=ue(8);return To(t,e,n,a),ty(r,i,a),a}function m3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ai(t),s=Ln(t);return n.val=s,n}function p3(t,e,r,n){var s=ue(14);return To(t,e,n,s),yo(r,s),s}var z1=AF;function g3(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var a=Eo(t,i),o=[];n>t.l;)o.push(mu(t));return[i,s,a,o]}function H1(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=bF(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var x3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function G1(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var l=Eo(t,a,r);s&32&&(l=x3[l.charCodeAt(0)]);var h=n-t.l;r&&r.biff==2&&--h;var d=n==t.l||o===0||!(h>0)?[]:P5(t,h,r,o);return{chKey:i,Name:l,itab:c,rgce:d}}function ly(t,e,r){if(r.biff<8)return w3(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(kF(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function w3(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=du(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function v3(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=Eo(t,n,r),a=Eo(t,s,r);return[i,a]}function _3(t,e,r){var n=oy(t);t.l++;var s=t.read_shift(1);return e-=8,[F5(t,e,r),s,n]}function q1(t,e,r){var n=IF(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,R5(t,e,r)]}function y3(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function E3(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=Oo(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,a,i]}}function T3(t,e,r){return E3(t,e,r)}function S3(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Of(t));return r}function A3(t){var e=ue(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)ay(t[r],e);return e}function k3(t,e,r){if(r&&r.biff<8)return I3(t,e,r);var n=cy(t),s=PF(t,e-22,n[1]);return{cmo:n,ft:s}}var b3={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function I3(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((b3[n]||Un)(t,e,r)),{cmo:[s,n,i],ft:a}}function C3(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:a=wF(t,6,r);var o=t.read_shift(2);t.read_shift(2),Gr(t,2);var c=t.read_shift(2);t.l+=c;for(var l=1;l<t.lens.length-1;++l){if(t.l-n!=t.lens[l])throw new Error("TxO: bad continue record");var h=t[t.l],d=Eo(t,t.lens[l+1]-t.lens[l]-1);if(s+=d,s.length>=(h?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function R3(t,e){var r=Of(t);t.l+=16;var n=EF(t,e-24);return[r,n]}function D3(t){var e=ue(24),r=yr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return hn([e,TF(t[1])])}function P3(t,e){t.read_shift(2);var r=Of(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Xn,""),[r,n]}function F3(t){var e=t[1].Tooltip,r=ue(10+2*(e.length+1));r.write_shift(2,2048);var n=yr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function N3(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=D1[r]||r,r=t.read_shift(2),e[1]=D1[r]||r,e}function O3(t){return t||(t=ue(4)),t.write_shift(2,1),t.write_shift(2,1),t}function L3(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(sy(t));return r}function M3(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(sy(t));return r}function B3(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function uy(t,e,r){if(!r.cellStyles)return Un(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var l={s,e:i,w:a,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(l.level=c>>8&7),l}function V3(t,e){var r=ue(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function j3(t,e){var r={};return e<32||(t.l+=16,r.header=Ln(t),r.footer=Ln(t),t.l+=2),r}function U3(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}function W3(t){for(var e=ue(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var $3=Ai,z3=ey,H3=mu;function G3(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function q3(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ai(t);++t.l;var s=Oo(t,e-7,r);return n.t="str",n.val=s,n}function X3(t){var e=Ai(t);++t.l;var r=Ln(t);return e.t="n",e.val=r,e}function K3(t,e,r){var n=ue(15);return wu(n,t,e),n.write_shift(8,r,"f"),n}function Y3(t){var e=Ai(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function Q3(t,e,r){var n=ue(9);return wu(n,t,e),n.write_shift(2,r),n}function J3(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function Z3(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function eN(t,e,r){var n=t.l+e,s=Ai(t),i=t.read_shift(2),a=Eo(t,i,r);return t.l=n,s.t="str",s.val=a,s}var tN=[2,3,48,49,131,139,140,245],dd=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Pf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var l=[],h=Ca(1);switch(c.type){case"base64":h=ps(vs(o));break;case"binary":h=ps(o);break;case"buffer":case"array":h=o;break}yn(h,0);var d=h.read_shift(1),f=!!(d&136),g=!1,w=!1;switch(d){case 2:break;case 3:break;case 48:g=!0,f=!0;break;case 49:g=!0,f=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var x=0,y=521;d==2&&(x=h.read_shift(2)),h.l+=3,d!=2&&(x=h.read_shift(4)),x>1048576&&(x=1e6),d!=2&&(y=h.read_shift(2));var A=h.read_shift(2),F=c.codepage||1252;d!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(F=t[h[h.l]]),h.l+=1,h.l+=2),w&&(h.l+=36);for(var I=[],W={},U=Math.min(h.length,d==2?521:y-10-(g?264:0)),z=w?32:11;h.l<U&&h[h.l]!=13;)switch(W={},W.name=Dl.utils.decode(F,h.slice(h.l,h.l+z)).replace(/[\u0000\r\n].*$/g,""),h.l+=z,W.type=String.fromCharCode(h.read_shift(1)),d!=2&&!w&&(W.offset=h.read_shift(4)),W.len=h.read_shift(1),d==2&&(W.offset=h.read_shift(2)),W.dec=h.read_shift(1),W.name.length&&I.push(W),d!=2&&(h.l+=w?13:14),W.type){case"B":(!g||W.len!=8)&&c.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+W.type)}if(h[h.l]!==13&&(h.l=y-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=y;var T=0,k=0;for(l[0]=[],k=0;k!=I.length;++k)l[0][k]=I[k].name;for(;x-- >0;){if(h[h.l]===42){h.l+=A;continue}for(++h.l,l[++T]=[],k=0,k=0;k!=I.length;++k){var S=h.slice(h.l,h.l+I[k].len);h.l+=I[k].len,yn(S,0);var R=Dl.utils.decode(F,S);switch(I[k].type){case"C":R.trim().length&&(l[T][k]=R.replace(/\s+$/,""));break;case"D":R.length===8?l[T][k]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):l[T][k]=R;break;case"F":l[T][k]=parseFloat(R.trim());break;case"+":case"I":l[T][k]=w?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":l[T][k]=!0;break;case"N":case"F":l[T][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));l[T][k]="##MEMO##"+(w?parseInt(R.trim(),10):S.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(l[T][k]=+R||0);break;case"@":l[T][k]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":l[T][k]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":l[T][k]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[T][k]=-S.read_shift(-8,"f");break;case"B":if(g&&I[k].len==8){l[T][k]=S.read_shift(8,"f");break}case"G":case"P":S.l+=I[k].len;break;case"0":if(I[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+I[k].type)}}}if(d!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=I,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var h=Vc(r(o,l),l);return h["!cols"]=l.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete l.DBF,h}function s(o,c){try{return Ma(n(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var l=c||{};if(+l.codepage>=0&&Js(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var h=as(),d=Yh(o,{header:1,raw:!0,cellDates:!0}),f=d[0],g=d.slice(1),w=o["!cols"]||[],x=0,y=0,A=0,F=1;for(x=0;x<f.length;++x){if(((w[x]||{}).DBF||{}).name){f[x]=w[x].DBF.name,++A;continue}if(f[x]!=null){if(++A,typeof f[x]=="number"&&(f[x]=f[x].toString(10)),typeof f[x]!="string")throw new Error("DBF Invalid column name "+f[x]+" |"+typeof f[x]+"|");if(f.indexOf(f[x])!==x){for(y=0;y<1024;++y)if(f.indexOf(f[x]+"_"+y)==-1){f[x]+="_"+y;break}}}}var I=Ot(o["!ref"]),W=[],U=[],z=[];for(x=0;x<=I.e.c-I.s.c;++x){var T="",k="",S=0,R=[];for(y=0;y<g.length;++y)g[y][x]!=null&&R.push(g[y][x]);if(R.length==0||f[x]==null){W[x]="?";continue}for(y=0;y<R.length;++y){switch(typeof R[y]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=R[y]instanceof Date?"D":"C";break;default:k="C"}S=Math.max(S,String(R[y]).length),T=T&&T!=k?"C":k}S>250&&(S=250),k=((w[x]||{}).DBF||{}).type,k=="C"&&w[x].DBF.len>S&&(S=w[x].DBF.len),T=="B"&&k=="N"&&(T="N",z[x]=w[x].DBF.dec,S=w[x].DBF.len),U[x]=T=="C"||k=="N"?S:i[T]||0,F+=U[x],W[x]=T}var C=h.next(32);for(C.write_shift(4,318902576),C.write_shift(4,g.length),C.write_shift(2,296+32*A),C.write_shift(2,F),x=0;x<4;++x)C.write_shift(4,0);for(C.write_shift(4,0|(+e[Z_]||3)<<8),x=0,y=0;x<f.length;++x)if(f[x]!=null){var _=h.next(32),P=(f[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);_.write_shift(1,P,"sbcs"),_.write_shift(1,W[x]=="?"?"C":W[x],"sbcs"),_.write_shift(4,y),_.write_shift(1,U[x]||i[W[x]]||0),_.write_shift(1,z[x]||0),_.write_shift(1,2),_.write_shift(4,0),_.write_shift(1,0),_.write_shift(4,0),_.write_shift(4,0),y+=U[x]||i[W[x]]||0}var Fe=h.next(264);for(Fe.write_shift(4,13),x=0;x<65;++x)Fe.write_shift(4,0);for(x=0;x<g.length;++x){var Ie=h.next(F);for(Ie.write_shift(1,0),y=0;y<f.length;++y)if(f[y]!=null)switch(W[y]){case"L":Ie.write_shift(1,g[x][y]==null?63:g[x][y]?84:70);break;case"B":Ie.write_shift(8,g[x][y]||0,"f");break;case"N":var je="0";for(typeof g[x][y]=="number"&&(je=g[x][y].toFixed(z[y]||0)),A=0;A<U[y]-je.length;++A)Ie.write_shift(1,32);Ie.write_shift(1,je,"sbcs");break;case"D":g[x][y]?(Ie.write_shift(4,("0000"+g[x][y].getFullYear()).slice(-4),"sbcs"),Ie.write_shift(2,("00"+(g[x][y].getMonth()+1)).slice(-2),"sbcs"),Ie.write_shift(2,("00"+g[x][y].getDate()).slice(-2),"sbcs")):Ie.write_shift(8,"00000000","sbcs");break;case"C":var Me=String(g[x][y]!=null?g[x][y]:"").slice(0,U[y]);for(Ie.write_shift(1,Me,"sbcs"),A=0;A<U[y]-Me.length;++A)Ie.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}})(),hy=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Rr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,g){var w=t[g];return typeof w=="number"?s1(w):w},n=function(f,g,w){var x=g.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return x==59?f:s1(x)};t["|"]=254;function s(f,g){switch(g.type){case"base64":return i(vs(f),g);case"binary":return i(f,g);case"buffer":return i(yt&&Buffer.isBuffer(f)?f.toString("binary"):La(f),g);case"array":return i(_o(f),g)}throw new Error("Unrecognized type "+g.type)}function i(f,g){var w=f.split(/[\n\r]+/),x=-1,y=-1,A=0,F=0,I=[],W=[],U=null,z={},T=[],k=[],S=[],R=0,C;for(+g.codepage>=0&&Js(+g.codepage);A!==w.length;++A){R=0;var _=w[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),P=_.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),Fe=P[0],Ie;if(_.length>0)switch(Fe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&W.push(_.slice(3).replace(/;;/g,";"));break;case"C":var je=!1,Me=!1,_t=!1,se=!1,Ye=-1,Je=-1;for(F=1;F<P.length;++F)switch(P[F].charAt(0)){case"A":break;case"X":y=parseInt(P[F].slice(1))-1,Me=!0;break;case"Y":for(x=parseInt(P[F].slice(1))-1,Me||(y=0),C=I.length;C<=x;++C)I[C]=[];break;case"K":Ie=P[F].slice(1),Ie.charAt(0)==='"'?Ie=Ie.slice(1,Ie.length-1):Ie==="TRUE"?Ie=!0:Ie==="FALSE"?Ie=!1:isNaN(ri(Ie))?isNaN(_c(Ie).getDate())||(Ie=hr(Ie)):(Ie=ri(Ie),U!==null&&Mc(U)&&(Ie=Nf(Ie))),je=!0;break;case"E":se=!0;var V=cc(P[F].slice(1),{r:x,c:y});I[x][y]=[I[x][y],V];break;case"S":_t=!0,I[x][y]=[I[x][y],"S5S"];break;case"G":break;case"R":Ye=parseInt(P[F].slice(1))-1;break;case"C":Je=parseInt(P[F].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+_)}if(je&&(I[x][y]&&I[x][y].length==2?I[x][y][0]=Ie:I[x][y]=Ie,U=null),_t){if(se)throw new Error("SYLK shared formula cannot have own formula");var Y=Ye>-1&&I[Ye][Je];if(!Y||!Y[1])throw new Error("SYLK shared formula cannot find base");I[x][y][1]=Cy(Y[1],{r:x-Ye,c:y-Je})}break;case"F":var q=0;for(F=1;F<P.length;++F)switch(P[F].charAt(0)){case"X":y=parseInt(P[F].slice(1))-1,++q;break;case"Y":for(x=parseInt(P[F].slice(1))-1,C=I.length;C<=x;++C)I[C]=[];break;case"M":R=parseInt(P[F].slice(1))/20;break;case"F":break;case"G":break;case"P":U=W[parseInt(P[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=P[F].slice(1).split(" "),C=parseInt(S[0],10);C<=parseInt(S[1],10);++C)R=parseInt(S[2],10),k[C-1]=R===0?{hidden:!0}:{wch:R},Ra(k[C-1]);break;case"C":y=parseInt(P[F].slice(1))-1,k[y]||(k[y]={});break;case"R":x=parseInt(P[F].slice(1))-1,T[x]||(T[x]={}),R>0?(T[x].hpt=R,T[x].hpx=Ec(R)):R===0&&(T[x].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+_)}q<1&&(U=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+_)}}return T.length>0&&(z["!rows"]=T),k.length>0&&(z["!cols"]=k),g&&g.sheetRows&&(I=I.slice(0,g.sheetRows)),[I,z]}function a(f,g){var w=s(f,g),x=w[0],y=w[1],A=Vc(x,g);return Rr(y).forEach(function(F){A[F]=y[F]}),A}function o(f,g){return Ma(a(f,g),g)}function c(f,g,w,x){var y="C;Y"+(w+1)+";X"+(x+1)+";K";switch(f.t){case"n":y+=f.v||0,f.f&&!f.F&&(y+=";E"+ep(f.f,{r:w,c:x}));break;case"b":y+=f.v?"TRUE":"FALSE";break;case"e":y+=f.w||f.v;break;case"d":y+='"'+(f.w||f.v)+'"';break;case"s":y+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function l(f,g){g.forEach(function(w,x){var y="F;W"+(x+1)+" "+(x+1)+" ";w.hidden?y+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Vl(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=jl(w.wpx)),typeof w.wch=="number"&&(y+=Math.round(w.wch))),y.charAt(y.length-1)!=" "&&f.push(y)})}function h(f,g){g.forEach(function(w,x){var y="F;";w.hidden?y+="M0;":w.hpt?y+="M"+20*w.hpt+";":w.hpx&&(y+="M"+20*Ul(w.hpx)+";"),y.length>2&&f.push(y+"R"+(x+1))})}function d(f,g){var w=["ID;PWXL;N;E"],x=[],y=Ot(f["!ref"]),A,F=Array.isArray(f),I=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),f["!cols"]&&l(w,f["!cols"]),f["!rows"]&&h(w,f["!rows"]),w.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var W=y.s.r;W<=y.e.r;++W)for(var U=y.s.c;U<=y.e.c;++U){var z=at({r:W,c:U});A=F?(f[W]||[])[U]:f[z],!(!A||A.v==null&&(!A.f||A.F))&&x.push(c(A,f,W,U))}return w.join(I)+I+x.join(I)+I+"E"+I}return{to_workbook:o,to_sheet:a,from_sheet:d}})(),fy=(function(){function t(i,a){switch(a.type){case"base64":return e(vs(i),a);case"binary":return e(i,a);case"buffer":return e(yt&&Buffer.isBuffer(i)?i.toString("binary"):La(i),a);case"array":return e(_o(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){for(var o=i.split(`
`),c=-1,l=-1,h=0,d=[];h!==o.length;++h){if(o[h].trim()==="BOT"){d[++c]=[],l=0;continue}if(!(c<0)){var f=o[h].trim().split(","),g=f[0],w=f[1];++h;for(var x=o[h]||"";(x.match(/["]/g)||[]).length&1&&h<o.length-1;)x+=`
`+o[++h];switch(x=x.trim(),+g){case-1:if(x==="BOT"){d[++c]=[],l=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?d[c][l]=!0:x==="FALSE"?d[c][l]=!1:isNaN(ri(w))?isNaN(_c(w).getDate())?d[c][l]=w:d[c][l]=hr(w):d[c][l]=ri(w),++l;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),d[c][l++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),d}function r(i,a){return Vc(t(i,a),a)}function n(i,a){return Ma(r(i,a),a)}var s=(function(){var i=function(c,l,h,d,f){c.push(l),c.push(h+","+d),c.push('"'+f.replace(/"/g,'""')+'"')},a=function(c,l,h,d){c.push(l+","+h),c.push(l==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var l=[],h=Ot(c["!ref"]),d,f=Array.isArray(c);i(l,"TABLE",0,1,"sheetjs"),i(l,"VECTORS",0,h.e.r-h.s.r+1,""),i(l,"TUPLES",0,h.e.c-h.s.c+1,""),i(l,"DATA",0,0,"");for(var g=h.s.r;g<=h.e.r;++g){a(l,-1,0,"BOT");for(var w=h.s.c;w<=h.e.c;++w){var x=at({r:g,c:w});if(d=f?(c[g]||[])[w]:c[x],!d){a(l,1,0,"");continue}switch(d.t){case"n":var y=d.w;!y&&d.v!=null&&(y=d.v),y==null?d.f&&!d.F?a(l,1,0,"="+d.f):a(l,1,0,""):a(l,0,y,"V");break;case"b":a(l,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":a(l,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Ns(d.z||it[14],nn(hr(d.v)))),a(l,0,d.w,"V");break;default:a(l,1,0,"")}}}a(l,-1,0,"EOD");var A=`\r
`,F=l.join(A);return F}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),dy=(function(){function t(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,f){for(var g=d.split(`
`),w=-1,x=-1,y=0,A=[];y!==g.length;++y){var F=g[y].trim().split(":");if(F[0]==="cell"){var I=yr(F[1]);if(A.length<=I.r)for(w=A.length;w<=I.r;++w)A[w]||(A[w]=[]);switch(w=I.r,x=I.c,F[2]){case"t":A[w][x]=t(F[3]);break;case"v":A[w][x]=+F[3];break;case"vtf":var W=F[F.length-1];case"vtc":switch(F[3]){case"nl":A[w][x]=!!+F[4];break;default:A[w][x]=+F[4];break}F[2]=="vtf"&&(A[w][x]=[A[w][x],W])}}}return f&&f.sheetRows&&(A=A.slice(0,f.sheetRows)),A}function n(d,f){return Vc(r(d,f),f)}function s(d,f){return Ma(n(d,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(d){if(!d||!d["!ref"])return"";for(var f=[],g=[],w,x="",y=os(d["!ref"]),A=Array.isArray(d),F=y.s.r;F<=y.e.r;++F)for(var I=y.s.c;I<=y.e.c;++I)if(x=at({r:F,c:I}),w=A?(d[F]||[])[I]:d[x],!(!w||w.v==null||w.t==="z")){switch(g=["cell",x,"t"],w.t){case"s":case"str":g.push(e(w.v));break;case"n":w.f?(g[2]="vtf",g[3]="n",g[4]=w.v,g[5]=e(w.f)):(g[2]="v",g[3]=w.v);break;case"b":g[2]="vt"+(w.f?"f":"c"),g[3]="nl",g[4]=w.v?"1":"0",g[5]=e(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var W=nn(hr(w.v));g[2]="vtc",g[3]="nd",g[4]=""+W,g[5]=w.w||Ns(w.z||it[14],W);break;case"e":continue}f.push(g.join(":"))}return f.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function h(d){return[i,a,o,a,l(d),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:h}})(),yc=(function(){function t(h,d,f,g,w){w.raw?d[f][g]=h:h===""||(h==="TRUE"?d[f][g]=!0:h==="FALSE"?d[f][g]=!1:isNaN(ri(h))?isNaN(_c(h).getDate())?d[f][g]=h:d[f][g]=hr(h):d[f][g]=ri(h))}function e(h,d){var f=d||{},g=[];if(!h||h.length===0)return g;for(var w=h.split(/[\r\n]/),x=w.length-1;x>=0&&w[x].length===0;)--x;for(var y=10,A=0,F=0;F<=x;++F)A=w[F].indexOf(" "),A==-1?A=w[F].length:A++,y=Math.max(y,A);for(F=0;F<=x;++F){g[F]=[];var I=0;for(t(w[F].slice(0,y).trim(),g,F,I,f),I=1;I<=(w[F].length-y)/10+1;++I)t(w[F].slice(y+(I-1)*10,y+I*10).trim(),g,F,I,f)}return f.sheetRows&&(g=g.slice(0,f.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(h){for(var d={},f=!1,g=0,w=0;g<h.length;++g)(w=h.charCodeAt(g))==34?f=!f:!f&&w in r&&(d[w]=(d[w]||0)+1);w=[];for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&w.push([d[g],g]);if(!w.length){d=n;for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&w.push([d[g],g])}return w.sort(function(x,y){return x[0]-y[0]||n[x[1]]-n[y[1]]}),r[w.pop()[1]]||44}function i(h,d){var f=d||{},g="",w=f.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(g=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(g=h.charAt(4),h=h.slice(6)):g=s(h.slice(0,1024)):f&&f.FS?g=f.FS:g=s(h.slice(0,1024));var y=0,A=0,F=0,I=0,W=0,U=g.charCodeAt(0),z=!1,T=0,k=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var S=f.dateNF!=null?UD(f.dateNF):null;function R(){var C=h.slice(I,W),_={};if(C.charAt(0)=='"'&&C.charAt(C.length-1)=='"'&&(C=C.slice(1,-1).replace(/""/g,'"')),C.length===0)_.t="z";else if(f.raw)_.t="s",_.v=C;else if(C.trim().length===0)_.t="s",_.v=C;else if(C.charCodeAt(0)==61)C.charCodeAt(1)==34&&C.charCodeAt(C.length-1)==34?(_.t="s",_.v=C.slice(2,-1).replace(/""/g,'"')):g6(C)?(_.t="n",_.f=C.slice(1)):(_.t="s",_.v=C);else if(C=="TRUE")_.t="b",_.v=!0;else if(C=="FALSE")_.t="b",_.v=!1;else if(!isNaN(F=ri(C)))_.t="n",f.cellText!==!1&&(_.w=C),_.v=F;else if(!isNaN(_c(C).getDate())||S&&C.match(S)){_.z=f.dateNF||it[14];var P=0;S&&C.match(S)&&(C=WD(C,f.dateNF,C.match(S)||[]),P=1),f.cellDates?(_.t="d",_.v=hr(C,P)):(_.t="n",_.v=nn(hr(C,P))),f.cellText!==!1&&(_.w=Ns(_.z,_.v instanceof Date?nn(_.v):_.v)),f.cellNF||delete _.z}else _.t="s",_.v=C;if(_.t=="z"||(f.dense?(w[y]||(w[y]=[]),w[y][A]=_):w[at({c:A,r:y})]=_),I=W+1,k=h.charCodeAt(I),x.e.c<A&&(x.e.c=A),x.e.r<y&&(x.e.r=y),T==U)++A;else if(A=0,++y,f.sheetRows&&f.sheetRows<=y)return!0}e:for(;W<h.length;++W)switch(T=h.charCodeAt(W)){case 34:k===34&&(z=!z);break;case U:case 10:case 13:if(!z&&R())break e;break}return W-I>0&&R(),w["!ref"]=wt(x),w}function a(h,d){return!(d&&d.PRN)||d.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,d):Vc(e(h,d),d)}function o(h,d){var f="",g=d.type=="string"?[0,0,0,0]:cp(h,d);switch(d.type){case"base64":f=vs(h);break;case"binary":f=h;break;case"buffer":d.codepage==65001?f=h.toString("utf8"):d.codepage&&typeof Dl<"u"||(f=yt&&Buffer.isBuffer(h)?h.toString("binary"):La(h));break;case"array":f=_o(h);break;case"string":f=h;break;default:throw new Error("Unrecognized type "+d.type)}return g[0]==239&&g[1]==187&&g[2]==191?f=rr(f.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?f=rr(f):d.type=="binary"&&typeof Dl<"u",f.slice(0,19)=="socialcalc:version:"?dy.to_sheet(d.type=="string"?f:rr(f),d):a(f,d)}function c(h,d){return Ma(o(h,d),d)}function l(h){for(var d=[],f=Ot(h["!ref"]),g,w=Array.isArray(h),x=f.s.r;x<=f.e.r;++x){for(var y=[],A=f.s.c;A<=f.e.c;++A){var F=at({r:x,c:A});if(g=w?(h[x]||[])[A]:h[F],!g||g.v==null){y.push("          ");continue}for(var I=(g.w||(Xi(g),g.w)||"").slice(0,10);I.length<10;)I+=" ";y.push(I+(A===0?" ":""))}d.push(y.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}})();function rN(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=hy.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return yc.to_workbook(t,e)}}var lo=(function(){function t(V,Y,q){if(V){yn(V,V.l||0);for(var X=q.Enum||Ye;V.l<V.length;){var he=V.read_shift(2),Ee=X[he]||X[65535],Ae=V.read_shift(2),ye=V.l+Ae,ve=Ee.f&&Ee.f(V,Ae,q);if(V.l=ye,Y(ve,Ee,he))return}}}function e(V,Y){switch(Y.type){case"base64":return r(ps(vs(V)),Y);case"binary":return r(ps(V),Y);case"buffer":case"array":return r(V,Y)}throw"Unsupported type "+Y.type}function r(V,Y){if(!V)return V;var q=Y||{},X=q.dense?[]:{},he="Sheet1",Ee="",Ae=0,ye={},ve=[],ct=[],j={s:{r:0,c:0},e:{r:0,c:0}},jt=q.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)q.Enum=Ye,t(V,function(ke,lr,dr){switch(dr){case 0:q.vers=ke,ke>=4096&&(q.qpro=!0);break;case 6:j=ke;break;case 204:ke&&(Ee=ke);break;case 222:Ee=ke;break;case 15:case 51:q.qpro||(ke[1].v=ke[1].v.slice(1));case 13:case 14:case 16:dr==14&&(ke[2]&112)==112&&(ke[2]&15)>1&&(ke[2]&15)<15&&(ke[1].z=q.dateNF||it[14],q.cellDates&&(ke[1].t="d",ke[1].v=Nf(ke[1].v))),q.qpro&&ke[3]>Ae&&(X["!ref"]=wt(j),ye[he]=X,ve.push(he),X=q.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},Ae=ke[3],he=Ee||"Sheet"+(Ae+1),Ee="");var Ur=q.dense?(X[ke[0].r]||[])[ke[0].c]:X[at(ke[0])];if(Ur){Ur.t=ke[1].t,Ur.v=ke[1].v,ke[1].z!=null&&(Ur.z=ke[1].z),ke[1].f!=null&&(Ur.f=ke[1].f);break}q.dense?(X[ke[0].r]||(X[ke[0].r]=[]),X[ke[0].r][ke[0].c]=ke[1]):X[at(ke[0])]=ke[1];break}},q);else if(V[2]==26||V[2]==14)q.Enum=Je,V[2]==14&&(q.qpro=!0,V.l=0),t(V,function(ke,lr,dr){switch(dr){case 204:he=ke;break;case 22:ke[1].v=ke[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ke[3]>Ae&&(X["!ref"]=wt(j),ye[he]=X,ve.push(he),X=q.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},Ae=ke[3],he="Sheet"+(Ae+1)),jt>0&&ke[0].r>=jt)break;q.dense?(X[ke[0].r]||(X[ke[0].r]=[]),X[ke[0].r][ke[0].c]=ke[1]):X[at(ke[0])]=ke[1],j.e.c<ke[0].c&&(j.e.c=ke[0].c),j.e.r<ke[0].r&&(j.e.r=ke[0].r);break;case 27:ke[14e3]&&(ct[ke[14e3][0]]=ke[14e3][1]);break;case 1537:ct[ke[0]]=ke[1],ke[0]==Ae&&(he=ke[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(X["!ref"]=wt(j),ye[Ee||he]=X,ve.push(Ee||he),!ct.length)return{SheetNames:ve,Sheets:ye};for(var pt={},Ft=[],ut=0;ut<ct.length;++ut)ye[ve[ut]]?(Ft.push(ct[ut]||ve[ut]),pt[ct[ut]]=ye[ct[ut]]||ye[ve[ut]]):(Ft.push(ct[ut]),pt[ct[ut]]={"!ref":"A1"});return{SheetNames:Ft,Sheets:pt}}function n(V,Y){var q=Y||{};if(+q.codepage>=0&&Js(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var X=as(),he=Ot(V["!ref"]),Ee=Array.isArray(V),Ae=[];Oe(X,0,i(1030)),Oe(X,6,c(he));for(var ye=Math.min(he.e.r,8191),ve=he.s.r;ve<=ye;++ve)for(var ct=Mr(ve),j=he.s.c;j<=he.e.c;++j){ve===he.s.r&&(Ae[j]=_r(j));var jt=Ae[j]+ct,pt=Ee?(V[ve]||[])[j]:V[jt];if(!(!pt||pt.t=="z"))if(pt.t=="n")(pt.v|0)==pt.v&&pt.v>=-32768&&pt.v<=32767?Oe(X,13,g(ve,j,pt.v)):Oe(X,14,x(ve,j,pt.v));else{var Ft=Xi(pt);Oe(X,15,d(ve,j,Ft.slice(0,239)))}}return Oe(X,1),X.end()}function s(V,Y){var q=Y||{};if(+q.codepage>=0&&Js(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var X=as();Oe(X,0,a(V));for(var he=0,Ee=0;he<V.SheetNames.length;++he)(V.Sheets[V.SheetNames[he]]||{})["!ref"]&&Oe(X,27,se(V.SheetNames[he],Ee++));var Ae=0;for(he=0;he<V.SheetNames.length;++he){var ye=V.Sheets[V.SheetNames[he]];if(!(!ye||!ye["!ref"])){for(var ve=Ot(ye["!ref"]),ct=Array.isArray(ye),j=[],jt=Math.min(ve.e.r,8191),pt=ve.s.r;pt<=jt;++pt)for(var Ft=Mr(pt),ut=ve.s.c;ut<=ve.e.c;++ut){pt===ve.s.r&&(j[ut]=_r(ut));var ke=j[ut]+Ft,lr=ct?(ye[pt]||[])[ut]:ye[ke];if(!(!lr||lr.t=="z"))if(lr.t=="n")Oe(X,23,R(pt,ut,Ae,lr.v));else{var dr=Xi(lr);Oe(X,22,T(pt,ut,Ae,dr.slice(0,239)))}}++Ae}}return Oe(X,1),X.end()}function i(V){var Y=ue(2);return Y.write_shift(2,V),Y}function a(V){var Y=ue(26);Y.write_shift(2,4096),Y.write_shift(2,4),Y.write_shift(4,0);for(var q=0,X=0,he=0,Ee=0;Ee<V.SheetNames.length;++Ee){var Ae=V.SheetNames[Ee],ye=V.Sheets[Ae];if(!(!ye||!ye["!ref"])){++he;var ve=os(ye["!ref"]);q<ve.e.r&&(q=ve.e.r),X<ve.e.c&&(X=ve.e.c)}}return q>8191&&(q=8191),Y.write_shift(2,q),Y.write_shift(1,he),Y.write_shift(1,X),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(1,1),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(4,0),Y}function o(V,Y,q){var X={s:{c:0,r:0},e:{c:0,r:0}};return Y==8&&q.qpro?(X.s.c=V.read_shift(1),V.l++,X.s.r=V.read_shift(2),X.e.c=V.read_shift(1),V.l++,X.e.r=V.read_shift(2),X):(X.s.c=V.read_shift(2),X.s.r=V.read_shift(2),Y==12&&q.qpro&&(V.l+=2),X.e.c=V.read_shift(2),X.e.r=V.read_shift(2),Y==12&&q.qpro&&(V.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function c(V){var Y=ue(8);return Y.write_shift(2,V.s.c),Y.write_shift(2,V.s.r),Y.write_shift(2,V.e.c),Y.write_shift(2,V.e.r),Y}function l(V,Y,q){var X=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(X[0].c=V.read_shift(1),X[3]=V.read_shift(1),X[0].r=V.read_shift(2),V.l+=2):(X[2]=V.read_shift(1),X[0].c=V.read_shift(2),X[0].r=V.read_shift(2)),X}function h(V,Y,q){var X=V.l+Y,he=l(V,Y,q);if(he[1].t="s",q.vers==20768){V.l++;var Ee=V.read_shift(1);return he[1].v=V.read_shift(Ee,"utf8"),he}return q.qpro&&V.l++,he[1].v=V.read_shift(X-V.l,"cstr"),he}function d(V,Y,q){var X=ue(7+q.length);X.write_shift(1,255),X.write_shift(2,Y),X.write_shift(2,V),X.write_shift(1,39);for(var he=0;he<X.length;++he){var Ee=q.charCodeAt(he);X.write_shift(1,Ee>=128?95:Ee)}return X.write_shift(1,0),X}function f(V,Y,q){var X=l(V,Y,q);return X[1].v=V.read_shift(2,"i"),X}function g(V,Y,q){var X=ue(7);return X.write_shift(1,255),X.write_shift(2,Y),X.write_shift(2,V),X.write_shift(2,q,"i"),X}function w(V,Y,q){var X=l(V,Y,q);return X[1].v=V.read_shift(8,"f"),X}function x(V,Y,q){var X=ue(13);return X.write_shift(1,255),X.write_shift(2,Y),X.write_shift(2,V),X.write_shift(8,q,"f"),X}function y(V,Y,q){var X=V.l+Y,he=l(V,Y,q);if(he[1].v=V.read_shift(8,"f"),q.qpro)V.l=X;else{var Ee=V.read_shift(2);W(V.slice(V.l,V.l+Ee),he),V.l+=Ee}return he}function A(V,Y,q){var X=Y&32768;return Y&=-32769,Y=(X?V:0)+(Y>=8192?Y-16384:Y),(X?"":"$")+(q?_r(Y):Mr(Y))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function W(V,Y){yn(V,0);for(var q=[],X=0,he="",Ee="",Ae="",ye="";V.l<V.length;){var ve=V[V.l++];switch(ve){case 0:q.push(V.read_shift(8,"f"));break;case 1:Ee=A(Y[0].c,V.read_shift(2),!0),he=A(Y[0].r,V.read_shift(2),!1),q.push(Ee+he);break;case 2:{var ct=A(Y[0].c,V.read_shift(2),!0),j=A(Y[0].r,V.read_shift(2),!1);Ee=A(Y[0].c,V.read_shift(2),!0),he=A(Y[0].r,V.read_shift(2),!1),q.push(ct+j+":"+Ee+he)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(V.read_shift(2));break;case 6:{for(var jt="";ve=V[V.l++];)jt+=String.fromCharCode(ve);q.push('"'+jt.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:ye=q.pop(),Ae=q.pop(),q.push(["AND","OR"][ve-20]+"("+Ae+","+ye+")");break;default:if(ve<32&&I[ve])ye=q.pop(),Ae=q.pop(),q.push(Ae+I[ve]+ye);else if(F[ve]){if(X=F[ve][1],X==69&&(X=V[V.l++]),X>q.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+q.join("|")+"|");return}var pt=q.slice(-X);q.length-=X,q.push(F[ve][0]+"("+pt.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}q.length==1?Y[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function U(V){var Y=[{c:0,r:0},{t:"n",v:0},0];return Y[0].r=V.read_shift(2),Y[3]=V[V.l++],Y[0].c=V[V.l++],Y}function z(V,Y){var q=U(V);return q[1].t="s",q[1].v=V.read_shift(Y-4,"cstr"),q}function T(V,Y,q,X){var he=ue(6+X.length);he.write_shift(2,V),he.write_shift(1,q),he.write_shift(1,Y),he.write_shift(1,39);for(var Ee=0;Ee<X.length;++Ee){var Ae=X.charCodeAt(Ee);he.write_shift(1,Ae>=128?95:Ae)}return he.write_shift(1,0),he}function k(V,Y){var q=U(V);q[1].v=V.read_shift(2);var X=q[1].v>>1;if(q[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return q[1].v=X,q}function S(V,Y){var q=U(V),X=V.read_shift(4),he=V.read_shift(4),Ee=V.read_shift(2);if(Ee==65535)return X===0&&he===3221225472?(q[1].t="e",q[1].v=15):X===0&&he===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Ae=Ee&32768;return Ee=(Ee&32767)-16446,q[1].v=(1-Ae*2)*(he*Math.pow(2,Ee+32)+X*Math.pow(2,Ee)),q}function R(V,Y,q,X){var he=ue(14);if(he.write_shift(2,V),he.write_shift(1,q),he.write_shift(1,Y),X==0)return he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,65535),he;var Ee=0,Ae=0,ye=0,ve=0;return X<0&&(Ee=1,X=-X),Ae=Math.log2(X)|0,X/=Math.pow(2,Ae-31),ve=X>>>0,(ve&2147483648)==0&&(X/=2,++Ae,ve=X>>>0),X-=ve,ve|=2147483648,ve>>>=0,X*=Math.pow(2,32),ye=X>>>0,he.write_shift(4,ye),he.write_shift(4,ve),Ae+=16383+(Ee?32768:0),he.write_shift(2,Ae),he}function C(V,Y){var q=S(V);return V.l+=Y-14,q}function _(V,Y){var q=U(V),X=V.read_shift(4);return q[1].v=X>>6,q}function P(V,Y){var q=U(V),X=V.read_shift(8,"f");return q[1].v=X,q}function Fe(V,Y){var q=P(V);return V.l+=Y-10,q}function Ie(V,Y){return V[V.l+Y-1]==0?V.read_shift(Y,"cstr"):""}function je(V,Y){var q=V[V.l++];q>Y-1&&(q=Y-1);for(var X="";X.length<q;)X+=String.fromCharCode(V[V.l++]);return X}function Me(V,Y,q){if(!(!q.qpro||Y<21)){var X=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var he=V.read_shift(Y-21,"cstr");return[X,he]}}function _t(V,Y){for(var q={},X=V.l+Y;V.l<X;){var he=V.read_shift(2);if(he==14e3){for(q[he]=[0,""],q[he][0]=V.read_shift(2);V[V.l];)q[he][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return q}function se(V,Y){var q=ue(5+V.length);q.write_shift(2,14e3),q.write_shift(2,Y);for(var X=0;X<V.length;++X){var he=V.charCodeAt(X);q[q.l++]=he>127?95:he}return q[q.l++]=0,q}var Ye={0:{n:"BOF",f:Gr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ie},222:{n:"SHEETNAMELP",f:je},65535:{n:""}},Je={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:C},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:_t},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:_},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:Fe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}})();function nN(t){var e={},r=t.match(Wn),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=lt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=Am[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var sN=(function(){var t=Nl("t"),e=Nl("rPr");function r(i){var a=i.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:Nt(a[1])},c=i.match(e);return c&&(o.s=nN(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(s).map(r).filter(function(o){return o.v})}})(),iN=(function(){var e=/(\r\n|\n)/g;function r(s,i,a){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),s.b&&(i.push("<b>"),a.push("</b>")),s.i&&(i.push("<i>"),a.push("</i>")),s.strike&&(i.push("<s>"),a.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),a.push("</"+c+">")),a.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),aN=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,oN=/<(?:\w+:)?r>/,cN=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Km(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Nt(rr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=rr(t),r&&(n.h=Om(n.t))):t.match(oN)&&(n.r=rr(t),n.t=Nt(rr((t.replace(cN,"").match(aN)||[]).join("").replace(Wn,""))),r&&(n.h=iN(sN(n.r)))),n):{t:""}}var lN=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,uN=/<(?:\w+:)?(?:si|sstItem)>/g,hN=/<\/(?:\w+:)?(?:si|sstItem)>/;function fN(t,e){var r=[],n="";if(!t)return r;var s=t.match(lN);if(s){n=s[2].replace(uN,"").split(hN);for(var i=0;i!=n.length;++i){var a=Km(n[i].trim(),e);a!=null&&(r[r.length]=a)}s=lt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var dN=/^\s|\s$|[\t\n\r]/;function my(t,e){if(!e.bookSST)return"";var r=[jr];r[r.length]=Pe("sst",null,{xmlns:Ro[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(dN)&&(i+=' xml:space="preserve"'),i+=">"+er(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function mN(t){return[t.read_shift(4),t.read_shift(4)]}function pN(t,e){var r=[],n=!1;return ta(t,function(i,a,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function gN(t,e){return e||(e=ue(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var xN=bP;function wN(t){var e=as();we(e,159,gN(t));for(var r=0;r<t.length;++r)we(e,19,xN(t[r]));return we(e,160),e.end()}function py(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function $i(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function vN(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=$i(t,4),e.U=$i(t,4),e.W=$i(t,4),e}function _N(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function yN(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(_N(t));return e}function EN(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function TN(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=$i(t,4),e.U=$i(t,4),e.W=$i(t,4),e}function SN(t){var e=TN(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function gy(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function xy(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function AN(t){var e=$i(t);switch(e.Minor){case 2:return[e.Minor,kN(t)];case 3:return[e.Minor,bN()];case 4:return[e.Minor,IN(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function kN(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=gy(t,r),s=xy(t,t.length-t.l);return{t:"Std",h:n,v:s}}function bN(){throw new Error("File is password-protected: ECMA-376 Extensible")}function IN(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Wn,function(i){var a=lt(i);switch(Si(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function CN(t,e){var r={},n=r.EncryptionVersionInfo=$i(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=gy(t,s),e-=s,r.EncryptionVerifier=xy(t,e),r}function RN(t){var e={},r=e.EncryptionVersionInfo=$i(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Ym(t){var e=0,r,n=py(t),s=n.length+1,i,a,o,c,l;for(r=Ca(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=(e&16384)===0?0:1,c=e<<1&32767,l=o|c,e=l^a;return e^52811}var wy=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},s=function(a,o){return n(a^o)},i=function(a){for(var o=e[a.length-1],c=104,l=a.length-1;l>=0;--l)for(var h=a[l],d=0;d!=7;++d)h&64&&(o^=r[c]),h*=2,--c;return o};return function(a){for(var o=py(a),c=i(o),l=o.length,h=Ca(16),d=0;d!=16;++d)h[d]=0;var f,g,w;for((l&1)===1&&(f=c>>8,h[l]=s(t[0],f),--l,f=c&255,g=o[o.length-1],h[l]=s(g,f));l>0;)--l,f=c>>8,h[l]=s(o[l],f),--l,f=c&255,h[l]=s(o[l],f);for(l=15,w=15-o.length;w>0;)f=c>>8,h[l]=s(t[w],f),--l,--w,f=c&255,h[l]=s(o[l],f),--l,--w;return h}})(),DN=function(t,e,r,n,s){s||(s=e),n||(n=wy(t));var i,a;for(i=0;i!=e.length;++i)a=e[i],a^=n[r],a=(a>>5|a<<3)&255,s[i]=a,++r;return[s,r,n]},PN=function(t){var e=0,r=wy(t);return function(n){var s=DN("",n,e,r);return e=s[1],s[0]}};function FN(t,e,r,n){var s={key:Gr(t),verificationBytes:Gr(t)};return r.password&&(s.verifier=Ym(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=PN(r.password)),s}function NN(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=RN(t):n.Data=CN(t,e),n}function ON(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?NN(t,e-2,n):FN(t,r.biff>=8?e:e-2,r,n),n}var vy=(function(){function t(s,i){switch(i.type){case"base64":return e(vs(s),i);case"binary":return e(s,i);case"buffer":return e(yt&&Buffer.isBuffer(s)?s.toString("binary"):La(s),i);case"array":return e(_o(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var a=i||{},o=a.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,d){Array.isArray(o)&&(o[d]=[]);for(var f=/\\\w+\b/g,g=0,w,x=-1;w=f.exec(h);){switch(w[0]){case"\\cell":var y=h.slice(g,f.lastIndex-w[0].length);if(y[0]==" "&&(y=y.slice(1)),++x,y.length){var A={v:y,t:"s"};Array.isArray(o)?o[d][x]=A:o[at({r:d,c:x})]=A}break}g=f.lastIndex}x>l.e.c&&(l.e.c=x)}),o["!ref"]=wt(l),o}function r(s,i){return Ma(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=Ot(s["!ref"]),o,c=Array.isArray(s),l=a.s.r;l<=a.e.r;++l){i.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var d=at({r:l,c:h});o=c?(s[l]||[])[h]:s[d],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Xi(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function LN(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Bl(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function MN(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),a=s-i;if(a===0)return[0,0,e];var o=0,c=0,l=s+i;switch(c=a/(l>1?2-l:l),s){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,c,l/2]}function BN(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,a=[i,i,i],o=6*e,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,a[0]+=s,a[1]+=c;break;case 1:c=s*(2-o),a[0]+=c,a[1]+=s;break;case 2:c=s*(o-2),a[1]+=s,a[2]+=c;break;case 3:c=s*(4-o),a[1]+=c,a[2]+=s;break;case 4:c=s*(o-4),a[2]+=s,a[0]+=c;break;case 5:c=s*(6-o),a[2]+=c,a[0]+=s;break}for(var l=0;l!=3;++l)a[l]=Math.round(a[l]*255);return a}function qh(t,e){if(e===0)return t;var r=MN(LN(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Bl(BN(r))}var _y=6,VN=15,jN=1,On=_y;function Vl(t){return Math.floor((t+Math.round(128/On)/256)*On)}function jl(t){return Math.floor((t-5)/On*100+.5)/100}function Xh(t){return Math.round((t*On+5)/On*256)/256}function _0(t){return Xh(jl(Vl(t)))}function Qm(t){var e=Math.abs(t-_0(t)),r=On;if(e>.005)for(On=jN;On<VN;++On)Math.abs(t-_0(t))<=e&&(e=Math.abs(t-_0(t)),r=On);On=r}function Ra(t){t.width?(t.wpx=Vl(t.width),t.wch=jl(t.wpx),t.MDW=On):t.wpx?(t.wch=jl(t.wpx),t.width=Xh(t.wch),t.MDW=On):typeof t.wch=="number"&&(t.width=Xh(t.wch),t.wpx=Vl(t.width),t.MDW=On),t.customWidth&&delete t.customWidth}var UN=96,yy=UN;function Ul(t){return t*96/yy}function Ec(t){return t*yy/96}var WN={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function $N(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match(Wn)||[]).forEach(function(a){var o=lt(a);switch(Si(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=ur(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=ur(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function zN(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match(Wn)||[]).forEach(function(a){var o=lt(a);switch(Si(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function HN(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match(Wn)||[]).forEach(function(a){var o=lt(a);switch(Si(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=rr(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?ur(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?ur(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?ur(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?ur(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?ur(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?ur(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?ur(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Am[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=ur(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=oo[s.color.index];s.color.index==81&&(c=oo[1]),c||(c=oo[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=qh(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function GN(t,e,r){e.NumberFmt=[];for(var n=Rr(it),s=0;s<n.length;++s)e.NumberFmt[n[s]]=it[n[s]];var i=t[0].match(Wn);if(i)for(s=0;s<i.length;++s){var a=lt(i[s]);switch(Si(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Nt(rr(a.formatCode)),c=parseInt(a.numFmtId,10);if(e.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=o}Wi(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function qN(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Pe("numFmt",null,{numFmtId:n,formatCode:er(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Pe("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Xu=["numFmtId","fillId","fontId","borderId","xfId"],Ku=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function XN(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(Wn)||[]).forEach(function(i){var a=lt(i),o=0;switch(Si(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Xu.length;++o)n[Xu[o]]&&(n[Xu[o]]=parseInt(n[Xu[o]],10));for(o=0;o<Ku.length;++o)n[Ku[o]]&&(n[Ku[o]]=ur(n[Ku[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};a.vertical&&(c.vertical=a.vertical),a.horizontal&&(c.horizontal=a.horizontal),a.textRotation!=null&&(c.textRotation=a.textRotation),a.indent&&(c.indent=a.indent),a.wrapText&&(c.wrapText=ur(a.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function KN(t){var e=[];return e[e.length]=Pe("cellXfs",null),t.forEach(function(r){e[e.length]=Pe("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Pe("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var YN=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var h={};if(!o)return h;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(e))&&GN(d,h,l),(d=o.match(s))&&HN(d,h,c,l),(d=o.match(n))&&zN(d,h,c,l),(d=o.match(i))&&$N(d,h,c,l),(d=o.match(r))&&XN(d,h,l),h}})();function Ey(t,e){var r=[jr,Pe("styleSheet",null,{xmlns:Ro[0],"xmlns:vt":tn.vt})],n;return t.SSF&&(n=qN(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=KN(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function QN(t,e){var r=t.read_shift(2),n=Bn(t);return[r,n]}function JN(t,e,r){r||(r=ue(6+4*e.length)),r.write_shift(2,t),fn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function ZN(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=NP(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=FP(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Bn(t),n}function eO(t,e){e||(e=ue(153)),e.write_shift(2,t.sz*20),OP(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),zh(t.color,e);var n=0;return n=2,e.write_shift(1,n),fn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var tO=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],y0,rO=Un;function X1(t,e){e||(e=ue(84)),y0||(y0=Pf(tO));var r=y0[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(zh({auto:1},e),zh({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function nO(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function Ty(t,e,r){r||(r=ue(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Qc(t,e){return e||(e=ue(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var sO=Un;function iO(t,e){return e||(e=ue(51)),e.write_shift(1,0),Qc(null,e),Qc(null,e),Qc(null,e),Qc(null,e),Qc(null,e),e.length>e.l?e.slice(0,e.l):e}function aO(t,e){return e||(e=ue(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),$h(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function oO(t,e,r){var n=ue(2052);return n.write_shift(4,t),$h(e,n),$h(r,n),n.length>n.l?n.slice(0,n.l):n}function cO(t,e,r){var n={};n.NumberFmt=[];for(var s in it)n.NumberFmt[s]=it[s];n.CellXf=[],n.Fonts=[];var i=[],a=!1;return ta(t,function(c,l,h){switch(h){case 44:n.NumberFmt[c[0]]=c[1],Wi(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=qh(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:i.push(h),a=!0;break;case 38:i.pop(),a=!1;break;default:if(l.T>0)i.push(h);else if(l.T<0)i.pop();else if(!a||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function lO(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(we(t,615,ni(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&we(t,44,JN(s,e[s]))}),we(t,616))}}function uO(t){var e=1;we(t,611,ni(e)),we(t,43,eO({sz:12,color:{theme:1},name:"Calibri",family:2})),we(t,612)}function hO(t){var e=2;we(t,603,ni(e)),we(t,45,X1({patternType:"none"})),we(t,45,X1({patternType:"gray125"})),we(t,604)}function fO(t){var e=1;we(t,613,ni(e)),we(t,46,iO()),we(t,614)}function dO(t){var e=1;we(t,626,ni(e)),we(t,47,Ty({numFmtId:0},65535)),we(t,627)}function mO(t,e){we(t,617,ni(e.length)),e.forEach(function(r){we(t,47,Ty(r,0))}),we(t,618)}function pO(t){var e=1;we(t,619,ni(e)),we(t,48,aO({xfId:0,name:"Normal"})),we(t,620)}function gO(t){var e=0;we(t,505,ni(e)),we(t,506)}function xO(t){var e=0;we(t,508,oO(e,"TableStyleMedium9","PivotStyleMedium4")),we(t,509)}function wO(t,e){var r=as();return we(r,278),lO(r,t.SSF),uO(r),hO(r),fO(r),dO(r),mO(r,e.cellXfs),pO(r),gO(r),xO(r),we(r,279),r.end()}var vO=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function _O(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Wn)||[]).forEach(function(s){var i=lt(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[vO.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function yO(){}function EO(){}var TO=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,SO=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,AO=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function kO(t,e,r){e.themeElements={};var n;[["clrScheme",TO,_O],["fontScheme",SO,yO],["fmtScheme",AO,EO]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var bO=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Sy(t,e){(!t||t.length===0)&&(t=Jm());var r,n={};if(!(r=t.match(bO)))throw new Error("themeElements not found in theme");return kO(r[0],n,e),n.raw=t,n}function Jm(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[jr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function IO(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var a;try{a=g2(i,{type:"array"})}catch{return}var o=gs(a,"theme/theme/theme1.xml",!0);if(o)return Sy(o,r)}}function CO(t){return t.read_shift(4)}function RO(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=DO(t,4);break;case 2:e.xclrValue=ny(t);break;case 3:e.xclrValue=CO(t);break;case 4:t.l+=4;break}return t.l+=8,e}function DO(t,e){return Un(t,e)}function PO(t,e){return Un(t,e)}function FO(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=RO(t);break;case 6:n[1]=PO(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function NO(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(FO(t,r-t.l));return{ixfe:n,ext:i}}function OO(t,e){e.forEach(function(r){r[0]})}function LO(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Bn(t)}}function MO(t){var e=ue(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),fn(t.name,e),e.slice(0,e.l)}function BO(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function VO(t){var e=ue(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function jO(t,e){var r=ue(8+2*e.length);return r.write_shift(4,t),fn(e,r),r.slice(0,r.l)}function UO(t){return t.l+=4,t.read_shift(4)!=0}function WO(t,e){var r=ue(8);return r.write_shift(4,t),r.write_shift(4,1),r}function $O(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],a=!1,o=2;return ta(t,function(c,l,h){switch(h){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(h),a=!0;break;case 36:i.pop(),a=!1;break;default:if(!l.T){if(!a||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function zO(){var t=as();return we(t,332),we(t,334,ni(1)),we(t,335,MO({name:"XLDAPR",version:12e4,flags:3496657072})),we(t,336),we(t,339,jO(1,"XLDAPR")),we(t,52),we(t,35,ni(514)),we(t,4096,ni(0)),we(t,4097,Rs(1)),we(t,36),we(t,53),we(t,340),we(t,337,WO(1)),we(t,51,VO([[1,0]])),we(t,338),we(t,333),t.end()}function HO(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,a;return t.replace(Wn,function(o){var c=lt(o);switch(Si(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==c.name&&(a=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function Ay(){var t=[jr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function GO(t){var e=[];if(!t)return e;var r=1;return(t.match(Wn)||[]).forEach(function(n){var s=lt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function qO(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=at(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function XO(t,e,r){var n=[];return ta(t,function(i,a,o){switch(o){case 63:n.push(i);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function KO(t,e,r,n){if(!t)return t;var s=n||{},i=!1;ta(t,function(o,c,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},s)}function YO(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Zo=1024;function ky(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Pe("xml",null,{"xmlns:v":fs.v,"xmlns:o":fs.o,"xmlns:x":fs.x,"xmlns:mv":fs.mv}).replace(/\/>/,">"),Pe("o:shapelayout",Pe("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Pe("v:shapetype",[Pe("v:stroke",null,{joinstyle:"miter"}),Pe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Zo<t*1e3;)Zo+=1e3;return e.forEach(function(i){var a=yr(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Pe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=Pe("v:fill",c,o),h={on:"t",obscured:"t"};++Zo,s=s.concat(["<v:shape"+Ol({id:"_x0000_s"+Zo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,Pe("v:shadow",null,h),Pe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",En("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),En("x:AutoFill","False"),En("x:Row",String(a.r)),En("x:Column",String(a.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function K1(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(a){var o=yr(a.ref);if(s?(t[o.r]||(t[o.r]=[]),i=t[o.r][o.c]):i=t[a.ref],!i){i={t:"z"},s?t[o.r][o.c]=i:t[a.ref]=i;var c=Ot(t["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=wt(c);l!==t["!ref"]&&(t["!ref"]=l)}i.c||(i.c=[]);var h={a:a.author,t:a.t,r:a.r,T:r};a.h&&(h.h=a.h);for(var d=i.c.length-1;d>=0;--d){if(!r&&i.c[d].T)return;r&&!i.c[d].T&&i.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(h.a==n[d].id){h.a=n[d].name||h.a;break}}i.c.push(h)})}function QO(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=lt(o[0]),l={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},h=yr(c.ref);if(!(e.sheetRows&&e.sheetRows<=h.r)){var d=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!d&&!!d[1]&&Km(d[1])||{r:"",t:"",h:""};l.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),l.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(l.h=f.h),n.push(l)}}}}),n}function by(t){var e=[jr,Pe("comments",null,{xmlns:Ro[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var i=er(s.a);r.indexOf(i)==-1&&(r.push(i),e.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(er(c.a))),i.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)e.push(En("t",er(i[0]||"")));else{for(var a=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)a+=`Reply:
    `+i[o]+`
`;e.push(En("t",er(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function JO(t,e){var r=[],n=!1,s={},i=0;return t.replace(Wn,function(o,c){var l=lt(o);switch(Si(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":s.t=t.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function ZO(t,e,r){var n=[jr,Pe("ThreadedComments",null,{xmlns:tn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var i="";(s[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(Pe("threadedComment",En("text",a.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function e6(t,e){var r=[],n=!1;return t.replace(Wn,function(i){var a=lt(i);switch(Si(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return i}),r}function t6(t){var e=[jr,Pe("personList",null,{xmlns:tn.TCMNT,"xmlns:x":Ro[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Pe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function r6(t){var e={};e.iauthor=t.read_shift(4);var r=No(t);return e.rfx=r.s,e.ref=at(r.s),t.l+=16,e}function n6(t,e){return e==null&&(e=ue(36)),e.write_shift(4,t[1].iauthor),jc(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var s6=Bn;function i6(t){return fn(t.slice(0,54))}function a6(t,e){var r=[],n=[],s={},i=!1;return ta(t,function(o,c,l){switch(l){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}function o6(t){var e=as(),r=[];return we(e,628),we(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),we(e,632,i6(s.a)))})}),we(e,631),we(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:yr(n[0]),e:yr(n[0])};we(e,635,n6([i,s])),s.t&&s.t.length>0&&we(e,637,CP(s)),we(e,636),delete s.iauthor})}),we(e,634),we(e,629),e.end()}var c6="application/vnd.ms-office.vbaProject";function l6(t){var e=Qe.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Qe.utils.cfb_add(e,s,t.FileIndex[n].content)}}),Qe.write(e)}function u6(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Qe.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var Iy=["xlsb","xlsm","xlam","biff8","xla"];function h6(){return{"!type":"dialog"}}function f6(){return{"!type":"dialog"}}function d6(){return{"!type":"macro"}}function m6(){return{"!type":"macro"}}var cc=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,a){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var l=i.length>0?parseInt(i,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,c?l+=e.r:--l,s+(o?"":"$")+_r(h)+(c?"":"$")+Mr(l)}return function(s,i){return e=i,s.replace(t,r)}})(),Zm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ep=(function(){return function(e,r){return e.replace(Zm,function(n,s,i,a,o,c){var l=jm(a)-(i?0:r.c),h=Vm(c)-(o?0:r.r),d=h==0?"":o?h+1:"["+h+"]",f=l==0?"":i?l+1:"["+l+"]";return s+"R"+d+"C"+f})}})();function Cy(t,e){return t.replace(Zm,function(r,n,s,i,a,o){return n+(s=="$"?s+i:_r(jm(i)+e.c))+(a=="$"?a+o:Mr(Vm(o)+e.r))})}function p6(t,e,r){var n=os(e),s=n.s,i=yr(r),a={r:i.r-s.r,c:i.c-s.c};return Cy(t,a)}function g6(t){return t.length!=1}function Y1(t){return t.replace(/_xlfn\./g,"")}function Wr(t){t.l+=1}function Da(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Ry(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Dy(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),a=Da(t),o=Da(t);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Dy(t){var e=Da(t),r=Da(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function x6(t,e,r){if(r.biff<8)return Dy(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=Da(t),a=Da(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function Py(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return w6(t);var n=t.read_shift(r&&r.biff==12?4:2),s=Da(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function w6(t){var e=Da(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function v6(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function _6(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return y6(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function y6(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function E6(t,e,r){var n=(t[t.l++]&96)>>5,s=Ry(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function T6(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var a=Ry(t,i,r);return[n,s,a]}function S6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function A6(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function k6(t,e,r){var n=(t[t.l++]&96)>>5,s=x6(t,e-1,r);return[n,s]}function b6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Q1(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function I6(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function C6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function R6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function D6(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function P6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function Fy(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function F6(t){return t.read_shift(2),Fy(t)}function N6(t){return t.read_shift(2),Fy(t)}function O6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=Py(t,0,r);return[n,s]}function L6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=_6(t,0,r);return[n,s]}function M6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=Py(t,0,r);return[n,s,i]}function B6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[U5[s],Ly[s],n]}function V6(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:j6(t);return[s,(i[0]===0?Ly:j5)[i[1]]]}function j6(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function U6(t,e,r){t.l+=r&&r.biff==2?3:4}function W6(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function $6(t){return t.l++,ra[t.read_shift(1)]}function z6(t){return t.l++,t.read_shift(2)}function H6(t){return t.l++,t.read_shift(1)!==0}function G6(t){return t.l++,Ln(t)}function q6(t,e,r){return t.l++,du(t,e-1,r)}function X6(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Fr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=ra[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Ln(t);break;case 2:r[1]=Oo(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function K6(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?No:Of)(t));return s}function Y6(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=X6(t,r.biff);return a}function Q6(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function J6(t,e,r){if(r.biff==5)return Z6(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function Z6(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function e5(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function t5(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function r5(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function n5(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var s5=Un,i5=Un,a5=Un;function pu(t,e,r){return t.l+=2,[v6(t)]}function tp(t){return t.l+=6,[]}var o5=pu,c5=tp,l5=tp,u5=pu;function Ny(t){return t.l+=2,[Gr(t),t.read_shift(2)&1]}var h5=pu,f5=Ny,d5=tp,m5=pu,p5=pu,g5=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function x5(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),a=g5[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:s,C:i}}function w5(t){return t.l+=2,[t.read_shift(4)]}function v5(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function _5(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function y5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function E5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function T5(t){return t.l+=4,[0,0]}var J1={1:{n:"PtgExp",f:W6},2:{n:"PtgTbl",f:a5},3:{n:"PtgAdd",f:Wr},4:{n:"PtgSub",f:Wr},5:{n:"PtgMul",f:Wr},6:{n:"PtgDiv",f:Wr},7:{n:"PtgPower",f:Wr},8:{n:"PtgConcat",f:Wr},9:{n:"PtgLt",f:Wr},10:{n:"PtgLe",f:Wr},11:{n:"PtgEq",f:Wr},12:{n:"PtgGe",f:Wr},13:{n:"PtgGt",f:Wr},14:{n:"PtgNe",f:Wr},15:{n:"PtgIsect",f:Wr},16:{n:"PtgUnion",f:Wr},17:{n:"PtgRange",f:Wr},18:{n:"PtgUplus",f:Wr},19:{n:"PtgUminus",f:Wr},20:{n:"PtgPercent",f:Wr},21:{n:"PtgParen",f:Wr},22:{n:"PtgMissArg",f:Wr},23:{n:"PtgStr",f:q6},26:{n:"PtgSheet",f:v5},27:{n:"PtgEndSheet",f:_5},28:{n:"PtgErr",f:$6},29:{n:"PtgBool",f:H6},30:{n:"PtgInt",f:z6},31:{n:"PtgNum",f:G6},32:{n:"PtgArray",f:b6},33:{n:"PtgFunc",f:B6},34:{n:"PtgFuncVar",f:V6},35:{n:"PtgName",f:Q6},36:{n:"PtgRef",f:O6},37:{n:"PtgArea",f:E6},38:{n:"PtgMemArea",f:e5},39:{n:"PtgMemErr",f:s5},40:{n:"PtgMemNoMem",f:i5},41:{n:"PtgMemFunc",f:t5},42:{n:"PtgRefErr",f:r5},43:{n:"PtgAreaErr",f:S6},44:{n:"PtgRefN",f:L6},45:{n:"PtgAreaN",f:k6},46:{n:"PtgMemAreaN",f:y5},47:{n:"PtgMemNoMemN",f:E5},57:{n:"PtgNameX",f:J6},58:{n:"PtgRef3d",f:M6},59:{n:"PtgArea3d",f:T6},60:{n:"PtgRefErr3d",f:n5},61:{n:"PtgAreaErr3d",f:A6},255:{}},S5={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},A5={1:{n:"PtgElfLel",f:Ny},2:{n:"PtgElfRw",f:m5},3:{n:"PtgElfCol",f:o5},6:{n:"PtgElfRwV",f:p5},7:{n:"PtgElfColV",f:u5},10:{n:"PtgElfRadical",f:h5},11:{n:"PtgElfRadicalS",f:d5},13:{n:"PtgElfColS",f:c5},15:{n:"PtgElfColSV",f:l5},16:{n:"PtgElfRadicalLel",f:f5},25:{n:"PtgList",f:x5},29:{n:"PtgSxName",f:w5},255:{}},k5={0:{n:"PtgAttrNoop",f:T5},1:{n:"PtgAttrSemi",f:P6},2:{n:"PtgAttrIf",f:R6},4:{n:"PtgAttrChoose",f:I6},8:{n:"PtgAttrGoto",f:C6},16:{n:"PtgAttrSum",f:U6},32:{n:"PtgAttrBaxcel",f:Q1},33:{n:"PtgAttrBaxcel",f:Q1},64:{n:"PtgAttrSpace",f:F6},65:{n:"PtgAttrSpaceSemi",f:N6},128:{n:"PtgAttrIfError",f:D6},255:{}};function gu(t,e,r,n){if(n.biff<8)return Un(t,e);for(var s=t.l+e,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=Y6(t,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=K6(t,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=s-t.l,e!==0&&i.push(Un(t,e)),i}function xu(t,e,r){for(var n=t.l+e,s,i,a=[];n!=t.l;)e=n-t.l,i=t[t.l],s=J1[i]||J1[S5[i]],(i===24||i===25)&&(s=(i===24?A5:k5)[t[t.l+1]]),!s||!s.f?Un(t,e):a.push([s.n,s.f(t,e,r)]);return a}function b5(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var I5={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function C5(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Oy(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Z1(t,e,r){var n=Oy(t,e,r);return n=="#REF"?n:C5(n,r)}function Fn(t,e,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0}},o=[],c,l,h,d=0,f=0,g,w="";if(!t[0]||!t[0][0])return"";for(var x=-1,y="",A=0,F=t[0].length;A<F;++A){var I=t[0][A];switch(I[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:y=Ir(" ",t[0][x][1][1]);break;case 1:y=Ir("\r",t[0][x][1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}l=l+y,x=-1}o.push(l+I5[I[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=gl(I[1][1],a,s),o.push(xl(h,i));break;case"PtgRefN":h=r?gl(I[1][1],r,s):I[1][1],o.push(xl(h,i));break;case"PtgRef3d":d=I[1][1],h=gl(I[1][2],a,s),w=Z1(n,d,s),o.push(w+"!"+xl(h,i));break;case"PtgFunc":case"PtgFuncVar":var W=I[1][0],U=I[1][1];W||(W=0),W&=127;var z=W==0?[]:o.slice(-W);o.length-=W,U==="User"&&(U=z.shift()),o.push(U+"("+z.join(",")+")");break;case"PtgBool":o.push(I[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(I[1]);break;case"PtgNum":o.push(String(I[1]));break;case"PtgStr":o.push('"'+I[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(I[1]);break;case"PtgAreaN":g=I1(I[1][1],r?{s:r}:a,s),o.push(x0(g,s));break;case"PtgArea":g=I1(I[1][1],a,s),o.push(x0(g,s));break;case"PtgArea3d":d=I[1][1],g=I[1][2],w=Z1(n,d,s),o.push(w+"!"+x0(g,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=I[1][2];var T=(n.names||[])[f-1]||(n[0]||[])[f],k=T?T.Name:"SH33TJSNAME"+String(f);k&&k.slice(0,6)=="_xlfn."&&!s.xlfn&&(k=k.slice(6)),o.push(k);break;case"PtgNameX":var S=I[1][1];f=I[1][2];var R;if(s.biff<=5)S<0&&(S=-S),n[S]&&(R=n[S][f]);else{var C="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][f]&&n[S][f].itab>0&&(C=n.SheetNames[n[S][f].itab-1]+"!"):C=n.SheetNames[f-1]+"!"),n[S]&&n[S][f])C+=n[S][f].Name;else if(n[0]&&n[0][f])C+=n[0][f].Name;else{var _=(Oy(n,S,s)||"").split(";;");_[f-1]?C=_[f-1]:C+="SH33TJSERRX"}o.push(C);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var P="(",Fe=")";if(x>=0){switch(y="",t[0][x][1][0]){case 2:P=Ir(" ",t[0][x][1][1])+P;break;case 3:P=Ir("\r",t[0][x][1][1])+P;break;case 4:Fe=Ir(" ",t[0][x][1][1])+Fe;break;case 5:Fe=Ir("\r",t[0][x][1][1])+Fe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(P+o.pop()+Fe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:I[1][1],r:I[1][0]};var Ie={c:r.c,r:r.r};if(n.sharedf[at(h)]){var je=n.sharedf[at(h)];o.push(Fn(je,a,Ie,n,s))}else{var Me=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(h.c<l[0].s.c||h.c>l[0].e.c)&&!(h.r<l[0].s.r||h.r>l[0].e.r)){o.push(Fn(l[1],a,Ie,n,s)),Me=!0;break}Me||o.push(I[1])}break;case"PtgArray":o.push("{"+b5(I[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+I[1].idx+"[#"+I[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(I));default:throw new Error("Unrecognized Formula Token: "+String(I))}var _t=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&x>=0&&_t.indexOf(t[0][A][0])==-1){I=t[0][x];var se=!0;switch(I[1][0]){case 4:se=!1;case 0:y=Ir(" ",I[1][1]);break;case 5:se=!1;case 1:y=Ir("\r",I[1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+I[1][0])}o.push((se?y:"")+o.pop()+(se?"":y)),x=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function R5(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],Un(t,e-2)];var o=xu(t,a,r);return e!==a+s&&(i=gu(t,e-a-s,o,r)),t.l=n,[o,i]}function D5(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],Un(t,e-2)];var o=xu(t,a,r);return e!==a+s&&(i=gu(t,e-a-s,o,r)),t.l=n,[o,i]}function P5(t,e,r,n){var s=t.l+e,i=xu(t,n,r),a;return s!==t.l&&(a=gu(t,s-t.l,i,r)),[i,a]}function F5(t,e,r){var n=t.l+e,s,i=t.read_shift(2),a=xu(t,i,r);return i==65535?[[],Un(t,e-2)]:(e!==i+2&&(s=gu(t,n-i-2,a,r)),[a,s])}function N5(t){var e;if(Li(t,t.l+6)!==65535)return[Ln(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function O5(t){if(t==null){var e=ue(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return yo(t);return yo(0)}function E0(t,e,r){var n=t.l+e,s=Ai(t);r.biff==2&&++t.l;var i=N5(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=D5(t,n-t.l,r);return{cell:s,val:i[0],formula:o,shared:a>>3&1,tt:i[1]}}function L5(t,e,r,n,s){var i=To(e,r,s),a=O5(t.v),o=ue(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=ue(t.bf.length),h=0;h<t.bf.length;++h)l[h]=t.bf[h];var d=hn([i,a,o,l]);return d}function Lf(t,e,r){var n=t.read_shift(4),s=xu(t,n,r),i=t.read_shift(4),a=i>0?gu(t,i,s,r):null;return[s,a]}var M5=Lf,Mf=Lf,B5=Lf,V5=Lf,j5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ly={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},U5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ex(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function W5(t){var e="of:="+t.replace(Zm,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function T0(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function $5(t){return t.replace(/\./,"!")}var vl={},lc={},_l=typeof Map<"u";function rp(t,e,r){var n=0,s=t.length;if(r){if(_l?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var i=_l?r.get(e):r[e];n<i.length;++n)if(t[i[n]].t===e)return t.Count++,i[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(_l?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function Bf(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(On=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=jl(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Xh(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function uo(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Ba(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,i=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Wi(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=i;++s)if(t[s].numFmtId===n)return s;return t[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function My(t,e,r,n,s,i){try{n.cellNF&&(t.z=it[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=hr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(it[e]==null&&Wi(jD[e]||"General",e),t.t==="e")t.w=t.w||ra[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Fl(t.v);else if(t.t==="d"){var a=nn(t.v);(a|0)===a?t.w=a.toString(10):t.w=Fl(a)}else{if(t.v===void 0)return"";t.w=vo(t.v,lc)}else t.t==="d"?t.w=Ns(e,nn(t.v),lc):t.w=Ns(e,t.v,lc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=qh(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=qh(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function z5(t,e,r){if(t&&t["!ref"]){var n=Ot(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function H5(t,e){var r=Ot(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=wt(r))}var G5=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,q5=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,X5=/<(?:\w:)?hyperlink [^>]*>/mg,K5=/"(\w*:\w*)"/,Y5=/<(?:\w:)?col\b[^>]*[\/]?>/g,Q5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,J5=/<(?:\w:)?pageMargins[^>]*\/>/g,By=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Z5=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,eL=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function tL(t,e,r,n,s,i,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",h="",d=t.match(q5);d?(l=t.slice(0,d.index),h=t.slice(d.index+d[0].length)):l=h=t;var f=l.match(By);f?np(f[0],o,s,r):(f=l.match(Z5))&&nL(f[0],f[1]||"",o,s,r);var g=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var w=l.slice(g,g+50).match(K5);w&&H5(o,w[1])}var x=l.match(eL);x&&x[1]&&gL(x[1],s);var y=[];if(e.cellStyles){var A=l.match(Y5);A&&hL(y,A)}d&&vL(d[1],o,e,c,i,a);var F=h.match(Q5);F&&(o["!autofilter"]=dL(F[0]));var I=[],W=h.match(G5);if(W)for(g=0;g!=W.length;++g)I[g]=Ot(W[g].slice(W[g].indexOf('"')+1));var U=h.match(X5);U&&cL(o,U,n);var z=h.match(J5);if(z&&(o["!margins"]=lL(lt(z[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=wt(c)),e.sheetRows>0&&o["!ref"]){var T=Ot(o["!ref"]);e.sheetRows<=+T.e.r&&(T.e.r=e.sheetRows-1,T.e.r>c.e.r&&(T.e.r=c.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>c.e.c&&(T.e.c=c.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=wt(T))}return y.length>0&&(o["!cols"]=y),I.length>0&&(o["!merges"]=I),o}function rL(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+wt(t[r])+'"/>';return e+"</mergeCells>"}function np(t,e,r,n){var s=lt(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Nt(rr(s.codeName)))}function nL(t,e,r,n,s){np(t.slice(0,t.indexOf(">")),r,n,s)}function sL(t,e,r,n,s){var i=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,a.codeName=xi(er(c))}if(t&&t["!outline"]){var l={summaryBelow:1,summaryRight:1};t["!outline"].above&&(l.summaryBelow=0),t["!outline"].left&&(l.summaryRight=0),o=(o||"")+Pe("outlinePr",null,l)}!i&&!o||(s[s.length]=Pe("sheetPr",o,a))}var iL=["objects","scenarios","selectLockedCells","selectUnlockedCells"],aL=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function oL(t){var e={sheet:1};return iL.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),aL.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Ym(t.password).toString(16).toUpperCase()),Pe("sheetProtection",null,e)}function cL(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=lt(rr(e[s]),!0);if(!i.ref)return;var a=((r||{})["!id"]||[])[i.id];a?(i.Target=a.Target,i.location&&(i.Target+="#"+Nt(i.location))):(i.Target="#"+Nt(i.location),a={Target:i.Target,TargetMode:"Internal"}),i.Rel=a,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Ot(i.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var h=at({c:l,r:c});n?(t[c]||(t[c]=[]),t[c][l]||(t[c][l]={t:"z",v:void 0}),t[c][l].l=i):(t[h]||(t[h]={t:"z",v:void 0}),t[h].l=i)}}}function lL(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function uL(t){return uo(t),Pe("pageMargins",null,t)}function hL(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=lt(e[n],!0);s.hidden&&(s.hidden=ur(s.hidden));var i=parseInt(s.min,10)-1,a=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Qm(s.width)),Ra(s);i<=a;)t[i++]=fr(s)}}function fL(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=Pe("col",null,Bf(s,n)));return r[r.length]="</cols>",r.join("")}function dL(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function mL(t,e,r,n){var s=typeof t.ref=="string"?t.ref:wt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,a=os(s);a.s.r==a.e.r&&(a.e.r=os(e["!ref"]).e.r,s=wt(a));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Pe("autoFilter",null,{ref:s})}var pL=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function gL(t,e){e.Views||(e.Views=[{}]),(t.match(pL)||[]).forEach(function(r,n){var s=lt(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),ur(s.rightToLeft)&&(e.Views[n].RTL=!0)})}function xL(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Pe("sheetViews",Pe("sheetView",null,s),{})}function wL(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",i=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=ra[t.v];break;case"d":n&&n.cellDates?s=hr(t.v,-1).toISOString():(t=fr(t),t.t="n",s=""+(t.v=nn(hr(t.v)))),typeof t.z>"u"&&(t.z=it[14]);break;default:s=t.v;break}var o=En("v",er(s)),c={r:e},l=Ba(n.cellXfs,t,n);switch(l!==0&&(c.s=l),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=En("v",""+rp(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=i&&(t.t=i,t.v=a),typeof t.f=="string"&&t.f){var h=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=Pe("f",er(t.f),h)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),Pe("c",o,c)}var vL=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Nl("v"),a=Nl("f");return function(c,l,h,d,f,g){for(var w=0,x="",y=[],A=[],F=0,I=0,W=0,U="",z,T,k=0,S=0,R,C,_=0,P=0,Fe=Array.isArray(g.CellXf),Ie,je=[],Me=[],_t=Array.isArray(l),se=[],Ye={},Je=!1,V=!!h.sheetStubs,Y=c.split(e),q=0,X=Y.length;q!=X;++q){x=Y[q].trim();var he=x.length;if(he!==0){var Ee=0;e:for(w=0;w<he;++w)switch(x[w]){case">":if(x[w-1]!="/"){++w;break e}if(h&&h.cellStyles){if(T=lt(x.slice(Ee,w),!0),k=T.r!=null?parseInt(T.r,10):k+1,S=-1,h.sheetRows&&h.sheetRows<k)continue;Ye={},Je=!1,T.ht&&(Je=!0,Ye.hpt=parseFloat(T.ht),Ye.hpx=Ec(Ye.hpt)),T.hidden=="1"&&(Je=!0,Ye.hidden=!0),T.outlineLevel!=null&&(Je=!0,Ye.level=+T.outlineLevel),Je&&(se[k-1]=Ye)}break;case"<":Ee=w;break}if(Ee>=w)break;if(T=lt(x.slice(Ee,w),!0),k=T.r!=null?parseInt(T.r,10):k+1,S=-1,!(h.sheetRows&&h.sheetRows<k)){d.s.r>k-1&&(d.s.r=k-1),d.e.r<k-1&&(d.e.r=k-1),h&&h.cellStyles&&(Ye={},Je=!1,T.ht&&(Je=!0,Ye.hpt=parseFloat(T.ht),Ye.hpx=Ec(Ye.hpt)),T.hidden=="1"&&(Je=!0,Ye.hidden=!0),T.outlineLevel!=null&&(Je=!0,Ye.level=+T.outlineLevel),Je&&(se[k-1]=Ye)),y=x.slice(w).split(t);for(var Ae=0;Ae!=y.length&&y[Ae].trim().charAt(0)=="<";++Ae);for(y=y.slice(Ae),w=0;w!=y.length;++w)if(x=y[w].trim(),x.length!==0){if(A=x.match(r),F=w,I=0,W=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,A!=null&&A.length===2){for(F=0,U=A[1],I=0;I!=U.length&&!((W=U.charCodeAt(I)-64)<1||W>26);++I)F=26*F+W;--F,S=F}else++S;for(I=0;I!=x.length&&x.charCodeAt(I)!==62;++I);if(++I,T=lt(x.slice(0,I),!0),T.r||(T.r=at({r:k-1,c:S})),U=x.slice(I),z={t:""},(A=U.match(i))!=null&&A[1]!==""&&(z.v=Nt(A[1])),h.cellFormula){if((A=U.match(a))!=null&&A[1]!==""){if(z.f=Nt(rr(A[1])).replace(/\r\n/g,`
`),h.xlfn||(z.f=Y1(z.f)),A[0].indexOf('t="array"')>-1)z.F=(U.match(s)||[])[1],z.F.indexOf(":")>-1&&je.push([Ot(z.F),z.F]);else if(A[0].indexOf('t="shared"')>-1){C=lt(A[0]);var ye=Nt(rr(A[1]));h.xlfn||(ye=Y1(ye)),Me[parseInt(C.si,10)]=[C,ye,T.r]}}else(A=U.match(/<f[^>]*\/>/))&&(C=lt(A[0]),Me[C.si]&&(z.f=p6(Me[C.si][1],Me[C.si][2],T.r)));var ve=yr(T.r);for(I=0;I<je.length;++I)ve.r>=je[I][0].s.r&&ve.r<=je[I][0].e.r&&ve.c>=je[I][0].s.c&&ve.c<=je[I][0].e.c&&(z.F=je[I][1])}if(T.t==null&&z.v===void 0)if(z.f||z.F)z.v=0,z.t="n";else if(V)z.t="z";else continue;else z.t=T.t||"n";switch(d.s.c>S&&(d.s.c=S),d.e.c<S&&(d.e.c=S),z.t){case"n":if(z.v==""||z.v==null){if(!V)continue;z.t="z"}else z.v=parseFloat(z.v);break;case"s":if(typeof z.v>"u"){if(!V)continue;z.t="z"}else R=vl[parseInt(z.v,10)],z.v=R.t,z.r=R.r,h.cellHTML&&(z.h=R.h);break;case"str":z.t="s",z.v=z.v!=null?rr(z.v):"",h.cellHTML&&(z.h=Om(z.v));break;case"inlineStr":A=U.match(n),z.t="s",A!=null&&(R=Km(A[1]))?(z.v=R.t,h.cellHTML&&(z.h=R.h)):z.v="";break;case"b":z.v=ur(z.v);break;case"d":h.cellDates?z.v=hr(z.v,1):(z.v=nn(hr(z.v,1)),z.t="n");break;case"e":(!h||h.cellText!==!1)&&(z.w=z.v),z.v=j2[z.v];break}if(_=P=0,Ie=null,Fe&&T.s!==void 0&&(Ie=g.CellXf[T.s],Ie!=null&&(Ie.numFmtId!=null&&(_=Ie.numFmtId),h.cellStyles&&Ie.fillId!=null&&(P=Ie.fillId))),My(z,_,P,h,f,g),h.cellDates&&Fe&&z.t=="n"&&Mc(it[_])&&(z.t="d",z.v=Nf(z.v)),T.cm&&h.xlmeta){var ct=(h.xlmeta.Cell||[])[+T.cm-1];ct&&ct.type=="XLDAPR"&&(z.D=!0)}if(_t){var j=yr(T.r);l[j.r]||(l[j.r]=[]),l[j.r][j.c]=z}else l[T.r]=z}}}}se.length>0&&(l["!rows"]=se)}})();function _L(t,e,r,n){var s=[],i=[],a=Ot(t["!ref"]),o="",c,l="",h=[],d=0,f=0,g=t["!rows"],w=Array.isArray(t),x={r:l},y,A=-1;for(f=a.s.c;f<=a.e.c;++f)h[f]=_r(f);for(d=a.s.r;d<=a.e.r;++d){for(i=[],l=Mr(d),f=a.s.c;f<=a.e.c;++f){c=h[f]+l;var F=w?(t[d]||[])[f]:t[c];F!==void 0&&(o=wL(F,c,t,e))!=null&&i.push(o)}(i.length>0||g&&g[d])&&(x={r:l},g&&g[d]&&(y=g[d],y.hidden&&(x.hidden=1),A=-1,y.hpx?A=Ul(y.hpx):y.hpt&&(A=y.hpt),A>-1&&(x.ht=A,x.customHeight=1),y.level&&(x.outlineLevel=y.level)),s[s.length]=Pe("row",i.join(""),x))}if(g)for(;d<g.length;++d)g&&g[d]&&(x={r:d+1},y=g[d],y.hidden&&(x.hidden=1),A=-1,y.hpx?A=Ul(y.hpx):y.hpt&&(A=y.hpt),A>-1&&(x.ht=A,x.customHeight=1),y.level&&(x.outlineLevel=y.level),s[s.length]=Pe("row","",x));return s.join("")}function Vy(t,e,r,n){var s=[jr,Pe("worksheet",null,{xmlns:Ro[0],"xmlns:r":tn.r})],i=r.SheetNames[t],a=0,o="",c=r.Sheets[i];c==null&&(c={});var l=c["!ref"]||"A1",h=Ot(l);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),l=wt(h)}n||(n={}),c["!comments"]=[];var d=[];sL(c,r,t,e,s),s[s.length]=Pe("dimension",null,{ref:l}),s[s.length]=xL(c,e,t,r),e.sheetFormat&&(s[s.length]=Pe("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=fL(c,c["!cols"])),s[a=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=_L(c,e),o.length>0&&(s[s.length]=o)),s.length>a+1&&(s[s.length]="</sheetData>",s[a]=s[a].replace("/>",">")),c["!protect"]&&(s[s.length]=oL(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=mL(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=rL(c["!merges"]));var f=-1,g,w=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(g={ref:x[0]},x[1].Target.charAt(0)!="#"&&(w=Zt(n,-1,er(x[1].Target).replace(/#.*$/,""),Et.HLINK),g["r:id"]="rId"+w),(f=x[1].Target.indexOf("#"))>-1&&(g.location=er(x[1].Target.slice(f+1))),x[1].Tooltip&&(g.tooltip=er(x[1].Tooltip)),s[s.length]=Pe("hyperlink",null,g))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=uL(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=En("ignoredErrors",Pe("ignoredError",null,{numberStoredAsText:1,sqref:l}))),d.length>0&&(w=Zt(n,-1,"../drawings/drawing"+(t+1)+".xml",Et.DRAW),s[s.length]=Pe("drawing",null,{"r:id":"rId"+w}),c["!drawing"]=d),c["!comments"].length>0&&(w=Zt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Et.VML),s[s.length]=Pe("legacyDrawing",null,{"r:id":"rId"+w}),c["!legacy"]=w),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function yL(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function EL(t,e,r){var n=ue(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var i=320;s.hpx?i=Ul(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var a=0;s.level&&(a|=s.level),s.hidden&&(a|=16),(s.hpx||s.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var l={r:t,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var d=-1,f=-1,g=h<<10;g<h+1<<10;++g){l.c=g;var w=Array.isArray(r)?(r[l.r]||[])[l.c]:r[at(l)];w&&(d<0&&(d=g),f=g)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,f))}var x=n.l;return n.l=c,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function TL(t,e,r,n){var s=EL(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&we(t,0,s)}var SL=No,AL=jc;function kL(){}function bL(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=RP(t),r}function IL(t,e,r){r==null&&(r=ue(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return zh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),O2(t,r),r.slice(0,r.l)}function CL(t){var e=Os(t);return[e]}function RL(t,e,r){return r==null&&(r=ue(8)),Do(e,r)}function DL(t){var e=Po(t);return[e]}function PL(t,e,r){return r==null&&(r=ue(4)),Fo(e,r)}function FL(t){var e=Os(t),r=t.read_shift(1);return[e,r,"b"]}function NL(t,e,r){return r==null&&(r=ue(9)),Do(e,r),r.write_shift(1,t.v?1:0),r}function OL(t){var e=Po(t),r=t.read_shift(1);return[e,r,"b"]}function LL(t,e,r){return r==null&&(r=ue(5)),Fo(e,r),r.write_shift(1,t.v?1:0),r}function ML(t){var e=Os(t),r=t.read_shift(1);return[e,r,"e"]}function BL(t,e,r){return r==null&&(r=ue(9)),Do(e,r),r.write_shift(1,t.v),r}function VL(t){var e=Po(t),r=t.read_shift(1);return[e,r,"e"]}function jL(t,e,r){return r==null&&(r=ue(8)),Fo(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function UL(t){var e=Os(t),r=t.read_shift(4);return[e,r,"s"]}function WL(t,e,r){return r==null&&(r=ue(12)),Do(e,r),r.write_shift(4,e.v),r}function $L(t){var e=Po(t),r=t.read_shift(4);return[e,r,"s"]}function zL(t,e,r){return r==null&&(r=ue(8)),Fo(e,r),r.write_shift(4,e.v),r}function HL(t){var e=Os(t),r=Ln(t);return[e,r,"n"]}function GL(t,e,r){return r==null&&(r=ue(16)),Do(e,r),yo(t.v,r),r}function jy(t){var e=Po(t),r=Ln(t);return[e,r,"n"]}function qL(t,e,r){return r==null&&(r=ue(12)),Fo(e,r),yo(t.v,r),r}function XL(t){var e=Os(t),r=zm(t);return[e,r,"n"]}function KL(t,e,r){return r==null&&(r=ue(12)),Do(e,r),L2(t.v,r),r}function YL(t){var e=Po(t),r=zm(t);return[e,r,"n"]}function QL(t,e,r){return r==null&&(r=ue(8)),Fo(e,r),L2(t.v,r),r}function JL(t){var e=Os(t),r=Um(t);return[e,r,"is"]}function ZL(t){var e=Os(t),r=Bn(t);return[e,r,"str"]}function e8(t,e,r){return r==null&&(r=ue(12+4*t.v.length)),Do(e,r),fn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function t8(t){var e=Po(t),r=Bn(t);return[e,r,"str"]}function r8(t,e,r){return r==null&&(r=ue(8+4*t.v.length)),Fo(e,r),fn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function n8(t,e,r){var n=t.l+e,s=Os(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"b"];if(r.cellFormula){t.l+=2;var o=Mf(t,n-t.l,r);a[3]=Fn(o,null,s,r.supbooks,r)}else t.l=n;return a}function s8(t,e,r){var n=t.l+e,s=Os(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"e"];if(r.cellFormula){t.l+=2;var o=Mf(t,n-t.l,r);a[3]=Fn(o,null,s,r.supbooks,r)}else t.l=n;return a}function i8(t,e,r){var n=t.l+e,s=Os(t);s.r=r["!row"];var i=Ln(t),a=[s,i,"n"];if(r.cellFormula){t.l+=2;var o=Mf(t,n-t.l,r);a[3]=Fn(o,null,s,r.supbooks,r)}else t.l=n;return a}function a8(t,e,r){var n=t.l+e,s=Os(t);s.r=r["!row"];var i=Bn(t),a=[s,i,"str"];if(r.cellFormula){t.l+=2;var o=Mf(t,n-t.l,r);a[3]=Fn(o,null,s,r.supbooks,r)}else t.l=n;return a}var o8=No,c8=jc;function l8(t,e){return e==null&&(e=ue(4)),e.write_shift(4,t),e}function u8(t,e){var r=t.l+e,n=No(t),s=Wm(t),i=Bn(t),a=Bn(t),o=Bn(t);t.l=r;var c={rfx:n,relId:s,loc:i,display:o};return a&&(c.Tooltip=a),c}function h8(t,e){var r=ue(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));jc({s:yr(t[0]),e:yr(t[0])},r),$m("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return fn(s||"",r),fn(t[1].Tooltip||"",r),fn("",r),r.slice(0,r.l)}function f8(){}function d8(t,e,r){var n=t.l+e,s=M2(t),i=t.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=M5(t,n-t.l,r);a[1]=o}else t.l=n;return a}function m8(t,e,r){var n=t.l+e,s=No(t),i=[s];if(r.cellFormula){var a=V5(t,n-t.l,r);i[1]=a,t.l=n}else t.l=n;return i}function p8(t,e,r){r==null&&(r=ue(18));var n=Bf(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var Uy=["left","right","top","bottom","header","footer"];function g8(t){var e={};return Uy.forEach(function(r){e[r]=Ln(t)}),e}function x8(t,e){return e==null&&(e=ue(48)),uo(t),Uy.forEach(function(r){yo(t[r],e)}),e}function w8(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function v8(t,e,r){r==null&&(r=ue(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function _8(t){var e=ue(24);return e.write_shift(4,4),e.write_shift(4,1),jc(t,e),e}function y8(t,e){return e==null&&(e=ue(66)),e.write_shift(2,t.password?Ym(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function E8(){}function T8(){}function S8(t,e,r,n,s,i,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var c=o.dense?[]:{},l,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,f=!1,g,w,x,y,A,F,I,W,U,z=[];o.biff=12,o["!row"]=0;var T=0,k=!1,S=[],R={},C=o.supbooks||s.supbooks||[[]];if(C.sharedf=R,C.arrayf=S,C.SheetNames=s.SheetNames||s.Sheets.map(function(_t){return _t.name}),!o.supbooks&&(o.supbooks=C,s.Names))for(var _=0;_<s.Names.length;++_)C[0][_+1]=s.Names[_];var P=[],Fe=[],Ie=!1;Wl[16]={n:"BrtShortReal",f:jy};var je;if(ta(t,function(se,Ye,Je){if(!f)switch(Je){case 148:l=se;break;case 0:g=se,o.sheetRows&&o.sheetRows<=g.r&&(f=!0),W=Mr(y=g.r),o["!row"]=g.r,(se.hidden||se.hpt||se.level!=null)&&(se.hpt&&(se.hpx=Ec(se.hpt)),Fe[se.r]=se);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:se[2]},se[2]){case"n":w.v=se[1];break;case"s":I=vl[se[1]],w.v=I.t,w.r=I.r;break;case"b":w.v=!!se[1];break;case"e":w.v=se[1],o.cellText!==!1&&(w.w=ra[w.v]);break;case"str":w.t="s",w.v=se[1];break;case"is":w.t="s",w.v=se[1].t;break}if((x=a.CellXf[se[0].iStyleRef])&&My(w,x.numFmtId,null,o,i,a),A=se[0].c==-1?A+1:se[0].c,o.dense?(c[y]||(c[y]=[]),c[y][A]=w):c[_r(A)+W]=w,o.cellFormula){for(k=!1,T=0;T<S.length;++T){var V=S[T];g.r>=V[0].s.r&&g.r<=V[0].e.r&&A>=V[0].s.c&&A<=V[0].e.c&&(w.F=wt(V[0]),k=!0)}!k&&se.length>3&&(w.f=se[3])}if(h.s.r>g.r&&(h.s.r=g.r),h.s.c>A&&(h.s.c=A),h.e.r<g.r&&(h.e.r=g.r),h.e.c<A&&(h.e.c=A),o.cellDates&&x&&w.t=="n"&&Mc(it[x.numFmtId])){var Y=io(w.v);Y&&(w.t="d",w.v=new Date(Y.y,Y.m-1,Y.d,Y.H,Y.M,Y.S,Y.u))}je&&(je.type=="XLDAPR"&&(w.D=!0),je=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;w={t:"z",v:void 0},A=se[0].c==-1?A+1:se[0].c,o.dense?(c[y]||(c[y]=[]),c[y][A]=w):c[_r(A)+W]=w,h.s.r>g.r&&(h.s.r=g.r),h.s.c>A&&(h.s.c=A),h.e.r<g.r&&(h.e.r=g.r),h.e.c<A&&(h.e.c=A),je&&(je.type=="XLDAPR"&&(w.D=!0),je=void 0);break;case 176:z.push(se);break;case 49:je=((o.xlmeta||{}).Cell||[])[se-1];break;case 494:var q=n["!id"][se.relId];for(q?(se.Target=q.Target,se.loc&&(se.Target+="#"+se.loc),se.Rel=q):se.relId==""&&(se.Target="#"+se.loc),y=se.rfx.s.r;y<=se.rfx.e.r;++y)for(A=se.rfx.s.c;A<=se.rfx.e.c;++A)o.dense?(c[y]||(c[y]=[]),c[y][A]||(c[y][A]={t:"z",v:void 0}),c[y][A].l=se):(F=at({c:A,r:y}),c[F]||(c[F]={t:"z",v:void 0}),c[F].l=se);break;case 426:if(!o.cellFormula)break;S.push(se),U=o.dense?c[y][A]:c[_r(A)+W],U.f=Fn(se[1],h,{r:g.r,c:A},C,o),U.F=wt(se[0]);break;case 427:if(!o.cellFormula)break;R[at(se[0].s)]=se[1],U=o.dense?c[y][A]:c[_r(A)+W],U.f=Fn(se[1],h,{r:g.r,c:A},C,o);break;case 60:if(!o.cellStyles)break;for(;se.e>=se.s;)P[se.e--]={width:se.w/256,hidden:!!(se.flags&1),level:se.level},Ie||(Ie=!0,Qm(se.w/256)),Ra(P[se.e+1]);break;case 161:c["!autofilter"]={ref:wt(se)};break;case 476:c["!margins"]=se;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),se.name&&(s.Sheets[r].CodeName=se.name),(se.above||se.left)&&(c["!outline"]={above:se.above,left:se.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),se.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!Ye.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+Je.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(h.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=wt(l||h)),o.sheetRows&&c["!ref"]){var Me=Ot(c["!ref"]);o.sheetRows<=+Me.e.r&&(Me.e.r=o.sheetRows-1,Me.e.r>h.e.r&&(Me.e.r=h.e.r),Me.e.r<Me.s.r&&(Me.s.r=Me.e.r),Me.e.c>h.e.c&&(Me.e.c=h.e.c),Me.e.c<Me.s.c&&(Me.s.c=Me.e.c),c["!fullref"]=c["!ref"],c["!ref"]=wt(Me))}return z.length>0&&(c["!merges"]=z),P.length>0&&(c["!cols"]=P),Fe.length>0&&(c["!rows"]=Fe),c}function A8(t,e,r,n,s,i,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=fr(e),e.z=e.z||it[14],e.v=nn(hr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var c={r,c:n};switch(c.s=Ba(s.cellXfs,e,s),e.l&&i["!links"].push([at(c),e.l]),e.c&&i["!comments"].push([at(c),e.c]),e.t){case"s":case"str":return s.bookSST?(o=rp(s.Strings,e.v,s.revStrings),c.t="s",c.v=o,a?we(t,18,zL(e,c)):we(t,7,WL(e,c))):(c.t="str",a?we(t,17,r8(e,c)):we(t,6,e8(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?we(t,13,QL(e,c)):we(t,2,KL(e,c)):a?we(t,16,qL(e,c)):we(t,5,GL(e,c)),!0;case"b":return c.t="b",a?we(t,15,LL(e,c)):we(t,4,NL(e,c)),!0;case"e":return c.t="e",a?we(t,14,jL(e,c)):we(t,3,BL(e,c)),!0}return a?we(t,12,PL(e,c)):we(t,1,RL(e,c)),!0}function k8(t,e,r,n){var s=Ot(e["!ref"]||"A1"),i,a="",o=[];we(t,145);var c=Array.isArray(e),l=s.e.r;e["!rows"]&&(l=Math.max(s.e.r,e["!rows"].length-1));for(var h=s.s.r;h<=l;++h){a=Mr(h),TL(t,e,s,h);var d=!1;if(h<=s.e.r)for(var f=s.s.c;f<=s.e.c;++f){h===s.s.r&&(o[f]=_r(f)),i=o[f]+a;var g=c?(e[h]||[])[f]:e[i];if(!g){d=!1;continue}d=A8(t,g,h,f,n,e,d)}}we(t,146)}function b8(t,e){!e||!e["!merges"]||(we(t,177,l8(e["!merges"].length)),e["!merges"].forEach(function(r){we(t,176,c8(r))}),we(t,178))}function I8(t,e){!e||!e["!cols"]||(we(t,390),e["!cols"].forEach(function(r,n){r&&we(t,60,p8(n,r))}),we(t,391))}function C8(t,e){!e||!e["!ref"]||(we(t,648),we(t,649,_8(Ot(e["!ref"]))),we(t,650))}function R8(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=Zt(r,-1,n[1].Target.replace(/#.*$/,""),Et.HLINK);we(t,494,h8(n,s))}}),delete e["!links"]}function D8(t,e,r,n){if(e["!comments"].length>0){var s=Zt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Et.VML);we(t,551,$m("rId"+s)),e["!legacy"]=s}}function P8(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],i=typeof s.ref=="string"?s.ref:wt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=os(i);o.s.r==o.e.r&&(o.e.r=os(e["!ref"]).e.r,i=wt(o));for(var c=0;c<a.length;++c){var l=a[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),we(t,161,jc(Ot(i))),we(t,162)}}function F8(t,e,r){we(t,133),we(t,137,v8(e,r)),we(t,138),we(t,134)}function N8(t,e){e["!protect"]&&we(t,535,y8(e["!protect"]))}function O8(t,e,r,n){var s=as(),i=r.SheetNames[t],a=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var c=Ot(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],we(s,129),(r.vbaraw||a["!outline"])&&we(s,147,IL(o,a["!outline"])),we(s,148,AL(c)),F8(s,a,r.Workbook),I8(s,a),k8(s,a,t,e),N8(s,a),P8(s,a,r,t),b8(s,a),R8(s,a,n),a["!margins"]&&we(s,476,x8(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&C8(s,a),D8(s,a,t,n),we(s,130),s.end()}function L8(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var a=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var s=Nt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function M8(t,e,r,n,s,i){var a=i||{"!type":"chart"};if(!t)return i;var o=0,c=0,l="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var f=L8(d);h.s.r=h.s.c=0,h.e.c=o,l=_r(o),f[0].forEach(function(g,w){a[l+Mr(w)]={t:"n",v:g,z:f[1]},c=w}),h.e.r<c&&(h.e.r=c),++o}),o>0&&(a["!ref"]=wt(h)),a}function B8(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(By);return o&&np(o[0],i,s,r),(a=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=a[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function V8(t,e){t.l+=10;var r=Bn(t);return{name:r}}function j8(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a=!1;return ta(t,function(c,l,h){switch(h){case 550:i["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var sp=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],U8=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],W8=[],$8=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function tx(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=ur(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function rx(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=ur(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function Wy(t){rx(t.WBProps,sp),rx(t.CalcPr,$8),tx(t.WBView,U8),tx(t.Sheets,W8),lc.date1904=ur(t.WBProps.date1904)}function z8(t){return!t.Workbook||!t.Workbook.WBProps?"false":ur(t.Workbook.WBProps.date1904)?"true":"false"}var H8="][*?/\\".split("");function $y(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return H8.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function G8(t,e,r){t.forEach(function(n,s){$y(n);for(var i=0;i<s;++i)if(n==t[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[s]&&e[s].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function q8(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];G8(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)z5(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var X8=/<\w+:workbook/;function K8(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},a=0;if(t.replace(Wn,function(c,l){var h=lt(c);switch(Si(h[0])){case"<?xml":break;case"<workbook":c.match(X8)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=h[s];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":sp.forEach(function(d){if(h[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=ur(h[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(h[d[0]],10);break;default:r.WBProps[d[0]]=h[d[0]]}}),h.codeName&&(r.WBProps.CodeName=rr(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=Nt(rr(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=rr(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),ur(h.hidden||"0")&&(i.Hidden=!0),a=l+c.length;break;case"</definedName>":i.Ref=Nt(rr(t.slice(a,l))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return c}),Ro.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Wy(r),r}function zy(t){var e=[jr];e[e.length]=Pe("workbook",null,{xmlns:Ro[0],"xmlns:r":tn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(sp.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Pe("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var a={name:er(t.SheetNames[i].slice(0,31))};if(a.sheetId=""+(i+1),a["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=Pe("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(e[e.length]=Pe("definedName",er(o.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function Y8(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=od(t),r.name=Bn(t),r}function Q8(t,e){return e||(e=ue(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),$m(t.strRelID,e),fn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function J8(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Bn(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Z8(t,e){e||(e=ue(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),O2(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function eM(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function tM(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=DP(t),a=B5(t,0,r),o=Wm(t);t.l=n;var c={Name:i,Ptg:a};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function rM(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],a=[[]];return a.SheetNames=[],a.XTI=[],Wl[16]={n:"BrtFRTArchID$",f:eM},ta(t,function(c,l,h){switch(h){case 156:a.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=Fn(c.Ptg,null,null,a,e),delete e.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([h,c]):a[0]=[h,c],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(c),a.XTI=a.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(h),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!l.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},e),Wy(r),r.Names=i,r.supbooks=a,r}function nM(t,e){we(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};we(t,156,Q8(s))}we(t,144)}function sM(t,e){e||(e=ue(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return fn("SheetJS",e),fn(Mh.version,e),fn(Mh.version,e),fn("7262",e),e.length>e.l?e.slice(0,e.l):e}function iM(t,e){e||(e=ue(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function aM(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(we(t,135),we(t,158,iM(s)),we(t,136))}}function oM(t,e){var r=as();return we(r,131),we(r,128,sM()),we(r,153,Z8(t.Workbook&&t.Workbook.WBProps||null)),aM(r,t),nM(r,t),we(r,132),r.end()}function cM(t,e,r){return e.slice(-4)===".bin"?rM(t,r):K8(t,r)}function lM(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?S8(t,n,r,s,i,a,o):tL(t,n,r,s,i,a,o)}function uM(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?j8(t,n,r,s,i):B8(t,n,r,s,i)}function hM(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?d6():m6()}function fM(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?h6():f6()}function dM(t,e,r,n){return e.slice(-4)===".bin"?cO(t,r,n):YN(t,r,n)}function mM(t,e,r){return Sy(t,r)}function pM(t,e,r){return e.slice(-4)===".bin"?pN(t,r):fN(t,r)}function gM(t,e,r){return e.slice(-4)===".bin"?a6(t,r):QO(t,r)}function xM(t,e,r){return e.slice(-4)===".bin"?XO(t):GO(t)}function wM(t,e,r,n){return r.slice(-4)===".bin"?KO(t,e,r,n):void 0}function vM(t,e,r){return e.slice(-4)===".bin"?$O(t,e,r):HO(t,e,r)}function _M(t,e,r){return(e.slice(-4)===".bin"?oM:zy)(t)}function yM(t,e,r,n,s){return(e.slice(-4)===".bin"?O8:Vy)(t,r,n,s)}function EM(t,e,r){return(e.slice(-4)===".bin"?wO:Ey)(t,r)}function TM(t,e,r){return(e.slice(-4)===".bin"?wN:my)(t,r)}function SM(t,e,r){return(e.slice(-4)===".bin"?o6:by)(t)}function AM(t){return(t.slice(-4)===".bin"?zO:Ay)()}var Hy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Gy=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Gs(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(Hy),i,a,o,c;if(s)for(c=0;c!=s.length;++c)i=s[c].match(Gy),(a=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),n[o]=i[2].slice(1,i[2].length-1));return n}function kM(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(Hy),s,i,a,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(Gy),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(i+1),r[a]=s[2].slice(1,s[2].length-1));return r}var yl;function bM(t,e){var r=yl[t]||Nt(t);return r==="General"?vo(e):Ns(r,e)}function IM(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=ur(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=hr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Nt(e)]=s}function CM(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||ra[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Fl(t.v):t.w=vo(t.v):t.w=bM(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=yl[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Mc(n)){var s=io(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function RM(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=WN[n.Pattern]||n.Pattern)}t[e.ID]=e}function DM(t,e,r,n,s,i,a,o,c,l){var h="General",d=n.StyleID,f={};l=l||{};var g=[],w=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&a&&(d=a.StyleID);i[d]!==void 0&&(i[d].nf&&(h=i[d].nf),i[d].Interior&&g.push(i[d].Interior),!!i[d].Parent);)d=i[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ur(t);break;case"String":n.t="s",n.r=v1(Nt(t)),n.v=t.indexOf("<")>-1?Nt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(hr(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Nt(t):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=j2[t],l.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=v1(e||t));break}if(CM(n,h,l),l.cellFormula!==!1)if(n.Formula){var x=Nt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=cc(x,s),delete n.Formula,n.ArrayRange=="RC"?n.F=cc("RC:RC",s):n.ArrayRange&&(n.F=cc(n.ArrayRange,s),c.push([Ot(n.F),n.F]))}else for(w=0;w<c.length;++w)s.r>=c[w][0].s.r&&s.r<=c[w][0].e.r&&s.c>=c[w][0].s.c&&s.c<=c[w][0].e.c&&(n.F=c[w][1]);l.cellStyles&&(g.forEach(function(y){!f.patternType&&y.patternType&&(f.patternType=y.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function PM(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function S0(t,e){var r=e||{};Bc();var n=il(Lm(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=rr(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var a=fr(r);return a.type="string",yc.to_workbook(n,a)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(lr){s.indexOf("<"+lr)>=0&&(i=!0)}),i)return x9(n,r);yl={"General Number":"General","General Date":it[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":it[15],"Short Date":it[14],"Long Time":it[19],"Medium Time":it[18],"Short Time":it[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:it[2],Standard:it[4],Percent:it[10],Scientific:it[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l,h={},d=[],f=r.dense?[]:{},g="",w={},x={},y=Gs('<Data ss:Type="String">'),A=0,F=0,I=0,W={s:{r:2e6,c:2e6},e:{r:0,c:0}},U={},z={},T="",k=0,S=[],R={},C={},_=0,P=[],Fe=[],Ie={},je=[],Me,_t=!1,se=[],Ye=[],Je={},V=0,Y=0,q={Sheets:[],WBProps:{date1904:!1}},X={};Ll.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var he="";o=Ll.exec(n);)switch(o[3]=(he=o[3]).toLowerCase()){case"data":if(he=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?DM(n.slice(A,o.index),T,y,c[c.length-1][0]=="comment"?Ie:w,{c:F,r:I},U,je[F],x,se,r):(T="",y=Gs(o[0]),A=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Fe.length>0&&(w.c=Fe),(!r.sheetRows||r.sheetRows>I)&&w.v!==void 0&&(r.dense?(f[I]||(f[I]=[]),f[I][F]=w):f[_r(F)+Mr(I)]=w),w.HRef&&(w.l={Target:Nt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(V=F+(parseInt(w.MergeAcross,10)|0),Y=I+(parseInt(w.MergeDown,10)|0),S.push({s:{c:F,r:I},e:{c:V,r:Y}})),!r.sheetStubs)w.MergeAcross?F=V+1:++F;else if(w.MergeAcross||w.MergeDown){for(var Ee=F;Ee<=V;++Ee)for(var Ae=I;Ae<=Y;++Ae)(Ee>F||Ae>I)&&(r.dense?(f[Ae]||(f[Ae]=[]),f[Ae][Ee]={t:"z"}):f[_r(Ee)+Mr(Ae)]={t:"z"});F=V+1}else++F;else w=kM(o[0]),w.Index&&(F=+w.Index-1),F<W.s.c&&(W.s.c=F),F>W.e.c&&(W.e.c=F),o[0].slice(-2)==="/>"&&++F,Fe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(I<W.s.r&&(W.s.r=I),I>W.e.r&&(W.e.r=I),o[0].slice(-2)==="/>"&&(x=Gs(o[0]),x.Index&&(I=+x.Index-1)),F=0,++I):(x=Gs(o[0]),x.Index&&(I=+x.Index-1),Je={},(x.AutoFitHeight=="0"||x.Height)&&(Je.hpx=parseInt(x.Height,10),Je.hpt=Ul(Je.hpx),Ye[I]=Je),x.Hidden=="1"&&(Je.hidden=!0,Ye[I]=Je));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));d.push(g),W.s.r<=W.e.r&&W.s.c<=W.e.c&&(f["!ref"]=wt(W),r.sheetRows&&r.sheetRows<=W.e.r&&(f["!fullref"]=f["!ref"],W.e.r=r.sheetRows-1,f["!ref"]=wt(W))),S.length&&(f["!merges"]=S),je.length>0&&(f["!cols"]=je),Ye.length>0&&(f["!rows"]=Ye),h[g]=f}else W={s:{r:2e6,c:2e6},e:{r:0,c:0}},I=F=0,c.push([o[3],!1]),l=Gs(o[0]),g=Nt(l.Name),f=r.dense?[]:{},S=[],se=[],Ye=[],X={name:g,Hidden:0},q.Sheets.push(X);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),je=[],_t=!1}break;case"style":o[1]==="/"?RM(U,z,r):z=Gs(o[0]);break;case"numberformat":z.nf=Nt(Gs(o[0]).Format||"General"),yl[z.nf]&&(z.nf=yl[z.nf]);for(var ye=0;ye!=392&&it[ye]!=z.nf;++ye);if(ye==392){for(ye=57;ye!=392;++ye)if(it[ye]==null){Wi(z.nf,ye);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Me=Gs(o[0]),Me.Hidden&&(Me.hidden=!0,delete Me.Hidden),Me.Width&&(Me.wpx=parseInt(Me.Width,10)),!_t&&Me.wpx>10){_t=!0,On=_y;for(var ve=0;ve<je.length;++ve)je[ve]&&Ra(je[ve])}_t&&Ra(Me),je[Me.Index-1||je.length]=Me;for(var ct=0;ct<+Me.Span;++ct)je[je.length]=fr(Me);break;case"namedrange":if(o[1]==="/")break;q.Names||(q.Names=[]);var j=lt(o[0]),jt={Name:j.Name,Ref:cc(j.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(jt.Sheet=q.Sheets.length-1),q.Names.push(jt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=n.slice(k,o.index):k=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;z.Interior=Gs(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?rF(R,he,n.slice(_,o.index)):_=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));PM(Ie),Fe.push(Ie)}else c.push([o[3],!1]),l=Gs(o[0]),Ie={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var pt=Gs(o[0]);f["!autofilter"]={ref:cc(pt.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return ox(n,r);var Ft=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ft=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ft=!1}break;case"excelworkbook":switch(o[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ft=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ft=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(_,o.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else _=o.index+o[0].length;break;case"header":f["!margins"]||uo(f["!margins"]={},"xlml"),isNaN(+lt(o[0]).Margin)||(f["!margins"].header=+lt(o[0]).Margin);break;case"footer":f["!margins"]||uo(f["!margins"]={},"xlml"),isNaN(+lt(o[0]).Margin)||(f["!margins"].footer=+lt(o[0]).Margin);break;case"pagemargins":var ut=lt(o[0]);f["!margins"]||uo(f["!margins"]={},"xlml"),isNaN(+ut.Top)||(f["!margins"].top=+ut.Top),isNaN(+ut.Left)||(f["!margins"].left=+ut.Left),isNaN(+ut.Right)||(f["!margins"].right=+ut.Right),isNaN(+ut.Bottom)||(f["!margins"].bottom=+ut.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ft=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ft=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ft=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ft=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ft=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ft=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ft=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ft=!1}break;case"smarttags":break;default:Ft=!1;break}if(Ft||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?IM(C,he,P,n.slice(_,o.index)):(P=o,_=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var ke={};return!r.bookSheets&&!r.bookProps&&(ke.Sheets=h),ke.SheetNames=d,ke.Workbook=q,ke.SSF=fr(it),ke.Props=R,ke.Custprops=C,ke}function md(t,e){switch(ap(e=e||{}),e.type||"base64"){case"base64":return S0(vs(t),e);case"binary":case"buffer":case"file":return S0(t,e);case"array":return S0(La(t),e)}}function FM(t,e){var r=[];return t.Props&&r.push(nF(t.Props,e)),t.Custprops&&r.push(sF(t.Props,t.Custprops)),r.join("")}function NM(){return""}function OM(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var i=[];i.push(Pe("NumberFormat",null,{"ss:Format":er(it[n.numFmtId])}));var a={"ss:ID":"s"+(21+s)};r.push(Pe("Style",i.join(""),a))}),Pe("Styles",r.join(""))}function qy(t){return Pe("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+ep(t.Ref,{r:0,c:0})})}function LM(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(qy(s)))}return Pe("Names",r.join(""))}function MM(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],a=0;a<s.length;++a){var o=s[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(qy(o)))}return i.join("")}function BM(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(Pe("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(Pe("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(Pe("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Pe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(En("ProtectContents","True")),t["!protect"].objects&&s.push(En("ProtectObjects","True")),t["!protect"].scenarios&&s.push(En("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(En("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(En("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&s.push("<"+a[1]+"/>")})),s.length==0?"":Pe("WorksheetOptions",s.join(""),{xmlns:fs.x})}function VM(t){return t.map(function(e){var r=aP(e.t||""),n=Pe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Pe("Comment",n,{"ss:Author":e.a})}).join("")}function jM(t,e,r,n,s,i,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+er(ep(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var c=yr(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=er(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=er(t.l.Tooltip))),r["!merges"])for(var l=r["!merges"],h=0;h!=l.length;++h)l[h].s.c!=a.c||l[h].s.r!=a.r||(l[h].e.c>l[h].s.c&&(o["ss:MergeAcross"]=l[h].e.c-l[h].s.c),l[h].e.r>l[h].s.r&&(o["ss:MergeDown"]=l[h].e.r-l[h].s.r));var d="",f="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",f=String(t.v);break;case"b":d="Boolean",f=t.v?"1":"0";break;case"e":d="Error",f=ra[t.v];break;case"d":d="DateTime",f=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||it[14]);break;case"s":d="String",f=iP(t.v||"");break}var g=Ba(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=a.c+1;var w=t.v!=null?f:"",x=t.t=="z"?"":'<Data ss:Type="'+d+'">'+w+"</Data>";return(t.c||[]).length>0&&(x+=VM(t.c)),Pe("Cell",x,o)}function UM(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Ec(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function WM(t,e,r,n){if(!t["!ref"])return"";var s=Ot(t["!ref"]),i=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(y,A){Ra(y);var F=!!y.width,I=Bf(A,y),W={"ss:Index":A+1};F&&(W["ss:Width"]=Vl(I.width)),y.hidden&&(W["ss:Hidden"]="1"),o.push(Pe("Column",null,W))});for(var c=Array.isArray(t),l=s.s.r;l<=s.e.r;++l){for(var h=[UM(l,(t["!rows"]||[])[l])],d=s.s.c;d<=s.e.c;++d){var f=!1;for(a=0;a!=i.length;++a)if(!(i[a].s.c>d)&&!(i[a].s.r>l)&&!(i[a].e.c<d)&&!(i[a].e.r<l)){(i[a].s.c!=d||i[a].s.r!=l)&&(f=!0);break}if(!f){var g={r:l,c:d},w=at(g),x=c?(t[l]||[])[d]:t[w];h.push(jM(x,w,t,e,r,n,g))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function $M(t,e,r){var n=[],s=r.SheetNames[t],i=r.Sheets[s],a=i?MM(i,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=i?WM(i,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(BM(i,e,t,r)),n.join("")}function zM(t,e){e||(e={}),t.SSF||(t.SSF=fr(it)),t.SSF&&(Bc(),Df(t.SSF),e.revssf=Ff(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Ba(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(FM(t,e)),r.push(NM()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Pe("Worksheet",$M(n,e,t),{"ss:Name":er(t.SheetNames[n])}));return r[2]=OM(t,e),r[3]=LM(t),jr+Pe("Workbook",r.join(""),{xmlns:fs.ss,"xmlns:o":fs.o,"xmlns:x":fs.x,"xmlns:ss":fs.ss,"xmlns:dt":fs.dt,"xmlns:html":fs.html})}function HM(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=LP(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=MP(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var GM=[60,1084,2066,2165,2175];function qM(t,e,r,n,s){var i=n,a=[],o=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}a.push(o),r.l+=i;for(var c=Li(r,r.l),l=pd[c],h=0;l!=null&&GM.indexOf(c)>-1;)i=Li(r,r.l+2),h=r.l+4,c==2066?h+=4:(c==2165||c==2175)&&(h+=12),o=r.slice(h,r.l+4+i),a.push(o),r.l+=4+i,l=pd[c=Li(r,r.l)];var d=hn(a);yn(d,0);var f=0;d.lens=[];for(var g=0;g<a.length;++g)d.lens.push(f),f+=a[g].length;if(d.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+d.length+" < "+n;return e.f(d,d.length,s)}function hi(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=it[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||ra[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Fl(t.v):t.w=vo(t.v):t.w=Ns(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&Mc(it[n]||String(n))){var s=io(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Yu(t,e,r){return{v:t,ixfe:e,t:r}}function XM(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},a={},o=null,c=[],l="",h={},d,f="",g,w,x,y,A={},F=[],I,W,U=[],z=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},S=function(dt){return dt<8?oo[dt]:dt<64&&z[dt-8]||oo[dt]},R=function(dt,Kt,Ar){var It=Kt.XF.data;if(!(!It||!It.patternType||!Ar||!Ar.cellStyles)){Kt.s={},Kt.s.patternType=It.patternType;var pn;(pn=Bl(S(It.icvFore)))&&(Kt.s.fgColor={rgb:pn}),(pn=Bl(S(It.icvBack)))&&(Kt.s.bgColor={rgb:pn})}},C=function(dt,Kt,Ar){if(!(Je>1)&&!(Ar.sheetRows&&dt.r>=Ar.sheetRows)){if(Ar.cellStyles&&Kt.XF&&Kt.XF.data&&R(dt,Kt,Ar),delete Kt.ixfe,delete Kt.XF,d=dt,f=at(dt),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),dt.r<a.s.r&&(a.s.r=dt.r),dt.c<a.s.c&&(a.s.c=dt.c),dt.r+1>a.e.r&&(a.e.r=dt.r+1),dt.c+1>a.e.c&&(a.e.c=dt.c+1),Ar.cellFormula&&Kt.f){for(var It=0;It<F.length;++It)if(!(F[It][0].s.c>dt.c||F[It][0].s.r>dt.r)&&!(F[It][0].e.c<dt.c||F[It][0].e.r<dt.r)){Kt.F=wt(F[It][0]),(F[It][0].s.c!=dt.c||F[It][0].s.r!=dt.r)&&delete Kt.f,Kt.f&&(Kt.f=""+Fn(F[It][1],a,dt,se,_));break}}Ar.dense?(s[dt.r]||(s[dt.r]=[]),s[dt.r][dt.c]=Kt):s[f]=Kt}},_={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:F,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(_.password=e.password);var P,Fe=[],Ie=[],je=[],Me=[],_t=!1,se=[];se.SheetNames=_.snames,se.sharedf=_.sharedf,se.arrayf=_.arrayf,se.names=[],se.XTI=[];var Ye=0,Je=0,V=0,Y=[],q=[],X;_.codepage=1200,Js(1200);for(var he=!1;t.l<t.length-1;){var Ee=t.l,Ae=t.read_shift(2);if(Ae===0&&Ye===10)break;var ye=t.l===t.length?0:t.read_shift(2),ve=pd[Ae];if(ve&&ve.f){if(e.bookSheets&&Ye===133&&Ae!==133)break;if(Ye=Ae,ve.r===2||ve.r==12){var ct=t.read_shift(2);if(ye-=2,!_.enc&&ct!==Ae&&((ct&255)<<8|ct>>8)!==Ae)throw new Error("rt mismatch: "+ct+"!="+Ae);ve.r==12&&(t.l+=10,ye-=10)}var j={};if(Ae===10?j=ve.f(t,ye,_):j=qM(Ae,ve,t,ye,_),Je==0&&[9,521,1033,2057].indexOf(Ye)===-1)continue;switch(Ae){case 34:r.opts.Date1904=T.WBProps.date1904=j;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(_.enc||(t.l=0),_.enc=j,!e.password)throw new Error("File is password-protected");if(j.valid==null)throw new Error("Encryption scheme unsupported");if(!j.valid)throw new Error("Password is incorrect");break;case 92:_.lastuser=j;break;case 66:var jt=Number(j);switch(jt){case 21010:jt=1200;break;case 32768:jt=1e4;break;case 32769:jt=1252;break}Js(_.codepage=jt),he=!0;break;case 317:_.rrtabid=j;break;case 25:_.winlocked=j;break;case 439:r.opts.RefreshAll=j;break;case 12:r.opts.CalcCount=j;break;case 16:r.opts.CalcDelta=j;break;case 17:r.opts.CalcIter=j;break;case 13:r.opts.CalcMode=j;break;case 14:r.opts.CalcPrecision=j;break;case 95:r.opts.CalcSaveRecalc=j;break;case 15:_.CalcRefMode=j;break;case 2211:r.opts.FullCalc=j;break;case 129:j.fDialog&&(s["!type"]="dialog"),j.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),j.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:U.push(j);break;case 430:se.push([j]),se[se.length-1].XTI=[];break;case 35:case 547:se[se.length-1].push(j);break;case 24:case 536:X={Name:j.Name,Ref:Fn(j.rgce,a,null,se,_)},j.itab>0&&(X.Sheet=j.itab-1),se.names.push(X),se[0]||(se[0]=[],se[0].XTI=[]),se[se.length-1].push(j),j.Name=="_xlnm._FilterDatabase"&&j.itab>0&&j.rgce&&j.rgce[0]&&j.rgce[0][0]&&j.rgce[0][0][0]=="PtgArea3d"&&(q[j.itab-1]={ref:wt(j.rgce[0][0][1][2])});break;case 22:_.ExternCount=j;break;case 23:se.length==0&&(se[0]=[],se[0].XTI=[]),se[se.length-1].XTI=se[se.length-1].XTI.concat(j),se.XTI=se.XTI.concat(j);break;case 2196:if(_.biff<8)break;X!=null&&(X.Comment=j[1]);break;case 18:s["!protect"]=j;break;case 19:j!==0&&_.WTF&&console.error("Password verifier: "+j);break;case 133:i[j.pos]=j,_.snames.push(j.name);break;case 10:{if(--Je)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,s["!ref"]=wt(a),e.sheetRows&&e.sheetRows<=a.e.r){var pt=a.e.r;a.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=wt(a),a.e.r=pt}a.e.r++,a.e.c++}Fe.length>0&&(s["!merges"]=Fe),Ie.length>0&&(s["!objects"]=Ie),je.length>0&&(s["!cols"]=je),Me.length>0&&(s["!rows"]=Me),T.Sheets.push(k)}l===""?h=s:n[l]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(_.biff===8&&(_.biff={9:2,521:3,1033:4}[Ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[j.BIFFVer]||8),_.biffguess=j.BIFFVer==0,j.BIFFVer==0&&j.dt==4096&&(_.biff=5,he=!0,Js(_.codepage=28591)),_.biff==8&&j.BIFFVer==0&&j.dt==16&&(_.biff=2),Je++)break;if(s=e.dense?[]:{},_.biff<8&&!he&&(he=!0,Js(_.codepage=e.codepage||1252)),_.biff<5||j.BIFFVer==0&&j.dt==4096){l===""&&(l="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Ft={pos:t.l-ye,name:l};i[Ft.pos]=Ft,_.snames.push(l)}else l=(i[Ee]||{name:""}).name;j.dt==32&&(s["!type"]="chart"),j.dt==64&&(s["!type"]="macro"),Fe=[],Ie=[],_.arrayf=F=[],je=[],Me=[],_t=!1,k={Hidden:(i[Ee]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[j.r]||[])[j.c]:s[at({c:j.c,r:j.r})])&&++j.c,I={ixfe:j.ixfe,XF:U[j.ixfe]||{},v:j.val,t:"n"},V>0&&(I.z=Y[I.ixfe>>8&63]),hi(I,e,r.opts.Date1904),C({c:j.c,r:j.r},I,e);break;case 5:case 517:I={ixfe:j.ixfe,XF:U[j.ixfe],v:j.val,t:j.t},V>0&&(I.z=Y[I.ixfe>>8&63]),hi(I,e,r.opts.Date1904),C({c:j.c,r:j.r},I,e);break;case 638:I={ixfe:j.ixfe,XF:U[j.ixfe],v:j.rknum,t:"n"},V>0&&(I.z=Y[I.ixfe>>8&63]),hi(I,e,r.opts.Date1904),C({c:j.c,r:j.r},I,e);break;case 189:for(var ut=j.c;ut<=j.C;++ut){var ke=j.rkrec[ut-j.c][0];I={ixfe:ke,XF:U[ke],v:j.rkrec[ut-j.c][1],t:"n"},V>0&&(I.z=Y[I.ixfe>>8&63]),hi(I,e,r.opts.Date1904),C({c:ut,r:j.r},I,e)}break;case 6:case 518:case 1030:{if(j.val=="String"){o=j;break}if(I=Yu(j.val,j.cell.ixfe,j.tt),I.XF=U[I.ixfe],e.cellFormula){var lr=j.formula;if(lr&&lr[0]&&lr[0][0]&&lr[0][0][0]=="PtgExp"){var dr=lr[0][0][1][0],Ur=lr[0][0][1][1],Qn=at({r:dr,c:Ur});A[Qn]?I.f=""+Fn(j.formula,a,j.cell,se,_):I.F=((e.dense?(s[dr]||[])[Ur]:s[Qn])||{}).F}else I.f=""+Fn(j.formula,a,j.cell,se,_)}V>0&&(I.z=Y[I.ixfe>>8&63]),hi(I,e,r.opts.Date1904),C(j.cell,I,e),o=j}break;case 7:case 519:if(o)o.val=j,I=Yu(j,o.cell.ixfe,"s"),I.XF=U[I.ixfe],e.cellFormula&&(I.f=""+Fn(o.formula,a,o.cell,se,_)),V>0&&(I.z=Y[I.ixfe>>8&63]),hi(I,e,r.opts.Date1904),C(o.cell,I,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{F.push(j);var cs=at(j[0].s);if(g=e.dense?(s[j[0].s.r]||[])[j[0].s.c]:s[cs],e.cellFormula&&g){if(!o||!cs||!g)break;g.f=""+Fn(j[1],a,j[0],se,_),g.F=wt(j[0])}}break;case 1212:{if(!e.cellFormula)break;if(f){if(!o)break;A[at(o.cell)]=j[0],g=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[at(o.cell)],(g||{}).f=""+Fn(j[0],a,d,se,_)}}break;case 253:I=Yu(c[j.isst].t,j.ixfe,"s"),c[j.isst].h&&(I.h=c[j.isst].h),I.XF=U[I.ixfe],V>0&&(I.z=Y[I.ixfe>>8&63]),hi(I,e,r.opts.Date1904),C({c:j.c,r:j.r},I,e);break;case 513:e.sheetStubs&&(I={ixfe:j.ixfe,XF:U[j.ixfe],t:"z"},V>0&&(I.z=Y[I.ixfe>>8&63]),hi(I,e,r.opts.Date1904),C({c:j.c,r:j.r},I,e));break;case 190:if(e.sheetStubs)for(var Jn=j.c;Jn<=j.C;++Jn){var Tr=j.ixfe[Jn-j.c];I={ixfe:Tr,XF:U[Tr],t:"z"},V>0&&(I.z=Y[I.ixfe>>8&63]),hi(I,e,r.opts.Date1904),C({c:Jn,r:j.r},I,e)}break;case 214:case 516:case 4:I=Yu(j.val,j.ixfe,"s"),I.XF=U[I.ixfe],V>0&&(I.z=Y[I.ixfe>>8&63]),hi(I,e,r.opts.Date1904),C({c:j.c,r:j.r},I,e);break;case 0:case 512:Je===1&&(a=j);break;case 252:c=j;break;case 1054:if(_.biff==4){Y[V++]=j[1];for(var Zn=0;Zn<V+163&&it[Zn]!=j[1];++Zn);Zn>=163&&Wi(j[1],V+163)}else Wi(j[1],j[0]);break;case 30:{Y[V++]=j;for(var zt=0;zt<V+163&&it[zt]!=j;++zt);zt>=163&&Wi(j,V+163)}break;case 229:Fe=Fe.concat(j);break;case 93:Ie[j.cmo[0]]=_.lastobj=j;break;case 438:_.lastobj.TxO=j;break;case 127:_.lastobj.ImData=j;break;case 440:for(y=j[0].s.r;y<=j[0].e.r;++y)for(x=j[0].s.c;x<=j[0].e.c;++x)g=e.dense?(s[y]||[])[x]:s[at({c:x,r:y})],g&&(g.l=j[1]);break;case 2048:for(y=j[0].s.r;y<=j[0].e.r;++y)for(x=j[0].s.c;x<=j[0].e.c;++x)g=e.dense?(s[y]||[])[x]:s[at({c:x,r:y})],g&&g.l&&(g.l.Tooltip=j[1]);break;case 28:{if(_.biff<=5&&_.biff>=2)break;g=e.dense?(s[j[0].r]||[])[j[0].c]:s[at(j[0])];var mr=Ie[j[2]];g||(e.dense?(s[j[0].r]||(s[j[0].r]=[]),g=s[j[0].r][j[0].c]={t:"z"}):g=s[at(j[0])]={t:"z"},a.e.r=Math.max(a.e.r,j[0].r),a.s.r=Math.min(a.s.r,j[0].r),a.e.c=Math.max(a.e.c,j[0].c),a.s.c=Math.min(a.s.c,j[0].c)),g.c||(g.c=[]),w={a:j[1],t:mr.TxO.t},g.c.push(w)}break;case 2173:OO(U[j.ixfe],j.ext);break;case 125:{if(!_.cellStyles)break;for(;j.e>=j.s;)je[j.e--]={width:j.w/256,level:j.level||0,hidden:!!(j.flags&1)},_t||(_t=!0,Qm(j.w/256)),Ra(je[j.e+1])}break;case 520:{var Sr={};j.level!=null&&(Me[j.r]=Sr,Sr.level=j.level),j.hidden&&(Me[j.r]=Sr,Sr.hidden=!0),j.hpt&&(Me[j.r]=Sr,Sr.hpt=j.hpt,Sr.hpx=Ec(j.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||uo(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ae]]=j;break;case 161:s["!margins"]||uo(s["!margins"]={}),s["!margins"].header=j.header,s["!margins"].footer=j.footer;break;case 574:j.RTL&&(T.Views[0].RTL=!0);break;case 146:z=j;break;case 2198:P=j;break;case 140:W=j;break;case 442:l?k.CodeName=j||k.name:T.WBProps.CodeName=j||"ThisWorkbook";break}}else ve||console.error("Missing Info for XLS Record 0x"+Ae.toString(16)),t.l+=ye}return r.SheetNames=Rr(i).sort(function(Tn,dt){return Number(Tn)-Number(dt)}).map(function(Tn){return i[Tn].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&q.forEach(function(Tn,dt){r.Sheets[r.SheetNames[dt]]["!autofilter"]=Tn}),r.Strings=c,r.SSF=fr(it),_.enc&&(r.Encryption=_.enc),P&&(r.Themes=P),r.Metadata={},W!==void 0&&(r.Metadata.Country=W),se.names.length>0&&(T.Names=se.names),r.Workbook=T,r}var El={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function KM(t,e,r){var n=Qe.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=M1(n,cd,El.DSI);for(var i in s)e[i]=s[i]}catch(l){if(r.WTF)throw l}var a=Qe.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=M1(a,ld,El.SI);for(var c in o)e[c]==null&&(e[c]=o[c])}catch(l){if(r.WTF)throw l}e.HeadingPairs&&e.TitlesOfParts&&(G2(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function YM(t,e){var r=[],n=[],s=[],i=0,a,o=d1(cd,"n"),c=d1(ld,"n");if(t.Props)for(a=Rr(t.Props),i=0;i<a.length;++i)(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(c,a[i])?n:s).push([a[i],t.Props[a[i]]]);if(t.Custprops)for(a=Rr(t.Custprops),i=0;i<a.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},a[i])||(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(c,a[i])?n:s).push([a[i],t.Custprops[a[i]]]);var l=[];for(i=0;i<s.length;++i)Z2.indexOf(s[i][0])>-1||H2.indexOf(s[i][0])>-1||s[i][1]!=null&&l.push(s[i]);n.length&&Qe.utils.cfb_add(e,"/SummaryInformation",B1(n,El.SI,c,ld)),(r.length||l.length)&&Qe.utils.cfb_add(e,"/DocumentSummaryInformation",B1(r,El.DSI,o,cd,l.length?l:null,El.UDI))}function Xy(t,e){e||(e={}),ap(e),bm(),e.codepage&&km(e.codepage);var r,n;if(t.FullPaths){if(Qe.find(t,"/encryption"))throw new Error("File is password-protected");r=Qe.find(t,"!CompObj"),n=Qe.find(t,"/Workbook")||Qe.find(t,"/Book")}else{switch(e.type){case"base64":t=ps(vs(t));break;case"binary":t=ps(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}yn(t,0),n={content:t}}var s,i;if(r&&HM(r),e.bookProps&&!e.bookSheets)s={};else{var a=yt?"buffer":"array";if(n&&n.content)s=XM(n.content,e);else if((i=Qe.find(t,"PerfectOffice_MAIN"))&&i.content)s=lo.to_workbook(i.content,(e.type=a,e));else if((i=Qe.find(t,"NativeContent_MAIN"))&&i.content)s=lo.to_workbook(i.content,(e.type=a,e));else throw(i=Qe.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Qe.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=l6(t))}var o={};return t.FullPaths&&KM(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}function QM(t,e){var r=e||{},n=Qe.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Qe.utils.cfb_add(n,s,Ky(t,r)),r.biff==8&&(t.Props||t.Custprops)&&YM(t,n),r.biff==8&&t.vbaraw&&u6(n,Qe.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Wl={0:{f:yL},1:{f:CL},2:{f:XL},3:{f:ML},4:{f:FL},5:{f:HL},6:{f:ZL},7:{f:UL},8:{f:a8},9:{f:i8},10:{f:n8},11:{f:s8},12:{f:DL},13:{f:YL},14:{f:VL},15:{f:OL},16:{f:jy},17:{f:t8},18:{f:$L},19:{f:Um},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:tM},40:{},42:{},43:{f:ZN},44:{f:QN},45:{f:rO},46:{f:sO},47:{f:nO},48:{},49:{f:SP},50:{},51:{f:BO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:uy},62:{f:JL},63:{f:qO},64:{f:E8},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Un,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:w8},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:bL},148:{f:SL,p:16},151:{f:f8},152:{},153:{f:J8},154:{},155:{},156:{f:Y8},157:{},158:{},159:{T:1,f:mN},160:{T:-1},161:{T:1,f:No},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:o8},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:LO},336:{T:-1},337:{f:UO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:od},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ly},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:d8},427:{f:m8},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:g8},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:kL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:u8},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:od},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:s6},633:{T:1},634:{T:-1},635:{T:1,f:r6},636:{T:-1},637:{f:IP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:V8},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:T8},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},pd={6:{f:E0},10:{f:la},12:{f:Gr},13:{f:Gr},14:{f:Fr},15:{f:Fr},16:{f:Ln},17:{f:Fr},18:{f:Fr},19:{f:Gr},20:{f:z1},21:{f:z1},23:{f:ly},24:{f:G1},25:{f:Fr},26:{},27:{},28:{f:T3},29:{},34:{f:Fr},35:{f:H1},38:{f:Ln},39:{f:Ln},40:{f:Ln},41:{f:Ln},42:{f:Fr},43:{f:Fr},47:{f:ON},49:{f:YF},51:{f:Gr},60:{},61:{f:HF},64:{f:Fr},65:{f:KF},66:{f:Gr},77:{},80:{},81:{},82:{},85:{f:Gr},89:{},90:{},91:{},92:{f:NF},93:{f:k3},94:{},95:{f:Fr},96:{},97:{},99:{f:Fr},125:{f:uy},128:{f:h3},129:{f:LF},130:{f:Gr},131:{f:Fr},132:{f:Fr},133:{f:MF},134:{},140:{f:N3},141:{f:Gr},144:{},146:{f:M3},151:{},152:{},153:{},154:{},155:{},156:{f:Gr},157:{},158:{},160:{f:z3},161:{f:j3},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:o3},190:{f:c3},193:{f:la},197:{},198:{},199:{},200:{},201:{},202:{f:Fr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Gr},220:{},221:{f:Fr},222:{},224:{f:u3},225:{f:FF},226:{f:la},227:{},229:{f:S3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:VF},253:{f:JF},255:{f:UF},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ey},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Fr},353:{f:la},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:g3},431:{f:Fr},432:{},433:{},434:{},437:{},438:{f:C3},439:{f:Fr},440:{f:R3},441:{},442:{f:mu},443:{},444:{f:Gr},445:{},446:{},448:{f:la},449:{f:zF,r:2},450:{f:la},512:{f:U1},513:{f:$3},515:{f:m3},516:{f:e3},517:{f:$1},519:{f:H3},520:{f:WF},523:{},545:{f:q1},549:{f:j1},566:{},574:{f:qF},638:{f:a3},659:{},1048:{},1054:{f:r3},1084:{},1212:{f:_3},2048:{f:P3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:qu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:la},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:B3,r:12},2173:{f:NO,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Fr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:v3,r:12},2197:{},2198:{f:IO,r:12},2199:{},2200:{},2201:{},2202:{f:y3,r:12},2203:{f:la},2204:{},2205:{},2206:{},2207:{},2211:{f:$F},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Gr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:U3},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:L3},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:U1},1:{},2:{f:Y3},3:{f:X3},4:{f:q3},5:{f:$1},7:{f:J3},8:{},9:{f:qu},11:{},22:{f:Gr},30:{f:s3},31:{},32:{},33:{f:q1},36:{},37:{f:j1},50:{f:Z3},62:{},52:{},67:{},68:{f:Gr},69:{},86:{},126:{},127:{f:G3},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:eN},223:{},234:{},354:{},421:{},518:{f:E0},521:{f:qu},536:{f:G1},547:{f:H1},561:{},579:{},1030:{f:E0},1033:{f:qu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Oe(t,e,r,n){var s=e;if(!isNaN(s)){var i=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&Bm(r)&&t.push(r)}}function JM(t,e,r,n){var s=(r||[]).length||0;if(s<=8224)return Oe(t,e,r,s);var i=e;if(!isNaN(i)){for(var a=r.parts||[],o=0,c=0,l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;var h=t.next(4);for(h.write_shift(2,i),h.write_shift(2,l),t.push(r.slice(c,c+l)),c+=l;c<s;){for(h=t.next(4),h.write_shift(2,60),l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;h.write_shift(2,l),t.push(r.slice(c,c+l)),c+=l}}}function wu(t,e,r){return t||(t=ue(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function ZM(t,e,r,n){var s=ue(9);return wu(s,t,e),ty(r,n||"b",s),s}function e9(t,e,r){var n=ue(8+2*r.length);return wu(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function t9(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?nn(hr(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?Oe(t,2,Q3(r,n,s)):Oe(t,3,K3(r,n,s));return;case"b":case"e":Oe(t,5,ZM(r,n,e.v,e.t));return;case"s":case"str":Oe(t,4,e9(r,n,(e.v||"").slice(0,255)));return}Oe(t,1,wu(null,r,n))}function r9(t,e,r,n){var s=Array.isArray(e),i=Ot(e["!ref"]||"A1"),a,o="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),a=wt(i)}for(var l=i.s.r;l<=i.e.r;++l){o=Mr(l);for(var h=i.s.c;h<=i.e.c;++h){l===i.s.r&&(c[h]=_r(h)),a=c[h]+o;var d=s?(e[l]||[])[h]:e[a];d&&t9(t,d,l,h)}}}function n9(t,e){for(var r=e||{},n=as(),s=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Oe(n,r.biff==4?1033:r.biff==3?521:9,Xm(t,16,r)),r9(n,t.Sheets[t.SheetNames[s]],s,r),Oe(n,10),n.end()}function s9(t,e,r){Oe(t,49,QF({sz:12,name:"Arial"},r))}function i9(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&Oe(t,1054,n3(s,e[s],r))})}function a9(t,e){var r=ue(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Oe(t,2151,r),r=ue(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),ay(Ot(e["!ref"]||"A1"),r),r.write_shift(4,4),Oe(t,2152,r)}function o9(t,e){for(var r=0;r<16;++r)Oe(t,224,W1({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Oe(t,224,W1(n,0,e))})}function c9(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Oe(t,440,D3(n)),n[1].Tooltip&&Oe(t,2048,F3(n))}delete e["!links"]}function l9(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&Oe(t,125,V3(Bf(s,n),s))})}}function u9(t,e,r,n,s){var i=16+Ba(s.cellXfs,e,s);if(e.v==null&&!e.bf){Oe(t,513,To(r,n,i));return}if(e.bf)Oe(t,6,L5(e,r,n,s,i));else switch(e.t){case"d":case"n":var a=e.t=="d"?nn(hr(e.v)):e.v;Oe(t,515,p3(r,n,a,i));break;case"b":case"e":Oe(t,517,d3(r,n,e.v,i,s,e.t));break;case"s":case"str":if(s.bookSST){var o=rp(s.Strings,e.v,s.revStrings);Oe(t,253,ZF(r,n,o,i))}else Oe(t,516,t3(r,n,(e.v||"").slice(0,255),i,s));break;default:Oe(t,513,To(r,n,i))}}function h9(t,e,r){var n=as(),s=r.SheetNames[t],i=r.Sheets[s]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},c=Array.isArray(i),l=e.biff==8,h,d="",f=[],g=Ot(i["!ref"]||"A1"),w=l?65536:16384;if(g.e.c>255||g.e.r>=w){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,w-1)}Oe(n,2057,Xm(r,16,e)),Oe(n,13,Rs(1)),Oe(n,12,Rs(100)),Oe(n,15,Gn(!0)),Oe(n,17,Gn(!1)),Oe(n,16,yo(.001)),Oe(n,95,Gn(!0)),Oe(n,42,Gn(!1)),Oe(n,43,Gn(!1)),Oe(n,130,Rs(1)),Oe(n,128,f3()),Oe(n,131,Gn(!1)),Oe(n,132,Gn(!1)),l&&l9(n,i["!cols"]),Oe(n,512,i3(g,e)),l&&(i["!links"]=[]);for(var x=g.s.r;x<=g.e.r;++x){d=Mr(x);for(var y=g.s.c;y<=g.e.c;++y){x===g.s.r&&(f[y]=_r(y)),h=f[y]+d;var A=c?(i[x]||[])[y]:i[h];A&&(u9(n,A,x,y,e),l&&A.l&&i["!links"].push([h,A.l]))}}var F=o.CodeName||o.name||s;return l&&Oe(n,574,XF((a.Views||[])[0])),l&&(i["!merges"]||[]).length&&Oe(n,229,A3(i["!merges"])),l&&c9(n,i),Oe(n,442,ry(F)),l&&a9(n,i),Oe(n,10),n.end()}function f9(t,e,r){var n=as(),s=(t||{}).Workbook||{},i=s.Sheets||[],a=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(Oe(n,2057,Xm(t,5,r)),r.bookType=="xla"&&Oe(n,135),Oe(n,225,o?Rs(1200):null),Oe(n,193,dF(2)),c&&Oe(n,191),c&&Oe(n,192),Oe(n,226),Oe(n,92,OF("SheetJS",r)),Oe(n,66,Rs(o?1200:1252)),o&&Oe(n,353,Rs(0)),o&&Oe(n,448),Oe(n,317,W3(t.SheetNames.length)),o&&t.vbaraw&&Oe(n,211),o&&t.vbaraw){var l=a.CodeName||"ThisWorkbook";Oe(n,442,ry(l))}Oe(n,156,Rs(17)),Oe(n,25,Gn(!1)),Oe(n,18,Gn(!1)),Oe(n,19,Rs(0)),o&&Oe(n,431,Gn(!1)),o&&Oe(n,444,Rs(0)),Oe(n,61,GF()),Oe(n,64,Gn(!1)),Oe(n,141,Rs(0)),Oe(n,34,Gn(z8(t)=="true")),Oe(n,14,Gn(!0)),o&&Oe(n,439,Gn(!1)),Oe(n,218,Rs(0)),s9(n,t,r),i9(n,t.SSF,r),o9(n,r),o&&Oe(n,352,Gn(!1));var h=n.end(),d=as();o&&Oe(d,140,O3()),o&&r.Strings&&JM(d,252,jF(r.Strings)),Oe(d,10);var f=d.end(),g=as(),w=0,x=0;for(x=0;x<t.SheetNames.length;++x)w+=(o?12:11)+(o?2:1)*t.SheetNames[x].length;var y=h.length+w+f.length;for(x=0;x<t.SheetNames.length;++x){var A=i[x]||{};Oe(g,133,BF({pos:y,hs:A.Hidden||0,dt:0,name:t.SheetNames[x]},r)),y+=e[x].length}var F=g.end();if(w!=F.length)throw new Error("BS8 "+w+" != "+F.length);var I=[];return h.length&&I.push(h),F.length&&I.push(F),f.length&&I.push(f),hn(I)}function d9(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=fr(it)),t&&t.SSF&&(Bc(),Df(t.SSF),r.revssf=Ff(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,op(r),r.cellXfs=[],Ba(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=h9(s,r,t);return n.unshift(f9(t,n,r)),hn(n)}function Ky(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=os(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return d9(t,e);case 4:case 3:case 2:return n9(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function nx(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),a=s.index,o=i&&i.index||t.length,c=QD(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,h=0,d=0,f=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(a=0;a<c.length;++a){var x=c[a].trim(),y=x.slice(0,3).toLowerCase();if(y=="<tr"){if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}h=0;continue}if(!(y!="<td"&&y!="<th")){var A=x.split(/<\/t[dh]>/i);for(o=0;o<A.length;++o){var F=A[o].trim();if(F.match(/<t[dh]/i)){for(var I=F,W=0;I.charAt(0)=="<"&&(W=I.indexOf(">"))>-1;)I=I.slice(W+1);for(var U=0;U<w.length;++U){var z=w[U];z.s.c==h&&z.s.r<l&&l<=z.e.r&&(h=z.e.c+1,U=-1)}var T=lt(F.slice(0,F.indexOf(">")));f=T.colspan?+T.colspan:1,((d=+T.rowspan)>1||f>1)&&w.push({s:{r:l,c:h},e:{r:l+(d||1)-1,c:h+f-1}});var k=T.t||T["data-t"]||"";if(!I.length){h+=f;continue}if(I=v2(I),g.s.r>l&&(g.s.r=l),g.e.r<l&&(g.e.r=l),g.s.c>h&&(g.s.c=h),g.e.c<h&&(g.e.c=h),!I.length){h+=f;continue}var S={t:"s",v:I};r.raw||!I.trim().length||k=="s"||(I==="TRUE"?S={t:"b",v:!0}:I==="FALSE"?S={t:"b",v:!1}:isNaN(ri(I))?isNaN(_c(I).getDate())||(S={t:"d",v:hr(I)},r.cellDates||(S={t:"n",v:nn(S.v)}),S.z=r.dateNF||it[14]):S={t:"n",v:ri(I)}),r.dense?(n[l]||(n[l]=[]),n[l][h]=S):n[at({r:l,c:h})]=S,h+=f}}}}return n["!ref"]=wt(g),w.length&&(n["!merges"]=w),n}function m9(t,e,r,n){for(var s=t["!merges"]||[],i=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,c=0,l=0;l<s.length;++l)if(!(s[l].s.r>r||s[l].s.c>a)&&!(s[l].e.r<r||s[l].e.c<a)){if(s[l].s.r<r||s[l].s.c<a){o=-1;break}o=s[l].e.r-s[l].s.r+1,c=s[l].e.c-s[l].s.c+1;break}if(!(o<0)){var h=at({r,c:a}),d=n.dense?(t[r]||[])[a]:t[h],f=d&&d.v!=null&&(d.h||Om(d.w||(Xi(d),d.w)||""))||"",g={};o>1&&(g.rowspan=o),c>1&&(g.colspan=c),n.editable?f='<span contenteditable="true">'+f+"</span>":d&&(g["data-t"]=d&&d.t||"z",d.v!=null&&(g["data-v"]=d.v),d.z!=null&&(g["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+d.l.Target+'">'+f+"</a>")),g.id=(n.id||"sjs")+"-"+h,i.push(Pe("td",f,g))}}var w="<tr>";return w+i.join("")+"</tr>"}var p9='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',g9="</body></html>";function x9(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ma(nx(r[0],e),e);var n=up();return r.forEach(function(s,i){hp(n,nx(s,e),"Sheet"+(i+1))}),n}function w9(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Yy(t,e){var r=e||{},n=r.header!=null?r.header:p9,s=r.footer!=null?r.footer:g9,i=[n],a=os(t["!ref"]);r.dense=Array.isArray(t),i.push(w9(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(m9(t,a,o,r));return i.push("</table>"+s),i.join("")}function Qy(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?yr(n.origin):n.origin;s=a.r,i=a.c}var o=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var h=os(t["!ref"]);l.s.r=Math.min(l.s.r,h.s.r),l.s.c=Math.min(l.s.c,h.s.c),l.e.r=Math.max(l.e.r,h.e.r),l.e.c=Math.max(l.e.c,h.e.c),s==-1&&(l.e.r=s=h.e.r+1)}var d=[],f=0,g=t["!rows"]||(t["!rows"]=[]),w=0,x=0,y=0,A=0,F=0,I=0;for(t["!cols"]||(t["!cols"]=[]);w<o.length&&x<c;++w){var W=o[w];if(sx(W)){if(n.display)continue;g[x]={hidden:!0}}var U=W.children;for(y=A=0;y<U.length;++y){var z=U[y];if(!(n.display&&sx(z))){var T=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):v2(z.innerHTML),k=z.getAttribute("data-z")||z.getAttribute("z");for(f=0;f<d.length;++f){var S=d[f];S.s.c==A+i&&S.s.r<x+s&&x+s<=S.e.r&&(A=S.e.c+1-i,f=-1)}I=+z.getAttribute("colspan")||1,((F=+z.getAttribute("rowspan")||1)>1||I>1)&&d.push({s:{r:x+s,c:A+i},e:{r:x+s+(F||1)-1,c:A+i+(I||1)-1}});var R={t:"s",v:T},C=z.getAttribute("data-t")||z.getAttribute("t")||"";T!=null&&(T.length==0?R.t=C||"z":n.raw||T.trim().length==0||C=="s"||(T==="TRUE"?R={t:"b",v:!0}:T==="FALSE"?R={t:"b",v:!1}:isNaN(ri(T))?isNaN(_c(T).getDate())||(R={t:"d",v:hr(T)},n.cellDates||(R={t:"n",v:nn(R.v)}),R.z=n.dateNF||it[14]):R={t:"n",v:ri(T)})),R.z===void 0&&k!=null&&(R.z=k);var _="",P=z.getElementsByTagName("A");if(P&&P.length)for(var Fe=0;Fe<P.length&&!(P[Fe].hasAttribute("href")&&(_=P[Fe].getAttribute("href"),_.charAt(0)!="#"));++Fe);_&&_.charAt(0)!="#"&&(R.l={Target:_}),n.dense?(t[x+s]||(t[x+s]=[]),t[x+s][A+i]=R):t[at({c:A+i,r:x+s})]=R,l.e.c<A+i&&(l.e.c=A+i),A+=I}}++x}return d.length&&(t["!merges"]=(t["!merges"]||[]).concat(d)),l.e.r=Math.max(l.e.r,x-1+s),t["!ref"]=wt(l),x>=c&&(t["!fullref"]=wt((l.e.r=o.length-w+x-1+s,l))),t}function Jy(t,e){var r=e||{},n=r.dense?[]:{};return Qy(n,t,e)}function v9(t,e){return Ma(Jy(t,e),e)}function sx(t){var e="",r=_9(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function _9(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function y9(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Nt(e.replace(/<[^>]*>/g,""));return[r]}var ix={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Zy(t,e){var r=e||{},n=Lm(t),s=[],i,a,o={name:""},c="",l=0,h,d,f={},g=[],w=r.dense?[]:{},x,y,A={value:""},F="",I=0,W=[],U=-1,z=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,S={},R=[],C={},_=0,P=0,Fe=[],Ie=1,je=1,Me=[],_t={Names:[]},se={},Ye=["",""],Je=[],V={},Y="",q=0,X=!1,he=!1,Ee=0;for(Ll.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Ll.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?w["!ref"]=wt(T):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(w["!fullref"]=w["!ref"],T.e.r=r.sheetRows-1,w["!ref"]=wt(T)),R.length&&(w["!merges"]=R),Fe.length&&(w["!rows"]=Fe),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),g.push(h.name),f[h.name]=w,he=!1):x[0].charAt(x[0].length-2)!=="/"&&(h=lt(x[0],!1),U=z=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,w=r.dense?[]:{},R=[],Fe=[],he=!0);break;case"table-row-group":x[1]==="/"?--k:++k;break;case"table-row":case"":if(x[1]==="/"){U+=Ie,Ie=1;break}if(d=lt(x[0],!1),d.?U=d.-1:U==-1&&(U=0),Ie=+d["number-rows-repeated"]||1,Ie<10)for(Ee=0;Ee<Ie;++Ee)k>0&&(Fe[U+Ee]={level:k});z=-1;break;case"covered-table-cell":x[1]!=="/"&&++z,r.sheetStubs&&(r.dense?(w[U]||(w[U]=[]),w[U][z]={t:"z"}):w[at({r:U,c:z})]={t:"z"}),F="",W=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++z,A=lt(x[0],!1),je=parseInt(A["number-columns-repeated"]||"1",10),y={t:"z",v:null},A.formula&&r.cellFormula!=!1&&(y.f=ex(Nt(A.formula))),(A.||A["value-type"])=="string"&&(y.t="s",y.v=Nt(A["string-value"]||""),r.dense?(w[U]||(w[U]=[]),w[U][z]=y):w[at({r:U,c:z})]=y),z+=je-1;else if(x[1]!=="/"){++z,F="",I=0,W=[],je=1;var Ae=Ie?U+Ie-1:U;if(z>T.e.c&&(T.e.c=z),z<T.s.c&&(T.s.c=z),U<T.s.r&&(T.s.r=U),Ae>T.e.r&&(T.e.r=Ae),A=lt(x[0],!1),Je=[],V={},y={t:A.||A["value-type"],v:null},r.cellFormula)if(A.formula&&(A.formula=Nt(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(_=parseInt(A["number-matrix-rows-spanned"],10)||0,P=parseInt(A["number-matrix-columns-spanned"],10)||0,C={s:{r:U,c:z},e:{r:U+_-1,c:z+P-1}},y.F=wt(C),Me.push([C,y.F])),A.formula)y.f=ex(A.formula);else for(Ee=0;Ee<Me.length;++Ee)U>=Me[Ee][0].s.r&&U<=Me[Ee][0].e.r&&z>=Me[Ee][0].s.c&&z<=Me[Ee][0].e.c&&(y.F=Me[Ee][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(_=parseInt(A["number-rows-spanned"],10)||0,P=parseInt(A["number-columns-spanned"],10)||0,C={s:{r:U,c:z},e:{r:U+_-1,c:z+P-1}},R.push(C)),A["number-columns-repeated"]&&(je=parseInt(A["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=ur(A["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(A.value);break;case"percentage":y.t="n",y.v=parseFloat(A.value);break;case"currency":y.t="n",y.v=parseFloat(A.value);break;case"date":y.t="d",y.v=hr(A["date-value"]),r.cellDates||(y.t="n",y.v=nn(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=XD(A["time-value"])/86400,r.cellDates&&(y.t="d",y.v=Nf(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(A.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",A["string-value"]!=null&&(F=Nt(A["string-value"]),W=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(X=!1,y.t==="s"&&(y.v=F||"",W.length&&(y.R=W),X=I==0),se.Target&&(y.l=se),Je.length>0&&(y.c=Je,Je=[]),F&&r.cellText!==!1&&(y.w=F),X&&(y.t="z",delete y.v),(!X||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=U))for(var ye=0;ye<Ie;++ye){if(je=parseInt(A["number-columns-repeated"]||"1",10),r.dense)for(w[U+ye]||(w[U+ye]=[]),w[U+ye][z]=ye==0?y:fr(y);--je>0;)w[U+ye][z+je]=fr(y);else for(w[at({r:U+ye,c:z})]=y;--je>0;)w[at({r:U+ye,c:z+je})]=fr(y);T.e.c<=z&&(T.e.c=z)}je=parseInt(A["number-columns-repeated"]||"1",10),z+=je-1,je=0,y={},F="",W=[]}se={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((i=s.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((i=s.pop())[0]!==x[3])throw"Bad state: "+i;V.t=F,W.length&&(V.R=W),V.a=Y,Je.push(V)}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);Y="",q=0,F="",I=0,W=[];break;case"creator":x[1]==="/"?Y=n.slice(q,x.index):q=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((i=s.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);F="",I=0,W=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(S[o.name]=c,(i=s.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&(c="",o=lt(x[0],!1),s.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":a=lt(x[0],!1),c+=ix[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":a=lt(x[0],!1),c+=ix[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(l,x.index);break}else l=x.index+x[0].length;break;case"named-range":a=lt(x[0],!1),Ye=T0(a["cell-range-address"]);var ve={Name:a.name,Ref:Ye[0]+"!"+Ye[1]};he&&(ve.Sheet=g.length),_t.Names.push(ve);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(x[1]==="/"&&(!A||!A["string-value"])){var ct=y9(n.slice(I,x.index));F=(F.length>0?F+`
`:"")+ct[0]}else lt(x[0],!1),I=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{Ye=T0(lt(x[0])["target-range-address"]),f[Ye[0]]["!autofilter"]={ref:Ye[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(se=lt(x[0],!1),!se.href)break;se.Target=Nt(se.href),delete se.href,se.Target.charAt(0)=="#"&&se.Target.indexOf(".")>-1?(Ye=T0(se.Target.slice(1)),se.Target="#"+Ye[0]+"!"+Ye[1]):se.Target.match(/^\.\.[\\\/]/)&&(se.Target=se.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var j={Sheets:f,SheetNames:g,Workbook:_t};return r.bookSheets&&delete j.Sheets,j}function ax(t,e){e=e||{},Cs(t,"META-INF/manifest.xml")&&XP(Hr(t,"META-INF/manifest.xml"),e);var r=gs(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Zy(rr(r),e);return Cs(t,"meta.xml")&&(n.Props=$2(Hr(t,"meta.xml"))),n}function ox(t,e){return Zy(t,e)}var E9=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Ol({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return jr+e}})(),cx=(function(){var t=function(i){return er(i).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,a,o){var c=[];c.push('      <table:table table:name="'+er(a.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,h=0,d=os(i["!ref"]||"A1"),f=i["!merges"]||[],g=0,w=Array.isArray(i);if(i["!cols"])for(h=0;h<=d.e.c;++h)c.push("        <table:table-column"+(i["!cols"][h]?' table:style-name="co'+i["!cols"][h].ods+'"':"")+`></table:table-column>
`);var x="",y=i["!rows"]||[];for(l=0;l<d.s.r;++l)x=y[l]?' table:style-name="ro'+y[l].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;l<=d.e.r;++l){for(x=y[l]?' table:style-name="ro'+y[l].ods+'"':"",c.push("        <table:table-row"+x+`>
`),h=0;h<d.s.c;++h)c.push(e);for(;h<=d.e.c;++h){var A=!1,F={},I="";for(g=0;g!=f.length;++g)if(!(f[g].s.c>h)&&!(f[g].s.r>l)&&!(f[g].e.c<h)&&!(f[g].e.r<l)){(f[g].s.c!=h||f[g].s.r!=l)&&(A=!0),F["table:number-columns-spanned"]=f[g].e.c-f[g].s.c+1,F["table:number-rows-spanned"]=f[g].e.r-f[g].s.r+1;break}if(A){c.push(r);continue}var W=at({r:l,c:h}),U=w?(i[l]||[])[h]:i[W];if(U&&U.f&&(F["table:formula"]=er(W5(U.f)),U.F&&U.F.slice(0,W.length)==W)){var z=os(U.F);F["table:number-matrix-columns-spanned"]=z.e.c-z.s.c+1,F["table:number-matrix-rows-spanned"]=z.e.r-z.s.r+1}if(!U){c.push(e);continue}switch(U.t){case"b":I=U.v?"TRUE":"FALSE",F["office:value-type"]="boolean",F["office:boolean-value"]=U.v?"true":"false";break;case"n":I=U.w||String(U.v||0),F["office:value-type"]="float",F["office:value"]=U.v||0;break;case"s":case"str":I=U.v==null?"":U.v,F["office:value-type"]="string";break;case"d":I=U.w||hr(U.v).toISOString(),F["office:value-type"]="date",F["office:date-value"]=hr(U.v).toISOString(),F["table:style-name"]="ce1";break;default:c.push(e);continue}var T=t(I);if(U.l&&U.l.Target){var k=U.l.Target;k=k.charAt(0)=="#"?"#"+$5(k.slice(1)):k,k.charAt(0)!="#"&&!k.match(/^\w+:/)&&(k="../"+k),T=Pe("text:a",T,{"xlink:href":k.replace(/&/g,"&amp;")})}c.push("          "+Pe("table:table-cell",Pe("text:p",T,{}),F)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,a){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var h=0;h<l["!cols"].length;++h)if(l["!cols"][h]){var d=l["!cols"][h];if(d.width==null&&d.wpx==null&&d.wch==null)continue;Ra(d),d.ods=o;var f=l["!cols"][h].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var h=0;h<l["!rows"].length;++h)if(l["!rows"][h]){l["!rows"][h].ods=c;var d=l["!rows"][h].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(a,o){var c=[jr],l=Ol({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=Ol({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+h+`>
`),c.push(W2().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),s(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=a.SheetNames.length;++d)c.push(n(a.Sheets[a.SheetNames[d]],a,d));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function eE(t,e){if(e.bookType=="fods")return cx(t,e);var r=Pm(),n="",s=[],i=[];return n="mimetype",vt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",vt(r,n,cx(t,e)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",vt(r,n,E9(t,e)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",vt(r,n,jr+W2()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",vt(r,n,QP(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",vt(r,n,KP(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function So(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function gd(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):rr(La(t))}function T9(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):ps(xi(t))}function S9(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Pa(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function lx(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function A9(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function k9(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)t[e+i]=s&255;t[e+15]|=r>=0?0:128}function $l(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Jt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Cr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Bt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=$l(t,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var c=r[0];t[r[0]++]>=128;);o=t.slice(c,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=$l(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var l={data:o,type:i};e[s]==null?e[s]=[l]:e[s].push(l)}return e}function vn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push(Jt(n*8+s.type)),s.type==2&&e.push(Jt(s.data.length)),e.push(s.data))})}),Pa(e)}function ip(t,e){return t?.map(function(r){return e(r.data)})||[]}function bs(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=$l(t,n),i=Bt(t.slice(n[0],n[0]+s));n[0]+=s;var a={id:Cr(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=Bt(o.data),l=Cr(c[3][0].data);a.messages.push({meta:c,data:t.slice(n[0],n[0]+l)}),n[0]+=l}),(e=i[3])!=null&&e[0]&&(a.merge=Cr(i[3][0].data)>>>0>0),r.push(a)}return r}function $o(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Jt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Jt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(a){s.push(a.data),a.meta[3]=[{type:0,data:Jt(a.data.length)}],n[2].push({data:vn(a.meta),type:2})});var i=vn(n);e.push(Jt(i.length)),e.push(i),s.forEach(function(a){return e.push(a)})}),Pa(e)}function b9(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=$l(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,l=0;if(i==1?(l=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(l=(e[r[0]++]>>2)+1,i==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Pa(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(s.push(s[0].slice(-c)),l-=c;l>=s[s.length-1].length;)s.push(s[s.length-1]),l-=s[s.length-1].length;s.push(s[0].slice(-c,-c+l))}}var h=Pa(s);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Is(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(b9(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Pa(e)}function zo(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var i=Jt(n),a=i.length;e.push(i),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,s[0]=0,s[1]=a&255,s[2]=a>>8&255,s[3]=a>>16&255,r+=n}return Pa(e)}function I9(t,e,r,n){var s=So(t),i=s.getUint32(4,!0),a=(n>1?12:8)+lx(i&(n>1?3470:398))*4,o=-1,c=-1,l=NaN,h=new Date(2001,0,1);i&512&&(o=s.getUint32(a,!0),a+=4),a+=lx(i&(n>1?12288:4096))*4,i&16&&(c=s.getUint32(a,!0),a+=4),i&32&&(l=s.getFloat64(a,!0),a+=8),i&64&&(h.setTime(h.getTime()+s.getFloat64(a,!0)*1e3),a+=8);var d;switch(t[2]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:e[c]};break;case 5:d={t:"d",v:h};break;case 6:d={t:"b",v:l>0};break;case 7:d={t:"n",v:l/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(c>-1)d={t:"s",v:e[c]};else if(!isNaN(l))d={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return d}function C9(t,e,r){var n=So(t),s=n.getUint32(8,!0),i=12,a=-1,o=-1,c=NaN,l=NaN,h=new Date(2001,0,1);s&1&&(c=A9(t,i),i+=16),s&2&&(l=n.getFloat64(i,!0),i+=8),s&4&&(h.setTime(h.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(o=n.getUint32(i,!0),i+=4),s&16&&(a=n.getUint32(i,!0),i+=4);var d;switch(t[1]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:e[o]};break;case 5:d={t:"d",v:h};break;case 6:d={t:"b",v:l>0};break;case 7:d={t:"n",v:l/86400};break;case 8:d={t:"e",v:0};break;case 9:if(a>-1)d={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:d={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return d}function A0(t,e){var r=new Uint8Array(32),n=So(r),s=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,k9(r,s,t.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),i|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,i,!0),r.slice(0,s)}function k0(t,e){var r=new Uint8Array(32),n=So(r),s=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),i|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,i,!0),r.slice(0,s)}function R9(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return I9(t,e,r,t[0]);case 5:return C9(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Pn(t){var e=Bt(t);return $l(e[1][0].data)}function ux(t,e){var r=Bt(e.data),n=Cr(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(a){var o=Bt(a.data),c=Cr(o[1][0].data)>>>0;switch(n){case 1:i[c]=gd(o[3][0].data);break;case 8:{var l=t[Pn(o[9][0].data)][0],h=Bt(l.data),d=t[Pn(h[1][0].data)][0],f=Cr(d.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var g=Bt(d.data);i[c]=g[3].map(function(w){return gd(w.data)}).join("")}break}}),i}function D9(t,e){var r,n,s,i,a,o,c,l,h,d,f,g,w,x,y=Bt(t),A=Cr(y[1][0].data)>>>0,F=Cr(y[2][0].data)>>>0,I=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Cr(y[8][0].data)>0||!1,W,U;if((i=(s=y[7])==null?void 0:s[0])!=null&&i.data&&e!=0)W=(o=(a=y[7])==null?void 0:a[0])==null?void 0:o.data,U=(l=(c=y[6])==null?void 0:c[0])==null?void 0:l.data;else if((d=(h=y[4])==null?void 0:h[0])!=null&&d.data&&e!=1)W=(g=(f=y[4])==null?void 0:f[0])==null?void 0:g.data,U=(x=(w=y[3])==null?void 0:w[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var z=I?4:1,T=So(W),k=[],S=0;S<W.length/2;++S){var R=T.getUint16(S*2,!0);R<65535&&k.push([S,R])}if(k.length!=F)throw"Expected ".concat(F," cells, found ").concat(k.length);var C=[];for(S=0;S<k.length-1;++S)C[k[S][0]]=U.subarray(k[S][1]*z,k[S+1][1]*z);return k.length>=1&&(C[k[k.length-1][0]]=U.subarray(k[k.length-1][1]*z)),{R:A,cells:C}}function P9(t,e){var r,n=Bt(e.data),s=(r=n?.[7])!=null&&r[0]?Cr(n[7][0].data)>>>0>0?1:0:-1,i=ip(n[5],function(a){return D9(a,s)});return{nrows:Cr(n[4][0].data)>>>0,data:i.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(c,l){if(a[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));a[o.R][l]=c}),a},[])}}function F9(t,e,r){var n,s=Bt(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Cr(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Cr(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=wt(i);var a=Bt(s[4][0].data),o=ux(t,t[Pn(a[4][0].data)][0]),c=(n=a[17])!=null&&n[0]?ux(t,t[Pn(a[17][0].data)][0]):[],l=Bt(a[3][0].data),h=0;l[1].forEach(function(d){var f=Bt(d.data),g=t[Pn(f[2][0].data)][0],w=Cr(g.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var x=P9(t,g);x.data.forEach(function(y,A){y.forEach(function(F,I){var W=at({r:h+A,c:I}),U=R9(F,o,c);U&&(r[W]=U)})}),h+=x.nrows})}function N9(t,e){var r=Bt(e.data),n={"!ref":"A1"},s=t[Pn(r[2][0].data)],i=Cr(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return F9(t,s[0],n),n}function O9(t,e){var r,n=Bt(e.data),s={name:(r=n[1])!=null&&r[0]?gd(n[1][0].data):"",sheets:[]},i=ip(n[2],Pn);return i.forEach(function(a){t[a].forEach(function(o){var c=Cr(o.meta[1][0].data);c==6e3&&s.sheets.push(N9(t,o))})}),s}function L9(t,e){var r=up(),n=Bt(e.data),s=ip(n[1],Pn);if(s.forEach(function(i){t[i].forEach(function(a){var o=Cr(a.meta[1][0].data);if(o==2){var c=O9(t,a);c.sheets.forEach(function(l,h){hp(r,l,h==0?c.name:c.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function b0(t){var e,r,n,s,i={},a=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=Is(c.content)}catch(d){return console.log("?? "+c.content.length+" "+(d.message||d))}var h;try{h=bs(l)}catch(d){return console.log("## "+(d.message||d))}h.forEach(function(d){i[d.id]=d.messages,a.push(d.id)})}}),!a.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=i?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Cr(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||a.forEach(function(c){i[c].forEach(function(l){var h=Cr(l.meta[1][0].data)>>>0;if(h==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return L9(i,o)}function M9(t,e,r){var n,s,i,a;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(i=t[8])==null?void 0:i[0])==null?void 0:a.data)&&Cr(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=So(t[7][0].data),h=0,d=[],f=So(t[4][0].data),g=0,w=[],x=0;x<e.length;++x){if(e[x]==null){l.setUint16(x*2,65535,!0),f.setUint16(x*2,65535);continue}l.setUint16(x*2,h,!0),f.setUint16(x*2,g,!0);var y,A;switch(typeof e[x]){case"string":y=A0({t:"s",v:e[x]},r),A=k0({t:"s",v:e[x]},r);break;case"number":y=A0({t:"n",v:e[x]},r),A=k0({t:"n",v:e[x]},r);break;case"boolean":y=A0({t:"b",v:e[x]},r),A=k0({t:"b",v:e[x]},r);break;default:throw new Error("Unsupported value "+e[x])}d.push(y),h+=y.length,w.push(A),g+=A.length,++c}for(t[2][0].data=Jt(c);x<t[7][0].data.length/2;++x)l.setUint16(x*2,65535,!0),f.setUint16(x*2,65535,!0);return t[6][0].data=Pa(d),t[3][0].data=Pa(w),c}function B9(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=os(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(wt(n)));var i=Yh(r,{range:n,header:1}),a=["~Sh33tJ5~"];i.forEach(function(Y){return Y.forEach(function(q){typeof q=="string"&&a.push(q)})});var o={},c=[],l=Qe.read(e.numbers,{type:"base64"});l.FileIndex.map(function(Y,q){return[Y,l.FullPaths[q]]}).forEach(function(Y){var q=Y[0],X=Y[1];if(q.type==2&&q.name.match(/\.iwa/)){var he=q.content,Ee=Is(he),Ae=bs(Ee);Ae.forEach(function(ye){c.push(ye.id),o[ye.id]={deps:[],location:X,type:Cr(ye.messages[0].meta[1][0].data)}})}}),c.sort(function(Y,q){return Y-q});var h=c.filter(function(Y){return Y>1}).map(function(Y){return[Y,Jt(Y)]});l.FileIndex.map(function(Y,q){return[Y,l.FullPaths[q]]}).forEach(function(Y){var q=Y[0];if(Y[1],!!q.name.match(/\.iwa/)){var X=bs(Is(q.content));X.forEach(function(he){he.messages.forEach(function(Ee){h.forEach(function(Ae){he.messages.some(function(ye){return Cr(ye.meta[1][0].data)!=11006&&S9(ye.data,Ae[1])})&&o[Ae[0]].deps.push(he.id)})})})}});for(var d=Qe.find(l,o[1].location),f=bs(Is(d.content)),g,w=0;w<f.length;++w){var x=f[w];x.id==1&&(g=x)}var y=Pn(Bt(g.messages[0].data)[1][0].data);for(d=Qe.find(l,o[y].location),f=bs(Is(d.content)),w=0;w<f.length;++w)x=f[w],x.id==y&&(g=x);for(y=Pn(Bt(g.messages[0].data)[2][0].data),d=Qe.find(l,o[y].location),f=bs(Is(d.content)),w=0;w<f.length;++w)x=f[w],x.id==y&&(g=x);for(y=Pn(Bt(g.messages[0].data)[2][0].data),d=Qe.find(l,o[y].location),f=bs(Is(d.content)),w=0;w<f.length;++w)x=f[w],x.id==y&&(g=x);var A=Bt(g.messages[0].data);{A[6][0].data=Jt(n.e.r+1),A[7][0].data=Jt(n.e.c+1);var F=Pn(A[46][0].data),I=Qe.find(l,o[F].location),W=bs(Is(I.content));{for(var U=0;U<W.length&&W[U].id!=F;++U);if(W[U].id!=F)throw"Bad ColumnRowUIDMapArchive";var z=Bt(W[U].messages[0].data);z[1]=[],z[2]=[],z[3]=[];for(var T=0;T<=n.e.c;++T){var k=[];k[1]=k[2]=[{type:0,data:Jt(T+420690)}],z[1].push({type:2,data:vn(k)}),z[2].push({type:0,data:Jt(T)}),z[3].push({type:0,data:Jt(T)})}z[4]=[],z[5]=[],z[6]=[];for(var S=0;S<=n.e.r;++S)k=[],k[1]=k[2]=[{type:0,data:Jt(S+726270)}],z[4].push({type:2,data:vn(k)}),z[5].push({type:0,data:Jt(S)}),z[6].push({type:0,data:Jt(S)});W[U].messages[0].data=vn(z)}I.content=zo($o(W)),I.size=I.content.length,delete A[46];var R=Bt(A[4][0].data);{R[7][0].data=Jt(n.e.r+1);var C=Bt(R[1][0].data),_=Pn(C[2][0].data);I=Qe.find(l,o[_].location),W=bs(Is(I.content));{if(W[0].id!=_)throw"Bad HeaderStorageBucket";var P=Bt(W[0].messages[0].data);for(S=0;S<i.length;++S){var Fe=Bt(P[2][0].data);Fe[1][0].data=Jt(S),Fe[4][0].data=Jt(i[S].length),P[2][S]={type:P[2][0].type,data:vn(Fe)}}W[0].messages[0].data=vn(P)}I.content=zo($o(W)),I.size=I.content.length;var Ie=Pn(R[2][0].data);I=Qe.find(l,o[Ie].location),W=bs(Is(I.content));{if(W[0].id!=Ie)throw"Bad HeaderStorageBucket";for(P=Bt(W[0].messages[0].data),T=0;T<=n.e.c;++T)Fe=Bt(P[2][0].data),Fe[1][0].data=Jt(T),Fe[4][0].data=Jt(n.e.r+1),P[2][T]={type:P[2][0].type,data:vn(Fe)};W[0].messages[0].data=vn(P)}I.content=zo($o(W)),I.size=I.content.length;var je=Pn(R[4][0].data);(function(){for(var Y=Qe.find(l,o[je].location),q=bs(Is(Y.content)),X,he=0;he<q.length;++he){var Ee=q[he];Ee.id==je&&(X=Ee)}var Ae=Bt(X.messages[0].data);{Ae[3]=[];var ye=[];a.forEach(function(j,jt){ye[1]=[{type:0,data:Jt(jt)}],ye[2]=[{type:0,data:Jt(1)}],ye[3]=[{type:2,data:T9(j)}],Ae[3].push({type:2,data:vn(ye)})})}X.messages[0].data=vn(Ae);var ve=$o(q),ct=zo(ve);Y.content=ct,Y.size=Y.content.length})();var Me=Bt(R[3][0].data);{var _t=Me[1][0];delete Me[2];var se=Bt(_t.data);{var Ye=Pn(se[2][0].data);(function(){for(var Y=Qe.find(l,o[Ye].location),q=bs(Is(Y.content)),X,he=0;he<q.length;++he){var Ee=q[he];Ee.id==Ye&&(X=Ee)}var Ae=Bt(X.messages[0].data);{delete Ae[6],delete Me[7];var ye=new Uint8Array(Ae[5][0].data);Ae[5]=[];for(var ve=0,ct=0;ct<=n.e.r;++ct){var j=Bt(ye);ve+=M9(j,i[ct],a),j[1][0].data=Jt(ct),Ae[5].push({data:vn(j),type:2})}Ae[1]=[{type:0,data:Jt(n.e.c+1)}],Ae[2]=[{type:0,data:Jt(n.e.r+1)}],Ae[3]=[{type:0,data:Jt(ve)}],Ae[4]=[{type:0,data:Jt(n.e.r+1)}]}X.messages[0].data=vn(Ae);var jt=$o(q),pt=zo(jt);Y.content=pt,Y.size=Y.content.length})()}_t.data=vn(se)}R[3][0].data=vn(Me)}A[4][0].data=vn(R)}g.messages[0].data=vn(A);var Je=$o(f),V=zo(Je);return d.content=V,d.size=d.content.length,l}function tE(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function ap(t){tE([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function op(t){tE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function V9(t){return Et.WS.indexOf(t)>-1?"sheet":t==Et.CS?"chart":t==Et.DS?"dialog":t==Et.MS?"macro":t&&t.length?t:"sheet"}function j9(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,V9(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function U9(t,e,r,n,s,i,a,o,c,l,h,d){try{i[n]=wl(gs(t,r,!0),e);var f=Hr(t,e),g;switch(o){case"sheet":g=lM(f,e,s,c,i[n],l,h,d);break;case"chart":if(g=uM(f,e,s,c,i[n],l,h,d),!g||!g["!drawel"])break;var w=ol(g["!drawel"].Target,e),x=Ml(w),y=YO(gs(t,w,!0),wl(gs(t,x,!0),w)),A=ol(y,w),F=Ml(A);g=M8(gs(t,A,!0),A,c,wl(gs(t,F,!0),A),l,g);break;case"macro":g=hM(f,e,s,c,i[n],l,h,d);break;case"dialog":g=fM(f,e,s,c,i[n],l,h,d);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=g;var I=[];i&&i[n]&&Rr(i[n]).forEach(function(W){var U="";if(i[n][W].Type==Et.CMNT){U=ol(i[n][W].Target,e);var z=gM(Hr(t,U,!0),U,c);if(!z||!z.length)return;K1(g,z,!1)}i[n][W].Type==Et.TCMNT&&(U=ol(i[n][W].Target,e),I=I.concat(JO(Hr(t,U,!0),c)))}),I&&I.length&&K1(g,I,!0,c.people||[])}catch(W){if(c.WTF)throw W}}function As(t){return t.charAt(0)=="/"?t.slice(1):t}function W9(t,e){if(Bc(),e=e||{},ap(e),Cs(t,"META-INF/manifest.xml")||Cs(t,"objectdata.xml"))return ax(t,e);if(Cs(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof b0<"u"){if(t.FileIndex)return b0(t);var r=Qe.utils.cfb_new();return g1(t).forEach(function(Fe){vt(r,Fe,ZD(t,Fe))}),b0(r)}throw new Error("Unsupported NUMBERS file")}if(!Cs(t,"[Content_Types].xml"))throw Cs(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Cs(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=g1(t),s=GP(gs(t,"[Content_Types].xml")),i=!1,a,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Hr(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Hr(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},l={};if(!e.bookSheets&&!e.bookProps){if(vl=[],s.sst)try{vl=pM(Hr(t,As(s.sst)),s.sst,e)}catch(Fe){if(e.WTF)throw Fe}e.cellStyles&&s.themes.length&&(c=mM(gs(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(l=dM(Hr(t,As(s.style)),s.style,c,e))}s.links.map(function(Fe){try{var Ie=wl(gs(t,Ml(As(Fe))),Fe);return wM(Hr(t,As(Fe)),Ie,Fe,e)}catch{}});var h=cM(Hr(t,As(s.workbooks[0])),s.workbooks[0],e),d={},f="";s.coreprops.length&&(f=Hr(t,As(s.coreprops[0]),!0),f&&(d=$2(f)),s.extprops.length!==0&&(f=Hr(t,As(s.extprops[0]),!0),f&&ZP(f,d,e)));var g={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(f=gs(t,As(s.custprops[0]),!0),f&&(g=tF(f,e)));var w={};if((e.bookSheets||e.bookProps)&&(h.Sheets?a=h.Sheets.map(function(Ie){return Ie.name}):d.Worksheets&&d.SheetNames.length>0&&(a=d.SheetNames),e.bookProps&&(w.Props=d,w.Custprops=g),e.bookSheets&&typeof a<"u"&&(w.SheetNames=a),e.bookSheets?w.SheetNames:e.bookProps))return w;a={};var x={};e.bookDeps&&s.calcchain&&(x=xM(Hr(t,As(s.calcchain)),s.calcchain));var y=0,A={},F,I;{var W=h.Sheets;d.Worksheets=W.length,d.SheetNames=[];for(var U=0;U!=W.length;++U)d.SheetNames[U]=W[U].name}var z=i?"bin":"xml",T=s.workbooks[0].lastIndexOf("/"),k=(s.workbooks[0].slice(0,T+1)+"_rels/"+s.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");Cs(t,k)||(k="xl/_rels/workbook."+z+".rels");var S=wl(gs(t,k,!0),k.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=vM(Hr(t,As(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=e6(Hr(t,As(s.people[0])),e)),S&&(S=j9(S,h.Sheets));var R=Hr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=d.Worksheets;++y){var C="sheet";if(S&&S[y]?(F="xl/"+S[y][1].replace(/[\/]?xl\//,""),Cs(t,F)||(F=S[y][1]),Cs(t,F)||(F=k.replace(/_rels\/.*$/,"")+S[y][1]),C=S[y][2]):(F="xl/worksheets/sheet"+(y+1-R)+"."+z,F=F.replace(/sheet0\./,"sheet.")),I=F.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(y!=e.sheets)continue e;break;case"string":if(d.SheetNames[y].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var _=!1,P=0;P!=e.sheets.length;++P)typeof e.sheets[P]=="number"&&e.sheets[P]==y&&(_=1),typeof e.sheets[P]=="string"&&e.sheets[P].toLowerCase()==d.SheetNames[y].toLowerCase()&&(_=1);if(!_)continue e}}U9(t,F,I,d.SheetNames[y],y,A,a,C,e,h,c,l)}return w={Directory:s,Workbook:h,Props:d,Custprops:g,Deps:x,Sheets:a,SheetNames:d.SheetNames,Strings:vl,Styles:l,Themes:c,SSF:fr(it)},e&&e.bookFiles&&(t.files?(w.keys=n,w.files=t.files):(w.keys=[],w.files={},t.FullPaths.forEach(function(Fe,Ie){Fe=Fe.replace(/^Root Entry[\/]/,""),w.keys.push(Fe),w.files[Fe]=t.FileIndex[Ie]}))),e&&e.bookVBA&&(s.vba.length>0?w.vbaraw=Hr(t,As(s.vba[0]),!0):s.defaults&&s.defaults.bin===c6&&(w.vbaraw=Hr(t,"xl/vbaProject.bin",!0))),w}function $9(t,e){var r=e||{},n="Workbook",s=Qe.find(t,n);try{if(n="/!DataSpaces/Version",s=Qe.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(vN(s.content),n="/!DataSpaces/DataSpaceMap",s=Qe.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=yN(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Qe.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=EN(s.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Qe.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);SN(s.content)}catch{}if(n="/EncryptionInfo",s=Qe.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=AN(s.content);if(n="/EncryptedPackage",s=Qe.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function z9(t,e){return e.bookType=="ods"?eE(t,e):e.bookType=="numbers"?B9(t,e):e.bookType=="xlsb"?H9(t,e):G9(t,e)}function H9(t,e){Zo=1024,t&&!t.SSF&&(t.SSF=fr(it)),t&&t.SSF&&(Bc(),Df(t.SSF),e.revssf=Ff(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,_l?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=Iy.indexOf(e.bookType)>-1,s=Gm();op(e=e||{});var i=Pm(),a="",o=0;if(e.cellXfs=[],Ba(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",vt(i,a,z2(t.Props,e)),s.coreprops.push(a),Zt(e.rels,2,a,Et.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],l=0;l<t.SheetNames.length;++l)(t.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(t.SheetNames[l]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,vt(i,a,q2(t.Props)),s.extprops.push(a),Zt(e.rels,3,a,Et.EXT_PROPS),t.Custprops!==t.Props&&Rr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",vt(i,a,X2(t.Custprops)),s.custprops.push(a),Zt(e.rels,4,a,Et.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},d=t.Sheets[t.SheetNames[o-1]],f=(d||{})["!type"]||"sheet";switch(f){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,vt(i,a,yM(o-1,a,e,t,h)),s.sheets.push(a),Zt(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Et.WS[0])}if(d){var g=d["!comments"],w=!1,x="";g&&g.length>0&&(x="xl/comments"+o+"."+r,vt(i,x,SM(g,x)),s.comments.push(x),Zt(h,-1,"../comments"+o+"."+r,Et.CMNT),w=!0),d["!legacy"]&&w&&vt(i,"xl/drawings/vmlDrawing"+o+".vml",ky(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&vt(i,Ml(a),oc(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,vt(i,a,TM(e.Strings,a,e)),s.strs.push(a),Zt(e.wbrels,-1,"sharedStrings."+r,Et.SST)),a="xl/workbook."+r,vt(i,a,_M(t,a)),s.workbooks.push(a),Zt(e.rels,1,a,Et.WB),a="xl/theme/theme1.xml",vt(i,a,Jm(t.Themes,e)),s.themes.push(a),Zt(e.wbrels,-1,"theme/theme1.xml",Et.THEME),a="xl/styles."+r,vt(i,a,EM(t,a,e)),s.styles.push(a),Zt(e.wbrels,-1,"styles."+r,Et.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",vt(i,a,t.vbaraw),s.vba.push(a),Zt(e.wbrels,-1,"vbaProject.bin",Et.VBA)),a="xl/metadata."+r,vt(i,a,AM(a)),s.metadata.push(a),Zt(e.wbrels,-1,"metadata."+r,Et.XLMETA),vt(i,"[Content_Types].xml",U2(s,e)),vt(i,"_rels/.rels",oc(e.rels)),vt(i,"xl/_rels/workbook."+r+".rels",oc(e.wbrels)),delete e.revssf,delete e.ssf,i}function G9(t,e){Zo=1024,t&&!t.SSF&&(t.SSF=fr(it)),t&&t.SSF&&(Bc(),Df(t.SSF),e.revssf=Ff(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,_l?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=Iy.indexOf(e.bookType)>-1,s=Gm();op(e=e||{});var i=Pm(),a="",o=0;if(e.cellXfs=[],Ba(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",vt(i,a,z2(t.Props,e)),s.coreprops.push(a),Zt(e.rels,2,a,Et.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],l=0;l<t.SheetNames.length;++l)(t.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(t.SheetNames[l]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,vt(i,a,q2(t.Props)),s.extprops.push(a),Zt(e.rels,3,a,Et.EXT_PROPS),t.Custprops!==t.Props&&Rr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",vt(i,a,X2(t.Custprops)),s.custprops.push(a),Zt(e.rels,4,a,Et.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},f=t.Sheets[t.SheetNames[o-1]],g=(f||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,vt(i,a,Vy(o-1,e,t,d)),s.sheets.push(a),Zt(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Et.WS[0])}if(f){var w=f["!comments"],x=!1,y="";if(w&&w.length>0){var A=!1;w.forEach(function(F){F[1].forEach(function(I){I.T==!0&&(A=!0)})}),A&&(y="xl/threadedComments/threadedComment"+o+"."+r,vt(i,y,ZO(w,h,e)),s.threadedcomments.push(y),Zt(d,-1,"../threadedComments/threadedComment"+o+"."+r,Et.TCMNT)),y="xl/comments"+o+"."+r,vt(i,y,by(w)),s.comments.push(y),Zt(d,-1,"../comments"+o+"."+r,Et.CMNT),x=!0}f["!legacy"]&&x&&vt(i,"xl/drawings/vmlDrawing"+o+".vml",ky(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&vt(i,Ml(a),oc(d))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,vt(i,a,my(e.Strings,e)),s.strs.push(a),Zt(e.wbrels,-1,"sharedStrings."+r,Et.SST)),a="xl/workbook."+r,vt(i,a,zy(t)),s.workbooks.push(a),Zt(e.rels,1,a,Et.WB),a="xl/theme/theme1.xml",vt(i,a,Jm(t.Themes,e)),s.themes.push(a),Zt(e.wbrels,-1,"theme/theme1.xml",Et.THEME),a="xl/styles."+r,vt(i,a,Ey(t,e)),s.styles.push(a),Zt(e.wbrels,-1,"styles."+r,Et.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",vt(i,a,t.vbaraw),s.vba.push(a),Zt(e.wbrels,-1,"vbaProject.bin",Et.VBA)),a="xl/metadata."+r,vt(i,a,Ay()),s.metadata.push(a),Zt(e.wbrels,-1,"metadata."+r,Et.XLMETA),h.length>1&&(a="xl/persons/person.xml",vt(i,a,t6(h)),s.people.push(a),Zt(e.wbrels,-1,"persons/person.xml",Et.PEOPLE)),vt(i,"[Content_Types].xml",U2(s,e)),vt(i,"_rels/.rels",oc(e.rels)),vt(i,"xl/_rels/workbook."+r+".rels",oc(e.wbrels)),delete e.revssf,delete e.ssf,i}function cp(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=vs(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function q9(t,e){return Qe.find(t,"EncryptedPackage")?$9(t,e):Xy(t,e)}function X9(t,e){var r,n=t,s=e||{};return s.type||(s.type=yt&&Buffer.isBuffer(t)?"buffer":"base64"),r=g2(n,s),W9(r,s)}function rE(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return md(t.slice(r),e);default:break e}return yc.to_workbook(t,e)}function K9(t,e){var r="",n=cp(t,e);switch(e.type){case"base64":r=vs(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=_o(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=rr(r)),e.type="binary",rE(r,e)}function Y9(t,e){var r=t;return e.type=="base64"&&(r=vs(r)),r=Dl.utils.decode(1200,r.slice(2),"str"),e.type="binary",rE(r,e)}function Q9(t){return t.match(/[^\x00-\x7F]/)?xi(t):t}function I0(t,e,r,n){return n?(r.type="string",yc.to_workbook(t,r)):yc.to_workbook(e,r)}function Kh(t,e){bm();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Kh(new Uint8Array(t),(r=fr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),lc={},r.dateNF&&(lc.dateNF=r.dateNF),r.type||(r.type=yt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=yt?"buffer":"binary",n=HD(t),typeof Uint8Array<"u"&&!yt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=Q9(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=fr(r),r.type="array",Kh(Im(n),r)}switch((s=cp(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return q9(Qe.read(n,r),r);break;case 9:if(s[1]<=8)return Xy(n,r);break;case 60:return md(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return rN(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return fy.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?X9(n,r):I0(t,n,r,i);case 239:return s[3]===60?md(n,r):I0(t,n,r,i);case 255:if(s[1]===254)return Y9(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return lo.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return lo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return dd.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return vy.to_workbook(n,r);break;case 10:case 13:case 32:return K9(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return tN.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?dd.to_workbook(n,r):I0(t,n,r,i)}function nE(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return hu(e.file,Qe.write(t,{type:yt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Qe.write(t,e)}function J9(t,e){var r=fr(e||{}),n=z9(t,r);return Z9(n,r)}function Z9(t,e){var r={},n=yt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?Qe.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(Rf(s))}return e.password&&typeof encrypt_agile<"u"?nE(encrypt_agile(s,e.password),e):e.type==="file"?hu(e.file,s):e.type=="string"?rr(s):s}function eB(t,e){var r=e||{},n=QM(t,r);return nE(n,r)}function mi(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Pl(xi(n));case"binary":return xi(n);case"string":return t;case"file":return hu(e.file,n,"utf8");case"buffer":return yt?ea(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):mi(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function tB(t,e){switch(e.type){case"base64":return Pl(t);case"binary":return t;case"string":return t;case"file":return hu(e.file,t,"binary");case"buffer":return yt?ea(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Qu(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Pl(r):e.type=="string"?rr(r):r;case"file":return hu(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function sE(t,e){bm(),q8(t);var r=fr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=sE(t,r);return r.type="array",Rf(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return mi(zM(t,r),r);case"slk":case"sylk":return mi(hy.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return mi(Yy(t.Sheets[t.SheetNames[s]],r),r);case"txt":return tB(iE(t.Sheets[t.SheetNames[s]],r),r);case"csv":return mi(lp(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return mi(fy.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return Qu(dd.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return mi(yc.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return mi(vy.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return mi(dy.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return mi(eE(t,r),r);case"wk1":return Qu(lo.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return Qu(lo.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Qu(Ky(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),eB(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return J9(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function rB(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Jc(t,e,r){var n={};return n.type="file",n.file=e,rB(n),sE(t,n)}function nB(t,e,r,n,s,i,a,o){var c=Mr(r),l=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,f=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!a||t[r])for(var g=e.s.c;g<=e.e.c;++g){var w=a?t[r][g]:t[n[g]+c];if(w===void 0||w.t===void 0){if(l===void 0)continue;i[g]!=null&&(f[i[g]]=l);continue}var x=w.v;switch(w.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(i[g]!=null){if(x==null)if(w.t=="e"&&x===null)f[i[g]]=null;else if(l!==void 0)f[i[g]]=l;else if(h&&x===null)f[i[g]]=null;else continue;else f[i[g]]=h&&(w.t!=="n"||w.t==="n"&&o.rawNumbers!==!1)?x:Xi(w,x,o);x!=null&&(d=!1)}}return{row:f,isempty:d}}function Yh(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=e||{},h=l.range!=null?l.range:t["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof h){case"string":c=Ot(h);break;case"number":c=Ot(t["!ref"]),c.s.r=h;break;default:c=h}n>0&&(s=0);var d=Mr(c.s.r),f=[],g=[],w=0,x=0,y=Array.isArray(t),A=c.s.r,F=0,I={};y&&!t[A]&&(t[A]=[]);var W=l.skipHidden&&t["!cols"]||[],U=l.skipHidden&&t["!rows"]||[];for(F=c.s.c;F<=c.e.c;++F)if(!(W[F]||{}).hidden)switch(f[F]=_r(F),r=y?t[A][F]:t[f[F]+d],n){case 1:i[F]=F-c.s.c;break;case 2:i[F]=f[F];break;case 3:i[F]=l.header[F-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Xi(r,null,l),x=I[a]||0,!x)I[a]=1;else{do o=a+"_"+x++;while(I[o]);I[a]=x,I[o]=1}i[F]=o}for(A=c.s.r+s;A<=c.e.r;++A)if(!(U[A]||{}).hidden){var z=nB(t,c,A,f,n,i,y,l);(z.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(g[w++]=z.row)}return g.length=w,g}var hx=/"/g;function sB(t,e,r,n,s,i,a,o){for(var c=!0,l=[],h="",d=Mr(r),f=e.s.c;f<=e.e.c;++f)if(n[f]){var g=o.dense?(t[r]||[])[f]:t[n[f]+d];if(g==null)h="";else if(g.v!=null){c=!1,h=""+(o.rawNumbers&&g.t=="n"?g.v:Xi(g,null,o));for(var w=0,x=0;w!==h.length;++w)if((x=h.charCodeAt(w))===s||x===i||x===34||o.forceQuotes){h='"'+h.replace(hx,'""')+'"';break}h=="ID"&&(h='"ID"')}else g.f!=null&&!g.F?(c=!1,h="="+g.f,h.indexOf(",")>=0&&(h='"'+h.replace(hx,'""')+'"')):h="";l.push(h)}return o.blankrows===!1&&c?null:l.join(a)}function lp(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=Ot(t["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((i=="|"?"\\|":i)+"+$"),h="",d=[];n.dense=Array.isArray(t);for(var f=n.skipHidden&&t["!cols"]||[],g=n.skipHidden&&t["!rows"]||[],w=s.s.c;w<=s.e.c;++w)(f[w]||{}).hidden||(d[w]=_r(w));for(var x=0,y=s.s.r;y<=s.e.r;++y)(g[y]||{}).hidden||(h=sB(t,s,y,d,a,c,i,n),h!=null&&(n.strip&&(h=h.replace(l,"")),(h||n.blankrows!==!1)&&r.push((x++?o:"")+h)));return delete n.dense,r.join("")}function iE(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=lp(t,e);return r}function iB(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=Ot(t["!ref"]),i="",a=[],o,c=[],l=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)a[o]=_r(o);for(var h=s.s.r;h<=s.e.r;++h)for(i=Mr(h),o=s.s.c;o<=s.e.c;++o)if(e=a[o]+i,r=l?(t[h]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function aE(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?yr(n.origin):n.origin;a=c.r,o=c.c}var l,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+s}};if(i["!ref"]){var d=Ot(i["!ref"]);h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),a==-1&&(a=d.e.r+1,h.e.r=a+e.length-1+s)}else a==-1&&(a=0,h.e.r=e.length-1+s);var f=n.header||[],g=0;e.forEach(function(x,y){Rr(x).forEach(function(A){(g=f.indexOf(A))==-1&&(f[g=f.length]=A);var F=x[A],I="z",W="",U=at({c:o+g,r:a+y+s});l=zl(i,U),F&&typeof F=="object"&&!(F instanceof Date)?i[U]=F:(typeof F=="number"?I="n":typeof F=="boolean"?I="b":typeof F=="string"?I="s":F instanceof Date?(I="d",n.cellDates||(I="n",F=nn(F)),W=n.dateNF||it[14]):F===null&&n.nullError&&(I="e",F=0),l?(l.t=I,l.v=F,delete l.w,delete l.R,W&&(l.z=W)):i[U]=l={t:I,v:F},W&&(l.z=W))})}),h.e.c=Math.max(h.e.c,o+f.length-1);var w=Mr(a);if(s)for(g=0;g<f.length;++g)i[_r(g+o)+w]={t:"s",v:f[g]};return i["!ref"]=wt(h),i}function aB(t,e){return aE(null,t,e)}function zl(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=yr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?zl(t,at(e)):zl(t,at({r:e,c:r||0}))}function oB(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function up(){return{SheetNames:[],Sheets:{}}}function hp(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=a+s)!=-1;++s);}if($y(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function cB(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=oB(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function lB(t,e){return t.z=e,t}function oE(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function uB(t,e,r){return oE(t,"#"+e,r)}function hB(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function fB(t,e,r,n){for(var s=typeof e!="string"?e:Ot(e),i=typeof e=="string"?e:wt(e),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var c=zl(t,a,o);c.t="n",c.F=i,delete c.v,a==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return t}var ir={encode_col:_r,encode_row:Mr,encode_cell:at,encode_range:wt,decode_col:jm,decode_row:Vm,split_cell:TP,decode_cell:yr,decode_range:os,format_cell:Xi,sheet_add_aoa:N2,sheet_add_json:aE,sheet_add_dom:Qy,aoa_to_sheet:Vc,json_to_sheet:aB,table_to_sheet:Jy,table_to_book:v9,sheet_to_csv:lp,sheet_to_txt:iE,sheet_to_json:Yh,sheet_to_html:Yy,sheet_to_formulae:iB,sheet_to_row_object_array:Yh,sheet_get_cell:zl,book_new:up,book_append_sheet:hp,book_set_sheet_visibility:cB,cell_set_number_format:lB,cell_set_hyperlink:oE,cell_set_internal_link:uB,cell_add_comment:hB,sheet_set_array_formula:fB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const dB=()=>{const{currentUser:t,logout:e,restoreAdminAccount:r}=mC(),[n,s]=$e.useState(0),[i,a]=$e.useState(null),[o,c]=$e.useState(!1),l=()=>{j(!ct)},[h,d]=$e.useState([]),[f,g]=$e.useState([]),[w,x]=$e.useState([]),[y,A]=$e.useState([]),[F,I]=$e.useState([]),[W,U]=$e.useState(!0),[z,T]=$e.useState(""),k=fx(),{isMobile:S,isSmallMobile:R,isLargeDesktop:C,isMobileOrSmaller:_}=pC(),[P,Fe]=$e.useState(!1),[Ie,je]=$e.useState(!1),[Me,_t]=$e.useState(!1),[se,Ye]=$e.useState(""),[Je,V]=$e.useState(""),[Y,q]=$e.useState(""),[X,he]=$e.useState([]),[Ee,Ae]=$e.useState(!1),[ye,ve]=$e.useState(!1),[ct,j]=$e.useState(!0),[jt,pt]=$e.useState(!1),[Ft,ut]=$e.useState(!1),[ke,lr]=$e.useState(null),[dr,Ur]=$e.useState({type:"merit",reason:""}),[Qn,cs]=$e.useState(!1),[Jn,Tr]=$e.useState(!1),[Zn,zt]=$e.useState(!1),[mr,Sr]=$e.useState("same_year"),[Tn,dt]=$e.useState([]),[Kt,Ar]=$e.useState({}),[It,pn]=$e.useState({name:"",email:"",phone:""}),[Es,na]=$e.useState(null),[Uc,Ls]=$e.useState(!1),[ki,bi]=$e.useState(null),[oi,Ii]=$e.useState(null),[kr,Ms]=$e.useState({key:"name",direction:"asc"}),[Wc,sa]=$e.useState({homeroomTeacher:null,subjectTeachers:[],students:[]}),[Lo,Bs]=$e.useState(!1),[$n,Kr]=$e.useState(null),[Va,Vs]=$e.useState([]),[Ut,es]=$e.useState(null),[vu,b]=$e.useState(""),[L,O]=$e.useState({key:"name",direction:"asc"}),[N,B]=$e.useState({key:"name",direction:"asc"}),[M,re]=$e.useState({key:"studentId",direction:"asc"}),oe=v=>{O(K=>({key:v,direction:K.key===v&&K.direction==="asc"?"desc":"asc"}))},te=v=>{B(K=>({key:v,direction:K.key===v&&K.direction==="asc"?"desc":"asc"}))},ne=v=>{re(K=>({key:v,direction:K.key===v&&K.direction==="asc"?"desc":"asc"}))};$e.useMemo(()=>L.key?[...h].sort((v,K)=>{let Q=0;if(L.key==="homeroomTeacher"){const J=f.find(Se=>Se.id===v.homeroomTeacher),G=f.find(Se=>Se.id===K.homeroomTeacher),Z=J?.name||"",xe=G?.name||"";Q=Z.localeCompare(xe,"ko-KR")}else{const J=v[L.key],G=K[L.key];if(J==null)return 1;if(G==null)return-1;typeof J=="string"&&typeof G=="string"?Q=J.localeCompare(G,"ko-KR"):typeof J=="number"&&typeof G=="number"?Q=J-G:Q=String(J).localeCompare(String(G),"ko-KR")}return L.direction==="asc"?Q:-Q}):h,[h,L,f]),$e.useMemo(()=>N.key?[...f].sort((v,K)=>{const Q=v[N.key],J=K[N.key];if(Q==null)return 1;if(J==null)return-1;let G=0;return typeof Q=="string"&&typeof J=="string"?G=Q.localeCompare(J,"ko-KR"):typeof Q=="number"&&typeof J=="number"?G=Q-J:G=String(Q).localeCompare(String(J),"ko-KR"),N.direction==="asc"?G:-G}):f,[f,N]),$e.useMemo(()=>M.key?[...w].sort((v,K)=>{let Q=0;if(M.key==="grade"){const J=parseInt(v.grade)||0,G=parseInt(K.grade)||0,Z=parseInt(v.class)||0,xe=parseInt(K.class)||0,Se=parseInt(v.number)||0,be=parseInt(K.number)||0;J!==G?Q=J-G:Z!==xe?Q=Z-xe:Q=Se-be}else{const J=v[M.key],G=K[M.key];if(J==null)return 1;if(G==null)return-1;typeof J=="string"&&typeof G=="string"?Q=J.localeCompare(G,"ko-KR"):typeof J=="number"&&typeof G=="number"?Q=J-G:Q=String(J).localeCompare(String(G),"ko-KR")}return M.direction==="asc"?Q:-Q}):w,[w,M]);const[H,ge]=$e.useState({grade:"",class:"",name:"",homeroomTeacher:"",subjectTeachers:[]});$e.useEffect(()=>{if(H.grade&&H.class){const v=`${H.grade} ${H.class}`;ge(K=>({...K,name:v}))}},[H.grade,H.class]);const[de,Be]=$e.useState({name:"",email:"",role:"homeroom_teacher",phone:"",subject:""}),[pe,De]=$e.useState({name:"",grade:"",class:"",number:"",birthDate:"",selectedClassId:""});$e.useEffect(()=>{t&&st()},[t]);const st=async()=>{try{U(!0),await Promise.all([zn(),Yr(),Ci(),ci(),ls()]);try{await Rn(We(ce,"system_logs"),{userId:t.uid,userName:t.name||t.email,userRole:t.role,majorCategory:" ",middleCategory:" ",minorCategory:"",action:"   ",details:`${t.name||t.email}    .`,timestamp:new Date,createdAt:new Date})}catch(v){console.error("   :",v)}}catch{}finally{U(!1)}},Yt=async()=>{try{const v=new Date;if(v.getMonth()+1>=9){const Q=ht(ce,"academic_settings","current"),J=await Ys(Q);let G="1",Z=v.getFullYear().toString();if(J.exists()){const xe=J.data();G=xe.currentSemester||"1",Z=xe.currentAcademicYear||v.getFullYear().toString()}else{const xe=Wa();G=xe.semester,Z=xe.academicYear}if(G==="1"){const xe=ht(ce,"semester_change_notifications","current"),Se=await Ys(xe);if(!Se.exists()||Se.data().status!=="approved"){const be=Se.exists()?Se.data():null;bi({currentAcademicYear:Z,currentSemester:"1",newSemester:"2",status:be?.status||"pending",backupId:be?.backupId||null}),be?.backupId&&Ii(be.backupId),Ls(!0)}}}}catch(v){console.error("   :",v)}},Wt=async()=>{try{U(!0);const v=We(ce,"accounts"),K=St(v,gt("role","==","student")),Q=await tt(K),J=We(ce,"classes"),G=await tt(J),Z={students:Q.docs.map(et=>{const Ht=et.data();return{id:et.id,currentAcademicYear:Ht.currentAcademicYear,currentSemester:Ht.currentSemester}}),classes:G.docs.map(et=>{const Ht=et.data();return{id:et.id,academicYear:Ht.academicYear,semester:Ht.semester}}),settings:null},xe=ht(ce,"academic_settings","current"),Se=await Ys(xe);Se.exists()&&(Z.settings=Se.data());const be=`backup_${Date.now()}`,qe=ht(ce,"semester_change_backups",be);await setDoc(qe,{...Z,createdAt:new Date,createdBy:t.uid}),Ii(be);const Ue=br(ce),{academicYear:Ce}=Wa(),Xe="2";Q.forEach(et=>{if(et.data().status==="active"){const pr=ht(ce,"accounts",et.id);Ue.update(pr,{currentSemester:Xe,updatedAt:new Date})}}),G.forEach(et=>{const Ht=ht(ce,"classes",et.id);Ue.update(Ht,{semester:Xe,updatedAt:new Date})}),Ue.set(xe,{currentAcademicYear:Ce,currentSemester:Xe,semester1Start:`${Ce}-03-01`,semester1End:`${Ce}-08-31`,semester2Start:`${Ce}-09-01`,semester2End:`${parseInt(Ce)+1}-02-28`,updatedAt:new Date,updatedBy:t.uid},{merge:!0});const ie=ht(ce,"semester_change_notifications","current");Ue.set(ie,{status:"approved",approvedAt:new Date,approvedBy:t.uid,backupId:be,currentAcademicYear:Ce,currentSemester:"1",newSemester:"2"},{merge:!0}),await Ue.commit(),await Ka(t,qt.SYSTEM_MANAGEMENT.middle.UPDATE,"   ",`${Ce} 1  2   `),await Re.fire({title:"  ",text:`${Ce} 2 .`,icon:"success"}),Ls(!1),bi(null),window.location.reload()}catch(v){console.error("   :",v),await Re.fire({title:"",text:"     : "+v.message,icon:"error"})}finally{U(!1)}},sr=async()=>{try{const v=oi||ki?.backupId;if(!v){await Re.fire({title:"",text:"     .",icon:"error"});return}if(!(await Re.fire({title:" ",html:`
          <div style="text-align: left;">
            <p><strong>  ?</strong></p>
            <p style="color: #d32f2f;">     !</p>
            <p>   <strong>"ROLLBACK"</strong> .</p>
            <input type="text" id="rollbackConfirmText" class="swal2-input" placeholder="ROLLBACK">
          </div>
        `,icon:"warning",showCancelButton:!0,confirmButtonText:"",cancelButtonText:"",confirmButtonColor:"#d32f2f",cancelButtonColor:"#6c757d",preConfirm:()=>document.getElementById("rollbackConfirmText").value!=="ROLLBACK"?(Re.showValidationMessage("  ."),!1):!0})).isConfirmed)return;U(!0);const Q=ht(ce,"semester_change_backups",v),J=await Ys(Q);if(!J.exists())throw new Error("    .");const G=J.data(),Z=br(ce);if(G.students&&Array.isArray(G.students)&&G.students.forEach(Se=>{const be=ht(ce,"accounts",Se.id);Z.update(be,{currentAcademicYear:Se.currentAcademicYear,currentSemester:Se.currentSemester,updatedAt:new Date})}),G.classes&&Array.isArray(G.classes)&&G.classes.forEach(Se=>{const be=ht(ce,"classes",Se.id);Z.update(be,{academicYear:Se.academicYear,semester:Se.semester,updatedAt:new Date})}),G.settings){const Se=ht(ce,"academic_settings","current");Z.set(Se,{...G.settings,updatedAt:new Date})}const xe=ht(ce,"semester_change_notifications","current");Z.update(xe,{status:"pending",rollbackAt:new Date,rollbackBy:t.uid}),await Z.commit(),await Ka(t,qt.SYSTEM_MANAGEMENT.middle.UPDATE,"  ",`    ( ID: ${v})`),await Re.fire({title:" ",text:"  .",icon:"success"}),Ls(!1),bi(null),Ii(null),window.location.reload()}catch(v){console.error(" :",v),await Re.fire({title:"",text:"   : "+v.message,icon:"error"})}finally{U(!1)}};$e.useEffect(()=>{if(!t)return;Yt();const v=We(ce,"classes"),K=Ko(v,Ce=>{const Xe=Ce.docs.map(ie=>({id:ie.id,...ie.data()}));d(Xe)}),Q=We(ce,"accounts"),J=St(Q,gt("role","in",["homeroom_teacher","subject_teacher"])),G=Ko(J,Ce=>{const Xe=Ce.docs.map(ie=>({id:ie.id,...ie.data()})).filter(ie=>ie.status!=="disabled");g(Xe)}),Z=We(ce,"accounts"),xe=St(Z,gt("role","==","student")),Se=Ko(xe,Ce=>{const Xe=Ce.docs.map(ie=>({id:ie.id,...ie.data()}));x(Xe)}),be=We(ce,"reset_requests"),qe=St(be),Ue=Ko(qe,Ce=>{const Xe=Ce.docs.map(ie=>({id:ie.id,...ie.data(),requestedAt:ie.data().requestedAt?.toDate?.()||new Date(ie.data().requestedAt),expiresAt:ie.data().expiresAt?.toDate?.()||new Date(ie.data().expiresAt)})).sort((ie,et)=>new Date(et.requestedAt)-new Date(ie.requestedAt));he(Xe)});return()=>{K(),G(),Se(),Ue()}},[t]);const zn=async()=>{const v=We(ce,"classes"),Q=(await tt(v)).docs.map(J=>({id:J.id,...J.data()}));d(Q)},ci=async()=>{const v=We(ce,"merit_demerit_records"),Q=(await tt(v)).docs.map(J=>({id:J.id,...J.data()}));A(Q),await li(Q)},li=async v=>{console.log("=== AdminDashboard updateStudentCumulativeScores  ==="),console.log(" :",v);const K={};v.forEach(J=>{const G=J.studentId;K[G]||(K[G]=0);const Z=J.points||0;K[G]+=Z,console.log(` ${G}: ${J.type} ${Z} , : ${K[G]}`)}),console.log("  :",K);const Q=Object.entries(K).map(async([J,G])=>{try{const Z=ht(ce,"accounts",J);await fi(Z,{cumulativeScore:G}),console.log(` accounts    -  ${J}: ${G}`)}catch(Z){console.error(` accounts    -  ${J}:`,Z)}});await Promise.all(Q),x(J=>{const G=J.map(Z=>{const xe=K[Z.id]||0;return console.log(` ${Z.name}(${Z.id})  : ${xe}`),{...Z,cumulativeScore:xe}});return console.log("  :",G),G})},ls=async()=>{const v=We(ce,"merit_reasons"),Q=(await tt(v)).docs.map(J=>({id:J.id,...J.data()}));I(Q)},ia=async v=>{try{console.log("===      ==="),console.log(" ID:",v);const K=We(ce,"merit_demerit_records"),Q=St(K,gt("studentId","==",v)),J=St(K,gt("student_id","==",v)),[G,Z]=await Promise.all([tt(Q),tt(J)]),xe=G.docs.map(Ce=>({id:Ce.id,...Ce.data(),createdAt:Ce.data().createdAt?.toDate?.()||new Date(Ce.data().createdAt)})),Se=Z.docs.map(Ce=>({id:Ce.id,...Ce.data(),createdAt:Ce.data().createdAt?.toDate?.()||new Date(Ce.data().createdAt)})),Ue=[...xe,...Se].filter((Ce,Xe,ie)=>Xe===ie.findIndex(et=>et.id===Ce.id)).sort((Ce,Xe)=>new Date(Xe.createdAt)-new Date(Ce.createdAt));return console.log("   :",Ue.length),console.log(" :",Ue),Vs(Ue),Ue}catch(K){return console.error("    :",K),T("      : "+K.message),[]}},Yr=async()=>{const v=We(ce,"accounts"),K=St(v,gt("role","in",["homeroom_teacher","subject_teacher"])),J=(await tt(K)).docs.map(G=>({id:G.id,...G.data()})).filter(G=>G.status!=="deleted"&&G.status!=="disabled");g(J)},Ci=async()=>{const v=We(ce,"accounts"),K=St(v,gt("role","==","student")),J=(await tt(K)).docs.map(G=>({id:G.id,...G.data()}));x(J)},_u=async v=>{try{if(console.log("handlePasswordReset  , :",v),!v||!v.trim()){await Re.fire({title:"",text:" .",icon:"error",customClass:{container:"swal2-container-high-z"}});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v)){await Re.fire({title:"",text:"   .",icon:"error",customClass:{container:"swal2-container-high-z"}});return}const Q=await oD(v);if(!Q.success){await Re.fire({title:"",text:Q.message,icon:"error",customClass:{container:"swal2-container-high-z"}});return}const J=await aD(v);if(J.success){await Re.fire({title:"",text:J.message,icon:"success",customClass:{container:"swal2-container-high-z"}});try{await Rn(We(ce,"system_logs"),{userId:t.uid,userName:t.name||t.email,userRole:t.role,majorCategory:" ",middleCategory:" ",minorCategory:"",action:"   ",details:`${t.name||t.email} ${v}    .`,timestamp:new Date,createdAt:new Date})}catch(G){console.error("  :",G)}}else await Re.fire({title:"",text:J.message,icon:"error",customClass:{container:"swal2-container-high-z"}})}catch(K){console.error("  :",K),await Re.fire({title:"",text:"    .",icon:"error",customClass:{container:"swal2-container-high-z"}})}},Mo=h.filter(v=>v.name?.toLowerCase().includes(se.toLowerCase())||v.grade?.toString().includes(se)||v.class?.toString().includes(se)),$c=f.filter(v=>v.name?.toLowerCase().includes(Je.toLowerCase())||v.email?.toLowerCase().includes(Je.toLowerCase())||v.role?.toLowerCase().includes(Je.toLowerCase())),zc=w.filter(v=>v.name?.toLowerCase().includes(Y.toLowerCase())||v.studentId?.toLowerCase().includes(Y.toLowerCase())||v.grade?.toString().includes(Y)||v.class?.toString().includes(Y)),yu=$e.useMemo(()=>L.key?[...Mo].sort((v,K)=>{let Q=0;if(L.key==="homeroomTeacher"){const J=f.find(Se=>Se.id===v.homeroomTeacher),G=f.find(Se=>Se.id===K.homeroomTeacher),Z=J?.name||"",xe=G?.name||"";Q=Z.localeCompare(xe,"ko-KR")}else{const J=v[L.key],G=K[L.key];if(J==null)return 1;if(G==null)return-1;typeof J=="string"&&typeof G=="string"?Q=J.localeCompare(G,"ko-KR"):typeof J=="number"&&typeof G=="number"?Q=J-G:Q=String(J).localeCompare(String(G),"ko-KR")}return L.direction==="asc"?Q:-Q}):Mo,[Mo,L,f]),Hc=v=>w.filter(Q=>Q.grade===v.grade&&Q.class===v.class).reduce((Q,J)=>Q+(J.cumulativeScore||0),0),Vf=async()=>{try{if(!dr.reason.trim()){await Re.fire({title:"",text:" .",icon:"error"});return}await Rn(We(ce,"merit_reasons"),{type:dr.type,reason:dr.reason.trim(),createdAt:new Date}),await ls(),Ur({type:"merit",reason:""}),ut(!1),await Re.fire({title:"",text:"  .",icon:"success"})}catch(v){await Re.fire({title:"",text:"    : "+v.message,icon:"error"})}},us=v=>{Ms(K=>({key:v,direction:K.key===v&&K.direction==="asc"?"desc":"asc"}))},js=$e.useMemo(()=>N.key?[...$c].sort((v,K)=>{const Q=v[N.key],J=K[N.key];if(Q==null)return 1;if(J==null)return-1;let G=0;return typeof Q=="string"&&typeof J=="string"?G=Q.localeCompare(J,"ko-KR"):typeof Q=="number"&&typeof J=="number"?G=Q-J:G=String(Q).localeCompare(String(J),"ko-KR"),N.direction==="asc"?G:-G}):$c,[$c,N]),Bo=$e.useMemo(()=>M.key?[...zc].sort((v,K)=>{let Q=0;if(M.key==="grade"){const J=parseInt(v.grade)||0,G=parseInt(K.grade)||0,Z=parseInt(v.class)||0,xe=parseInt(K.class)||0,Se=parseInt(v.number)||0,be=parseInt(K.number)||0;J!==G?Q=J-G:Z!==xe?Q=Z-xe:Q=Se-be}else if(M.key==="cumulativeScore"){const J=parseFloat(v.cumulativeScore)||0,G=parseFloat(K.cumulativeScore)||0;Q=J-G}else{const J=v[M.key],G=K[M.key];if(J==null)return 1;if(G==null)return-1;typeof J=="string"&&typeof G=="string"?Q=J.localeCompare(G,"ko-KR"):typeof J=="number"&&typeof G=="number"?Q=J-G:Q=String(J).localeCompare(String(G),"ko-KR")}return M.direction==="asc"?Q:-Q}):zc,[zc,M]),Vo=async()=>{try{await e()}catch{}},Eu=async()=>{try{if(!H.grade||!H.class){T("  .");return}if(H.homeroomTeacher&&h.find(Q=>Q.homeroomTeacher===H.homeroomTeacher&&Q.id!==Ut.id)){await Re.fire({title:"",text:"       .    1    .",icon:"error",customClass:{container:"swal2-container-high-z"}});return}const v={name:`${H.grade} ${H.class}`,grade:parseInt(H.grade),class:parseInt(H.class),homeroomTeacher:H.homeroomTeacher,homeroomTeacherId:H.homeroomTeacher,subjectTeachers:H.subjectTeachers,updatedAt:new Date};if(await fi(ht(ce,"classes",Ut.id),v),H.homeroomTeacher){console.log(` ${H.grade} ${H.class}   ${H.homeroomTeacher} .`);const K=h.find(Se=>Se.id===Ut.id);if(K&&K.homeroomTeacher&&K.homeroomTeacher!==H.homeroomTeacher){console.log(`   ${K.homeroomTeacher}   .`);const Se=St(We(ce,"classes"),gt("homeroomTeacher","==",K.homeroomTeacher)),be=await tt(Se);if(be.size>0){console.log(`      : ${be.size}`);for(const qe of be.docs){const Ue=qe.data(),Ce=St(We(ce,"accounts"),gt("role","==","student"),gt("grade","==",Ue.grade),gt("class","==",Ue.class)),Xe=await tt(Ce);if(Xe.size>0){const ie=br(ce);Xe.forEach(et=>{const Ht=et.data();console.log(`   ${Ht.name}    null :`,{_homeroomTeacher:Ht.homeroomTeacher,_homeroomTeacherId:Ht.homeroomTeacherId}),ie.update(et.ref,{homeroomTeacher:null,homeroomTeacherId:null,updatedAt:new Date})}),await ie.commit(),console.log(`${Xe.size}     .`)}}}}const Q=We(ce,"accounts"),J=St(Q,gt("role","==","student"),gt("grade","==",parseInt(H.grade)),gt("class","==",parseInt(H.class))),G=await tt(J);console.log(`   : ${G.size}`);const Z=br(ce);let xe=0;if(G.forEach(Se=>{const be=Se.data();console.log(` ${be.name}    :`,{_homeroomTeacher:be.homeroomTeacher,_homeroomTeacherId:be.homeroomTeacherId,__ID:H.homeroomTeacher}),Z.update(Se.ref,{homeroomTeacher:H.homeroomTeacher,homeroomTeacherId:H.homeroomTeacher,updatedAt:new Date}),xe++}),xe>0){await Z.commit(),console.log(`${xe}   .`);const Se=await tt(J);console.log("  -    :"),Se.forEach(be=>{const qe=be.data();console.log(` ${qe.name}: homeroomTeacher = ${qe.homeroomTeacher}, homeroomTeacherId = ${qe.homeroomTeacherId}`)})}}Fe(!1),es(null),ge({grade:"",class:"",name:"",homeroomTeacher:"",subjectTeachers:[]}),await zn(),await Re.fire({title:"",text:"        !",icon:"success"})}catch(v){T("    : "+v.message)}},nr=async()=>{try{if(!H.grade||!H.class){await Re.fire({title:"",text:"  .",icon:"error",customClass:{container:"swal2-container-high-z"}});return}const v=`${H.grade} ${H.class}`;if(h.find(Z=>Z.grade===H.grade&&Z.class===H.class)){await Re.fire({title:"",text:`${v}()  .`,icon:"error",customClass:{container:"swal2-container-high-z"}});return}if(H.homeroomTeacher&&h.find(xe=>xe.homeroomTeacher===H.homeroomTeacher)){await Re.fire({title:"",text:"       .    1    .",icon:"error",customClass:{container:"swal2-container-high-z"}});return}const Q={...H,grade:parseInt(H.grade),class:parseInt(H.class),name:v,homeroomTeacherId:H.homeroomTeacher,students:[],createdAt:new Date,updatedAt:new Date},J=await Rn(We(ce,"classes"),Q);if(H.homeroomTeacher){console.log(`  ${H.grade} ${H.class}   ${H.homeroomTeacher} .`);const Z=We(ce,"accounts"),xe=St(Z,gt("role","==","student"),gt("grade","==",parseInt(H.grade)),gt("class","==",parseInt(H.class))),Se=await tt(xe);if(console.log(`   : ${Se.size}`),Se.size>0){const be=br(ce);let qe=0;Se.forEach(Ce=>{const Xe=Ce.data();console.log(` ${Xe.name}    :`,{_homeroomTeacher:Xe.homeroomTeacher,_homeroomTeacherId:Xe.homeroomTeacherId,__ID:H.homeroomTeacher}),be.update(Ce.ref,{homeroomTeacher:H.homeroomTeacher,homeroomTeacherId:H.homeroomTeacher,updatedAt:new Date}),qe++}),await be.commit(),console.log(`${qe}   .`);const Ue=await tt(xe);console.log("  -    :"),Ue.forEach(Ce=>{const Xe=Ce.data();console.log(` ${Xe.name}: homeroomTeacher = ${Xe.homeroomTeacher}, homeroomTeacherId = ${Xe.homeroomTeacherId}`)})}}try{await Rn(We(ce,"system_logs"),{userId:t.uid,userName:t.name||t.email,userRole:t.role,majorCategory:" ",middleCategory:" ",minorCategory:"",action:" ",details:`${t.name||t.email} ${v}() .`,timestamp:new Date,createdAt:new Date})}catch{}Fe(!1),ge({grade:"",class:"",name:"",homeroomTeacher:"",subjectTeachers:[]}),await zn();const G=H.homeroomTeacher?`${v}()  ,       !`:`${v}()  !`;await Re.fire({title:"",text:G,icon:"success"})}catch(v){await Re.fire({title:"",text:"    : "+v.message,icon:"error",customClass:{container:"swal2-container-high-z"}})}},jo=async()=>{try{if(T(""),!de.name){T(" .");return}if(de.role==="subject_teacher"&&!de.subject){await Re.fire({title:"",text:"     .",icon:"error",customClass:{container:"swal2-container-high-z"}});return}const v={name:de.name,role:de.role,phone:de.phone,subject:de.subject||"",updatedAt:new Date};await fi(ht(ce,"accounts",Ut.id),v),je(!1),es(null),Be({name:"",email:"",role:"homeroom_teacher",phone:"",subject:""}),Yr(),T(""),await Re.fire({title:"",text:"   !",icon:"success",customClass:{container:"swal2-container-high-z"}})}catch(v){T("     : "+v.message)}},ja=async()=>{try{if(T(""),!de.name||!de.email){await Re.fire({title:"",text:"  .",icon:"error",customClass:{container:"swal2-container-high-z"}});return}if(de.role==="subject_teacher"&&!de.subject){await Re.fire({title:"",text:"     .",icon:"error",customClass:{container:"swal2-container-high-z"}});return}if(f.find(Ue=>Ue.email===de.email)){await Re.fire({title:"",text:"  .",icon:"error",customClass:{container:"swal2-container-high-z"}});return}const K={name:de.name,email:de.email,role:de.role,phone:de.phone,subject:de.subject||"",assignedClasses:[]},Q=t,{createUserWithEmailAndPassword:J,sendPasswordResetEmail:G,signOut:Z,signInWithEmailAndPassword:xe}=await ro(async()=>{const{createUserWithEmailAndPassword:Ue,sendPasswordResetEmail:Ce,signOut:Xe,signInWithEmailAndPassword:ie}=await Promise.resolve().then(()=>Hg);return{createUserWithEmailAndPassword:Ue,sendPasswordResetEmail:Ce,signOut:Xe,signInWithEmailAndPassword:ie}},void 0),{getAuth:Se}=await ro(async()=>{const{getAuth:Ue}=await Promise.resolve().then(()=>Hg);return{getAuth:Ue}},void 0),be=Se(),qe=Math.random().toString(36).slice(-8)+"!@#";try{const Ue=await J(be,de.email,qe),{doc:Ce,setDoc:Xe}=await ro(async()=>{const{doc:et,setDoc:Ht}=await Promise.resolve().then(()=>J0);return{doc:et,setDoc:Ht}},void 0),{db:ie}=await ro(async()=>{const{db:et}=await Promise.resolve().then(()=>n_);return{db:et}},void 0);if(await Xe(Ce(ie,"accounts",Ue.user.uid),{...K,uid:Ue.user.uid,status:"active",createdAt:new Date,updatedAt:new Date}),await G(be,de.email),await Z(be),Q&&Q.uid)try{const et=await r(Q.uid);et.success||console.error("   :",et.error)}catch(et){console.error("   :",et)}je(!1),Be({name:"",email:"",role:"homeroom_teacher",phone:"",subject:""}),Yr(),T(""),await Re.fire({title:"",text:"   !    .",icon:"success",customClass:{container:"swal2-container-high-z"}});try{const{addDoc:et,collection:Ht}=await ro(async()=>{const{addDoc:pr,collection:Us}=await Promise.resolve().then(()=>J0);return{addDoc:pr,collection:Us}},void 0);await et(Ht(ie,"system_logs"),{userId:Q.uid,userName:Q.name||Q.email,userRole:Q.role,majorCategory:" ",middleCategory:" ",minorCategory:" ",action:"       ",details:`${Q.name||Q.email} ${de.name}(${de.email})       .`,timestamp:new Date,createdAt:new Date})}catch(et){console.error("  :",et)}}catch(Ue){console.error("Firebase Auth :",Ue);let Ce="     .";Ue.code==="auth/email-already-in-use"?Ce="  .   .":Ue.code==="auth/invalid-email"?Ce="   .":Ue.code==="auth/weak-password"?Ce="  .":Ce=`     : ${Ue.message}`,await Re.fire({title:"",text:Ce,icon:"error",customClass:{container:"swal2-container-high-z"}});return}}catch(v){console.error("   :",v),await Re.fire({title:"",text:`     : ${v.message}`,icon:"error",customClass:{container:"swal2-container-high-z"}})}},Ua=async()=>{try{if(!pe.selectedClassId){await Re.fire({title:"",text:" .",icon:"error",customClass:{container:"swal2-container-high-z"}});return}const v=h.find(G=>G.id===pe.selectedClassId);if(!v){T("    .");return}if(Ut.grade&&Ut.class){const G=h.find(Z=>Z.grade===Ut.grade&&Z.class===Ut.class);if(G&&G.students){const Z=G.students.filter(Se=>Se!==Ut.id),xe=ht(ce,"classes",G.id);await fi(xe,{students:Z,updatedAt:new Date})}}const K=`${v.grade}${v.class.toString().padStart(2,"0")}${pe.number.toString().padStart(2,"0")}`,Q={name:pe.name,grade:v.grade,class:v.class,number:parseInt(pe.number),birthDate:pe.birthDate,studentId:K,homeroomTeacher:v.homeroomTeacher,subjectTeachers:v.subjectTeachers||[],updatedAt:new Date};await fi(ht(ce,"accounts",Ut.id),Q);const J=ht(ce,"classes",v.id);await fi(J,{students:[...v.students||[],Ut.id],updatedAt:new Date});try{await Rn(We(ce,"system_logs"),{userId:t.uid,userName:t.name||t.email,userRole:t.role,majorCategory:" ",middleCategory:" ",minorCategory:"",action:"  ",details:`${t.name||t.email} ${pe.name}   .`,timestamp:new Date,createdAt:new Date})}catch{}_t(!1),es(null),De({name:"",grade:"",class:"",number:"",birthDate:"",selectedClassId:""}),Ci(),await Re.fire({title:"",text:"   !",icon:"success"})}catch(v){T("     : "+v.message)}},jf=async()=>{try{if(!pe.selectedClassId){await Re.fire({title:"",text:" .",icon:"error",customClass:{container:"swal2-container-high-z"}});return}const v=h.find(Z=>Z.id===pe.selectedClassId);if(!v){await Re.fire({title:"",text:"    .",icon:"error",customClass:{container:"swal2-container-high-z"}});return}const K=`${v.grade}${v.class.toString().padStart(2,"0")}${pe.number.toString().padStart(2,"0")}`,Q={...pe,studentId:K,role:"student",status:"active",grade:v.grade,class:v.class,homeroomTeacher:v.homeroomTeacher,subjectTeachers:v.subjectTeachers||[],cumulativeScore:0,createdAt:new Date,updatedAt:new Date},J=await Rn(We(ce,"accounts"),Q),G=ht(ce,"classes",v.id);await fi(G,{students:[...v.students||[],J.id],updatedAt:new Date});try{await Rn(We(ce,"system_logs"),{userId:t.uid,userName:t.name||t.email,userRole:t.role,majorCategory:" ",middleCategory:" ",minorCategory:"",action:" ",details:`${t.name||t.email} ${v.name} ${pe.name}  .`,timestamp:new Date,createdAt:new Date})}catch{}_t(!1),De({name:"",grade:"",class:"",number:"",birthDate:"",selectedClassId:""}),Ci(),await Re.fire({title:"",text:"   !",icon:"success"})}catch(v){T("     : "+v.message)}},Tu=async()=>{try{if((await Re.fire({title:"  ",html:`
          <div style="text-align: left;">
            <p><strong>   ?</strong></p>
            <p style="color: #d32f2f; font-weight: bold;">     !</p>
            <ul style="margin: 10px 0; padding-left: 20px;">
              <li>   </li>
              <li>   </li>
              <li>    </li>
            </ul>
            <p>   <strong>"DELETE ALL STUDENTS"</strong> .</p>
            <input type="text" id="confirmText" class="swal2-input" placeholder="DELETE ALL STUDENTS">
          </div>
        `,icon:"warning",showCancelButton:!0,confirmButtonText:" ",cancelButtonText:"",confirmButtonColor:"#d32f2f",cancelButtonColor:"#6c757d",customClass:{container:"swal2-container-high-z"},preConfirm:()=>document.getElementById("confirmText").value!=="DELETE ALL STUDENTS"?(Re.showValidationMessage("  ."),!1):!0})).isConfirmed){const K=Date.now();U(!0),console.log("===     ==="),console.log(":",t.name||t.email),console.log(" :",new Date().toLocaleString()),await d0(t,qt.SECURITY.middle.SUSPICIOUS_ACTIVITY,"   ","    ");const Q=We(ce,"accounts"),J=St(Q,gt("role","==","student")),G=await tt(J);if(G.empty){await ju(t,qt.STUDENT_MANAGEMENT.major,qt.STUDENT_MANAGEMENT.middle.DELETE,"    -   ","    ",{studentCount:0}),await Re.fire({title:"",text:"  .",icon:"info",customClass:{container:"swal2-container-high-z"}}),U(!1);return}console.log("  :",G.size);const Z=br(ce);let xe=0;G.forEach(Xe=>{Z.delete(Xe.ref),xe++}),await Z.commit(),console.log("   :",xe,"");const Se=We(ce,"merit_demerit_records"),be=await tt(Se);let qe=0;if(!be.empty){const Xe=br(ce);be.forEach(ie=>{Xe.delete(ie.ref),qe++}),await Xe.commit(),console.log("   :",qe,"")}const Ce=Date.now()-K;await ju(t,qt.STUDENT_MANAGEMENT.major,qt.STUDENT_MANAGEMENT.middle.BULK_DELETE,"   ",` ${xe},   ${qe}  `,{studentCount:xe,meritRecordCount:qe,duration:Ce,operation:"bulk_delete_students"}),await m0(t,"  ",Ce,{studentCount:xe,meritRecordCount:qe}),await Ka(t,qt.STUDENT_MANAGEMENT.middle.DELETE,"  ",`     (${xe})`),console.log("===     ==="),console.log(" :",Ce,"ms"),console.log("  :",xe),console.log("   :",qe),await Ci(),await Re.fire({title:" ",text:`${xe}   .`,icon:"success",customClass:{container:"swal2-container-high-z"}}),U(!1)}}catch(v){U(!1),T("     : "+v.message),await Re.fire({title:"",text:"     .",icon:"error",customClass:{container:"swal2-container-high-z"}})}},Uf=async()=>{try{if((await Re.fire({title:"  ",html:`
          <div style="text-align: left;">
            <p><strong>   ?</strong></p>
            <p style="color: #d32f2f; font-weight: bold;">     !</p>
            <ul style="margin: 10px 0; padding-left: 20px;">
              <li>   </li>
              <li> /   </li>
              <li>    </li>
            </ul>
            <p>   <strong>"DELETE ALL TEACHERS"</strong> .</p>
            <input type="text" id="confirmText" class="swal2-input" placeholder="DELETE ALL TEACHERS">
          </div>
        `,icon:"warning",showCancelButton:!0,confirmButtonText:" ",cancelButtonText:"",confirmButtonColor:"#d32f2f",cancelButtonColor:"#6c757d",customClass:{container:"swal2-container-high-z"},preConfirm:()=>document.getElementById("confirmText").value!=="DELETE ALL TEACHERS"?(Re.showValidationMessage("  ."),!1):!0})).isConfirmed){U(!0);const K=We(ce,"accounts"),Q=St(K,gt("role","in",["teacher","homeroom_teacher","subject_teacher"])),J=await tt(Q);if(J.empty){await Re.fire({title:"",text:"  .",icon:"info",customClass:{container:"swal2-container-high-z"}}),U(!1);return}const G=br(ce);let Z=0;J.forEach(be=>{G.delete(be.ref),Z++}),await G.commit();const xe=We(ce,"classes"),Se=await tt(xe);if(!Se.empty){const be=br(ce);Se.forEach(qe=>{be.update(qe.ref,{homeroomTeacher:null,homeroomTeacherId:null,subjectTeachers:[],updatedAt:new Date})}),await be.commit()}await Ka("  ",`     (${Z})`,t.uid),await Yr(),await zn(),await Re.fire({title:" ",text:`${Z}   .`,icon:"success",customClass:{container:"swal2-container-high-z"}}),U(!1)}}catch(v){console.error("   :",v),await Re.fire({title:"",text:"    : "+v.message,icon:"error",customClass:{container:"swal2-container-high-z"}}),U(!1)}},Wf=async()=>{try{if((await Re.fire({title:"  ",html:`
          <div style="text-align: left;">
            <p><strong>   ?</strong></p>
            <p style="color: #ff9800; font-weight: bold;">     !</p>
            <ul style="margin: 10px 0; padding-left: 20px;">
              <li>   </li>
              <li>   </li>
              <li>   </li>
              <li>    </li>
            </ul>
            <p>   <strong>"RESET ALL MERIT RECORDS"</strong> .</p>
            <input type="text" id="confirmText" class="swal2-input" placeholder="RESET ALL MERIT RECORDS">
          </div>
        `,icon:"warning",showCancelButton:!0,confirmButtonText:" ",cancelButtonText:"",confirmButtonColor:"#ff9800",cancelButtonColor:"#6c757d",customClass:{container:"swal2-container-high-z"},preConfirm:()=>document.getElementById("confirmText").value!=="RESET ALL MERIT RECORDS"?(Re.showValidationMessage("  ."),!1):!0})).isConfirmed){U(!0);const K=We(ce,"merit_demerit_records"),Q=await tt(K);let J=0;if(!Q.empty){const Ue=br(ce);Q.forEach(Ce=>{Ue.delete(Ce.ref),J++}),await Ue.commit()}const G=We(ce,"merit_demerit_requests"),Z=await tt(G);let xe=0;if(!Z.empty){const Ue=br(ce);Z.forEach(Ce=>{Ue.delete(Ce.ref),xe++}),await Ue.commit()}const Se=We(ce,"accounts"),be=St(Se,gt("role","==","student")),qe=await tt(be);if(!qe.empty){const Ue=br(ce);qe.forEach(Ce=>{Ue.update(Ce.ref,{totalMeritPoints:0,totalDemeritPoints:0,meritPoints:0,demeritPoints:0,updatedAt:new Date})}),await Ue.commit()}await Ka(t,qt.SYSTEM_MANAGEMENT.middle.DELETE,"   ",`     (: ${J}, : ${xe})`),await ci(),await Re.fire({title:" ",text:`  ${J}  ${xe} .`,icon:"success",customClass:{container:"swal2-container-high-z"}}),U(!1)}}catch(v){U(!1),T("     : "+v.message),await Re.fire({title:"",text:"     .",icon:"error",customClass:{container:"swal2-container-high-z"}})}},Su=v=>{const K=String(v).padStart(5,"0");if(K.length!==5)throw new Error(" 5 .");const Q=parseInt(K[0]),J=parseInt(K.substring(1,3)),G=parseInt(K.substring(3,5));if(Q<1||Q>6)throw new Error(" 1~6  .");if(J<1||J>20)throw new Error(" 1~20  .");if(G<1||G>40)throw new Error(" 1~40  .");return{grade:Q,class:J,number:G}},Wa=()=>{const v=new Date,K=v.getFullYear(),Q=v.getMonth()+1;return Q>=3&&Q<=8?{academicYear:K.toString(),semester:"1"}:Q>=9?{academicYear:K.toString(),semester:"2"}:{academicYear:(K-1).toString(),semester:"2"}},$a=async()=>{try{U(!0);const v=We(ce,"accounts"),K=St(v,gt("role","==","student"),gt("status","==","active")),J=(await tt(K)).docs.map(qe=>{const Ue=qe.data();let Ce=Ue.studentNumber||"";return!Ce&&Ue.grade&&Ue.class&&Ue.number&&(Ce=`${Ue.grade}${String(Ue.class).padStart(2,"0")}${String(Ue.number).padStart(2,"0")}`),{uid:qe.id,:Ue.name||"",:Ce,:""}}),G=["uid","","",""],Z=ir.json_to_sheet(J,{header:G}),xe=[{wch:30},{wch:15},{wch:12},{wch:12}];Z["!cols"]=xe;const Se=ir.book_new();ir.book_append_sheet(Se,Z,"");const be=`_${new Date().toISOString().split("T")[0].replace(/-/g,"")}.xlsx`;Jc(Se,be),await Re.fire({title:" ",text:`   . (${J.length})`,icon:"success"}),cs(!1)}catch(v){console.error("   :",v),await Re.fire({title:"",text:"     : "+v.message,icon:"error"})}finally{U(!1)}},Ts=async v=>{if(v)try{U(!0);const K=new FileReader;K.onload=async Q=>{try{const J=new Uint8Array(Q.target.result),G=Kh(J,{type:"array"}),Z=G.SheetNames[0],xe=G.Sheets[Z],Se=ir.sheet_to_json(xe);console.log(" :",Se);let{academicYear:be,semester:qe}=Wa();mr==="new_year"?(be=(parseInt(be)+1).toString(),qe="1"):qe="2";const Ue=We(ce,"accounts"),Ce=St(Ue,gt("role","==","student")),Xe=await tt(Ce),ie={};Xe.forEach(Le=>{ie[Le.id]=Le.data()});const et=[],Ht=[],pr=[],Us=new Set,Sn=new Set;for(let Le=0;Le<Se.length;Le++){const ze=Se[Le],tr=ze.uid||ze.UID||"",xr=ze.||ze.name||"",Dr=ze.||ze.currentStudentNumber||"",Lt=ze.||ze.newStudentNumber||"";if(!xr||!Lt){pr.push(` ${Le+2}:   .`);continue}if(String(Lt).length!==5){pr.push(` ${Le+2}:  5 . (${Lt})`);continue}if(Sn.has(Lt)){pr.push(` ${Le+2}:  . (${Lt})`);continue}if(Sn.add(Lt),tr){Us.add(tr);const wr=ie[tr];if(!wr){pr.push(` ${Le+2}: UID  . (${tr})`);continue}if(wr.name!==xr){pr.push(` ${Le+2}:   . (: ${wr.name}, : ${xr})`);continue}if(wr.studentNumber!==Dr){pr.push(` ${Le+2}:   . (: ${wr.studentNumber}, : ${Dr})`);continue}let sn;try{sn=Su(Lt)}catch(Zr){pr.push(` ${Le+2}:    - ${Zr.message}`);continue}et.push({uid:tr,name:xr,currentNumber:Dr,newNumber:Lt,...sn})}else{let wr;try{wr=Su(Lt)}catch(sn){pr.push(` ${Le+2}:    - ${sn.message}`);continue}Ht.push({name:xr,newNumber:Lt,...wr})}}if(pr.length>0){await Re.fire({title:" ",html:`<div style="text-align: left; max-height: 400px; overflow-y: auto;">${pr.map(Le=>`<p>${Le}</p>`).join("")}</div>`,icon:"error",width:"600px"}),U(!1);return}const gr=br(ce);for(const Le of et){const ze=ie[Le.uid],tr=ht(We(ce,"student_history"));gr.set(tr,{studentId:Le.uid,academicYear:ze.currentAcademicYear||be,semester:ze.currentSemester||qe,grade:ze.grade,class:ze.class,number:ze.number,studentNumber:ze.studentNumber,homeroomTeacherId:ze.homeroomTeacherId||null,startDate:ze.createdAt?.toDate?.()||new Date,endDate:new Date,createdAt:new Date})}const Jr=We(ce,"classes"),gn=await tt(Jr),Dt=new Map;gn.forEach(Le=>{const ze=Le.data();if(ze.academicYear===(ie[et[0]?.uid]?.currentAcademicYear||be)&&ze.semester===(ie[et[0]?.uid]?.currentSemester||qe)){const tr=Le(We(ce,"class_history"));gr.set(tr,{classId:Le.id,academicYear:ze.academicYear,semester:ze.semester,grade:ze.grade,class:ze.class,name:ze.name,homeroomTeacherId:ze.homeroomTeacherId||null,homeroomTeacherName:ze.homeroomTeacherName||null,studentCount:ze.students?.length||0,startDate:ze.createdAt?.toDate?.()||new Date,endDate:new Date,createdAt:new Date})}});const Qt=Object.keys(ie).filter(Le=>ie[Le].status==="active").filter(Le=>!Us.has(Le));for(const Le of Qt){const ze=ie[Le],tr=ht(ce,"accounts",Le);gr.update(tr,{status:"transferred",transferredAt:new Date,updatedAt:new Date});const xr=ht(We(ce,"student_history"));gr.set(xr,{studentId:Le,academicYear:ze.currentAcademicYear||be,semester:ze.currentSemester||qe,grade:ze.grade,class:ze.class,number:ze.number,studentNumber:ze.studentNumber,status:"transferred",transferredAt:new Date,createdAt:new Date})}for(const Le of et){const ze=ht(ce,"accounts",Le.uid);gr.update(ze,{grade:Le.grade,class:Le.class,number:Le.number,studentNumber:Le.newNumber,currentAcademicYear:be,currentSemester:qe,updatedAt:new Date})}const An=[];for(const Le of Ht){const ze=`student_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,tr=ht(ce,"accounts",ze);gr.set(tr,{uid:ze,name:Le.name,email:"",role:"student",grade:Le.grade,class:Le.class,number:Le.number,studentNumber:Le.newNumber,currentAcademicYear:be,currentSemester:qe,status:"active",cumulativeScore:0,createdAt:new Date,updatedAt:new Date}),An.push(ze)}gn.forEach(Le=>{gr.delete(Le.ref)});const xn=new Map;[...et,...Ht.map((Le,ze)=>({...Le,uid:An[ze]}))].forEach(Le=>{const ze=`${Le.grade}-${Le.class}`;xn.has(ze)||xn.set(ze,[]),xn.get(ze).push(Le.uid)});const wn=[];xn.forEach((Le,ze)=>{const[tr,xr]=ze.split("-").map(Number),Dr=`class_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,Lt=ht(ce,"classes",Dr);gr.set(Lt,{id:Dr,grade:tr,class:xr,name:`${tr} ${xr}`,academicYear:be,semester:qe,homeroomTeacherId:null,homeroomTeacherName:null,studentCount:Le.length,students:Le,createdAt:new Date,updatedAt:new Date}),wn.push({id:Dr,grade:tr,class:xr,name:`${tr} ${xr}`,studentCount:Le.length})});const xt=ht(ce,"academic_settings","current");gr.set(xt,{currentAcademicYear:be,currentSemester:qe,semester1Start:`${be}-03-01`,semester1End:`${be}-08-31`,semester2Start:`${be}-09-01`,semester2End:`${parseInt(be)+1}-02-28`,updatedAt:new Date,updatedBy:t.uid},{merge:!0}),await gr.commit(),dt(wn),await Ka(t,qt.SYSTEM_MANAGEMENT.middle.UPDATE,"  ",` : ${et.length}, : ${Ht.length}, : ${Qt.length},  : ${wn.length}`),await Re.fire({title:" ",html:`
              <div style="text-align: left;">
                <p><strong>  .</strong></p>
                <p>: ${et.length}</p>
                <p>: ${Ht.length}</p>
                <p>: ${Qt.length}</p>
                <p> : ${wn.length}</p>
              </div>
            `,icon:"success"}),Tr(!0)}catch(J){console.error("   :",J),await Re.fire({title:"",text:"     : "+J.message,icon:"error"})}finally{U(!1)}},K.readAsArrayBuffer(v)}catch(K){console.error("  :",K),U(!1),await Re.fire({title:"",text:"    : "+K.message,icon:"error"})}},Au=async()=>{const v=Date.now();try{U(!0),await d0(t,qt.SECURITY.middle.LOGIN_ATTEMPT,"   ","XLSX  "),console.log("===     ==="),console.log(":",t.name||t.email),console.log(" :",new Date().toLocaleString());const K=We(ce,"accounts"),Q=St(K,gt("role","==","student")),G=(await tt(Q)).docs.map(ie=>({id:ie.id,...ie.data()}));console.log("  :",G.length);const Z=We(ce,"merit_demerit_records"),Se=(await tt(Z)).docs.map(ie=>({id:ie.id,...ie.data(),createdAt:ie.data().createdAt?.toDate?.()||new Date(ie.data().createdAt)}));console.log("   :",Se.length);const be=ir.json_to_sheet(G.map(ie=>({:ie.studentId||"",:ie.name||"",:ie.grade||"",:ie.class||"",:ie.number||"",:ie.birthDate||"",:ie.homeroomTeacher||"",:ie.cumulativeScore||0,:ie.status||"active",:ie.createdAt?new Date(ie.createdAt.seconds*1e3).toLocaleString():""}))),qe=ir.json_to_sheet(Se.map(ie=>({:ie.studentId,:ie.studentName,:ie.type==="merit"?"":"",:ie.points||ie.value||0,:ie.reason||"",:ie.description||"",:ie.processedByName||ie.creatorName||"N/A",:ie.createdAt?ie.createdAt.toLocaleString():"",:ie.status||"approved"}))),Ue=ir.book_new();ir.book_append_sheet(Ue,be," "),ir.book_append_sheet(Ue,qe," "),Jc(Ue,`students_with_merit_${new Date().toISOString().split("T")[0]}.xlsx`);const Xe=Date.now()-v;await ju(t,qt.DATA_MANAGEMENT.major,qt.DATA_MANAGEMENT.middle.EXPORT,"   ",` ${G.length},   ${Se.length}  `,{studentCount:G.length,meritRecordCount:Se.length,fileName:`students_with_merit_${new Date().toISOString().split("T")[0]}.xlsx`,duration:Xe,fileSize:"N/A"}),await m0(t,"  ",Xe,{studentCount:G.length,meritRecordCount:Se.length}),console.log("===     ==="),console.log(" :",Xe,"ms"),console.log(" :",`students_with_merit_${new Date().toISOString().split("T")[0]}.xlsx`),await Re.fire({title:" ",text:`     XLSX  . (: ${G.length},  : ${Se.length})`,icon:"success",customClass:{container:"swal2-container-high-z"}}),U(!1)}catch(K){U(!1),console.error(" XLSX  :",K),await fD(t,K,"  XLSX ",{operation:"handleDownloadStudentsXLSX",timestamp:new Date().toISOString(),userAgent:navigator.userAgent}),await Re.fire({title:"",text:" XLSX    .",icon:"error",customClass:{container:"swal2-container-high-z"}})}},ku=async()=>{try{const v=We(ce,"accounts"),K=St(v,gt("role","in",["teacher","homeroom_teacher","subject_teacher","super_admin"])),J=(await tt(K)).docs.map(xe=>({id:xe.id,...xe.data()})),G=ir.json_to_sheet(J.map(xe=>({ID:xe.id||"",:xe.name||"",:xe.email||"",:xe.role||"",:xe.subject||"",:xe.status||"active",:xe.createdAt?new Date(xe.createdAt.seconds*1e3).toLocaleString():""}))),Z=ir.book_new();ir.book_append_sheet(Z,G," "),Jc(Z,`teachers_${new Date().toISOString().split("T")[0]}.xlsx`),await Re.fire({title:" ",text:"  XLSX  .",icon:"success",customClass:{container:"swal2-container-high-z"}})}catch(v){console.error(" XLSX  :",v),await Re.fire({title:"",text:" XLSX    .",icon:"error",customClass:{container:"swal2-container-high-z"}})}},bu=async()=>{try{const v=We(ce,"classes"),Q=(await tt(v)).docs.map(Z=>({id:Z.id,...Z.data()})),J=ir.json_to_sheet(Q.map(Z=>({ID:Z.id||"",:Z.name||"",:Z.grade||"",:Z.class||"",:Z.homeroomTeacher||"",:(Z.subjectTeachers||[]).join(";"),:(Z.students||[]).length,:Z.createdAt?new Date(Z.createdAt.seconds*1e3).toLocaleString():""}))),G=ir.book_new();ir.book_append_sheet(G,J," "),Jc(G,`classes_${new Date().toISOString().split("T")[0]}.xlsx`),await Re.fire({title:" ",text:"  XLSX  .",icon:"success",customClass:{container:"swal2-container-high-z"}})}catch(v){console.error(" XLSX  :",v),await Re.fire({title:"",text:" XLSX    .",icon:"error",customClass:{container:"swal2-container-high-z"}})}},aa=async()=>{try{U(!0);const[v,K,Q,J]=await Promise.all([tt(St(We(ce,"accounts"),gt("role","==","student"))),tt(St(We(ce,"accounts"),gt("role","in",["teacher","homeroom_teacher","subject_teacher","super_admin"]))),tt(We(ce,"classes")),tt(We(ce,"merit_demerit_records"))]),G=v.docs.map(ie=>({id:ie.id,...ie.data()})),Z=K.docs.map(ie=>({id:ie.id,...ie.data()})),xe=Q.docs.map(ie=>({id:ie.id,...ie.data()})),Se=J.docs.map(ie=>({id:ie.id,...ie.data(),createdAt:ie.data().createdAt?.toDate?.()||new Date(ie.data().createdAt)})),be=ir.book_new(),qe=ir.json_to_sheet(G.map(ie=>({:ie.studentId||"",:ie.name||"",:ie.grade||"",:ie.class||"",:ie.number||"",:ie.birthDate||"",:ie.homeroomTeacher||"",:ie.cumulativeScore||0,:ie.status||"active",:ie.createdAt?new Date(ie.createdAt.seconds*1e3).toLocaleString():""})));ir.book_append_sheet(be,qe," ");const Ue=ir.json_to_sheet(Z.map(ie=>({ID:ie.id||"",:ie.name||"",:ie.email||"",:ie.role||"",:ie.subject||"",:ie.status||"active",:ie.createdAt?new Date(ie.createdAt.seconds*1e3).toLocaleString():""})));ir.book_append_sheet(be,Ue," ");const Ce=ir.json_to_sheet(xe.map(ie=>({ID:ie.id||"",:ie.name||"",:ie.grade||"",:ie.class||"",:ie.homeroomTeacher||"",:(ie.subjectTeachers||[]).join(";"),:(ie.students||[]).length,:ie.createdAt?new Date(ie.createdAt.seconds*1e3).toLocaleString():""})));ir.book_append_sheet(be,Ce," ");const Xe=ir.json_to_sheet(Se.map(ie=>({:ie.studentId,:ie.studentName,:ie.type==="merit"?"":"",:ie.points||ie.value||0,:ie.reason||"",:ie.description||"",:ie.processedByName||ie.creatorName||"N/A",:ie.createdAt?ie.createdAt.toLocaleString():"",:ie.status||"approved"})));ir.book_append_sheet(be,Xe," "),Jc(be,`all_data_${new Date().toISOString().split("T")[0]}.xlsx`),await Re.fire({title:" ",text:`  XLSX  . (: ${G.length}, : ${Z.length}, : ${xe.length},  : ${Se.length})`,icon:"success",customClass:{container:"swal2-container-high-z"}}),U(!1)}catch(v){U(!1),console.error("  XLSX  :",v),await Re.fire({title:"",text:"  XLSX    .",icon:"error",customClass:{container:"swal2-container-high-z"}})}},Iu=async v=>{if(!v)return;const K=Date.now();try{await d0(t,qt.SECURITY.middle.LOGIN_ATTEMPT,"XLSX   ",`: ${v.name}, : ${v.size} bytes`),console.log("=== XLSX    ==="),console.log(":",v.name),console.log(" :",v.size,"bytes"),console.log(" :",v.type),console.log(":",t.name||t.email),console.log(" :",new Date().toLocaleString());const Q=new FileReader;Q.onload=async J=>{try{const G=new Uint8Array(J.target.result),Z=Kh(G,{type:"array"}),xe=Z.SheetNames;console.log(" :",xe);const Se=xe.find(xt=>xt.includes("")||xt.includes("student")||xt==="Sheet1")||xe[0],be=Z.Sheets[Se],qe=ir.sheet_to_json(be),Ue=xe.find(xt=>xt.includes("")||xt.includes("merit")||xt.includes(""));let Ce=[];if(Ue){const xt=Z.Sheets[Ue];Ce=ir.sheet_to_json(xt),console.log("  :",Ce.length,"")}if(qe.length===0){await Re.fire({title:"",text:"  .",icon:"error",customClass:{container:"swal2-container-high-z"}});return}if(!(await Re.fire({title:" ",html:`
              <div style="text-align: left;">
                <p><strong> :      !</strong></p>
                <p>  :</p>
                <ul>
                  <li>  </li>
                  <li>  </li>
                  <li>  </li>
                </ul>
                <p> :</p>
                <ul>
                  <li>: ${qe.length}</li>
                  <li> : ${Ce.length}</li>
                </ul>
              </div>
            `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:" ",cancelButtonText:"",customClass:{container:"swal2-container-high-z"}})).isConfirmed)return;const ie=qe.length+Ce.length;let et=null;ie>5&&(et=Re.fire({title:"  ...",html:`
                <div style="text-align: center;">
                  <div style="margin: 20px 0;">
                    <div class="swal2-progress-bar" style="width: 100%; height: 20px; background: #f0f0f0; border-radius: 10px; overflow: hidden;">
                      <div id="progress-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #4CAF50, #8BC34A); transition: width 0.3s ease;"></div>
                    </div>
                    <div id="progress-text" style="margin-top: 10px; font-weight: bold;"> ... (0/${ie})</div>
                  </div>
                </div>
              `,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,customClass:{container:"swal2-container-high-z"}})),console.log("   ...");const Ht=await tt(St(We(ce,"accounts"),gt("role","==","student"))),pr=br(ce);Ht.docs.forEach(xt=>{pr.delete(xt.ref)}),await pr.commit();const Us=await tt(We(ce,"merit_demerit_records")),Sn=br(ce);Us.docs.forEach(xt=>{Sn.delete(xt.ref)}),await Sn.commit();const gr=await tt(We(ce,"classes")),Jr=br(ce);gr.docs.forEach(xt=>{Jr.delete(xt.ref)}),await Jr.commit(),console.log("   ");let gn=0,Dt=0,Ct=0;const Qt=[];for(let xt=0;xt<qe.length;xt++){const Le=qe[xt];try{if(gn++,et){const Gt=gn/ie*100,Ss=document.getElementById("progress-bar"),ts=document.getElementById("progress-text");Ss&&(Ss.style.width=`${Gt}%`),ts&&(ts.textContent=`  ... (${gn}/${ie})`)}const ze=Le.||Le.,tr=Le.,xr=Le.,Dr=Le.,Lt=Le.,wr=Le.,sn=[];if(wr||sn.push(""),ze||sn.push(""),tr||sn.push(""),xr||sn.push(""),Dr||sn.push(""),sn.length>0){Qt.push(` ${qe.indexOf(Le)+2}:    (${sn.join(", ")}) - ${wr||" "}`),Ct++;continue}const Zr=parseInt(tr),u=parseInt(xr),p=parseInt(Dr);if(isNaN(Zr)||Zr<1||Zr>6){Qt.push(` ${qe.indexOf(Le)+2}:    (${tr}) - ${wr}`),Ct++;continue}if(isNaN(u)||u<1||u>20){Qt.push(` ${qe.indexOf(Le)+2}:    (${xr}) - ${wr}`),Ct++;continue}if(isNaN(p)||p<1||p>500){Qt.push(` ${xt+2}:    (${Dr}) - ${wr}`),Ct++;continue}if(w.some(Gt=>Gt.name===wr&&Gt.birthDate===(Lt||"")&&Gt.grade===Zr&&Gt.class===u&&Gt.number===p)){Qt.push(` ${xt+2}: ${wr} -   (: ${wr}, : ${Lt||""}, ${Zr} ${u} ${p})`),Ct++;continue}const D=`${Zr}${u.toString().padStart(2,"0")}${p.toString().padStart(2,"0")}`;let ee=null,ae="",Ne="";const Mt=h.find(Gt=>Gt.name===ze);if(Mt)ee=Mt.id,ae=Mt.homeroomTeacherId||"",Ne=Mt.homeroomTeacher||"";else{const Gt=ht(We(ce,"classes"));batch.set(Gt,{name:ze,grade:Zr,classNumber:u,homeroomTeacherId:"",homeroomTeacher:"",createdAt:new Date,updatedAt:new Date}),ee=Gt.id}const Pr=ht(We(ce,"accounts"));batch.set(Pr,{name:wr,studentId:D,grade:Zr,class:u,number:p,birthDate:Lt||"",homeroomTeacher:Ne,homeroomTeacherId:ae,role:"student",status:"active",cumulativeScore:0,createdAt:new Date,updatedAt:new Date});const Rt=ht(ce,"classes",ee),en=await Ys(Rt);if(en.exists()){const Ss=en.data().students||[];Ss.includes(Pr.id)||batch.update(Rt,{students:[...Ss,Pr.id],updatedAt:new Date})}Dt++}catch(ze){console.error("   :",ze),Qt.push(` ${xt+2}: ${Le.||" "} - ${ze.message}`),Ct++}}if(Ce.length>0){console.log("   ...");for(let xt=0;xt<Ce.length;xt++){const Le=Ce[xt];try{if(gn++,et){const p=gn/ie*100,E=document.getElementById("progress-bar"),D=document.getElementById("progress-text");E&&(E.style.width=`${p}%`),D&&(D.textContent=`   ... (${gn}/${ie})`)}const ze=Le.,tr=Le.,xr=Le.===""?"merit":"demerit",Dr=parseInt(Le.)||0,Lt=Le.||"",wr=Le.||"",sn=Le.||"N/A",Zr=Le.||new Date().toLocaleString();if(!ze||!tr){Qt.push(`  ${xt+1}:    `),Ct++;continue}const u=ht(We(ce,"merit_demerit_records"));batch.set(u,{studentId:ze,studentName:tr,type:xr,points:xr==="demerit"?-Math.abs(Dr):Math.abs(Dr),value:xr==="demerit"?-Math.abs(Dr):Math.abs(Dr),reason:Lt,description:wr,processedByName:sn,creatorName:sn,creatorRole:"admin",status:"approved",createdAt:new Date(Zr)||new Date,updatedAt:new Date}),Dt++}catch(ze){console.error("   :",ze),Qt.push(`  ${xt+1}: ${ze.message}`),Ct++}}}et&&await Re.close(),await batch.commit(),await Ci(),await Yr(),await zn(),await ui();const xn=Date.now()-K;await ju(t,qt.DATA_MANAGEMENT.major,qt.DATA_MANAGEMENT.middle.OVERWRITE,"XLSX      ",` ${Dt},   ${Ce.length}   (: ${Ct})`,{fileName:v.name,fileSize:v.size,studentCount:Dt,meritRecordCount:Ce.length,errorCount:Ct,duration:xn,errors:Qt.slice(0,10),totalErrors:Qt.length}),await m0(t,"XLSX     ",xn,{studentCount:Dt,meritRecordCount:Ce.length,errorCount:Ct}),await Ka(t,qt.STUDENT_MANAGEMENT.middle.CREATE,"  ",`${Dt}   . (: ${Ct})`),console.log("=== XLSX   ==="),console.log(" :",xn,"ms"),console.log("  :",Dt),console.log("   :",Ce.length),console.log(" :",Ct);let wn=`${Dt}  .`;Ct>0&&(wn+=`

  : ${Ct}`,Qt.length>0&&(wn+=`

 :
${Qt.slice(0,10).join(`
`)}`,Qt.length>10&&(wn+=`
...  ${Qt.length-10}`))),Ct>0?await Re.fire({title:Ct>0?" ":"",html:`
                <div style="text-align: left;">
                  <p><strong>:</strong> ${Dt}</p>
                  <p><strong>:</strong> ${Ct}</p>
                  ${Qt.length>0?`
                    <details style="margin-top: 10px;">
                      <summary style="cursor: pointer; font-weight: bold;">   ( )</summary>
                      <div style="margin-top: 10px; max-height: 300px; overflow-y: auto; background: #f5f5f5; padding: 10px; border-radius: 5px;">
                        ${Qt.map(xt=>`<div style="margin-bottom: 5px; font-size: 12px;"> ${xt}</div>`).join("")}
                      </div>
                    </details>
                  `:""}
                </div>
              `,icon:Ct>0?"warning":"success",customClass:{container:"swal2-container-high-z"},width:"600px"}):await Re.fire({title:"",text:wn,icon:"success",customClass:{container:"swal2-container-high-z"}})}catch(G){console.error("XLSX   :",G),await Re.fire({title:"XLSX   ",html:`
              <div style="text-align: left;">
                <p><strong> :</strong> ${G.name||"   "}</p>
                <p><strong> :</strong> ${G.message||"  "}</p>
                <details style="margin-top: 10px;">
                  <summary style="cursor: pointer; font-weight: bold;">   ( )</summary>
                  <div style="margin-top: 10px; background: #f5f5f5; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px; word-wrap: break-word; white-space: pre-wrap; overflow-wrap: break-word; max-width: 100%;">
                    <pre style="white-space: pre-wrap; word-wrap: break-word; overflow-wrap: break-word; margin: 0; padding: 0;">${G.stack||"  "}</pre>
                  </div>
                </details>
              </div>
            `,icon:"error",customClass:{container:"swal2-container-high-z"},width:"600px"})}},Q.readAsArrayBuffer(v)}catch(Q){console.error("XLSX  :",Q),await Re.fire({title:"XLSX   ",html:`
          <div style="text-align: left;">
            <p><strong> :</strong> ${Q.name||"   "}</p>
            <p><strong> :</strong> ${Q.message||"  "}</p>
            <details style="margin-top: 10px;">
              <summary style="cursor: pointer; font-weight: bold;">   ( )</summary>
              <div style="margin-top: 10px; background: #f5f5f5; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px; word-wrap: break-word; white-space: pre-wrap; overflow-wrap: break-word; max-width: 100%;">
                <pre style="white-space: pre-wrap; word-wrap: break-word; overflow-wrap: break-word; margin: 0; padding: 0;">${Q.stack||"  "}</pre>
              </div>
            </details>
          </div>
        `,icon:"error",customClass:{container:"swal2-container-high-z"},width:"600px"})}},Gc=async(v,K)=>{if(K==="class"){const Q=v.homeroomTeacher&&f.find(G=>G.id===v.homeroomTeacher&&G.status!=="disabled")?v.homeroomTeacher:"",J=(v.subjectTeachers||[]).filter(G=>f.find(Z=>Z.id===G&&Z.status!=="disabled"));ge({grade:v.grade,class:v.class,name:v.name,homeroomTeacher:Q,subjectTeachers:J}),es({...v,type:K}),Fe(!0)}else if(K==="teacher")Be({name:v.name,email:v.email,role:v.role,phone:v.phone||"",subject:v.subject||""}),es({...v,type:K}),je(!0);else if(K==="student"){const Q=h.find(J=>J.grade===v.grade&&J.classNumber===v.class);De({name:v.name,grade:v.grade,class:v.class,number:v.number,birthDate:v.birthDate,selectedClassId:Q?.id||""}),es({...v,type:K}),_t(!0)}},qc=async(v,K)=>{let Q=`  ${K==="class"?"":K==="teacher"?"":""} ?`;if(K==="class"){const G=w.filter(Z=>Z.grade===v.grade&&Z.class===v.class);G.length>0&&(Q=` :    ${G.length}   !

 ?`)}if((await Re.fire({title:" ",text:Q,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"",cancelButtonText:""})).isConfirmed)try{if(K==="class"){const G=w.filter(xe=>xe.grade===v.grade&&xe.class===v.class),Z=br(ce);Z.delete(ht(ce,"classes",v.id));for(const xe of G)Z.delete(ht(ce,"accounts",xe.id));await Z.commit(),await uD(t,qt.CLASS_MANAGEMENT.middle.DELETE,` "${v.name}"  ( ${G.length} )`),await Re.fire({title:" ",text:` ${G.length}   .`,icon:"success"})}else{let G="";if(K==="teacher"){G="accounts";try{console.log("   :",v.email);const Z=ht(ce,"accounts",v.id);await fi(Z,{status:"deleted",deletedAt:new Date,deletedBy:t.uid,deletedByEmail:t.email}),console.log("  :",v.email)}catch(Z){console.error("  :",Z)}}else K==="student"&&(G="accounts");if(K==="teacher"){const Z=br(ce),xe=We(ce,"merit_demerit_requests"),Se=St(xe,gt("requestingTeacherId","==",v.id));(await tt(Se)).forEach(Jr=>{Z.delete(Jr.ref)});const qe=We(ce,"merit_demerit_records"),Ue=St(qe,gt("teacherId","==",v.id));(await tt(Ue)).forEach(Jr=>{Z.delete(Jr.ref)});const Xe=We(ce,"classes"),ie=St(Xe,gt("homeroomTeacherId","==",v.id));(await tt(ie)).forEach(Jr=>{Z.update(Jr.ref,{homeroomTeacherId:null})});const Ht=St(Xe,gt("subjectTeachers","array-contains",v.id));(await tt(Ht)).forEach(Jr=>{const Dt=Jr.data().subjectTeachers.filter(Ct=>Ct!==v.id);Z.update(Jr.ref,{subjectTeachers:Dt})}),Z.delete(ht(ce,G,v.id));const Us=We(ce,"reset_requests"),Sn=St(Us,gt("teacherId","==",v.id));(await tt(Sn)).forEach(Jr=>{Z.delete(Jr.ref)}),await Z.commit(),await lD(t,qt.USER_MANAGEMENT.middle.TEACHER,` "${v.name}"  (  )`)}else if(K==="student"){const Z=br(ce),xe=We(ce,"merit_demerit_requests"),Se=St(xe,gt("studentId","==",v.id));(await tt(Se)).forEach(Xe=>{Z.delete(Xe.ref)});const qe=We(ce,"merit_demerit_records"),Ue=St(qe,gt("studentId","==",v.id));(await tt(Ue)).forEach(Xe=>{Z.delete(Xe.ref)}),Z.delete(ht(ce,G,v.id)),await Z.commit(),await hD(t,qt.STUDENT_MANAGEMENT.middle.DELETE,` "${v.name}"  (  )`)}else await av(ht(ce,G,v.id));await Re.fire({title:" ",text:`${K==="teacher"?"  . (Firebase Auth    )":"  ."}`,icon:"success"})}st()}catch(G){await Re.fire({title:"",text:"   : "+G.message,icon:"error"})}},ui=async()=>{try{const v=We(ce,"reset_requests"),K=St(v,Zd("requestedAt","desc"));return Ko(K,J=>{const G=J.docs.map(Z=>({id:Z.id,...Z.data(),requestedAt:Z.data().requestedAt?.toDate?.()||new Date(Z.data().requestedAt),expiresAt:Z.data().expiresAt?.toDate?.()||new Date(Z.data().expiresAt)}));he(G)},J=>{})}catch{}},$f=async v=>{try{lr(v);let K=null;if(v.homeroomTeacherId||v.homeroomTeacher){const G=v.homeroomTeacherId||v.homeroomTeacher,Z=await Ys(ht(ce,"accounts",G));Z.exists()&&(K={id:Z.id,...Z.data()})}const Q=[];if(v.subjectTeachers&&v.subjectTeachers.length>0)for(const G of v.subjectTeachers){const Z=await Ys(ht(ce,"accounts",G));Z.exists()&&Q.push({id:Z.id,...Z.data()})}let J=[];if(v.grade&&v.class){const G=We(ce,"accounts"),Z=St(G,gt("role","==","student"),gt("grade","==",v.grade),gt("class","==",v.class));J=(await tt(Z)).docs.map(Se=>({id:Se.id,...Se.data()}))}sa({homeroomTeacher:K,subjectTeachers:Q,students:J}),pt(!0)}catch{await Re.fire({title:"",text:"      .",icon:"error"})}},Cu=async v=>{try{console.log(" :",v),Kr(v),await ia(v.id),Bs(!0)}catch(K){console.error("    :",K),T("      : "+K.message)}},za=async v=>{if(!v||!window.confirm(` :     !

     CSV   ?

-    
- CSV    `))return;const K=new FileReader;K.onload=async Q=>{try{const G=Q.target.result.split(`
`);if(G.length<2){alert("CSV     .");return}const Z=br(ce),xe=We(ce,"classes");(await tt(xe)).docs.forEach(Dt=>{Z.delete(Dt.ref)});const be=We(ce,"accounts");(await tt(St(be,gt("role","==","teacher")))).docs.forEach(Dt=>{Z.delete(Dt.ref)});const Ue=We(ce,"accounts");(await tt(St(Ue,gt("role","==","student")))).docs.forEach(Dt=>{Z.delete(Dt.ref)});const Xe=We(ce,"merit_demerit_records");(await tt(Xe)).docs.forEach(Dt=>{Z.delete(Dt.ref)});const et=We(ce,"reset_requests");(await tt(et)).docs.forEach(Dt=>{Z.delete(Dt.ref)}),await Z.commit();let pr=0,Us=0,Sn="",gr=[],Jr=[],gn=[];for(let Dt=0;Dt<G.length;Dt++){const Ct=G[Dt].trim();if(Ct!==""){if(Ct.includes("=== ")){Sn="class";continue}else if(Ct.includes(" ")){Sn="student";continue}else if(Ct.includes(" ")){Sn="teacher";continue}if(Sn==="class"&&Ct.includes(",")){const Qt=Ct.split(",");if(Qt.length>=3){const[An,xn,wn]=Qt;An&&xn&&wn&&An!==" "&&gr.push({name:An.trim(),grade:parseInt(xn),class:parseInt(wn),students:[],createdAt:new Date,updatedAt:new Date})}}else if(Sn==="student"&&Ct.includes(",")){const Qt=Ct.split(",");if(Qt.length>=6){const[An,xn,wn,xt,Le,ze]=Qt;An&&xn&&An!==""&&gn.push({studentId:An.trim(),name:xn.trim(),grade:parseInt(wn),class:parseInt(xt),number:parseInt(Le),birthDate:ze.trim(),role:"student",createdAt:new Date,updatedAt:new Date})}}}}for(const Dt of gr)await Rn(We(ce,"classes"),Dt);for(const Dt of gn)await Rn(We(ce,"accounts"),Dt);st(),alert(`  .
: ${gr.length}, : ${gn.length}`)}catch(J){console.error("CSV  :",J),alert("CSV    : "+J.message)}},K.readAsText(v)},Ha=v=>{if(!v)return"-";const K=f.find(Q=>Q.id===v);return K?`${K.name} (${K.email})`:v},[Qr,Ga]=$e.useState({key:"createdAt",direction:"desc"}),hs=v=>{Ga(K=>({key:v,direction:K.key===v&&K.direction==="asc"?"desc":"asc"}))},Xc=$e.useMemo(()=>!y||y.length===0?[]:[...y].sort((v,K)=>{const{key:Q,direction:J}=Qr;let G,Z;switch(Q){case"studentName":G=v.studentName||"",Z=K.studentName||"";break;case"processedTeacher":G=v.processedTeacherName||v.teacherName||v.creatorName||"",Z=K.processedTeacherName||K.teacherName||K.creatorName||"";break;case"requestingTeacher":G=v.requestingTeacherName||"",Z=K.requestingTeacherName||"";break;case"points":G=v.points||0,Z=K.points||0;break;case"cumulativeScore":const xe=w.find(Ue=>Ue.id===v.studentId),Se=w.find(Ue=>Ue.id===K.studentId);G=xe?.cumulativeScore||0,Z=Se?.cumulativeScore||0;break;case"status":G=v.status||"",Z=K.status||"";break;case"createdAt":default:const be=v.createdAt?.toDate?.()||new Date(v.createdAt||0),qe=K.createdAt?.toDate?.()||new Date(K.createdAt||0);G=be,Z=qe;break}return G<Z?J==="asc"?-1:1:G>Z?J==="asc"?1:-1:0}),[y,Qr,w]),Kc=[{text:" ",icon:m.jsx(xE,{}),value:0},{text:" ",icon:m.jsx(fp,{}),value:1},{text:" ",icon:m.jsx(dp,{}),value:2},{text:" ",icon:m.jsx(wE,{}),value:3},{text:" ",icon:m.jsx(vE,{}),value:4},{text:"   ",icon:m.jsx(_E,{}),value:5}];return!t||t.role!=="super_admin"?null:W?m.jsx(Ge,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh"},children:m.jsx(_e,{variant:"h6",children:"  ..."})}):z?m.jsxs(Ge,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"100vh",p:3},children:[m.jsx(_e,{variant:"h6",color:"error",gutterBottom:!0,children:" "}),m.jsx(_e,{variant:"body1",color:"text.secondary",align:"center",gutterBottom:!0,children:z}),m.jsx(nt,{variant:"contained",onClick:()=>window.location.reload(),sx:{mt:2},children:" "})]}):m.jsxs(Ge,{sx:{display:"flex",minHeight:"100vh",maxWidth:"100vw",overflowX:"hidden"},children:[_&&m.jsx(oa,{onClick:l,sx:{position:"fixed",top:16,left:16,zIndex:1300,backgroundColor:"white",boxShadow:2,"&:hover":{backgroundColor:"grey.100"}},children:m.jsx(lE,{})}),m.jsxs(uE,{variant:_?"temporary":"permanent",open:ct,onClose:l,sx:{width:R?200:S?240:280,flexShrink:0,"& .MuiDrawer-paper":{width:R?200:S?240:280,boxSizing:"border-box",backgroundColor:k.palette.primary.main,color:"white",height:"100vh",display:"flex",flexDirection:"column"}},children:[m.jsxs(Ge,{sx:{p:R?1.5:S?2:3,textAlign:"center"},children:[m.jsx(Ge,{sx:{mb:2},children:m.jsx("img",{src:iD,alt:"",style:{width:"50px",height:"50px"}})}),m.jsx(_e,{variant:R?"body1":"h6",sx:{fontWeight:"bold",mb:1},children:" "}),m.jsx(_e,{variant:R?"caption":"body2",sx:{opacity:.8},children:t.name})]}),m.jsx(Hf,{sx:{backgroundColor:"rgba(255,255,255,0.2)"}}),m.jsx(hE,{sx:{mt:2,flexGrow:1,overflowY:"auto","&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-track":{background:"rgba(255,255,255,0.1)"},"&::-webkit-scrollbar-thumb":{background:"rgba(255,255,255,0.3)",borderRadius:"3px"},"&::-webkit-scrollbar-thumb:hover":{background:"rgba(255,255,255,0.5)"}},children:Kc.map(v=>m.jsx(fE,{disablePadding:!0,children:m.jsxs(dE,{onClick:()=>s(v.value),selected:n===v.value,sx:{"&.Mui-selected":{backgroundColor:"rgba(255,255,255,0.1)"},"&:hover":{backgroundColor:"rgba(255,255,255,0.05)"}},children:[m.jsx(mE,{sx:{color:"white",minWidth:40},children:v.icon}),m.jsx(pE,{primary:v.text})]})},v.text))}),m.jsx(Hf,{sx:{backgroundColor:"rgba(255,255,255,0.2)",my:2}}),m.jsxs(Ge,{sx:{p:2,mt:"auto"},children:[m.jsx("input",{accept:".xlsx",style:{display:"none"},id:"csv-overwrite-pc",type:"file",onChange:v=>{v.target.files&&v.target.files[0]&&za(v.target.files[0])}}),m.jsx(nt,{fullWidth:!0,variant:"outlined",startIcon:m.jsx(gE,{}),onClick:Vo,sx:{color:"white",borderColor:"white","&:hover":{borderColor:"white",backgroundColor:"rgba(255,255,255,0.1)"}},children:""})]})]}),m.jsxs(Ge,{sx:{flexGrow:1,overflow:"auto",p:_?1:3,display:"flex",overflowX:"hidden",flexDirection:"column",alignItems:"center",width:"100%",maxWidth:"100%"},children:[m.jsx(Ge,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,width:"100%",maxWidth:"100%",mt:_?6:0},children:m.jsxs(_e,{variant:_?"h6":"h5",component:"h1",sx:{fontWeight:"bold"},children:[t.name," "]})}),m.jsxs(Tt,{container:!0,spacing:_?1:3,sx:{mb:2,width:"100%",maxWidth:"100%"},children:[m.jsx(Tt,{xs:12,sm:4,children:m.jsx(In,{children:m.jsxs(Cn,{sx:{textAlign:"center",p:_?1.5:2},children:[m.jsx(Gf,{sx:{fontSize:_?30:40,color:"primary.main",mb:1}}),m.jsx(_e,{variant:_?"h6":"h5",children:h.length}),m.jsx(_e,{color:"text.secondary",variant:_?"caption":"body2",children:"  "})]})})}),m.jsx(Tt,{xs:12,sm:4,children:m.jsx(In,{children:m.jsxs(Cn,{sx:{textAlign:"center",p:_?1.5:2},children:[m.jsx(fp,{sx:{fontSize:_?30:40,color:"secondary.main",mb:1}}),m.jsx(_e,{variant:_?"h6":"h5",children:f.length}),m.jsx(_e,{color:"text.secondary",variant:_?"caption":"body2",children:"  "})]})})}),m.jsx(Tt,{xs:12,sm:4,children:m.jsx(In,{children:m.jsxs(Cn,{sx:{textAlign:"center",p:_?1.5:2},children:[m.jsx(dp,{sx:{fontSize:_?30:40,color:"success.main",mb:1}}),m.jsx(_e,{variant:_?"h6":"h5",children:w.length}),m.jsx(_e,{color:"text.secondary",variant:_?"caption":"body2",children:"  "})]})})})]}),n===0&&m.jsxs(Ge,{sx:{width:"100%",maxWidth:"100%",minWidth:"100%",mt:1},children:[m.jsxs(Ge,{sx:{display:"flex",flexDirection:_?"column":"row",justifyContent:"space-between",alignItems:_?"stretch":"center",mb:2,gap:_?1:0},children:[m.jsx($r,{label:" ",variant:"outlined",size:"small",value:se,onChange:v=>Ye(v.target.value),placeholder:", ,  ",sx:{minWidth:_?"100%":300}}),m.jsx(nt,{variant:"contained",startIcon:m.jsx(qf,{}),onClick:()=>Fe(!0),size:R||S?"small":"medium",fullWidth:_,children:" "})]}),m.jsx("div",{className:"table-scroll-container",children:m.jsx(Ya,{component:ua,children:m.jsxs(Qa,{children:[m.jsx(Ja,{children:m.jsxs(on,{children:[m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem"},onClick:()=>oe("name"),children:[" ",L.key==="name"&&(L.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},onClick:()=>oe("homeroomTeacher"),children:[" ",L.key==="homeroomTeacher"&&(L.direction==="asc"?"":"")]}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},children:""}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem"},onClick:()=>oe("students"),children:["  ",L.key==="students"&&(L.direction==="asc"?"":"")]}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:" "}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:""})]})}),m.jsx(Za,{children:yu.map(v=>m.jsxs(on,{children:[m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:m.jsx(nt,{variant:"text",onClick:()=>$f(v),sx:{textTransform:"none",fontWeight:"bold",color:"primary.main","&:hover":{textDecoration:"underline"},fontSize:_?"0.75rem":"0.875rem",p:_?.5:1},children:v.name})}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},children:Ha(v.homeroomTeacher)}),m.jsxs(Te,{sx:{fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},children:[v.subjectTeachers?.length||0,""]}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:`${w.filter(Q=>Q.grade===v.grade&&Q.class===v.class).length}`}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:m.jsx(an,{label:`${Hc(v)}`,color:Hc(v)>=0?"success":"error",size:"small"})}),m.jsxs(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:[m.jsx(oa,{size:"small",color:"primary",onClick:()=>Gc(v,"class"),children:m.jsx(Xf,{fontSize:_?"small":"medium"})}),m.jsx(oa,{size:"small",color:"error",onClick:()=>qc(v,"class"),children:m.jsx(Kf,{fontSize:_?"small":"medium"})})]})]},v.id))})]})})})]}),n===1&&m.jsxs(Ge,{sx:{width:"100%",maxWidth:"100%",minWidth:"100%",mt:1},children:[m.jsxs(Ge,{sx:{display:"flex",flexDirection:_?"column":"row",justifyContent:"space-between",alignItems:_?"stretch":"center",mb:2,gap:_?1:0},children:[m.jsx($r,{label:" ",variant:"outlined",size:"small",value:Je,onChange:v=>V(v.target.value),placeholder:", ,  ",sx:{minWidth:_?"100%":300}}),m.jsx(nt,{variant:"contained",startIcon:m.jsx(qf,{}),onClick:()=>je(!0),fullWidth:_,children:" "})]}),m.jsx("div",{className:"table-scroll-container",children:m.jsx(Ya,{component:ua,children:m.jsxs(Qa,{children:[m.jsx(Ja,{children:m.jsxs(on,{children:[m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem"},onClick:()=>te("name"),children:[" ",N.key==="name"&&(N.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},onClick:()=>te("email"),children:[" ",N.key==="email"&&(N.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem"},onClick:()=>te("role"),children:[" ",N.key==="role"&&(N.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},onClick:()=>te("subject"),children:["  ",N.key==="subject"&&(N.direction==="asc"?"":"")]}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},children:" "}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:""})]})}),m.jsx(Za,{children:js.map(v=>{const K=v.role==="homeroom_teacher"?h.find(J=>J.homeroomTeacher===v.id):null,Q=v.role==="subject_teacher"?h.filter(J=>J.subjectTeachers&&J.subjectTeachers.includes(v.id)):[];return m.jsxs(on,{children:[m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:v.name}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},children:v.email}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:m.jsx(an,{label:v.role==="homeroom_teacher"?"":"",color:v.role==="homeroom_teacher"?"primary":"secondary",size:"small"})}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},children:v.subject||"-"}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},children:v.role==="homeroom_teacher"?K?K.name:" ":Q.length>0?Q.sort((J,G)=>J.grade!==G.grade?J.grade-G.grade:J.class-G.class).map(J=>J.name).join(", "):" "}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:m.jsxs(Ge,{sx:{display:"flex",gap:1},children:[m.jsx(oa,{size:"small",color:"primary",onClick:()=>Gc(v,"teacher"),title:"",children:m.jsx(Xf,{fontSize:_?"small":"medium"})}),m.jsx(oa,{size:"small",color:"warning",onClick:async()=>{console.log("   :",v.email);const{value:J}=await Re.fire({title:" ",text:`${v.name}(${v.email})   ?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ff9800",cancelButtonColor:"#d33",confirmButtonText:"",cancelButtonText:"",customClass:{container:"swal2-container-high-z"}});J&&await _u(v.email)},title:" ",children:m.jsx(Yf,{fontSize:_?"small":"medium"})}),m.jsx(oa,{size:"small",color:"error",onClick:()=>qc(v,"teacher"),title:"",children:m.jsx(Kf,{fontSize:_?"small":"medium"})})]})})]},v.id)})})]})})})]}),n===2&&m.jsxs(Ge,{sx:{width:"100%",maxWidth:"100%",minWidth:"100%",mt:1},children:[m.jsxs(Ge,{sx:{display:"flex",flexDirection:_?"column":"row",justifyContent:"space-between",alignItems:_?"stretch":"center",mb:2,gap:_?1:2},children:[m.jsxs(Ge,{sx:{display:"flex",flexDirection:_?"column":"row",gap:_?1:2,alignItems:_?"stretch":"center"},children:[m.jsx($r,{label:" ",variant:"outlined",size:"small",value:Y,onChange:v=>q(v.target.value),placeholder:", ,  ",sx:{minWidth:_?"100%":300}}),m.jsx("input",{accept:".xlsx",style:{display:"none"},id:"xlsx-upload-pc",type:"file",onChange:v=>Iu(v.target.files[0])}),m.jsx("label",{htmlFor:"xlsx-upload-pc",children:m.jsx(nt,{variant:"outlined",component:"span",startIcon:m.jsx(qa,{}),size:R||S?"small":"medium",fullWidth:_,children:"XLSX "})})]}),m.jsx(nt,{variant:"contained",startIcon:m.jsx(qf,{}),onClick:()=>{De({name:"",studentId:"",grade:"",class:"",number:"",birthDate:"",homeroomTeacherId:"",homeroomTeacherName:""}),_t(!0)},size:R||S?"small":"medium",fullWidth:_,children:" "})]}),m.jsx("div",{className:"table-scroll-container",children:m.jsx(Ya,{component:ua,children:m.jsxs(Qa,{children:[m.jsx(Ja,{children:m.jsxs(on,{children:[m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},onClick:()=>ne("studentId"),children:[" ",M.key==="studentId"&&(M.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem"},onClick:()=>ne("name"),children:[" ",M.key==="name"&&(M.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem"},onClick:()=>ne("grade"),children:["// ",M.key==="grade"&&(M.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},onClick:()=>ne("birthDate"),children:[" ",M.key==="birthDate"&&(M.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem"},onClick:()=>ne("cumulativeScore"),children:["  ",M.key==="cumulativeScore"&&(M.direction==="asc"?"":"")]}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:""})]})}),m.jsx(Za,{children:Bo.map(v=>m.jsxs(on,{children:[m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},children:m.jsx(nt,{variant:"text",onClick:()=>Cu(v),sx:{textTransform:"none",fontWeight:"bold",color:"primary.main","&:hover":{textDecoration:"underline"},fontSize:_?"0.75rem":"0.875rem",p:_?.5:1,minWidth:"auto"},children:v.studentId})}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:m.jsx(nt,{variant:"text",onClick:()=>Cu(v),sx:{textTransform:"none",fontWeight:"bold",color:"primary.main","&:hover":{textDecoration:"underline"},fontSize:_?"0.75rem":"0.875rem",p:_?.5:1,minWidth:"auto"},children:v.name})}),m.jsxs(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:[v.grade," ",v.class," ",v.number,""]}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},children:v.birthDate}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:m.jsx(an,{label:v.cumulativeScore||0,color:v.cumulativeScore>0?"success":v.cumulativeScore<0?"error":"default",size:"small",sx:{fontWeight:"bold",minWidth:"40px"}})}),m.jsxs(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:[m.jsx(oa,{size:"small",color:"primary",onClick:()=>Gc(v,"student"),children:m.jsx(Xf,{fontSize:_?"small":"medium"})}),m.jsx(oa,{size:"small",color:"error",onClick:()=>qc(v,"student"),children:m.jsx(Kf,{fontSize:_?"small":"medium"})})]})]},v.id))})]})})})]}),n===3&&m.jsxs(Ge,{sx:{width:"100%",maxWidth:"100%",minWidth:"100%"},children:[m.jsxs(Ge,{sx:{display:"flex",flexDirection:_?"column":"row",justifyContent:"space-between",alignItems:_?"stretch":"center",mb:2,width:"100%",gap:_?1:0},children:[m.jsx($r,{label:" ",variant:"outlined",size:"small",placeholder:", ,  ",sx:{minWidth:_?"100%":300,maxWidth:_?"100%":"60%"}}),m.jsxs(Ge,{sx:{display:"flex",flexDirection:"row",gap:1},children:[m.jsx(nt,{variant:"outlined",size:R||S?"small":"medium",fullWidth:_,children:""}),m.jsx(nt,{variant:"outlined",size:R||S?"small":"medium",fullWidth:_,children:""}),m.jsx(nt,{variant:"outlined",size:R||S?"small":"medium",fullWidth:_,children:" "})]})]}),m.jsx(cD,{})]}),n===4&&m.jsxs(Ge,{sx:{width:"100%",maxWidth:"100%",minWidth:"100%",mt:1},children:[m.jsx(_e,{variant:_?"h6":"h5",sx:{mb:2,fontWeight:"bold"},children:" "}),m.jsx("div",{className:"table-scroll-container",children:m.jsx(Ya,{component:ua,children:m.jsxs(Qa,{children:[m.jsx(Ja,{children:m.jsxs(on,{children:[m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem",fontWeight:"bold"},onClick:()=>hs("studentName"),children:["  ",Qr.key==="studentName"&&(Qr.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem",fontWeight:"bold",display:_?"none":"table-cell"},onClick:()=>hs("processedTeacher"),children:["  ",Qr.key==="processedTeacher"&&(Qr.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem",fontWeight:"bold",display:_?"none":"table-cell"},onClick:()=>hs("requestingTeacher"),children:["  ",Qr.key==="requestingTeacher"&&(Qr.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem",fontWeight:"bold"},onClick:()=>hs("points"),children:["  ",Qr.key==="points"&&(Qr.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem",fontWeight:"bold"},onClick:()=>hs("cumulativeScore"),children:["  ",Qr.key==="cumulativeScore"&&(Qr.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem",fontWeight:"bold"},onClick:()=>hs("status"),children:[" ",Qr.key==="status"&&(Qr.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none",fontSize:_?"0.75rem":"0.875rem",fontWeight:"bold",display:_?"none":"table-cell"},onClick:()=>hs("createdAt"),children:[" ",Qr.key==="createdAt"&&(Qr.direction==="asc"?"":"")]})]})}),m.jsx(Za,{children:Xc.length===0?m.jsx(on,{children:m.jsx(Te,{colSpan:7,align:"center",sx:{fontSize:_?"0.75rem":"0.875rem"},children:"  ."})}):Xc.map(v=>{const K=w.find(J=>J.id===v.studentId),Q=K?.cumulativeScore||0;return m.jsxs(on,{children:[m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:m.jsx(nt,{variant:"text",onClick:()=>{a(v),c(!0)},sx:{textTransform:"none",fontWeight:"bold",color:"primary.main","&:hover":{textDecoration:"underline"},fontSize:_?"0.75rem":"0.875rem",p:_?.5:1},children:v.studentName||K?.name||"  "})}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},children:v.processedTeacherName||v.teacherName||v.creatorName||"N/A"}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},children:v.requestingTeacherName||"-"}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:m.jsx(an,{label:v.points>0?`+${v.points}`:v.points,color:v.points>0?"success":"error",size:"small"})}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:m.jsx(an,{label:Q,color:Q>0?"success":Q<0?"error":"default",size:"small"})}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem"},children:m.jsx(an,{label:v.status==="approved"?"":v.status==="rejected"?"":v.status==="pending"?"":"",color:v.status==="approved"?"success":v.status==="rejected"?"error":v.status==="pending"?"warning":"default",size:"small"})}),m.jsx(Te,{sx:{fontSize:_?"0.75rem":"0.875rem",display:_?"none":"table-cell"},children:v.createdAt?.toDate?.()?new Date(v.createdAt.toDate()).toLocaleString("ko-KR"):v.createdAt?new Date(v.createdAt).toLocaleString("ko-KR"):"N/A"})]},v.id)})})]})})})]}),n===5&&m.jsxs(Ge,{sx:{width:"100%",maxWidth:"100%",minWidth:"100%"},children:[m.jsxs(Ge,{sx:{display:"flex",flexDirection:_?"column":"row",justifyContent:"space-between",alignItems:_?"stretch":"center",mb:2,gap:_?1:0},children:[m.jsx(_e,{variant:_?"h6":"h5",sx:{color:"#d32f2f",fontWeight:"bold"},children:"    "}),m.jsxs(Ge,{sx:{display:"flex",flexDirection:"row",gap:1},children:[m.jsx(nt,{variant:"outlined",color:"error",size:R||S?"small":"medium",fullWidth:_,children:" "}),m.jsx(nt,{variant:"outlined",color:"error",size:R||S?"small":"medium",fullWidth:_,children:" "})]})]}),m.jsxs(Uo,{severity:"warning",sx:{mb:3},children:[m.jsx(_e,{variant:_?"body1":"h6",gutterBottom:!0,children:"   "}),m.jsx(_e,{variant:"body2",children:"         .        ."})]}),m.jsx(Ge,{sx:{overflowX:"auto",overflowY:"hidden",mb:3,"&::-webkit-scrollbar":{height:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#f1f1f1",borderRadius:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#888",borderRadius:"4px"},"&::-webkit-scrollbar-thumb:hover":{backgroundColor:"#555"}},children:m.jsxs(Ge,{sx:{display:"flex",gap:2,minWidth:_?"max-content":"auto",pb:1},children:[m.jsx(In,{sx:{minWidth:_?"300px":"auto",flex:_?"0 0 auto":"1 1 0",height:"100%",border:"2px solid #d32f2f"},children:m.jsxs(Cn,{sx:{p:_?2:3},children:[m.jsxs(Ge,{sx:{display:"flex",alignItems:"center",mb:2},children:[m.jsx(Du,{sx:{color:"#d32f2f",mr:1,fontSize:_?24:28}}),m.jsx(_e,{variant:_?"body1":"h6",sx:{color:"#d32f2f",fontWeight:"bold"},children:"  "})]}),m.jsx(_e,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"      ."}),m.jsxs(Ge,{sx:{mb:2},children:[m.jsx(_e,{variant:"subtitle2",gutterBottom:!0,children:" :"}),m.jsxs("ul",{style:{margin:0,paddingLeft:20},children:[m.jsx("li",{children:"  "}),m.jsx("li",{children:"  "}),m.jsx("li",{children:"   "})]})]}),m.jsxs(_e,{variant:"body2",color:"error",sx:{mb:2,fontWeight:"bold"},children:["  : ",w.length,""]}),m.jsx(nt,{variant:"contained",color:"error",fullWidth:!0,startIcon:m.jsx(Du,{}),onClick:Tu,sx:{fontWeight:"bold","&:hover":{backgroundColor:"#b71c1c"}},size:_?"small":"medium",children:"  "})]})}),m.jsx(In,{sx:{minWidth:_?"300px":"auto",flex:_?"0 0 auto":"1 1 0",height:"100%",border:"2px solid #d32f2f"},children:m.jsxs(Cn,{sx:{p:_?2:3},children:[m.jsxs(Ge,{sx:{display:"flex",alignItems:"center",mb:2},children:[m.jsx(Du,{sx:{color:"#d32f2f",mr:1,fontSize:_?24:28}}),m.jsx(_e,{variant:_?"body1":"h6",sx:{color:"#d32f2f",fontWeight:"bold"},children:"  "})]}),m.jsx(_e,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"      ."}),m.jsxs(Ge,{sx:{mb:2},children:[m.jsx(_e,{variant:"subtitle2",gutterBottom:!0,children:" :"}),m.jsxs("ul",{style:{margin:0,paddingLeft:20},children:[m.jsx("li",{children:"   (  )"}),m.jsx("li",{children:" /  "}),m.jsx("li",{children:"   "})]})]}),m.jsxs(_e,{variant:"body2",color:"error",sx:{mb:2,fontWeight:"bold"},children:["  : ",f.filter(v=>v.role!=="super_admin").length,""]}),m.jsx(nt,{variant:"contained",color:"error",fullWidth:!0,startIcon:m.jsx(Du,{}),onClick:Uf,sx:{fontWeight:"bold","&:hover":{backgroundColor:"#b71c1c"}},size:_?"small":"medium",children:"  "})]})}),m.jsx(In,{sx:{minWidth:_?"300px":"auto",flex:_?"0 0 auto":"1 1 0",height:"100%",border:"2px solid #ff9800"},children:m.jsxs(Cn,{sx:{p:_?2:3},children:[m.jsxs(Ge,{sx:{display:"flex",alignItems:"center",mb:2},children:[m.jsx(Yf,{sx:{color:"#ff9800",mr:1,fontSize:_?24:28}}),m.jsx(_e,{variant:_?"body1":"h6",sx:{color:"#ff9800",fontWeight:"bold"},children:"  "})]}),m.jsx(_e,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"     ."}),m.jsxs(Ge,{sx:{mb:2},children:[m.jsx(_e,{variant:"subtitle2",gutterBottom:!0,children:" :"}),m.jsxs("ul",{style:{margin:0,paddingLeft:20},children:[m.jsx("li",{children:"  "}),m.jsx("li",{children:"  "}),m.jsx("li",{children:"  "})]})]}),m.jsxs(_e,{variant:"body2",color:"warning.main",sx:{mb:2,fontWeight:"bold"},children:["   : ",y.length,""]}),m.jsx(nt,{variant:"contained",color:"warning",fullWidth:!0,startIcon:m.jsx(Yf,{}),onClick:Wf,sx:{fontWeight:"bold",backgroundColor:"#ff9800","&:hover":{backgroundColor:"#f57c00"}},size:_?"small":"medium",children:"  "})]})}),m.jsx(In,{sx:{minWidth:_?"300px":"auto",flex:_?"0 0 auto":"1 1 0",height:"100%",border:"2px solid #1976d2"},children:m.jsxs(Cn,{sx:{p:_?2:3},children:[m.jsxs(Ge,{sx:{display:"flex",alignItems:"center",mb:2},children:[m.jsx(Gf,{sx:{color:"#1976d2",mr:1,fontSize:_?24:28}}),m.jsx(_e,{variant:_?"body1":"h6",sx:{color:"#1976d2",fontWeight:"bold"},children:" "})]}),m.jsx(_e,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"      ."}),m.jsxs(Ge,{sx:{mb:2},children:[m.jsx(_e,{variant:"subtitle2",gutterBottom:!0,children:":"}),m.jsxs("ul",{style:{margin:0,paddingLeft:20},children:[m.jsx("li",{children:"  "}),m.jsx("li",{children:"  "}),m.jsx("li",{children:"  "}),m.jsx("li",{children:" "})]})]}),m.jsx(nt,{variant:"contained",color:"primary",fullWidth:!0,startIcon:m.jsx(Gf,{}),onClick:()=>{cs(!0),setTimeout(()=>{const v=document.getElementById("new-semester-upload-trigger");v&&(v.onclick=()=>{document.getElementById("new-semester-upload")?.click()})},100)},sx:{fontWeight:"bold","&:hover":{backgroundColor:"#1565c0"}},size:_?"small":"medium",children:" "}),m.jsx("input",{accept:".xlsx",style:{display:"none"},id:"new-semester-upload-inline",type:"file",onChange:v=>{v.target.files&&v.target.files[0]&&Ts(v.target.files[0])}}),m.jsx("label",{htmlFor:"new-semester-upload-inline",children:m.jsx(nt,{variant:"outlined",color:"primary",component:"span",startIcon:m.jsx(qa,{}),fullWidth:!0,sx:{mt:1},size:_?"small":"medium",children:"   "})})]})})]})}),m.jsx(_e,{variant:_?"body1":"h6",gutterBottom:!0,sx:{mt:4,mb:2,color:"#1976d2"},children:"   "}),m.jsx(Ge,{sx:{overflowX:"auto",overflowY:"hidden",mb:4,"&::-webkit-scrollbar":{height:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#f1f1f1",borderRadius:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#888",borderRadius:"4px"},"&::-webkit-scrollbar-thumb:hover":{backgroundColor:"#555"}},children:m.jsxs(Ge,{sx:{display:"flex",gap:2,minWidth:_?"max-content":"auto",pb:1},children:[m.jsx(In,{sx:{minWidth:_?"300px":"auto",flex:_?"0 0 auto":"1 1 0",height:"100%",border:"1px solid #1976d2"},children:m.jsxs(Cn,{sx:{p:_?2:3},children:[m.jsx(Ge,{sx:{display:"flex",alignItems:"center",mb:2},children:m.jsx(_e,{variant:_?"body1":"h6",sx:{color:"#1976d2",fontWeight:"bold"},children:" "})}),m.jsx(Ge,{sx:{mb:2},children:F.filter(v=>v.type==="merit").map(v=>m.jsx(an,{label:v.reason,color:"success",size:"small",sx:{mr:1,mb:1}},v.id))}),m.jsx(nt,{variant:"outlined",color:"primary",onClick:()=>{Ur({type:"merit",reason:""}),ut(!0)},size:"small",fullWidth:_,children:"  "})]})}),m.jsx(In,{sx:{minWidth:_?"300px":"auto",flex:_?"0 0 auto":"1 1 0",height:"100%",border:"1px solid #d32f2f"},children:m.jsxs(Cn,{sx:{p:_?2:3},children:[m.jsx(Ge,{sx:{display:"flex",alignItems:"center",mb:2},children:m.jsx(_e,{variant:_?"body1":"h6",sx:{color:"#d32f2f",fontWeight:"bold"},children:" "})}),m.jsx(Ge,{sx:{mb:2},children:F.filter(v=>v.type==="demerit").map(v=>m.jsx(an,{label:v.reason,color:"error",size:"small",sx:{mr:1,mb:1}},v.id))}),m.jsx(nt,{variant:"outlined",color:"error",onClick:()=>{Ur({type:"demerit",reason:""}),ut(!0)},size:"small",fullWidth:_,children:"  "})]})})]})}),m.jsx(_e,{variant:_?"body1":"h6",gutterBottom:!0,sx:{mt:4,mb:2,color:"#1976d2"},children:" CSV  "}),m.jsx(Ge,{sx:{overflowX:"auto",overflowY:"hidden",mb:3,"&::-webkit-scrollbar":{height:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#f1f1f1",borderRadius:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#888",borderRadius:"4px"},"&::-webkit-scrollbar-thumb:hover":{backgroundColor:"#555"}},children:m.jsxs(Ge,{sx:{display:"flex",gap:2,minWidth:_?"max-content":"auto",pb:1},children:[m.jsx(In,{sx:{minWidth:_?"300px":"auto",flex:_?"0 0 auto":"1 1 0",height:"100%",border:"1px solid #1976d2"},children:m.jsxs(Cn,{sx:{p:_?2:3},children:[m.jsxs(Ge,{sx:{display:"flex",alignItems:"center",mb:2},children:[m.jsx(mp,{sx:{color:"#1976d2",mr:1,fontSize:_?24:28}}),m.jsx(_e,{variant:_?"body1":"h6",sx:{color:"#1976d2",fontWeight:"bold"},children:" "})]}),m.jsx(_e,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"   CSV  ."}),m.jsxs(Ge,{sx:{display:"flex",flexDirection:"column",gap:1},children:[m.jsx(nt,{variant:"outlined",color:"primary",startIcon:m.jsx(Pu,{}),onClick:Au,fullWidth:!0,size:_?"small":"medium",children:"  "}),m.jsx(nt,{variant:"outlined",color:"primary",startIcon:m.jsx(Pu,{}),onClick:ku,fullWidth:!0,size:_?"small":"medium",children:"  "}),m.jsx(nt,{variant:"outlined",color:"primary",startIcon:m.jsx(Pu,{}),onClick:bu,fullWidth:!0,size:_?"small":"medium",children:"  "}),m.jsx(nt,{variant:"contained",color:"primary",startIcon:m.jsx(mp,{}),onClick:aa,fullWidth:!0,sx:{mt:1,fontWeight:"bold"},size:_?"small":"medium",children:"  "})]})]})}),m.jsx(In,{sx:{minWidth:_?"300px":"auto",flex:_?"0 0 auto":"1 1 0",height:"100%",border:"1px solid #ff9800"},children:m.jsxs(Cn,{sx:{p:_?2:3},children:[m.jsxs(Ge,{sx:{display:"flex",alignItems:"center",mb:2},children:[m.jsx(qa,{sx:{color:"#ff9800",mr:1,fontSize:_?24:28}}),m.jsx(_e,{variant:_?"body1":"h6",sx:{color:"#ff9800",fontWeight:"bold"},children:" "})]}),m.jsx(_e,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"CSV     ."}),m.jsxs(Ge,{sx:{display:"flex",flexDirection:"column",gap:1},children:[m.jsx("input",{accept:".xlsx",style:{display:"none"},id:"csv-upload-admin-2",type:"file",onChange:v=>Iu(v.target.files[0])}),m.jsx("label",{htmlFor:"csv-upload-admin-2",children:m.jsx(nt,{variant:"outlined",color:"warning",startIcon:m.jsx(qa,{}),component:"span",fullWidth:!0,size:_?"small":"medium",children:"  "})}),m.jsx("input",{accept:".xlsx",style:{display:"none"},id:"csv-overwrite-admin-2",type:"file",onChange:v=>za(v.target.files[0])}),m.jsx("label",{htmlFor:"csv-overwrite-admin-2",children:m.jsx(nt,{variant:"outlined",color:"error",startIcon:m.jsx(qa,{}),component:"span",fullWidth:!0,size:_?"small":"medium",children:"  "})})]})]})})]})}),m.jsx(In,{sx:{mt:3,backgroundColor:"#fff3e0"},children:m.jsxs(Cn,{sx:{p:_?2:3},children:[m.jsx(_e,{variant:_?"body1":"h6",gutterBottom:!0,sx:{color:"#e65100"},children:"   "}),m.jsxs(_e,{variant:"body2",color:"text.secondary",children:["       ",m.jsx("br",{}),"    ",m.jsx("br",{}),"    ",m.jsx("br",{}),"     ",m.jsx("br",{})," CSV       "]})]})})]}),m.jsxs(Ws,{open:P,onClose:()=>{Fe(!1),es(null),ge({grade:"",class:"",name:"",homeroomTeacher:"",subjectTeachers:[]})},maxWidth:"md",fullWidth:!0,children:[m.jsx($s,{children:Ut?" ":" "}),m.jsx(zs,{children:m.jsxs(Ge,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1,maxWidth:"500px",mx:"auto"},children:[m.jsxs(Ge,{children:[m.jsx(_e,{variant:"subtitle2",color:"text.secondary",sx:{mb:1},children:""}),m.jsx(_e,{variant:"h6",sx:{fontWeight:"bold",color:"primary.main",p:2,backgroundColor:"#f5f5f5",borderRadius:1,border:"1px solid #e0e0e0"},children:H.name||(H.grade&&H.class?`${H.grade} ${H.class}`:"    ")}),m.jsx(_e,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:"    "})]}),m.jsx($r,{fullWidth:!0,label:"",type:"number",value:H.grade||"",onChange:v=>ge({...H,grade:parseInt(v.target.value)}),required:!0,size:"medium"}),m.jsx($r,{fullWidth:!0,label:"",type:"number",value:H.class||"",onChange:v=>ge({...H,class:parseInt(v.target.value)}),required:!0,size:"medium"}),m.jsxs(qs,{fullWidth:!0,children:[m.jsx(Xs,{children:""}),m.jsxs(Ks,{value:H.homeroomTeacher||"",onChange:v=>ge({...H,homeroomTeacher:v.target.value}),label:"",size:"medium",children:[m.jsx(Nr,{value:"",children:" "}),f.filter(v=>v.role==="homeroom_teacher").map(v=>m.jsx(Nr,{value:v.id,children:v.name},v.id))]})]}),m.jsxs(qs,{fullWidth:!0,children:[m.jsx(Xs,{children:"  (  )"}),m.jsx(Ks,{multiple:!0,value:H.subjectTeachers||[],onChange:v=>ge({...H,subjectTeachers:v.target.value}),label:"  (  )",size:"medium",children:f.filter(v=>v.role==="subject_teacher").map(v=>m.jsxs(Nr,{value:v.id,children:[v.name," (",v.subject||" ",")"]},v.id))})]})]})}),m.jsxs(Hs,{children:[m.jsx(nt,{onClick:()=>{Fe(!1),es(null),ge({grade:"",class:"",name:"",homeroomTeacher:"",subjectTeachers:[]})},children:""}),m.jsx(nt,{onClick:Ut?Eu:nr,variant:"contained",children:Ut?"":""})]})]}),m.jsxs(Ws,{open:Ie,onClose:()=>je(!1),maxWidth:"md",fullWidth:!0,children:[m.jsx($s,{children:Ut?" ":" "}),m.jsxs(zs,{children:[z&&m.jsx(Uo,{severity:"error",sx:{mb:2},children:z}),m.jsxs(Ge,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1,maxWidth:"500px",mx:"auto"},children:[m.jsx($r,{fullWidth:!0,label:"",value:de.name,onChange:v=>Be({...de,name:v.target.value}),required:!0,size:"medium"}),m.jsx($r,{fullWidth:!0,label:"",type:"email",value:de.email,onChange:Ut?void 0:v=>Be({...de,email:v.target.value}),required:!0,size:"medium",InputProps:{readOnly:!!Ut},helperText:Ut?"   .":""}),m.jsxs(qs,{fullWidth:!0,children:[m.jsx(Xs,{children:""}),m.jsxs(Ks,{value:de.role,onChange:v=>Be({...de,role:v.target.value}),label:"",size:"medium",children:[m.jsx(Nr,{value:"homeroom_teacher",children:""}),m.jsx(Nr,{value:"subject_teacher",children:""})]})]}),de.role==="subject_teacher"&&m.jsx($r,{fullWidth:!0,label:" ",value:de.subject,onChange:v=>Be({...de,subject:v.target.value}),required:!0,size:"medium"}),m.jsx($r,{fullWidth:!0,label:"",value:de.phone,onChange:v=>Be({...de,phone:v.target.value}),size:"medium"})]})]}),m.jsxs(Hs,{children:[m.jsx(nt,{onClick:()=>{je(!1),es(null)},children:""}),m.jsx(nt,{onClick:Ut?jo:ja,variant:"contained",children:Ut?"":""})]})]}),m.jsxs(Ws,{open:jt,onClose:()=>pt(!1),maxWidth:"lg",fullWidth:!0,children:[m.jsx($s,{children:"  "}),m.jsx(zs,{children:ke&&m.jsxs(Ge,{sx:{mt:2},children:[m.jsxs(Tt,{container:!0,spacing:3,children:[m.jsx(Tt,{item:!0,xs:12,children:m.jsx(_e,{variant:"h6",gutterBottom:!0,children:ke.name})}),m.jsx(Tt,{item:!0,xs:12,sm:6,children:m.jsxs(_e,{variant:"body1",gutterBottom:!0,children:[m.jsx("strong",{children:" :"})," ",Ha(ke.homeroomTeacher)]})}),m.jsx(Tt,{item:!0,xs:12,sm:6,children:m.jsxs(_e,{variant:"body1",gutterBottom:!0,children:[m.jsx("strong",{children:" :"})," ",ke.subjectTeachers?.length||0,""]})}),m.jsx(Tt,{item:!0,xs:12,children:m.jsxs(_e,{variant:"body1",gutterBottom:!0,children:[m.jsx("strong",{children:" :"})," ",`${w.filter(K=>K.grade===ke.grade&&K.class===ke.class).length}`]})})]}),m.jsx(Hf,{sx:{my:3}}),m.jsx(_e,{variant:"h6",gutterBottom:!0,children:"  "}),(()=>{const v=f.find(K=>K.id===ke.homeroomTeacher);return v?m.jsxs(Ge,{sx:{p:2,border:"1px solid #ddd",borderRadius:1,mb:2},children:[m.jsxs(_e,{variant:"body1",children:[m.jsx("strong",{children:":"})," ",v.name]}),m.jsxs(_e,{variant:"body1",children:[m.jsx("strong",{children:":"})," ",v.email]}),m.jsxs(_e,{variant:"body1",children:[m.jsx("strong",{children:":"})," ",v.phone||"-"]})]}):m.jsx(_e,{variant:"body1",color:"text.secondary",children:"   ."})})(),m.jsx(_e,{variant:"h6",gutterBottom:!0,children:"  "}),ke.subjectTeachers&&ke.subjectTeachers.length>0?m.jsx(Ge,{sx:{mb:2},children:ke.subjectTeachers.map((v,K)=>{const Q=f.find(J=>J.id===v);return Q?m.jsxs(Ge,{sx:{p:2,border:"1px solid #ddd",borderRadius:1,mb:1},children:[m.jsxs(_e,{variant:"body1",children:[m.jsx("strong",{children:":"})," ",Q.name]}),m.jsxs(_e,{variant:"body1",children:[m.jsx("strong",{children:" :"})," ",Q.subject||"-"]}),m.jsxs(_e,{variant:"body1",children:[m.jsx("strong",{children:":"})," ",Q.email]})]},v):null})}):m.jsx(_e,{variant:"body1",color:"text.secondary",children:"   ."}),m.jsx(_e,{variant:"h6",gutterBottom:!0,children:" "}),m.jsx("div",{className:"table-scroll-container",children:m.jsx(Ya,{component:ua,children:m.jsxs(Qa,{size:"small",children:[m.jsx(Ja,{children:m.jsxs(on,{children:[m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none"},onClick:()=>us("number"),children:[" ",kr.key==="number"&&(kr.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none"},onClick:()=>us("name"),children:[" ",kr.key==="name"&&(kr.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none"},onClick:()=>us("studentId"),children:[" ",kr.key==="studentId"&&(kr.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none"},onClick:()=>us("birthDate"),children:[" ",kr.key==="birthDate"&&(kr.direction==="asc"?"":"")]}),m.jsxs(Te,{sx:{cursor:"pointer",userSelect:"none"},onClick:()=>us("cumulativeScore"),children:["  ",kr.key==="cumulativeScore"&&(kr.direction==="asc"?"":"")]})]})}),m.jsx(Za,{children:(()=>{const K=[...w.filter(Q=>Q.grade===ke.grade&&Q.class===ke.class)].sort((Q,J)=>{let G=0;const Z=Q[kr.key],xe=J[kr.key];return Z==null?1:xe==null?-1:(typeof Z=="string"&&typeof xe=="string"?G=Z.localeCompare(xe,"ko-KR"):typeof Z=="number"&&typeof xe=="number"?G=Z-xe:G=String(Z).localeCompare(String(xe),"ko-KR"),kr.direction==="asc"?G:-G)});return K.length>0?K.map(Q=>m.jsxs(on,{children:[m.jsx(Te,{children:Q.number}),m.jsx(Te,{children:Q.name}),m.jsx(Te,{children:Q.studentId}),m.jsx(Te,{children:Q.birthDate}),m.jsx(Te,{children:m.jsx(an,{label:`${Q.cumulativeScore||0}`,color:Q.cumulativeScore>0?"success":Q.cumulativeScore<0?"error":"default",size:"small"})})]},Q.id)):m.jsx(on,{children:m.jsx(Te,{colSpan:5,align:"center",children:"  ."})})})()})]})})})]})}),m.jsx(Hs,{children:m.jsx(nt,{onClick:()=>pt(!1),children:""})})]}),m.jsxs(Ws,{open:Me,onClose:()=>pt(!1),maxWidth:"md",fullWidth:!0,children:[m.jsx($s,{children:Ut?" ":" "}),m.jsxs(zs,{children:[z&&m.jsx(Uo,{severity:"error",sx:{mb:2},children:z}),m.jsxs(Ge,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1,maxWidth:"500px",mx:"auto"},children:[m.jsx($r,{fullWidth:!0,label:"",value:pe.name,onChange:v=>De({...pe,name:v.target.value}),required:!0,size:"medium"}),m.jsxs(qs,{fullWidth:!0,children:[m.jsx(Xs,{children:" "}),m.jsx(Ks,{value:pe.selectedClassId,onChange:v=>De({...pe,selectedClassId:v.target.value}),label:" ",size:"medium",children:h.map(v=>m.jsx(Nr,{value:v.id,children:v.name},v.id))})]}),m.jsx($r,{fullWidth:!0,label:"",type:"number",value:pe.number,onChange:v=>De({...pe,number:v.target.value}),required:!0,size:"medium"}),m.jsx($r,{fullWidth:!0,label:"",type:"date",value:pe.birthDate,onChange:v=>De({...pe,birthDate:v.target.value}),InputLabelProps:{shrink:!0},required:!0,size:"medium"})]})]}),m.jsxs(Hs,{children:[m.jsx(nt,{onClick:()=>{_t(!1),es(null)},children:""}),m.jsx(nt,{onClick:Ut?Ua:jf,variant:"contained",children:Ut?"":""})]})]}),m.jsxs(Ws,{open:Ft,onClose:()=>ut(!1),maxWidth:"sm",fullWidth:!0,children:[m.jsx($s,{children:dr.type==="merit"?"  ":"  "}),m.jsx(zs,{children:m.jsxs(Ge,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1,maxWidth:"500px",mx:"auto"},children:[m.jsxs(qs,{fullWidth:!0,children:[m.jsx(Xs,{children:""}),m.jsxs(Ks,{value:dr.type,onChange:v=>Ur({...dr,type:v.target.value}),label:"",size:"medium",children:[m.jsx(Nr,{value:"merit",children:""}),m.jsx(Nr,{value:"demerit",children:""})]})]}),m.jsx($r,{fullWidth:!0,label:"",value:dr.reason,onChange:v=>Ur({...dr,reason:v.target.value}),placeholder:" ",multiline:!0,rows:3,size:"medium"})]})}),m.jsxs(Hs,{children:[m.jsx(nt,{onClick:()=>ut(!1),children:""}),m.jsx(nt,{onClick:Vf,variant:"contained",children:""})]})]}),m.jsxs(Ws,{open:Lo,onClose:()=>Bs(!1),maxWidth:"lg",fullWidth:!0,children:[m.jsx($s,{children:$n?`${$n.name}   `:" "}),m.jsxs(zs,{children:[$n&&m.jsxs(Ge,{sx:{mb:3},children:[m.jsx(_e,{variant:"h6",gutterBottom:!0,children:" "}),m.jsxs(Tt,{container:!0,spacing:2,children:[m.jsx(Tt,{item:!0,xs:12,sm:6,children:m.jsxs(_e,{variant:"body2",color:"text.secondary",children:[": ",$n.studentId]})}),m.jsx(Tt,{item:!0,xs:12,sm:6,children:m.jsxs(_e,{variant:"body2",color:"text.secondary",children:["//: ",$n.grade," ",$n.class," ",$n.number,""]})}),m.jsx(Tt,{item:!0,xs:12,sm:6,children:m.jsxs(_e,{variant:"body2",color:"text.secondary",children:[" :",m.jsx(an,{label:$n.cumulativeScore||0,color:$n.cumulativeScore>0?"success":$n.cumulativeScore<0?"error":"default",size:"small",sx:{ml:1,fontWeight:"bold"}})]})})]})]}),m.jsx(_e,{variant:"h6",gutterBottom:!0,children:" "}),Va.length===0?m.jsx(_e,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",py:4},children:"  ."}):m.jsx(Ya,{component:ua,children:m.jsxs(Qa,{children:[m.jsx(Ja,{children:m.jsxs(on,{children:[m.jsx(Te,{sx:{fontWeight:"bold"},children:""}),m.jsx(Te,{sx:{fontWeight:"bold"},children:""}),m.jsx(Te,{sx:{fontWeight:"bold"},children:""}),m.jsx(Te,{sx:{fontWeight:"bold"},children:""}),m.jsx(Te,{sx:{fontWeight:"bold"},children:" "}),m.jsx(Te,{sx:{fontWeight:"bold"},children:" "})]})}),m.jsx(Za,{children:Va.map(v=>m.jsxs(on,{children:[m.jsx(Te,{children:v.createdAt?new Date(v.createdAt).toLocaleString():"N/A"}),m.jsx(Te,{children:m.jsx(an,{label:v.type==="merit"?"":"",color:v.type==="merit"?"success":"error",size:"small"})}),m.jsx(Te,{children:m.jsx(an,{label:v.points>0?`+${v.points}`:v.points,color:v.points>0?"success":"error",size:"small",sx:{fontWeight:"bold"}})}),m.jsx(Te,{children:v.reason||""}),m.jsx(Te,{children:v.description||""}),m.jsx(Te,{children:v.processedTeacherName||v.teacherName||v.creatorName||"N/A"})]},v.id))})]})})]}),m.jsx(Hs,{children:m.jsx(nt,{onClick:()=>Bs(!1),children:""})})]}),m.jsxs(Ws,{open:o,onClose:()=>{c(!1),a(null)},maxWidth:"md",fullWidth:!0,children:[m.jsx($s,{children:"   "}),m.jsx(zs,{children:i?m.jsx(Ge,{sx:{mt:1},children:m.jsxs(Tt,{container:!0,spacing:2,children:[m.jsxs(Tt,{item:!0,xs:12,sm:6,children:[m.jsx(_e,{variant:"subtitle2",color:"text.secondary",children:" "}),m.jsx(_e,{variant:"body1",sx:{fontWeight:"bold"},children:i.studentName||w.find(v=>v.id===i.studentId)?.name||"  "})]}),m.jsxs(Tt,{item:!0,xs:12,sm:6,children:[m.jsx(_e,{variant:"subtitle2",color:"text.secondary",children:""}),m.jsx(_e,{variant:"body1",children:i.studentId||w.find(v=>v.id===i.studentId)?.studentId||"N/A"})]}),m.jsxs(Tt,{item:!0,xs:12,sm:6,children:[m.jsx(_e,{variant:"subtitle2",color:"text.secondary",children:""}),m.jsx(an,{label:i.type==="merit"?"":"",color:i.type==="merit"?"success":"error",size:"medium",sx:{fontWeight:"bold"}})]}),m.jsxs(Tt,{item:!0,xs:12,sm:6,children:[m.jsx(_e,{variant:"subtitle2",color:"text.secondary",children:" "}),m.jsx(an,{label:i.points>0?`+${i.points}`:i.points,color:i.points>0?"success":"error",size:"medium",sx:{fontWeight:"bold",fontSize:"1rem"}})]}),m.jsxs(Tt,{item:!0,xs:12,sm:6,children:[m.jsx(_e,{variant:"subtitle2",color:"text.secondary",children:" "}),m.jsx(_e,{variant:"body1",children:i.processedTeacherName||i.teacherName||i.creatorName||"N/A"})]}),m.jsxs(Tt,{item:!0,xs:12,sm:6,children:[m.jsx(_e,{variant:"subtitle2",color:"text.secondary",children:" "}),m.jsx(_e,{variant:"body1",children:i.requestingTeacherName||"-"})]}),m.jsxs(Tt,{item:!0,xs:12,sm:6,children:[m.jsx(_e,{variant:"subtitle2",color:"text.secondary",children:""}),m.jsx(an,{label:i.status==="approved"?"":i.status==="rejected"?"":i.status==="pending"?"":"",color:i.status==="approved"?"success":i.status==="rejected"?"error":i.status==="pending"?"warning":"default",size:"small"})]}),m.jsxs(Tt,{item:!0,xs:12,sm:6,children:[m.jsx(_e,{variant:"subtitle2",color:"text.secondary",children:""}),m.jsx(_e,{variant:"body1",children:i.createdAt?.toDate?.()?new Date(i.createdAt.toDate()).toLocaleString("ko-KR"):i.createdAt?new Date(i.createdAt).toLocaleString("ko-KR"):"N/A"})]}),m.jsxs(Tt,{item:!0,xs:12,children:[m.jsx(_e,{variant:"subtitle2",color:"text.secondary",children:""}),m.jsx(_e,{variant:"body1",sx:{mt:1,p:2,backgroundColor:"#f5f5f5",borderRadius:1},children:i.reason||" "})]}),i.description&&m.jsxs(Tt,{item:!0,xs:12,children:[m.jsx(_e,{variant:"subtitle2",color:"text.secondary",children:" "}),m.jsx(_e,{variant:"body1",sx:{mt:1,p:2,backgroundColor:"#f5f5f5",borderRadius:1,whiteSpace:"pre-wrap"},children:i.description})]})]})}):m.jsx(_e,{children:"    ."})}),m.jsx(Hs,{children:m.jsx(nt,{onClick:()=>{c(!1),a(null)},children:""})})]}),m.jsxs(Ws,{open:Uc,onClose:()=>{},maxWidth:"sm",fullWidth:!0,children:[m.jsx($s,{sx:{color:"#ff9800",fontWeight:"bold"},children:"   "}),m.jsx(zs,{children:m.jsxs(Ge,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[m.jsxs(Uo,{severity:"warning",children:[m.jsx(_e,{variant:"body1",sx:{fontWeight:"bold",mb:1},children:" 9.   ."}),m.jsxs(_e,{variant:"body2",children:[ki?.currentAcademicYear," 1  2 ."]})]}),m.jsxs(_e,{variant:"body2",color:"text.secondary",children:["       .",m.jsx("br",{})," ,        ."]})]})}),m.jsxs(Hs,{children:[m.jsx(nt,{onClick:()=>{Ls(!1)},color:"inherit",children:""}),(ki?.status==="approved"||oi)&&m.jsx(nt,{onClick:sr,color:"error",variant:"outlined",children:""}),m.jsx(nt,{onClick:Wt,variant:"contained",color:"primary",sx:{fontWeight:"bold"},disabled:W,children:""})]})]}),m.jsxs(Ws,{open:Qn,onClose:()=>cs(!1),maxWidth:"sm",fullWidth:!0,children:[m.jsx($s,{children:" "}),m.jsx(zs,{children:m.jsxs(Ge,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[m.jsx(Uo,{severity:"info",children:m.jsxs(_e,{variant:"body2",children:[": ",Wa().academicYear," ",Wa().semester,""]})}),m.jsxs(qs,{fullWidth:!0,children:[m.jsx(Xs,{children:" "}),m.jsxs(Ks,{value:mr,onChange:v=>Sr(v.target.value),label:" ",children:[m.jsx(Nr,{value:"same_year",children:"1  2 ( )"}),m.jsx(Nr,{value:"new_year",children:"2  1 ( ,  +1)"})]})]}),m.jsxs(_e,{variant:"body2",color:"text.secondary",children:["1.      XLSX  .",m.jsx("br",{}),"2.    .",m.jsx("br",{}),'3.   "  "  .']})]})}),m.jsxs(Hs,{children:[m.jsx(nt,{onClick:()=>cs(!1),children:""}),m.jsx(nt,{variant:"outlined",onClick:$a,startIcon:m.jsx(Pu,{}),children:"  "}),m.jsx("input",{accept:".xlsx",style:{display:"none"},id:"new-semester-upload-dialog",type:"file",onChange:v=>{v.target.files&&v.target.files[0]&&(Ts(v.target.files[0]),cs(!1))}}),m.jsx("label",{htmlFor:"new-semester-upload-dialog",children:m.jsx(nt,{variant:"contained",component:"span",startIcon:m.jsx(qa,{}),children:"   "})})]})]}),m.jsx("input",{accept:".xlsx",style:{display:"none"},id:"new-semester-upload",type:"file",onChange:v=>{v.target.files&&v.target.files[0]&&Ts(v.target.files[0])}}),m.jsx("label",{htmlFor:"new-semester-upload",children:m.jsx(nt,{variant:"outlined",color:"primary",component:"span",startIcon:m.jsx(qa,{}),sx:{display:"none"},id:"new-semester-upload-trigger",children:"   "})}),m.jsxs(Ws,{open:Jn,onClose:()=>Tr(!1),maxWidth:"md",fullWidth:!0,children:[m.jsx($s,{children:" "}),m.jsx(zs,{children:m.jsx(Ge,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1,maxHeight:"60vh",overflowY:"auto"},children:Tn.map(v=>m.jsxs(Ge,{sx:{p:2,border:"1px solid #e0e0e0",borderRadius:1},children:[m.jsxs(_e,{variant:"h6",gutterBottom:!0,children:[v.name," (",v.studentCount,")"]}),m.jsxs(Ge,{sx:{display:"flex",gap:1,alignItems:"center"},children:[m.jsxs(qs,{fullWidth:!0,children:[m.jsx(Xs,{children:""}),m.jsxs(Ks,{value:Kt[v.id]||"",onChange:K=>{Ar({...Kt,[v.id]:K.target.value})},label:"",children:[m.jsx(Nr,{value:"",children:" "}),f.filter(K=>K.role==="homeroom_teacher"&&K.status!=="disabled").map(K=>m.jsxs(Nr,{value:K.id,children:[K.name," (",K.email,")"]},K.id)),m.jsx(Nr,{value:"__create_new__",children:"+  "})]})]}),Kt[v.id]==="__create_new__"&&m.jsx(nt,{variant:"outlined",onClick:()=>{na(v),zt(!0)},children:""})]})]},v.id))})}),m.jsxs(Hs,{children:[m.jsx(nt,{onClick:()=>Tr(!1),children:""}),m.jsx(nt,{variant:"contained",onClick:async()=>{try{U(!0);const v=br(ce);for(const K of Tn){const Q=Kt[K.id];if(Q&&Q!=="__create_new__"){const J=ht(ce,"classes",K.id),G=f.find(Z=>Z.id===Q);v.update(J,{homeroomTeacherId:Q,homeroomTeacherName:G?.name||"",updatedAt:new Date})}}await v.commit(),await Re.fire({title:"",text:"  .",icon:"success"}),Tr(!1),dt([]),Ar({}),window.location.reload()}catch(v){console.error("  :",v),await Re.fire({title:"",text:"    : "+v.message,icon:"error"})}finally{U(!1)}},children:""})]})]}),m.jsxs(Ws,{open:Zn,onClose:()=>{zt(!1),pn({name:"",email:"",phone:""}),na(null)},maxWidth:"sm",fullWidth:!0,children:[m.jsx($s,{children:" "}),m.jsx(zs,{children:m.jsxs(Ge,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[m.jsx($r,{fullWidth:!0,label:"",value:It.name,onChange:v=>pn({...It,name:v.target.value}),required:!0}),m.jsx($r,{fullWidth:!0,label:"",type:"email",value:It.email,onChange:v=>pn({...It,email:v.target.value}),required:!0}),m.jsx($r,{fullWidth:!0,label:"",value:It.phone,onChange:v=>pn({...It,phone:v.target.value})}),Es&&m.jsxs(Uo,{severity:"info",children:[Es.name," ."]})]})}),m.jsxs(Hs,{children:[m.jsx(nt,{onClick:()=>{zt(!1),pn({name:"",email:"",phone:""}),na(null)},children:""}),m.jsx(nt,{variant:"contained",onClick:async()=>{try{if(!It.name||!It.email){await Re.fire({title:"",text:"  .",icon:"error"});return}U(!0);const v={name:It.name,email:It.email,phone:It.phone||"",role:"homeroom_teacher",subject:"",status:"active",createdAt:new Date,updatedAt:new Date},K=await Rn(We(ce,"accounts"),v);if(Es){const Q=ht(ce,"classes",Es.id);await fi(Q,{homeroomTeacherId:K.id,homeroomTeacherName:It.name,updatedAt:new Date}),Ar({...Kt,[Es.id]:K.id})}await Re.fire({title:"",text:"  .",icon:"success"}),zt(!1),pn({name:"",email:"",phone:""}),na(null),window.location.reload()}catch(v){console.error("  :",v),await Re.fire({title:"",text:"    : "+v.message,icon:"error"})}finally{U(!1)}},children:""})]})]})]})]})},vB=Object.freeze(Object.defineProperty({__proto__:null,default:dB},Symbol.toStringTag,{value:"Module"}));export{gB as A,xB as F,qt as L,Re as S,ro as _,pC as a,Rn as b,We as c,ce as d,ht as e,fi as f,tt as g,d0 as h,fD as i,Ys as j,ju as k,iD as l,m0 as m,wB as n,Ko as o,Zd as p,St as q,vB as r,lb as s,mC as u,gt as w};
